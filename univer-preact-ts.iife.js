var UniverPreactTs=function(Ut){"use strict";var en=(r=>(r[r.OBSERVER_ACTION=1]="OBSERVER_ACTION",r[r.SERVER_ACTION=2]="SERVER_ACTION",r[r.UNDO_ACTION=3]="UNDO_ACTION",r[r.EXTENSION_ACTION=4]="EXTENSION_ACTION",r[r.DEFAULT_ACTION=7]="DEFAULT_ACTION",r))(en||{});class hd{constructor(e,t){this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class Qe extends hd{constructor(e,t,n){if(super(e,n),t.WorkBookUnit==null)throw new Error("action workbook domain can not be null!");this._workbook=t.WorkBookUnit}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class dd{constructor(e=!1){this.isStopPropagation=!1,this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class au{constructor(e){this.callback=e,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class ye{constructor(e){this._observers=new Array,this._eventState=new dd,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const s=new au(e);return s.unregisterOnNextCall=n,t?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),s}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return t!==-1?(this._observers.splice(t,1),!0):!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let s=0;s<this._observers.length;s++){const o=this._observers[s];if(!o._willBeUnregistered&&(t.lastReturnValue=o.callback(e,t),o.unregisterOnNextCall&&this._deferUnregister(o),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let s=0;s<this._observers.length;s++){const o=this._observers[s];n.skipNextObservers||o._willBeUnregistered||(t=t.then(()=>o.callback(e,n)),o.unregisterOnNextCall&&this._deferUnregister(o))}return t.then(()=>e)}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new ye;return e._observers=this._observers.slice(0),e}}class db extends ye{add(e){if(!e)return null;const t=new au(e);return this._observers=[t],this._onObserverAdded&&this._onObserverAdded(t),t}makeObserverTopPriority(){}makeObserverBottomPriority(){}}class gd{constructor(e,t){this.name=e,this.observableHooks=t}}class fd{constructor(){this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new gd(e,t))}getHooks(e){const t=this._observableHooksArray.find(n=>n.name===e);return t?t.observableHooks:null}}function md(r,e){let t=0,n=r.length-1;for(;t<=n;){let s=Math.floor((n+t)/2);if(e<r[s]&&(s===0||e>=r[s-1]))return s;if(e>=r[s])t=s+1;else if(e<r[s])n=s-1;else return-1}return-1}function pd(r,e){let t=0,n=0,s=0,o=-1,i=r.length-1;for(;t<r.length&&i>=0&&i>=t;){if(n=r[i],i===0?s=0:s=r[i-1],e>=s&&e<n){o=i;break}if(n=r[t],t===0?s=0:s=r[t-1],e>=s&&e<n){o=t;break}t++,i--}return o}function Ln(r,e){let t=r.length-1;return r.length<40||e<=r[20]||e>=r[t-20]?t=pd(r,e):t=md(r,e),t}const tr=r=>r!=null;class nt{static objectKeys(e){if(e){const t=Object.keys(e),n=t.indexOf("length");return n>-1&&t.splice(n,1),t}return[]}static getMaxLength(e){if(e){if(e.length)return e.length;const t=nt.objectKeys(e);if(t.length)return Math.max(...t)+1}return 0}constructor(...e){if(W.hasLength(e,1)){if(W.isObject(e[0])){this._array=e[0],this._length=nt.getMaxLength(this._array);return}if(W.isNumber(e[0])){this._array={},this._length=e[0];return}}if(W.hasLength(e,2)){const t=e[0],n=e[1];this._array=t,this._length=n;return}W.hasLength(e,0)&&(this._array={},this._length=0)}obtain(e,t){var n;return(n=this._array[e])!=null?n:t}getKeys(){return nt.objectKeys(this._array)}get(e){return this._array[e]}set(e,t){if(tr(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,s=t[n];return n>0&&(delete t[n],this._length--),s}return null}push(e){if(tr(e)){let t=this._length;const n=this._array;n[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let s;for(let o=0;o<n;o++)s=this._array[o+1],tr(s)&&(this._array[o]=s);return this._length--,delete this._array[n],t}return null}unshift(e){if(tr(e)){const t=this._length,n=this._array,s=t+1;let o=n[0];for(let i=1;i<s;i++){const a=this._array[i];tr(o)&&(n[i]=o),o=a}n[0]=e,this._length=s}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return{...this._array,length:this._length}}toArray(){const e=new Array,t=this._array,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){const i=+n[o];e[i]=t[i]}return e}forEach(e){const t=this._array,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){const i=+n[o];if(e(i,t[i])===!1)return this}return this}clone(e){const t=new nt;return e?this.forEach((n,s)=>{t.set(n,e(s))}):this.forEach((n,s)=>{t.set(n,s)}),t}isEmpty(){const e=this._array;return Object.keys(e).length===0}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){const i=+n[o];if(t[i]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const o={};let i=0;for(let a=e;a<t;a++){const l=n[a];tr(l)&&(o[i]=n[a],i++)}return new nt(o,i)}return new nt}concat(e){const t=this._array,n=Object.keys(t),s=n.length,o=e._array,i=Object.keys(o),a=i.length,l=new nt(s+a),u=l._array;let c=0;for(let h=0;h<s;h++,c++){const d=n[h];u[c]=t[d]}for(let h=0;h<a;h++,c++){const d=i[h];u[c]=o[d]}return l}find(e){const t=this._array,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){const i=+n[o],a=t[i];if(e(i,a)===!0)return a}return null}splice(e,t){const n=this._length;if(n>0){const s=e+t,o=this._array;let i=0;const a={};for(let c=e;c<s;c++){const h=o[c];tr(h)&&(delete o[c],a[i]=h,i++)}const l=s-e,u=n;if(this._length-=l,this._length<=0)this._array={},this._length=0;else for(let c=s;c<u;c++){const h=o[c];tr(h)&&(o[c-l]=o[c],delete o[c])}return new nt(a,i)}return new nt}findIndex(e){const t=this._array,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){const i=+n[o];if(e(i,t[i])===!0)return o}return-1}map(e){const t=this._array,n=Object.keys(t),s=n.length,o={};for(let i=0;i<s;i++){const a=+n[i],l=t[a];o[i]=e(l)}return new nt(o)}filter(e){const t=this._array,n=Object.keys(t),s=n.length,o={};let i=0;for(let a=0;a<s;a++){const l=+n[a],u=t[l];e(l,u)&&(o[i]=u,i++)}return new nt(o,i)}insert(e,t){const n=this._length,s=this._array;for(let o=n-1;o>=e;o--)s[o+1]=s[o];return s[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,s=t._length,o=this._array,a=this._length-1;for(let l=a;l>=e;l--){const u=o[l];tr(u)&&(delete o[l],o[l+s]=u)}for(let l=0;l<s;l++){const u=n[l];tr(u)&&(o[l+e]=n[l])}return this._length+=s,this}[Symbol.iterator](){return new oa(this)}}class oa{constructor(e){this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const s=t[n],o=e.get(+s);return this._cursor++,{value:o,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new oa(this._array)}}class _e{constructor(e={}){if(W.isAssignableFrom(e,_e)){this._matrix=e._matrix;return}if(W.isAssignableFrom(e,nt)){this._matrix=e;return}W.isPlainObject(e)&&(this._matrix=new nt(e))}getMatrix(){return this._matrix}forEach(e){const n=this._matrix.getKeys(),s=n.length;for(let o=0;o<s;o++){const i=+n[o],a=this.getRow(i);if(e(i,a)===!1)return this}return this}forValue(e){const n=this._matrix.getKeys(),s=n.length;for(let o=0;o<s;o++){const i=+n[o],a=this.getRow(i),l=a.getKeys(),u=l.length;for(let c=0;c<u;c++){const h=+l[c],d=a.get(h);if(e(i,h,d)===!1)return this}}return this}swapRow(e,t){const n=this._matrix.get(e),s=this._matrix.get(t);this._matrix.set(t,n),this._matrix.set(e,s)}getRow(e){const{_matrix:t}=this;let n=t.get(e);if(W.isAssignableFrom(n,nt))return n;if(W.isPlainObject(n))return n=new nt(n),t.set(e,n),n}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const n=new nt;return this._matrix.set(e,n),n}reset(){this._matrix=new nt({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._matrix.splice(e,t);return new _e(n)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const n=new _e;return this._matrix.forEach((s,o)=>{var i;for(let a=e;a<e+t;a++)n.setValue(s,a-e,this.getValue(s,a));(i=this._matrix.get(s))==null||i.splice(e,t)}),n}insertColumns(e,t){const n=t.getRow(0).getLength();this.forEach((s,o)=>{var i,a;for(let l=e;l<e+n;l++)(i=t.getRow(s))==null||i.get(l-e),o.insert(l,(a=t.getRow(s))==null?void 0:a.get(l-e))})}getFragments(e,t,n,s){const o=new _e;for(let i=e;i<=t;i++){const a=new nt;for(let l=n;l<=s;l++){const u=this.getValue(i,l);a.push(u)}o.pushRow(a)}return o}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const n=this.getSizeOf();let s=0;const o=this.getLength();for(let i=0;i<o;i++){const a=this.getRow(i);if(a){const l=a.getSizeOf();a.getSizeOf()>s&&(s=l-1)}}return{startRow:0,startColumn:0,endRow:n,endColumn:s}}toArray(){return this._matrix.toArray().map(e=>e.toArray())}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,s=!1;const o=new _e;return this.forEach((i,a)=>{n||(n=!0,e=i),a.forEach((l,u)=>{s?l<t&&(t=l):(s=!0,t=l);const c=this.getValue(i,l);o.setValue(i-e,l-t,c)})}),o.getData()}getDataRange(){let e=0,t=0,n=0,s=!1,o=!1;this.forEach((a,l)=>{s||(s=!0,e=a);const u=l.getLength()-1;u>n&&(n=u),l.forEach((c,h)=>{o?c<t&&(t=c):(o=!0,t=c)})});const i=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:i,endColumn:n}}}const gb=/^-ms-/,fb=/-([a-z])/g,Hr=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class W{static stringAt(e){let t="",n=e;for(;n>=Hr.length;)n/=Hr.length,n-=1,t+=Hr[n%Hr.length];const s=e%Hr.length;return t+=Hr[s],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const s=e.charCodeAt(n)-65,o=e.length-1-n;t+=Hr.length**o+Hr.length*s}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return W.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t=navigator.platform==="Win32"||navigator.platform==="Windows",n=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(n)return"Mac";if(navigator.platform==="X11"&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,s=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const c=parseFloat(RegExp.$1);return c===7?"IE7":c===8?"IE8":c===9?"IE9":c===10?"IE10":"0"}return i?"FF":t?"Opera":a?"Safari":l?"Chrome":o?"Edge":s?"IE11":"Unknown browser"}static generateRandomId(){function e(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){t.forEach(i=>i&&o(i));function n(i,a){i.forEach((l,u)=>{var c,h;if(W.isArray(l)){const d=(c=a[u])!=null?c:[];a[u]=d,n(l,d);return}if(W.isObject(l)){const d=(h=a[u])!=null?h:{};a[u]=d,s(l,d);return}a[u]=l})}function s(i,a){Object.keys(i).forEach(l=>{var c,h;const u=i[l];if(W.isObject(u)){const d=(c=a[l])!=null?c:{};a[l]=d,s(u,d);return}if(W.isArray(u)){const d=(h=a[l])!=null?h:[];a[l]=d,n(u,d);return}a[l]=u})}function o(i){Object.keys(i).forEach(a=>{var u,c;const l=i[a];if(W.isArray(l)){const h=(u=e[a])!=null?u:[];e[a]=h,n(l,h);return}if(W.isObject(l)){const h=(c=e[a])!=null?c:{};e[a]=h,s(l,h);return}e[a]=l})}return e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(i,a){const l=W.getValueType(i),u=W.getValueType(a);return l!==u?!1:W.isArray(i)?s(i,a):W.isObject(i)?o(i,a):W.isDate(i)?i.getTime()===a.getTime():W.isRegExp(i)?i.toString()===a.toString():i===a}function s(i,a){if(e.length!==t.length)return!1;for(let l=0,u=i.length;l<u;l++){const c=i[l],h=a[l];if(!n(c,h))return!1}return!0}function o(i,a){const l=Object.keys(i),u=Object.keys(a);if(l.length!==u.length)return!1;for(const c of l){if(!u.includes(c))return!1;const h=i[c],d=a[c];if(!n(h,d))return!1}return!0}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach((n,s)=>{t[s]=W.deepClone(n)}),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=W.deepClone(s)}),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return W.isDefine(e)?W.isDefine(t)?e.length===t:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(gb,"ms-").replace(fb,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];s==null?delete e[n]:W.removeNull(s)}),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map(s=>new Array(t).fill(n))}static fillObjectMatrix(e,t,n){const s=new _e;for(let o=0;o<e;o++)for(let i=0;i<t;i++)s.setValue(o,i,n);return s.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=n===0?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return NaN;const t=e.toLowerCase().split(""),n=t.length;let s=0,o=0;for(let i=0;i<n;i++)o=t[i].charCodeAt(0)-96,s+=o*26**(n-i-1);return s===0?NaN:s-1}static chatAtABC(e){const t="a".charCodeAt(0),s="z".charCodeAt(0)-t+1;let o="";for(;e>=0;)o=String.fromCharCode(e%s+t)+o,e=Math.floor(e/s)-1;return o.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const s=parseInt((Math.random()*n).toString()),o=e[s];e[s]=e[t],e[t]=o}return e}static commonExtend(e,t){let n={};for(let s in e)n[s]=e[s];for(let s in t)t[s]!=null&&(n[s]=t[s]);return n}static commonExtend1(e,t){for(let n in e)t[n]==null&&(t[n]=e[n]);return t}static arrayToObject(e){const t={};return e.forEach((n,s)=>{t[s]={},n.forEach((o,i)=>{t[s][i]=o})}),t}}var ia=(r=>(r[r.DEFAULT_SERIES=0]="DEFAULT_SERIES",r[r.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",r))(ia||{}),_d=(r=>(r.CELL_EMPTY="CELL_EMPTY",r.CELL_NOT_EMPTY="CELL_NOT_EMPTY",r.DATE_AFTER="DATE_AFTER",r.DATE_BEFORE="DATE_BEFORE",r.DATE_EQUAL_TO="DATE_EQUAL_TO",r.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",r.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",r.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",r.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",r.NUMBER_BETWEEN="NUMBER_BETWEEN",r.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",r.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",r.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",r.NUMBER_LESS_THAN="NUMBER_LESS_THAN",r.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",r.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",r.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",r.TEXT_CONTAINS="TEXT_CONTAINS",r.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",r.TEXT_EQUAL_TO="TEXT_EQUAL_TO",r.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",r.TEXT_STARTS_WITH="TEXT_STARTS_WITH",r.TEXT_ENDS_WITH="TEXT_ENDS_WITH",r.CUSTOM_FORMULA="CUSTOM_FORMULA",r))(_d||{}),C=(r=>(r[r.NONE=0]="NONE",r[r.THIN=1]="THIN",r[r.HAIR=2]="HAIR",r[r.DOTTED=3]="DOTTED",r[r.DASHED=4]="DASHED",r[r.DASH_DOT=5]="DASH_DOT",r[r.DASH_DOT_DOT=6]="DASH_DOT_DOT",r[r.DOUBLE=7]="DOUBLE",r[r.MEDIUM=8]="MEDIUM",r[r.MEDIUM_DASHED=9]="MEDIUM_DASHED",r[r.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",r[r.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",r[r.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",r[r.THICK=13]="THICK",r))(C||{}),Rn=(r=>(r.TOP="top",r.BOTTOM="bottom",r.LEFT="left",r.RIGHT="right",r.NONE="none",r.ALL="all",r.OUTSIDE="outside",r.INSIDE="inside",r.HORIZONTAL="horizontal",r.VERTICAL="vertical",r))(Rn||{}),In=(r=>(r[r.UNSUPPORTED=0]="UNSUPPORTED",r[r.RGB=1]="RGB",r[r.HEX=2]="HEX",r[r.THEME=3]="THEME",r))(In||{}),bd=(r=>(r[r.ON=0]="ON",r[r.OFF=1]="OFF",r))(bd||{}),vd=(r=>(r[r.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",r[r.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",r[r.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",r[r.NUMBER_LESS=3]="NUMBER_LESS",r[r.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",r[r.NUMBER_EQ=5]="NUMBER_EQ",r[r.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",r[r.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",r[r.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",r[r.TEXT_CONTAINS=9]="TEXT_CONTAINS",r[r.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",r[r.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",r[r.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",r[r.TEXT_EQ=13]="TEXT_EQ",r[r.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",r[r.TEXT_IS_URL=15]="TEXT_IS_URL",r[r.DATE_EQ=16]="DATE_EQ",r[r.DATE_BEFORE=17]="DATE_BEFORE",r[r.DATE_AFTER=18]="DATE_AFTER",r[r.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",r[r.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",r[r.DATE_BETWEEN=21]="DATE_BETWEEN",r[r.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",r[r.DATE_IS_VALID=23]="DATE_IS_VALID",r[r.ONE_OF_RANGE=24]="ONE_OF_RANGE",r[r.ONE_OF_LIST=25]="ONE_OF_LIST",r[r.BLANK=26]="BLANK",r[r.NOT_BLANK=27]="NOT_BLANK",r[r.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",r[r.BOOLEAN=29]="BOOLEAN",r[r.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",r[r.DATE_NOT_EQ=31]="DATE_NOT_EQ",r))(vd||{}),Xs=(r=>(r[r.PASTE_NORMAL=0]="PASTE_NORMAL",r[r.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",r[r.PASTE_FORMAT=2]="PASTE_FORMAT",r[r.PASTE_FORMULA=3]="PASTE_FORMULA",r[r.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",r[r.PASTE_VALUES=5]="PASTE_VALUES",r[r.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",r[r.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",r))(Xs||{}),Cd=(r=>(r[r.DOCUMENT=0]="DOCUMENT",r[r.PROJECT=1]="PROJECT",r))(Cd||{}),Ur=(r=>(r[r.COLUMNS=0]="COLUMNS",r[r.ROWS=1]="ROWS",r))(Ur||{}),ee=(r=>(r[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT",r[r.TOP=2]="TOP",r[r.BOTTOM=3]="BOTTOM",r))(ee||{}),aa=(r=>(r[r.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",r[r.TEXT=1]="TEXT",r[r.NUMBER=2]="NUMBER",r[r.PERCENT=3]="PERCENT",r[r.CURRENCY=4]="CURRENCY",r[r.DATE=5]="DATE",r[r.TIME=6]="TIME",r[r.DATE_TIME=7]="DATE_TIME",r[r.SCIENTIFIC=8]="SCIENTIFIC",r))(aa||{}),Ed=(r=>(r[r.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",r[r.MIN=1]="MIN",r[r.MAX=2]="MAX",r[r.NUMBER=3]="NUMBER",r[r.PERCENT=4]="PERCENT",r[r.PERCENTILE=5]="PERCENTILE",r))(Ed||{}),gr=(r=>(r[r.BACKSPACE=8]="BACKSPACE",r[r.TAB=9]="TAB",r[r.ENTER=13]="ENTER",r[r.SHIFT=16]="SHIFT",r[r.CTRL=17]="CTRL",r[r.PAUSE=19]="PAUSE",r[r.CAPS_LOCK=20]="CAPS_LOCK",r[r.ESC=27]="ESC",r[r.SPACE=33]="SPACE",r[r.PAGE_UP=33]="PAGE_UP",r[r.PAGE_DOWN=34]="PAGE_DOWN",r[r.END=35]="END",r[r.HOME=36]="HOME",r[r.LEFT=37]="LEFT",r[r.UP=38]="UP",r[r.RIGHT=39]="RIGHT",r[r.DOWN=40]="DOWN",r[r.INSERT=45]="INSERT",r[r.DELETE=46]="DELETE",r[r.WIN=91]="WIN",r[r.WIN_R=92]="WIN_R",r[r.MENU=93]="MENU",r[r.F1=112]="F1",r[r.F2=113]="F2",r[r.F3=114]="F3",r[r.F4=115]="F4",r[r.F5=116]="F5",r[r.F6=117]="F6",r[r.F7=118]="F7",r[r.F8=119]="F8",r[r.F9=120]="F9",r[r.F10=121]="F10",r[r.F11=122]="F11",r[r.F12=123]="F12",r[r.NUM_LOCK=144]="NUM_LOCK",r[r.SCROLL_LOCK=145]="SCROLL_LOCK",r))(gr||{}),lu=(r=>(r.backspace="Backspace",r.delete="Delete",r))(lu||{}),bn=(r=>(r.EN="en",r.ZH="zh",r))(bn||{}),wd=(r=>(r[r.RANGE=0]="RANGE",r[r.SHEET=1]="SHEET",r))(wd||{}),Td=(r=>(r[r.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",r[r.PAST_YEAR=1]="PAST_YEAR",r[r.PAST_MONTH=2]="PAST_MONTH",r[r.PAST_WEEK=3]="PAST_WEEK",r[r.YESTERDAY=4]="YESTERDAY",r[r.TODAY=5]="TODAY",r[r.TOMORROW=6]="TOMORROW",r))(Td||{}),Dt=(r=>(r[r.GRID=0]="GRID",r[r.KANBAN=1]="KANBAN",r[r.GANTT=2]="GANTT",r))(Dt||{}),Ys=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",r[r.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",r))(Ys||{}),Tt=(r=>(r[r.DASH=0]="DASH",r[r.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",r[r.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",r[r.DASHED_HEAVY=3]="DASHED_HEAVY",r[r.DASH_LONG=4]="DASH_LONG",r[r.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",r[r.DOT_DASH=6]="DOT_DASH",r[r.DOT_DOT_DASH=7]="DOT_DOT_DASH",r[r.DOTTED=8]="DOTTED",r[r.DOTTED_HEAVY=9]="DOTTED_HEAVY",r[r.DOUBLE=10]="DOUBLE",r[r.NONE=11]="NONE",r[r.SINGLE=12]="SINGLE",r[r.THICK=13]="THICK",r[r.WAVE=14]="WAVE",r[r.WAVY_DOUBLE=15]="WAVY_DOUBLE",r[r.WAVY_HEAVY=16]="WAVY_HEAVY",r[r.WORDS=17]="WORDS",r))(Tt||{}),ut=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LEFT=1]="LEFT",r[r.CENTER=2]="CENTER",r[r.RIGHT=3]="RIGHT",r[r.JUSTIFIED=4]="JUSTIFIED",r))(ut||{}),tn=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.TOP=1]="TOP",r[r.MIDDLE=2]="MIDDLE",r[r.BOTTOM=3]="BOTTOM",r))(tn||{}),kt=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.OVERFLOW=1]="OVERFLOW",r[r.CLIP=2]="CLIP",r[r.WRAP=3]="WRAP",r))(kt||{}),Sd=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ITALIC=1]="ITALIC",r))(Sd||{}),yd=(r=>(r[r.NORMAL=0]="NORMAL",r[r.BOLD=1]="BOLD",r))(yd||{}),cn=(r=>(r[r.NORMAL=0]="NORMAL",r[r.SUBSCRIPT=1]="SUBSCRIPT",r[r.SUPERSCRIPT=2]="SUPERSCRIPT",r))(cn||{}),te=(r=>(r[r.FALSE=0]="FALSE",r[r.TRUE=1]="TRUE",r))(te||{}),xn=(r=>(r[r.STRING=0]="STRING",r[r.NUMBER=1]="NUMBER",r[r.BOOLEAN=2]="BOOLEAN",r[r.FORCE_STRING=3]="FORCE_STRING",r))(xn||{}),hn=(r=>(r[r.DARK1=0]="DARK1",r[r.LIGHT1=1]="LIGHT1",r[r.DARK2=2]="DARK2",r[r.LIGHT2=3]="LIGHT2",r[r.ACCENT1=4]="ACCENT1",r[r.ACCENT2=5]="ACCENT2",r[r.ACCENT3=6]="ACCENT3",r[r.ACCENT4=7]="ACCENT4",r[r.ACCENT5=8]="ACCENT5",r[r.ACCENT6=9]="ACCENT6",r[r.HYPERLINK=10]="HYPERLINK",r[r.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",r))(hn||{}),la=(r=>(r.OFFICE="Office",r.OFFICE_2007_2010="Office 2007-2010",r.GRAYSCALE="Grayscale",r.BLUE_WARM="Blue Warm",r.BLUE="Blue",r.BLUE_II="Blue II",r.BLUE_GREEN="Blue Green",r.GREEN="Green",r.GREEN_YELLOW="Green Yellow",r.YELLOW="Yellow",r.YELLOW_ORANGE="Yellow Orange",r.ORANGE="Orange",r.ORANGE_RED="Orange Red",r.RED_ORANGE="Red Orange",r.RED="Red",r.RED_VIOLET="Red Violet",r.VIOLET="Violet",r.VIOLET_II="Violet II",r.MEDIAN="Median",r.PAPER="Paper",r.MARQUEE="Marquee",r.SLIPSTREAM="Slipstream",r.Aspect="Aspect",r))(la||{}),Ot=(r=>(r[r.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",r[r.TEXT_BOX=1]="TEXT_BOX",r[r.RECTANGLE=2]="RECTANGLE",r[r.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",r[r.ELLIPSE=4]="ELLIPSE",r[r.ARC=5]="ARC",r[r.BENT_ARROW=6]="BENT_ARROW",r[r.BENT_UP_ARROW=7]="BENT_UP_ARROW",r[r.BEVEL=8]="BEVEL",r[r.BLOCK_ARC=9]="BLOCK_ARC",r[r.BRACE_PAIR=10]="BRACE_PAIR",r[r.BRACKET_PAIR=11]="BRACKET_PAIR",r[r.CAN=12]="CAN",r[r.CHEVRON=13]="CHEVRON",r[r.CHORD=14]="CHORD",r[r.CLOUD=15]="CLOUD",r[r.CORNER=16]="CORNER",r[r.CUBE=17]="CUBE",r[r.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",r[r.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",r[r.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",r[r.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",r[r.DECAGON=22]="DECAGON",r[r.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",r[r.DIAMOND=24]="DIAMOND",r[r.DODECAGON=25]="DODECAGON",r[r.DONUT=26]="DONUT",r[r.DOUBLE_WAVE=27]="DOUBLE_WAVE",r[r.DOWN_ARROW=28]="DOWN_ARROW",r[r.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",r[r.FOLDED_CORNER=30]="FOLDED_CORNER",r[r.FRAME=31]="FRAME",r[r.HALF_FRAME=32]="HALF_FRAME",r[r.HEART=33]="HEART",r[r.HEPTAGON=34]="HEPTAGON",r[r.HEXAGON=35]="HEXAGON",r[r.HOME_PLATE=36]="HOME_PLATE",r[r.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",r[r.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",r[r.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",r[r.LEFT_ARROW=40]="LEFT_ARROW",r[r.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",r[r.LEFT_BRACE=42]="LEFT_BRACE",r[r.LEFT_BRACKET=43]="LEFT_BRACKET",r[r.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",r[r.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",r[r.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",r[r.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",r[r.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",r[r.MATH_DIVIDE=49]="MATH_DIVIDE",r[r.MATH_EQUAL=50]="MATH_EQUAL",r[r.MATH_MINUS=51]="MATH_MINUS",r[r.MATH_MULTIPLY=52]="MATH_MULTIPLY",r[r.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",r[r.MATH_PLUS=54]="MATH_PLUS",r[r.MOON=55]="MOON",r[r.NO_SMOKING=56]="NO_SMOKING",r[r.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",r[r.OCTAGON=58]="OCTAGON",r[r.PARALLELOGRAM=59]="PARALLELOGRAM",r[r.PENTAGON=60]="PENTAGON",r[r.PIE=61]="PIE",r[r.PLAQUE=62]="PLAQUE",r[r.PLUS=63]="PLUS",r[r.QUAD_ARROW=64]="QUAD_ARROW",r[r.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",r[r.RIBBON=66]="RIBBON",r[r.RIBBON_2=67]="RIBBON_2",r[r.RIGHT_ARROW=68]="RIGHT_ARROW",r[r.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",r[r.RIGHT_BRACE=70]="RIGHT_BRACE",r[r.RIGHT_BRACKET=71]="RIGHT_BRACKET",r[r.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",r[r.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",r[r.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",r[r.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",r[r.SMILEY_FACE=76]="SMILEY_FACE",r[r.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",r[r.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",r[r.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",r[r.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",r[r.STAR_10=81]="STAR_10",r[r.STAR_12=82]="STAR_12",r[r.STAR_16=83]="STAR_16",r[r.STAR_24=84]="STAR_24",r[r.STAR_32=85]="STAR_32",r[r.STAR_4=86]="STAR_4",r[r.STAR_5=87]="STAR_5",r[r.STAR_6=88]="STAR_6",r[r.STAR_7=89]="STAR_7",r[r.STAR_8=90]="STAR_8",r[r.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",r[r.SUN=92]="SUN",r[r.TRAPEZOID=93]="TRAPEZOID",r[r.TRIANGLE=94]="TRIANGLE",r[r.UP_ARROW=95]="UP_ARROW",r[r.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",r[r.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",r[r.UTURN_ARROW=98]="UTURN_ARROW",r[r.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",r[r.WAVE=100]="WAVE",r[r.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",r[r.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",r[r.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",r[r.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",r[r.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",r[r.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",r[r.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",r[r.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",r[r.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",r[r.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",r[r.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",r[r.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",r[r.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",r[r.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",r[r.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",r[r.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",r[r.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",r[r.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",r[r.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",r[r.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",r[r.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",r[r.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",r[r.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",r[r.FLOW_CHART_OR=124]="FLOW_CHART_OR",r[r.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",r[r.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",r[r.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",r[r.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",r[r.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",r[r.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",r[r.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",r[r.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",r[r.ARROW_EAST=133]="ARROW_EAST",r[r.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",r[r.ARROW_NORTH=135]="ARROW_NORTH",r[r.SPEECH=136]="SPEECH",r[r.STARBURST=137]="STARBURST",r[r.TEARDROP=138]="TEARDROP",r[r.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",r[r.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",r[r.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",r[r.CUSTOM=142]="CUSTOM",r))(Ot||{});class js{constructor(){this._colorType=In.UNSUPPORTED,this._themeColors=la.OFFICE,this._themeTint=0}asRgbColor(){return new Jo(this._rgbValue,this)}asThemeColor(){return new uu(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case In.THEME:return this.asThemeColor();case In.RGB:return this.asRgbColor();case In.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=In.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=In.THEME,this._themeColors=e}setThemeTint(e){this._colorType=In.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=In.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const Ad={[la.OFFICE]:{[hn.ACCENT1]:"#4472C4",[hn.ACCENT2]:"#ED7D31",[hn.ACCENT3]:"#A5A5A5",[hn.ACCENT4]:"#70AD47",[hn.ACCENT5]:"#5B9BD5",[hn.ACCENT6]:"#70AD47",[hn.DARK1]:"#000000",[hn.DARK2]:"#44546A",[hn.LIGHT1]:"#FFFFFF",[hn.LIGHT2]:"#E7E6E6",[hn.HYPERLINK]:"#0563C1",[hn.FOLLOWED_HYPERLINK]:"#954F72"}};class nr{static rgbColorToHexValue(e){return`#${(16777216+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,s=+`0x${e[4]}${e[5]}`;return new js().setRgbColor(`rgb(${t},${n},${s})`).asRgbColor()}static hexToRgbString(e){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(o,i,a,l)=>i+i+a+a+l+l);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s=null;if(n){const o=parseInt(n[1],16),i=parseInt(n[2],16),a=parseInt(n[3],16);s=`rgba(${o},${i},${a})`}return s}constructor(e){this._builder=e}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new nr(this._builder)}equals(e){return!1}}class Rd{constructor(e){const t=e.getRed()/255,n=e.getGreen()/255,s=e.getBlue()/255,o=e.getAlpha()/255,i=Math.min(t,Math.min(n,s)),a=Math.max(t,Math.max(n,s)),l=a-i;if(a===i){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(i+a)/2,this._lightness<.5?this._saturation=l/(a+i):this._saturation=l/(2-a-i),t===a&&(this._hue=(n-s)/l),n===a&&(this._hue=2+(s-t)/l),s===a&&(this._hue=4+(t-n)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new js;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let t;this._lightness<.5?t=this._lightness*(1+this._saturation):t=this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,s=this._hue/360,o=s+1/3,i=this.setColor(t,n,o),a=this.setColor(t,n,s),l=s-1/3,u=this.setColor(t,n,l);return e.setRgbColor(`rgba(${Math.round(i*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){n<0&&(n+=1),n>1&&(n-=1);let s;return 6*n<1?s=t+(e-t)*6*n:2*n<1?s=e:3*n<2?s=t+(e-t)*(.6666666666666666-n)*6:s=t,s}setLightness(e){this._lightness=e}}const zr=class extends nr{constructor(r,e){super(e);let t=r.match(zr.RGBA_EXTRACT);if(t){const n=+t[1],s=+t[2],o=+t[3],i=+t[4];this._cssString=r,this._red=n,this._green=s,this._blue=o,this._alpha=i;return}if(t=r.match(zr.RGB_EXTRACT),t){const n=+t[1],s=+t[2],o=+t[3];this._cssString=r,this._red=n,this._green=s,this._blue=o,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return nr.rgbColorToHexValue(this)}getRed(){let r=this._red+zr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getGreen(){let r=this._green+zr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getBlue(){let r=this._blue+zr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getAlpha(){return this._alpha}getColorType(){return In.RGB}clone(){return new zr(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(r){return r instanceof zr?r._red===this._red&&r._blue===this._blue&&r._green===this._green&&r._alpha===this._alpha:!1}getCssString(){return this._cssString}};let Jo=zr;Jo.RGB_COLOR_AMT=0,Jo.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),Jo.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const Ks=class extends nr{constructor(r,e,t,n){super(n),this._themeColorType=r,this._themeTint=e,this._themeColors=t}lumValue(r,e){if(r==null)return e;let t;return r<0?t=e*(1+r):t=e*(1-r)+(255-255*(1-r)),t}asRgbColor(){const r=Ad[this._themeColors];if(r==null)throw new Error("not find themeColors type");const e=r.get(this._themeColorType);if(e==null)throw new Error("not find themeColors value");let t;if(Ks._cacheThemeColor.has(this._themeColors)){if(t=Ks._cacheThemeColor.get(this._themeColors),t.has(this._themeColorType))return t.get(this._themeColorType)}else t=new Map,Ks._cacheThemeColor.set(this._themeColors,t);const n=new Rd(nr.hexValueToRgbColor(e));n.setLightness(this.lumValue(this._themeTint,n.getLightness()*255)/255);const s=n.asRgbColor();return t.set(this._themeColorType,s),s}clone(){return new Ks(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(r){return r instanceof Ks?r._themeColorType===this._themeColorType:!1}getColorType(){return In.THEME}getThemeColorType(){return this._themeColorType}};let uu=Ks;uu._cacheThemeColor=new Map;var $=(r=>(r.INSERT_ROW_DATA_ACTION="InsertRowDataAction",r.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",r.INSERT_ROW_ACTION="InsertRowAction",r.REMOVE_ROW_ACTION="RemoveRowAction",r.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",r.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",r.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",r.SET_SELECTION_ACTION="SetSelectionActivateAction",r.SET_RANGE_DATA_ACTION="SetRangeDataAction",r.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",r.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",r.DELETE_RANGE_ACTION="DeleteRangeAction",r.INSERT_SHEET_ACTION="InsertSheetAction",r.REMOVE_SHEET_ACTION="RemoveSheetAction",r.CLEAR_RANGE_ACTION="ClearRangeAction",r.INSERT_RANGE_ACTION="InsertRangeAction",r.SET_TAB_COLOR_ACTION="SetTabColorAction",r.HIDE_SHEET_ACTION="SetWorkSheetHideAction",r.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",r.INSERT_COLUMN_ACTION="InsertColumnAction",r.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",r.REMOVE_COLUMN_ACTION="RemoveColumnAction",r.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",r.SET_HIDE_ROW_ACTION="SetRowHideAction",r.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",r.SET_SHOW_ROW_ACTION="SetRowShowAction",r.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",r.ADD_MERGE_ACTION="AddMergeAction",r.REMOVE_MERGE_ACTION="RemoveMergeAction",r.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",r.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",r.SET_BORDER_ACTION="SetBorderAction",r.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",r.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",r.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",r.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",r.DELETE_BANDING_ACTION="DeleteBandingAction",r.SET_BANDING_ACTION="SetBandingAction",r.ADD_BANDING_ACTION="AddBandingAction",r.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",r.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",r.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",r.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",r.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",r.SET_FROZEN_COLUMNS_ACTION="",r.SET_FROZEN_ROWS_ACTION="",r))($||{});const Qo={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},Id={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},Zs={startRow:0,startColumn:0,endRow:0,endColumn:0},xd={extensions:[],id:"",sheetOrder:[],socketEnable:te.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:bn.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},Wr={type:Dt.GRID,name:"",id:"sheet-01",tabColor:"",hidden:te.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:te.FALSE,showGridlines:te.TRUE,rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A1"],rightToLeft:te.FALSE,pluginMeta:{}},us={ff:"Times New Roman",fs:14,it:te.FALSE,bl:te.FALSE,ul:{s:te.FALSE},st:{s:te.FALSE},ol:{s:te.FALSE},tr:{a:0,v:te.FALSE},td:Ys.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:ut.UNSPECIFIED,vt:tn.UNSPECIFIED,tb:kt.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Dd={id:"default_doc",documentStyle:{}},Od={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var Fd=(r=>(r.ARRAY_CONVERTOR="ARRAY_CONVERTOR",r.MATRIX_CONVERTOR="MATRIX_CONVERTOR",r))(Fd||{});const cu={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var Pe=(r=>(r.BASE_COMPONENT="baseComponent",r.BASE_RENDER="renderEngine",r.SPREADSHEET="spreadsheet",r.DOCUMENT="document",r.SLIDE="slide",r))(Pe||{});class Md{constructor(e,t){this._workSheet=e,this._columnData=new nt(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new nt;for(let s=e;s<e+t;s++){const o=this.getColumnOrCreate(s);n.push(o)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig();let o=0;if(e.length===1)o=n.obtain(e[0],{hd:te.FALSE,w:s.defaultColumnWidth}).w;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)o+=n.obtain(i,{hd:te.FALSE,w:s.defaultColumnWidth}).w;return o}setColumnWidth(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:$.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},i=new ge({WorkBookUnit:n.getWorkBook()},o);s.invoke(i)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig(),o=n.get(e);if(o)return o;const i={w:s.defaultColumnWidth,hd:te.FALSE};return this._columnData.set(e,i),i}}function Nd(r,e){let t=[];for(let n=0;n<e.length;n++)r.add(e[n]);return t}function kd(r,e){let t=[];for(let n=0;n<e.length;n++)t=t.concat(r.remove(e[n]));return t}class Bd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet();return Nd(e.getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){const e=this.getWorkSheet();kd(e.getMerges(),this._doActionData.rectangles)}validate(){return!1}}function Ld(r,e){r.push(e)}function Pd(r,e){return r.find((t,n)=>t.namedRangeId===e?(r.splice(n,1),t):null)}class Hd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={actionName:$.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),Ld(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:$.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:Pd(n,e)}}validate(){return!1}}function mb(r,e,t){const{startRow:n,endRow:s,startColumn:o,endColumn:i}=t,a=new _e;for(let l=n;l<=s;l++)for(let u=o;u<=i;u++){const c=r.getValue(l,u);a.setValue(l,u,W.deepClone(c)),c&&(e.formatOnly&&delete c.s,e.contentsOnly&&(c.v="",c.m=""),r.setValue(l,u,W.deepClone(c)))}return a.getData()}function Ud(r,e,t,n){const{startRow:s,endRow:o,startColumn:i,endColumn:a}=n,l=o-s+1,u=a-i+1,c=r.rowCount,h=r.columnCount,d=new _e;if(t===Ur.ROWS)for(let g=s;g<=c;g++)for(let m=i;m<=a;m++){if(g<=o){const p=e.getValue(g,m);d.setValue(g,m,p)}const f=e.getValue(g+l,m);f?e.setValue(g,m,W.deepClone(f)):e.getValue(g,m)&&(e.deleteValue(g,m),m--)}else if(t===Ur.COLUMNS)for(let g=s;g<=o;g++)for(let m=i;m<=h;m++){if(m<=a){const p=e.getValue(g,m);d.setValue(g,m,p)}else for(let p=0;p<=a;p++){const b=e.getValue(g,m);d.setValue(g,m+p,b)}const f=e.getValue(g,m+u);if(f)e.setValue(g,m,W.deepClone(f));else if(e.getValue(g,m)){for(let b=0;b<=a;b++)e.deleteValue(g,m);break}}return d.getData()}function zd(r,e){const t=r.getConfig(),n=t.hidden;return t.hidden=e,n}function Wd(r=0,e=1,t){new nt(t).inserts(r,new nt(e))}function Vd(r,e,t){new _e(t).insertColumns(r,new _e(e))}function $d(r,e,t){new _e(t).insertRows(r,new _e(e))}function Gd(r,e,t,n,s){const{startRow:o,endRow:i,startColumn:a,endColumn:l}=n,u=i-o+1,c=l-a+1,h=r.rowCount,d=r.columnCount;if(t===Ur.ROWS){for(let g=h;g>=o;g--)for(let m=a;m<=l;m++){const f=e.getValue(g,m);e.setValue(g+u,m,f)}for(let g=i;g>=o;g--)for(let m=a;m<=l;m++)e.setValue(g,m,s[g-o][m-a])}else if(t===Ur.COLUMNS){for(let g=o;g<=i;g++)for(let m=d;m>=a;m--){const f=e.getValue(g,m);e.setValue(g,m+c,f)}for(let g=o;g<=i;g++)for(let m=l;m>=a;m--)e.setValue(g,m,s[g-o][m-a])}}function Xd(r=0,e=1,t){new nt(t).inserts(r,new nt(e))}function Yd(r,e,t){const n=r.getWorksheets(),s=r.getConfig(),{sheets:o,sheetOrder:i}=s;if(o[t.id])throw new Error(`Insert Sheet fail ${t.id} is already exist`);return o[t.id]=t,i.splice(e,0,t.id),n.set(t.id,new vn(r.getContext(),t)),t.id}function jd(r,e,t){const n=new nt(t),s=new nt,o=r,i=r+e;for(let a=o;a<i;a++){const l=n.splice(r,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function Kd(r,e,t){return new _e(t).spliceColumns(r,e).toJSON()}function Zd(r,e,t){const n=new nt(t),s=new nt,o=r,i=r+e;for(let a=o;a<i;a++){const l=n.splice(r,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function qd(r,e,t){return new _e(t).spliceRows(r,e).toJSON()}function Jd(r,e){const t=r.getWorksheets(),n=r.getConfig(),{sheets:s}=n;if(s[e]==null)throw new Error(`Remove Sheet fail ${e} is not exist`);const o=s[e],i=n.sheetOrder.findIndex(a=>a===e);return delete s[e],i!==n.sheetOrder.length-1?s[n.sheetOrder[i+1]].status=1:s[n.sheetOrder[i-1]].status=1,n.sheetOrder.splice(i,1),t.delete(e),{index:i,sheet:o}}function Qd(r,e,t){const n=new _e(t),s=new _e;return n.forValue((o,i,a)=>{const l=r.getValue(o,i);if(l){const u=e.get(l.s);u&&s.setValue(o,i,u),l.s=e.setValue(a)}}),s.toJSON()}function eg(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getColumnOrCreate(n);s.hd=1}}function tg(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getColumn(n);s&&(s.hd=0)}}function ng(r=0,e,t){const n=[];for(let s=r;s<r+e.length;s++){const o=t.getColumnOrCreate(s);n[s-r]=o.w,o.w=e[s-r]}return n}function rg(r,e){const t=r.getConfig(),n=t.showGridlines===0;return e?t.showGridlines=0:t.showGridlines=1,n}function sg(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getRowOrCreate(n);s&&(s.hd=1)}}function og(r,e){return r.find((t,n)=>t.namedRangeId===e.namedRangeId?(r[n]=e,t):null)}function ig(r,e,t,n){const{startRow:s,endRow:o,startColumn:i,endColumn:a}=t,l=new _e;for(let u=s;u<=o;u++)for(let c=i;c<=a;c++){const h=r.getValue(u,c)||{},d=n.getStyleByCell(h);d==null&&delete h.s;const g=hu(d,e[u-s][c-i]);g&&W.removeNull(g),W.isEmptyObject(g)?delete h.s:h.s=n.setValue(g),h.p&&bb(h.p,e[u-s][c-i]),r.setValue(u,c,h),l.setValue(u-s,c-i,ag(d,e[u-s][c-i]))}return l.getData()}function ag(r,e){return pb(r,e)}function pb(r,e){if(!e||!Object.keys(e).length)return r;const t=W.deepClone(r)||{};for(const n in e)n==="bd"?t[n]=_b(t[n]||{},e[n]):n in t||(t[n]=null);return t}function _b(r,e){if(!e||!Object.keys(e).length)return r;for(const t in e)t in r||(r[t]=null);return r}function hu(r,e,t=!1){if(e===null)return e;if(e===void 0)return r;const n=W.deepClone(r)||{};for(const s in e)t&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in n&&s==="bd"?n[s]=Object.assign(n[s],e[s]):(n[s]=e[s],"cl"in n&&["ul","ol","st"].includes(s)&&(n[s].cl=n.cl)));return n}function bb(r,e){var t;(t=r.body)==null||t.blockElementOrder.forEach(n=>{var s,o;if(((s=r.body)==null?void 0:s.blockElements[n].blockType)===0){const i=(o=r.body)==null?void 0:o.blockElements[n].paragraph;i==null||i.elementOrder.forEach(({elementId:a,paragraphElementType:l})=>{i.elements[a].tr||(i.elements[a].tr={});const u=i.elements[a].tr;u.ts||(u.ts={});const c=u.ts,h=hu(c,e,!0);h&&W.removeNull(h),W.isEmptyObject(h)?delete u.ts:u.ts=h})}})}function du(r,e,t,n){let s=new _e(e);const o=new _e;return n?(s.forValue((i,a,l)=>{const u=r.getValue(i,a),c={};n.contentsOnly&&(c.m=u==null?void 0:u.m,c.v=u==null?void 0:u.v),n.formatOnly&&(c.v=u==null?void 0:u.v,c.m=u==null?void 0:u.m),o.setValue(i,a,c||{}),r.setValue(i,a,l||{})}),o.getData()):(s.forValue((i,a,l)=>{const u=r.getValue(i,a)||{};if(!l)r.setValue(i,a,l),o.setValue(i,a,u);else{const c=t.getStyleByCell(u),h=ag(c,l==null?void 0:l.s),d=W.deepClone(u);d.s=h,o.setValue(i,a,d),c==null&&delete u.s;const g=hu(c,l==null?void 0:l.s);g&&W.removeNull(g),W.isEmptyObject(g)?delete u.s:u.s=t.setValue(g),l.v!=null&&(u.v=l.v),l.m!=null?u.m=l.m:u.m=String(u.v),l.t!=null&&(u.t=l.t),r.setValue(i,a,u)}}),o.getData())}function lg(r,e,t){const n=new _e(e),s=new _e;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(o,i);if(a){JSON.parse(a);const l=r.getValue(o,i),u=W.deepClone(l||{});r.setValue(o,i,u||{})}else{const l=r.getValue(o,i),u=W.deepClone(l||{});r.setValue(o,i,u||{})}}return s.getData()}function ug(r,e,t){const n=new _e(e),s=new _e;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(o,i),l=r.getValue(o,i),u=W.deepClone(l||{});u.f=a,r.setValue(o,i,u||{})}return s.getData()}function cg(r,e,t){const n=new _e(e),s=new _e;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(o,i),l=r.getValue(o,i),u=W.deepClone(l||{});u.n=a,r.setValue(o,i,u||{})}return s.getData()}function hg(r,e,t){const n=new _e(e),s=new _e;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(o,i),l=r.getValue(o,i);s.setValue(o,i,l&&l.v||"");const u=W.deepClone(l||{});u.v=a,u.m=`${a}`,r.setValue(o,i,u||{})}return s.getData()}function dg(r,e){const t=r.getConfig(),n=t.rightToLeft;return t.rightToLeft=e,n}function gg(r=0,e,t){const n=[];for(let s=r;s<r+e.length;s++){const o=t.getRowOrCreate(s);n[s-r]=o.h,o.h=e[s-r]}return n}function fg(r,e,t,n){var l,u,c;const s=r.getSelection(),o=(l=s.getActiveRangeList())==null?void 0:l.getRangeList(),i=(u=s.getActiveRange())==null?void 0:u.getRangeData(),a=(c=s.getCurrentCell())==null?void 0:c.getRangeData();return s.setRanges(e,t,n),{activeRangeList:o,activeRange:i,currentCell:a}}function mg(r,e,t){const n=r.getConfig(),s=n.sheetOrder.findIndex(i=>i===e),o=n.sheetOrder.filter(i=>i!==e);return o.splice(t,0,e),n.sheetOrder=o,s}function pg(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getRow(n);s&&(s.hd=0)}}function _g(r,e){const t=r.getConfig(),n=t.tabColor;return t.tabColor=e,n}function bg(r,e){const t=r.getContext().getWorkBook().getActiveSheet();let n="";const s=te.FALSE;t&&(n=t.getSheetId());const o=r.getContext().getWorkBook().getSheets(),i=r.getSheetId();return o.forEach(a=>{a.getSheetId()===i?a.getConfig().status=te.TRUE:a.getConfig().status=te.FALSE}),{oldSheetId:n,status:s}}function vg(r,e){const t=r.getConfig(),n=t.name;return t.name=e,n}function Cg(r,e){const t=r.getConfig(),n=t.status;return t.status=e,n}function Eg(r,e,t){const n=r.getSheetBySheetId(e);if(n){const s=n.getConfig().zoomRatio;return n.getConfig().zoomRatio=t,s}return 1}class wg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=mb(e.getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{cellValue:t}=this._oldActionData,n=this._workbook.getStyles();e&&(du(e.getCellMatrix(),t,n),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Tg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={actionName:$.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),Pd(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.ADD_BANDING_ACTION,namedRange:this.do()}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),Ld(t,e)}validate(){return!1}}class gu extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Ud({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.INSERT_RANGE_ACTION,shiftDimension:n,rangeData:t,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:n,cellValue:s}=this._oldActionData;e&&(Gd({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,n,s),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class fu extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getColumnManager();Wd(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),jd(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON())}validate(){return!1}}class Sg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e,columnCount:nt.getMaxLength(e.columnData[0])},this.validate()}do(){const e=this.getWorkSheet();Vd(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Kd(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class yg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();e&&(Gd({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Ud({rowCount:s.getLastRow(),columnCount:s.getLastColumn()},s.getCellMatrix(),n,e),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class mu extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getRowManager();Xd(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),Zd(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON())}validate(){return!1}}class Ag extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e,rowCount:nt.getMaxLength(e.rowData[0])},this.validate()}do(){const e=this.getWorkSheet();$d(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();qd(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Rg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetId:this.do()}}do(){const e=this.getWorkBook(),t=Yd(e,this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){const e=this.getWorkBook();Jd(e,this._oldActionData.sheetId),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}class pu extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getColumnManager(),n=jd(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();Wd(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ig extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Kd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();Vd(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class xg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=kd(e.getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();Nd(e.getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class _u extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getRowManager(),n=Zd(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();Xd(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Dg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=qd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();$d(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Og extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,...this.do()}}do(){return this.redo()}redo(){const e=this.getWorkBook(),t=Jd(e,this._doActionData.sheetId);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),Yd(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}class Fg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,styles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=e.getCellMatrix(),o=e.getContext().getWorkBook().getStyles(),i=Qd(t,o,this._doActionData.styles);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),i}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=e.getCellMatrix(),o=e.getContext().getWorkBook().getStyles();Qd(t,o,this._oldActionData.styles),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Mg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();eg(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();tg(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ng extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();tg(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();eg(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class kg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnWidth:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ng(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=ng(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class Bg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,hideGridlines:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=rg(e,this._doActionData.hideGridlines);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();rg(e,this._oldActionData.hideGridlines),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Lg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={actionName:$.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),og(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:$.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:$.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:og(n,e)}}validate(){return!1}}class Pg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),n=du(e.getCellMatrix(),this._doActionData.cellValue,t,this._doActionData.options);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e,options:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),options:t}}undo(){const{sheetId:e,cellValue:t,options:n}=this._oldActionData,s=this.getWorkSheet(),o=this._workbook.getStyles();s&&(this._doActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:du(s.getCellMatrix(),t,o),options:n},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Hg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=lg(e.getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:$.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:lg(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Ug extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellFormula:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ug(e.getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:$.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:ug(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class zg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellNote:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=cg(e.getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:$.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:cg(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Wg extends Qe{constructor(e,t,n){super(e,t,n),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix(),o=ig(s,e,t,n);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),o}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,s=this._workbook.getStyles(),o=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:$.SET_RANGE_STYLE_ACTION,sheetId:n,value:ig(o,e,t,s),rangeData:t},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Vg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=hg(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:$.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:hg(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class $g extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rightToLeft:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=dg(e,this._doActionData.rightToLeft);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();dg(e,this._oldActionData.rightToLeft),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Gg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowHeight:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=gg(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=gg(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class Xg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();sg(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();pg(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Yg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();pg(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();sg(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class jg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const{activeRangeList:s,activeRange:o,currentCell:i}=this.do();this._oldActionData={...e,activeRangeList:s,activeRange:o,currentCell:i},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,s=this.getWorkSheet(),o=fg(s,e,t,n);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),o}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:s}=this.do();this._oldActionData={actionName:$.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:n,currentCell:s}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:s}=this._oldActionData,o=this.getWorkSheet(),i=fg(o,e,t,n);this._doActionData={actionName:$.SET_SELECTION_ACTION,sheetId:s,activeRangeList:i.activeRangeList,activeRange:i.activeRange,currentCell:i.currentCell},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class bu extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,order:this.do()},this.validate()}do(){const n=this.getWorkSheet().getContext().getWorkBook(),s=mg(n,this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),s}redo(){this.do()}undo(){const n=this.getWorkSheet().getContext().getWorkBook();mg(n,this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Kg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=_g(e,this._doActionData.color);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:$.SET_TAB_COLOR_ACTION,sheetId:t,color:_g(n,e)},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Zg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const{oldSheetId:s,status:o}=this.do();this._oldActionData={...e,sheetId:s,status:o},this.validate(),this.removeOperation(en.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=this._workbook.getSheetBySheetId(e),s=bg(n);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),s}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:$.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:n,status:s}=bg(t);this._doActionData={actionName:$.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:n,status:s},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}class qg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,hidden:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=zd(e,this._doActionData.hidden);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:$.HIDE_SHEET_ACTION,sheetId:t,hidden:zd(n,e)},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Jg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetName:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=vg(e,this._doActionData.sheetName);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:$.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:vg(n,e)},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Qg extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetStatus:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Cg(e,this._doActionData.sheetStatus);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:$.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:$.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:Cg(n,e)},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class ef extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,zoom:this.do()},this.validate()}redo(){const e=Eg(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){Eg(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:Ee.REDO,data:this._oldActionData,action:this})}validate(){return!1}}class Zt{constructor(...e){if(W.hasLength(e,0)){this.startRow=0,this.startColumn=0,this.endRow=0,this.endColumn=0;return}if(W.hasLength(e,1)){const t=e[0];this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,this.endColumn=t.endColumn;return}if(W.hasLength(e,4)){const t=e[0],n=e[1],s=e[2],o=e[3];this.startRow=t,this.startColumn=n,this.endRow=s,this.endColumn=o}}intersects(e){const t=this.startRow,n=this.endRow,s=this.startColumn,o=this.endColumn,i=e.startRow,a=e.endRow,l=e.startColumn,u=e.endColumn,c=Math.abs(s+o-l-u),h=Math.abs(s-o)+Math.abs(l-u),d=Math.abs(t+n-i-a),g=Math.abs(t-n)+Math.abs(i-a);return c<=h&&d<=g}union(e){const{startRow:t,startColumn:n,endRow:s,endColumn:o}=this;return new Zt(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>s?e.endRow:s,e.endColumn>o?e.endColumn:o)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const qs=class{static checkup(r,...e){if(r.length!==e.length)return!1;const t=r.length;for(let n=0;n<t;n++){const s=r[n],o=e[n];switch(o){case qs.BOOLEAN_TYPE:{if(!W.isBoolean(s))return!1;break}case qs.NUMBER_TYPE:{if(!W.isNumber(s))return!1;break}case qs.STRING_TYPE:{if(!W.isString(s))return!1;break}case qs.FUNCTION_TYPE:{if(!W.isFunction(s))return!1;break}case qs.OBJECT_TYPE:{if(!W.isPlainObject(s))return!1;break}default:{if(!W.isAssignableFrom(s,o))return!1;break}}}return!0}};let ot=qs;ot.STRING_TYPE=1,ot.NUMBER_TYPE=2,ot.BOOLEAN_TYPE=3,ot.FUNCTION_TYPE=4,ot.OBJECT_TYPE=5;class tf{constructor(e,t){this._worksheet=e,this._rectangleList=t,He.getCommandInjectorObservers().add(n=>{let s=n.include(mu),o=n.include(fu),i=n.include(_u),a=n.include(pu),l=n.include(gu);if(s){const u=s.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=W.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const d=c[h],g=u.rowCount;u.rowIndex>d.endRow||(u.rowIndex>=d.startRow&&u.rowIndex<=d.endRow||(d.startRow+=g),d.endRow+=g)}this.modifyMerge(this._rectangleList,c)}}if(o){const u=o.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=W.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const d=c[h],g=u.columnCount;u.columnIndex>d.endColumn||(u.columnIndex>=d.startColumn&&u.columnIndex<=d.endColumn||(d.startColumn+=g),d.endColumn+=g)}this.modifyMerge(this._rectangleList,c)}}if(i){const u=i.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()&&u.sheetId===this._worksheet.getSheetId()){const c=W.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const d=c[h],g=u.rowCount;u.rowIndex>d.endRow||(u.rowIndex>=d.startRow&&u.rowIndex<=d.endRow||(d.startRow-=g),d.endRow-=g)}this.modifyMerge(this._rectangleList,c)}}if(a){const u=a.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()&&u.sheetId===this._worksheet.getSheetId()){const c=W.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const d=c[h],g=u.columnCount;u.columnIndex>d.endColumn||(u.columnIndex>=d.startColumn&&u.columnIndex<=d.endColumn||(d.startColumn-=g),d.endColumn-=g)}this.modifyMerge(this._rectangleList,c)}}if(l){const u=l.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=W.deepClone(this._rectangleList),h=this.getByRowColumn(u.rangeData.startRow,u.rangeData.endRow,u.rangeData.startColumn,u.rangeData.endColumn);if(h&&h.forEach(d=>{const g=new Zt(d);for(let m=0;m<c.length;m++){const f=c[m];g.intersects(new Zt(f))&&c.splice(m,1)}}),u.shiftDimension)for(let d=0;d<c.length;d++){const g=c[d];if(g.endRow>=u.rangeData.startRow){if(g.endColumn<u.rangeData.startColumn)continue;if(g.startColumn>u.rangeData.endColumn)continue;if(g.startColumn>=u.rangeData.startColumn&&g.endColumn<=u.rangeData.endColumn){const m=u.rangeData.endRow-u.rangeData.startRow;g.startRow-=m,g.endRow-=m}else return}}else for(let d=0;d<c.length;d++){const g=c[d];if(g.startColumn>u.rangeData.endColumn){if(g.endRow<u.rangeData.startRow)continue;if(g.startRow>u.rangeData.endRow)continue;if(g.startRow>=u.rangeData.startRow&&g.endRow<=u.rangeData.endRow){const m=u.rangeData.endColumn-u.rangeData.startColumn;g.startColumn-=m,g.endColumn-=m}else return}}this.modifyMerge(this._rectangleList,c)}}})}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;ot.checkup(e,ot.NUMBER_TYPE,ot.NUMBER_TYPE,ot.NUMBER_TYPE,ot.NUMBER_TYPE)?n=new Zt(e[0],e[2],e[1],e[3]):ot.checkup(e,ot.NUMBER_TYPE,ot.NUMBER_TYPE)&&(n=new Zt(e[0],e[1],e[0],e[1]));const s=[];for(let o=0;o<t.length;o++){const i=t[o];n.intersects(new Zt(i))&&s.push(i)}return s.length?s:null}remove(e){const{_rectangleList:t}=this,n=new Zt(e);let s=t.findIndex(o=>!!n.intersects(new Zt(o)));return s!==-1&&t.splice(s,1),this}size(){return this._rectangleList.length}add(e){const{_rectangleList:t}=this,n=new Zt(e);return t.findIndex(o=>!!n.intersects(new Zt(o)))===-1&&this._rectangleList.push(e),this}union(e){const{_rectangleList:t}=this,{length:n}=t;let s=new Zt(e);for(let o=0;o<n;o++){const i=t[o];s=s.union(new Zt(i))}return s.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,s=[];for(let o=0;o<n;o++){const i=t[o];new Zt(e).intersects(new Zt(i))&&s.push(i)}return s}modifyMerge(e,t){const n=this._worksheet.getCommandManager(),s=this._worksheet.getContext(),o={actionName:$.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},i={actionName:$.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},a=new ge({WorkBookUnit:s.getWorkBook()},o,i);n.invoke(a)}}var Vr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ua(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nf={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Vr,function(){var t=1e3,n=6e4,s=36e5,o="millisecond",i="second",a="minute",l="hour",u="day",c="week",h="month",d="quarter",g="year",m="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var E=["th","st","nd","rd"],N=x%100;return"["+x+(E[(N-20)%10]||E[N]||E[0])+"]"}},w=function(x,E,N){var X=String(x);return!X||X.length>=E?x:""+Array(E+1-X.length).join(N)+x},S={s:w,z:function(x){var E=-x.utcOffset(),N=Math.abs(E),X=Math.floor(N/60),L=N%60;return(E<=0?"+":"-")+w(X,2,"0")+":"+w(L,2,"0")},m:function x(E,N){if(E.date()<N.date())return-x(N,E);var X=12*(N.year()-E.year())+(N.month()-E.month()),L=E.clone().add(X,h),ne=N-L<0,G=E.clone().add(X+(ne?-1:1),h);return+(-(X+(N-L)/(ne?L-G:G-L))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:h,y:g,w:c,d:u,D:m,h:l,m:a,s:i,ms:o,Q:d}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},T="en",D={};D[T]=v;var R=function(x){return x instanceof M},I=function x(E,N,X){var L;if(!E)return T;if(typeof E=="string"){var ne=E.toLowerCase();D[ne]&&(L=ne),N&&(D[ne]=N,L=ne);var G=E.split("-");if(!L&&G.length>1)return x(G[0])}else{var Q=E.name;D[Q]=E,L=Q}return!X&&L&&(T=L),L||!X&&T},y=function(x,E){if(R(x))return x.clone();var N=typeof E=="object"?E:{};return N.date=x,N.args=arguments,new M(N)},O=S;O.l=I,O.i=R,O.w=function(x,E){return y(x,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var M=function(){function x(N){this.$L=I(N.locale,null,!0),this.parse(N)}var E=x.prototype;return E.parse=function(N){this.$d=function(X){var L=X.date,ne=X.utc;if(L===null)return new Date(NaN);if(O.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var G=L.match(p);if(G){var Q=G[2]-1||0,P=(G[7]||"0").substring(0,3);return ne?new Date(Date.UTC(G[1],Q,G[3]||1,G[4]||0,G[5]||0,G[6]||0,P)):new Date(G[1],Q,G[3]||1,G[4]||0,G[5]||0,G[6]||0,P)}}return new Date(L)}(N),this.$x=N.x||{},this.init()},E.init=function(){var N=this.$d;this.$y=N.getFullYear(),this.$M=N.getMonth(),this.$D=N.getDate(),this.$W=N.getDay(),this.$H=N.getHours(),this.$m=N.getMinutes(),this.$s=N.getSeconds(),this.$ms=N.getMilliseconds()},E.$utils=function(){return O},E.isValid=function(){return this.$d.toString()!==f},E.isSame=function(N,X){var L=y(N);return this.startOf(X)<=L&&L<=this.endOf(X)},E.isAfter=function(N,X){return y(N)<this.startOf(X)},E.isBefore=function(N,X){return this.endOf(X)<y(N)},E.$g=function(N,X,L){return O.u(N)?this[X]:this.set(L,N)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(N,X){var L=this,ne=!!O.u(X)||X,G=O.p(N),Q=function(Ce,fe){var Te=O.w(L.$u?Date.UTC(L.$y,fe,Ce):new Date(L.$y,fe,Ce),L);return ne?Te:Te.endOf(u)},P=function(Ce,fe){return O.w(L.toDate()[Ce].apply(L.toDate("s"),(ne?[0,0,0,0]:[23,59,59,999]).slice(fe)),L)},V=this.$W,pe=this.$M,oe=this.$D,Z="set"+(this.$u?"UTC":"");switch(G){case g:return ne?Q(1,0):Q(31,11);case h:return ne?Q(1,pe):Q(0,pe+1);case c:var ie=this.$locale().weekStart||0,be=(V<ie?V+7:V)-ie;return Q(ne?oe-be:oe+(6-be),pe);case u:case m:return P(Z+"Hours",0);case l:return P(Z+"Minutes",1);case a:return P(Z+"Seconds",2);case i:return P(Z+"Milliseconds",3);default:return this.clone()}},E.endOf=function(N){return this.startOf(N,!1)},E.$set=function(N,X){var L,ne=O.p(N),G="set"+(this.$u?"UTC":""),Q=(L={},L[u]=G+"Date",L[m]=G+"Date",L[h]=G+"Month",L[g]=G+"FullYear",L[l]=G+"Hours",L[a]=G+"Minutes",L[i]=G+"Seconds",L[o]=G+"Milliseconds",L)[ne],P=ne===u?this.$D+(X-this.$W):X;if(ne===h||ne===g){var V=this.clone().set(m,1);V.$d[Q](P),V.init(),this.$d=V.set(m,Math.min(this.$D,V.daysInMonth())).$d}else Q&&this.$d[Q](P);return this.init(),this},E.set=function(N,X){return this.clone().$set(N,X)},E.get=function(N){return this[O.p(N)]()},E.add=function(N,X){var L,ne=this;N=Number(N);var G=O.p(X),Q=function(pe){var oe=y(ne);return O.w(oe.date(oe.date()+Math.round(pe*N)),ne)};if(G===h)return this.set(h,this.$M+N);if(G===g)return this.set(g,this.$y+N);if(G===u)return Q(1);if(G===c)return Q(7);var P=(L={},L[a]=n,L[l]=s,L[i]=t,L)[G]||1,V=this.$d.getTime()+N*P;return O.w(V,this)},E.subtract=function(N,X){return this.add(-1*N,X)},E.format=function(N){var X=this,L=this.$locale();if(!this.isValid())return L.invalidDate||f;var ne=N||"YYYY-MM-DDTHH:mm:ssZ",G=O.z(this),Q=this.$H,P=this.$m,V=this.$M,pe=L.weekdays,oe=L.months,Z=function(fe,Te,Le,Ze){return fe&&(fe[Te]||fe(X,ne))||Le[Te].slice(0,Ze)},ie=function(fe){return O.s(Q%12||12,fe,"0")},be=L.meridiem||function(fe,Te,Le){var Ze=fe<12?"AM":"PM";return Le?Ze.toLowerCase():Ze},Ce={YY:String(this.$y).slice(-2),YYYY:this.$y,M:V+1,MM:O.s(V+1,2,"0"),MMM:Z(L.monthsShort,V,oe,3),MMMM:Z(oe,V),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:Z(L.weekdaysMin,this.$W,pe,2),ddd:Z(L.weekdaysShort,this.$W,pe,3),dddd:pe[this.$W],H:String(Q),HH:O.s(Q,2,"0"),h:ie(1),hh:ie(2),a:be(Q,P,!0),A:be(Q,P,!1),m:String(P),mm:O.s(P,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:G};return ne.replace(b,function(fe,Te){return Te||Ce[fe]||G.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(N,X,L){var ne,G=O.p(X),Q=y(N),P=(Q.utcOffset()-this.utcOffset())*n,V=this-Q,pe=O.m(this,Q);return pe=(ne={},ne[g]=pe/12,ne[h]=pe,ne[d]=pe/3,ne[c]=(V-P)/6048e5,ne[u]=(V-P)/864e5,ne[l]=V/s,ne[a]=V/n,ne[i]=V/t,ne)[G]||V,L?pe:O.a(pe)},E.daysInMonth=function(){return this.endOf(h).$D},E.$locale=function(){return D[this.$L]},E.locale=function(N,X){if(!N)return this.$L;var L=this.clone(),ne=I(N,X,!0);return ne&&(L.$L=ne),L},E.clone=function(){return O.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},x}(),F=M.prototype;return y.prototype=F,[["$ms",o],["$s",i],["$m",a],["$H",l],["$W",u],["$M",h],["$y",g],["$D",m]].forEach(function(x){F[x[1]]=function(E){return this.$g(E,x[0],x[1])}}),y.extend=function(x,E){return x.$i||(x(E,M,y),x.$i=!0),y},y.locale=I,y.isDayjs=R,y.unix=function(x){return y(1e3*x)},y.en=D[T],y.Ls=D,y.p={},y})})(nf);var me=nf.exports,rf={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(r){(function(e,t){r.exports?r.exports=t():e.numeral=t()})(Vr,function(){var e,t,n="2.0.6",s={},o={},i={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:i.currentLocale,zeroFormat:i.zeroFormat,nullFormat:i.nullFormat,defaultFormat:i.defaultFormat,scalePercentBy100:i.scalePercentBy100};function l(u,c){this._input=u,this._value=c}return e=function(u){var c,h,d,g;if(e.isNumeral(u))c=u.value();else if(u===0||typeof u=="undefined")c=0;else if(u===null||t.isNaN(u))c=null;else if(typeof u=="string")if(a.zeroFormat&&u===a.zeroFormat)c=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)c=null;else{for(h in s)if(g=typeof s[h].regexps.unformat=="function"?s[h].regexps.unformat():s[h].regexps.unformat,g&&u.match(g)){d=s[h].unformat;break}d=d||e._.stringToNumber,c=d(u)}else c=Number(u)||null;return new l(u,c)},e.version=n,e.isNumeral=function(u){return u instanceof l},e._=t={numberToFormat:function(u,c,h){var d=o[e.options.currentLocale],g=!1,m=!1,f=0,p="",b=1e12,v=1e9,w=1e6,S=1e3,T="",D=!1,R,I,y,O,M,F,x;if(u=u||0,I=Math.abs(u),e._.includes(c,"(")?(g=!0,c=c.replace(/[\(|\)]/g,"")):(e._.includes(c,"+")||e._.includes(c,"-"))&&(M=e._.includes(c,"+")?c.indexOf("+"):u<0?c.indexOf("-"):-1,c=c.replace(/[\+|\-]/g,"")),e._.includes(c,"a")&&(R=c.match(/a(k|m|b|t)?/),R=R?R[1]:!1,e._.includes(c," a")&&(p=" "),c=c.replace(new RegExp(p+"a[kmbt]?"),""),I>=b&&!R||R==="t"?(p+=d.abbreviations.trillion,u=u/b):I<b&&I>=v&&!R||R==="b"?(p+=d.abbreviations.billion,u=u/v):I<v&&I>=w&&!R||R==="m"?(p+=d.abbreviations.million,u=u/w):(I<w&&I>=S&&!R||R==="k")&&(p+=d.abbreviations.thousand,u=u/S)),e._.includes(c,"[.]")&&(m=!0,c=c.replace("[.]",".")),y=u.toString().split(".")[0],O=c.split(".")[1],F=c.indexOf(","),f=(c.split(".")[0].split(",")[0].match(/0/g)||[]).length,O?(e._.includes(O,"[")?(O=O.replace("]",""),O=O.split("["),T=e._.toFixed(u,O[0].length+O[1].length,h,O[1].length)):T=e._.toFixed(u,O.length,h),y=T.split(".")[0],e._.includes(T,".")?T=d.delimiters.decimal+T.split(".")[1]:T="",m&&Number(T.slice(1))===0&&(T="")):y=e._.toFixed(u,0,h),p&&!R&&Number(y)>=1e3&&p!==d.abbreviations.trillion)switch(y=String(Number(y)/1e3),p){case d.abbreviations.thousand:p=d.abbreviations.million;break;case d.abbreviations.million:p=d.abbreviations.billion;break;case d.abbreviations.billion:p=d.abbreviations.trillion;break}if(e._.includes(y,"-")&&(y=y.slice(1),D=!0),y.length<f)for(var E=f-y.length;E>0;E--)y="0"+y;return F>-1&&(y=y.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),c.indexOf(".")===0&&(y=""),x=y+T+(p||""),g?x=(g&&D?"(":"")+x+(g&&D?")":""):M>=0?x=M===0?(D?"-":"+")+x:x+(D?"-":"+"):D&&(x="-"+x),x},stringToNumber:function(u){var c=o[a.currentLocale],h=u,d={thousand:3,million:6,billion:9,trillion:12},g,m,f;if(a.zeroFormat&&u===a.zeroFormat)m=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)m=null;else{m=1,c.delimiters.decimal!=="."&&(u=u.replace(/\./g,"").replace(c.delimiters.decimal,"."));for(g in d)if(f=new RegExp("[^a-zA-Z]"+c.abbreviations[g]+"(?:\\)|(\\"+c.currency.symbol+")?(?:\\))?)?$"),h.match(f)){m*=Math.pow(10,d[g]);break}m*=(u.split("-").length+Math.min(u.split("(").length-1,u.split(")").length-1))%2?1:-1,u=u.replace(/[^0-9\.]+/g,""),m*=Number(u)}return m},isNaN:function(u){return typeof u=="number"&&isNaN(u)},includes:function(u,c){return u.indexOf(c)!==-1},insert:function(u,c,h){return u.slice(0,h)+c+u.slice(h)},reduce:function(u,c){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof c!="function")throw new TypeError(c+" is not a function");var h=Object(u),d=h.length>>>0,g=0,m;if(arguments.length===3)m=arguments[2];else{for(;g<d&&!(g in h);)g++;if(g>=d)throw new TypeError("Reduce of empty array with no initial value");m=h[g++]}for(;g<d;g++)g in h&&(m=c(m,h[g],g,h));return m},multiplier:function(u){var c=u.toString().split(".");return c.length<2?1:Math.pow(10,c[1].length)},correctionFactor:function(){var u=Array.prototype.slice.call(arguments);return u.reduce(function(c,h){var d=t.multiplier(h);return c>d?c:d},1)},toFixed:function(u,c,h,d){var g=u.toString().split("."),m=c-(d||0),f,p,b,v;return g.length===2?f=Math.min(Math.max(g[1].length,m),c):f=m,b=Math.pow(10,f),v=(h(u+"e+"+f)/b).toFixed(f),d>c-f&&(p=new RegExp("\\.?0{1,"+(d-(c-f))+"}$"),v=v.replace(p,"")),v}},e.options=a,e.formats=s,e.locales=o,e.locale=function(u){return u&&(a.currentLocale=u.toLowerCase()),a.currentLocale},e.localeData=function(u){if(!u)return o[a.currentLocale];if(u=u.toLowerCase(),!o[u])throw new Error("Unknown locale : "+u);return o[u]},e.reset=function(){for(var u in i)a[u]=i[u]},e.zeroFormat=function(u){a.zeroFormat=typeof u=="string"?u:null},e.nullFormat=function(u){a.nullFormat=typeof u=="string"?u:null},e.defaultFormat=function(u){a.defaultFormat=typeof u=="string"?u:"0.0"},e.register=function(u,c,h){if(c=c.toLowerCase(),this[u+"s"][c])throw new TypeError(c+" "+u+" already registered.");return this[u+"s"][c]=h,h},e.validate=function(u,c){var h,d,g,m,f,p,b,v;if(typeof u!="string"&&(u+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",u)),u=u.trim(),u.match(/^\d+$/))return!0;if(u==="")return!1;try{b=e.localeData(c)}catch{b=e.localeData(e.locale())}return g=b.currency.symbol,f=b.abbreviations,h=b.delimiters.decimal,b.delimiters.thousands==="."?d="\\.":d=b.delimiters.thousands,v=u.match(/^[^\d]+/),v!==null&&(u=u.substr(1),v[0]!==g)||(v=u.match(/[^\d]+$/),v!==null&&(u=u.slice(0,-1),v[0]!==f.thousand&&v[0]!==f.million&&v[0]!==f.billion&&v[0]!==f.trillion))?!1:(p=new RegExp(d+"{2}"),u.match(/[^\d.,]/g)?!1:(m=u.split(h),m.length>2?!1:m.length<2?!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p):m[0].length===1?!!m[0].match(/^\d+$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/):!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/)))},e.fn=l.prototype={clone:function(){return e(this)},format:function(u,c){var h=this._value,d=u||a.defaultFormat,g,m,f;if(c=c||Math.round,h===0&&a.zeroFormat!==null)m=a.zeroFormat;else if(h===null&&a.nullFormat!==null)m=a.nullFormat;else{for(g in s)if(d.match(s[g].regexps.format)){f=s[g].format;break}f=f||e._.numberToFormat,m=f(h,d,c)}return m},value:function(){return this._value},input:function(){return this._input},set:function(u){return this._value=Number(u),this},add:function(u){var c=t.correctionFactor.call(null,this._value,u);function h(d,g,m,f){return d+Math.round(c*g)}return this._value=t.reduce([this._value,u],h,0)/c,this},subtract:function(u){var c=t.correctionFactor.call(null,this._value,u);function h(d,g,m,f){return d-Math.round(c*g)}return this._value=t.reduce([u],h,Math.round(this._value*c))/c,this},multiply:function(u){function c(h,d,g,m){var f=t.correctionFactor(h,d);return Math.round(h*f)*Math.round(d*f)/Math.round(f*f)}return this._value=t.reduce([this._value,u],c,1),this},divide:function(u){function c(h,d,g,m){var f=t.correctionFactor(h,d);return Math.round(h*f)/Math.round(d*f)}return this._value=t.reduce([this._value,u],c),this},difference:function(u){return Math.abs(e(this._value).subtract(u).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(u){var c=u%10;return~~(u%100/10)===1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(u,c,h){var d=e._.includes(c," BPS")?" ":"",g;return u=u*1e4,c=c.replace(/\s?BPS/,""),g=e._.numberToFormat(u,c,h),e._.includes(g,")")?(g=g.split(""),g.splice(-1,0,d+"BPS"),g=g.join("")):g=g+d+"BPS",g},unformat:function(u){return+(e._.stringToNumber(u)*1e-4).toFixed(15)}})}(),function(){var u={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},c={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},h=u.suffixes.concat(c.suffixes.filter(function(g){return u.suffixes.indexOf(g)<0})),d=h.join("|");d="("+d.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(d)},format:function(g,m,f){var p,b=e._.includes(m,"ib")?c:u,v=e._.includes(m," b")||e._.includes(m," ib")?" ":"",w,S,T;for(m=m.replace(/\s?i?b/,""),w=0;w<=b.suffixes.length;w++)if(S=Math.pow(b.base,w),T=Math.pow(b.base,w+1),g===null||g===0||g>=S&&g<T){v+=b.suffixes[w],S>0&&(g=g/S);break}return p=e._.numberToFormat(g,m,f),p+v},unformat:function(g){var m=e._.stringToNumber(g),f,p;if(m){for(f=u.suffixes.length-1;f>=0;f--){if(e._.includes(g,u.suffixes[f])){p=Math.pow(u.base,f);break}if(e._.includes(g,c.suffixes[f])){p=Math.pow(c.base,f);break}}m*=p||1}return m}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(u,c,h){var d=e.locales[e.options.currentLocale],g={before:c.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:c.match(/([\+|\-|\)|\s|\$]*)$/)[0]},m,f,p;for(c=c.replace(/\s?\$\s?/,""),m=e._.numberToFormat(u,c,h),u>=0?(g.before=g.before.replace(/[\-\(]/,""),g.after=g.after.replace(/[\-\)]/,"")):u<0&&!e._.includes(g.before,"-")&&!e._.includes(g.before,"(")&&(g.before="-"+g.before),p=0;p<g.before.length;p++)switch(f=g.before[p],f){case"$":m=e._.insert(m,d.currency.symbol,p);break;case" ":m=e._.insert(m," ",p+d.currency.symbol.length-1);break}for(p=g.after.length-1;p>=0;p--)switch(f=g.after[p],f){case"$":m=p===g.after.length-1?m+d.currency.symbol:e._.insert(m,d.currency.symbol,-(g.after.length-(1+p)));break;case" ":m=p===g.after.length-1?m+" ":e._.insert(m," ",-(g.after.length-(1+p)+d.currency.symbol.length-1));break}return m}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(u,c,h){var d,g=typeof u=="number"&&!e._.isNaN(u)?u.toExponential():"0e+0",m=g.split("e");return c=c.replace(/e[\+|\-]{1}0/,""),d=e._.numberToFormat(Number(m[0]),c,h),d+"e"+m[1]},unformat:function(u){var c=e._.includes(u,"e+")?u.split("e+"):u.split("e-"),h=Number(c[0]),d=Number(c[1]);d=e._.includes(u,"e-")?d*=-1:d;function g(m,f,p,b){var v=e._.correctionFactor(m,f),w=m*v*(f*v)/(v*v);return w}return e._.reduce([h,Math.pow(10,d)],g,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(u,c,h){var d=e.locales[e.options.currentLocale],g,m=e._.includes(c," o")?" ":"";return c=c.replace(/\s?o/,""),m+=d.ordinal(u),g=e._.numberToFormat(u,c,h),g+m}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(u,c,h){var d=e._.includes(c," %")?" ":"",g;return e.options.scalePercentBy100&&(u=u*100),c=c.replace(/\s?\%/,""),g=e._.numberToFormat(u,c,h),e._.includes(g,")")?(g=g.split(""),g.splice(-1,0,d+"%"),g=g.join("")):g=g+d+"%",g},unformat:function(u){var c=e._.stringToNumber(u);return e.options.scalePercentBy100?c*.01:c}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(u,c,h){var d=Math.floor(u/60/60),g=Math.floor((u-d*60*60)/60),m=Math.round(u-d*60*60-g*60);return d+":"+(g<10?"0"+g:g)+":"+(m<10?"0"+m:m)},unformat:function(u){var c=u.split(":"),h=0;return c.length===3?(h=h+Number(c[0])*60*60,h=h+Number(c[1])*60,h=h+Number(c[2])):c.length===2&&(h=h+Number(c[0])*60,h=h+Number(c[1])),Number(h)}})}(),e})})(rf);var cs=rf.exports;const vu={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function vb(r){let e=!1;for(const t in vu)if(r===vu[t]){e=!0;break}return e}function Js(r){return r===null||r.toString().replace(/\s/g,"")===""||typeof r=="boolean"?!1:!Number.isNaN(r)}function Cb(r){if(r===null||r.toString().length<5)return!1;if(e(r))return!0;return!1;function e(t){const n=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,s=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!n.test(t)&&!s.test(t))return!1;const o=RegExp.$1,i=RegExp.$2,a=RegExp.$3;return!(o<1900||i>12||a>31||i===2&&(new Date(o,1,29).getDate()===29&&a>29||new Date(o,1,29).getDate()!==29&&a>28))}}let ca=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(ca.getFullYear())&&(ca=new Date("2/19/17"));const Eb=ca.getFullYear()===2017;function wb(r,e){const t=new Date(r);if(Eb)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(ca.getFullYear()===1917&&!Number.isNaN(t.getFullYear())){const o=t.getFullYear();return r.indexOf(`${o}`)>-1||t.setFullYear(t.getFullYear()+100),t}const n=r.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}const Tb=new Date(1900,2,1,0,0,0);function sf(r,e){let t=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds());const n=Date.UTC(1899,11,31,0,0,0);return e?t-=1262304e5:r>=Tb&&(t+=864e5),(t-n)/864e5}function nn(r){let e=null,t={},n=r;if(r===null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(r)){e=r,n=Number(r.split(".")[0].replace(",",""));let s="#,##0";if(r.split(".")[1]){s="#,##0.";for(let o=0;o<r.split(".")[1].length;o++)s+=0}t={fa:s,t:"n"}}else if(r.toString().substr(0,1)==="'")e=r.toString().substr(1),t={fa:"@",t:"s"};else if(r.toString().toUpperCase()==="TRUE")e="TRUE",t={fa:"General",t:"b"},n=!0;else if(r.toString().toUpperCase()==="FALSE")e="FALSE",t={fa:"General",t:"b"},n=!1;else if(vb(r))e=r.toString(),t={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(r))e=r.toString(),t={fa:"@",t:"s"};else if(Js(r)&&Math.abs(parseFloat(r))>0&&(Math.abs(parseFloat(r))>=1e11||Math.abs(parseFloat(r))<1e-9)){n=cs(r).value();const s=n.toExponential();if(s.indexOf(".")>-1){let o=s.split(".")[1].split("e")[0].length;o>5&&(o=5),t={fa:`#0.${new Array(o+1).join("0")}E+00`,t:"n"}}else t={fa:"#0.E+00",t:"n"};e=$r.format(t.fa,n)}else if(r.toString().indexOf("%")>-1){const s=r.toString().indexOf("%");let o=r.toString().substr(0,s);const i=o.replace(/,/g,"");if(s===r.toString().length-1&&Js(i))if(o.indexOf(".")>-1)if(o.indexOf(".")===o.lastIndexOf(".")){const a=o.split(".")[0];let u=o.split(".")[1].length;if(u>9&&(u=9),a.indexOf(",")>-1){let c=!0,h=a.split(",");for(let d=1;d<h.length;d++)if(h[d].length<3){c=!1;break}c?(t={fa:`#,##0.${new Array(u+1).join("0")}%`,t:"n"},n=cs(r).value(),e=$r.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else t={fa:`0.${new Array(u+1).join("0")}%`,t:"n"},n=cs(r).value(),e=$r.format(t.fa,n)}else e=r.toString(),t={fa:"@",t:"s"};else if(o.indexOf(",")>-1){let a=!0,l=o.split(",");for(let u=1;u<l.length;u++)if(l[u].length<3){a=!1;break}a?(t={fa:"#,##0%",t:"n"},n=cs(r).value(),e=$r.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else t={fa:"0%",t:"n"},n=cs(r).value(),e=$r.format(t.fa,n);else e=r.toString(),t={fa:"@",t:"s"}}else if(r.toString().indexOf(".")>-1)if(r.toString().indexOf(".")===r.toString().lastIndexOf(".")){const s=r.toString().split(".")[0];let o=r.toString().split(".")[1],i=o.length;if(i>9&&(i=9),s.indexOf(",")>-1){let a=!0,l=s.split(",");for(let u=1;u<l.length;u++)if(!Js(l[u])||l[u].length<3){a=!1;break}a?(t={fa:`#,##0.${new Array(i+1).join("0")}`,t:"n"},n=cs(r).value(),e=$r.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else Js(s)&&Js(o)?(t={fa:`0.${new Array(i+1).join("0")}`,t:"n"},n=cs(r).value(),e=$r.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else e=r.toString(),t={fa:"@",t:"s"};else Js(r)?(e=r.toString(),t={fa:"General",t:"n"},n=parseFloat(r)):Cb(r)&&(r.toString().indexOf(".")>-1||r.toString().indexOf(":")>-1||r.toString().length<16)?(n=sf(wb(r.toString().replace(/-/g,"/"))),n.toString().indexOf(".")>-1?r.toString().length>18?t.fa="yyyy-MM-dd hh:mm:ss":r.toString().length>11?t.fa="yyyy-MM-dd hh:mm":t.fa="yyyy-MM-dd":t.fa="yyyy-MM-dd",t.t="d",e=$r.format(t.fa,n)):(e=r,t.fa="General",t.t="g");return[e,t,n]}const $r={format(r,e){}},hs=(r,e)=>{};class ei{static getApplyData(e,t,n,s,o){const i=this,a=[];i.applyType=s,i.direction=o;const l=Math.floor(n/t),u=n%t,c=e.number,h=[];if(c)for(let I=0;I<c.length;I++){const y=i.getLenS(c[I].index,u),O=c[I].index.length*l+y;let M;s===1?M=i.getDataByType(c[I].data,O,o,s,"number"):s==="2"?M=i.getDataByType(c[I].data,O,o,s):M=i.getDataByType(c[I].data,O,o,"0");const F=i.getDataIndex(t,n,c[I].index);h.push({data:M,index:F})}const d=e.extendNumber,g=[];if(d)for(let I=0;I<d.length;I++){const y=i.getLenS(d[I].index,u),O=d[I].index.length*l+y;let M;s==="1"||s==="3"?M=i.getDataByType(d[I].data,O,o,s,"extendNumber"):s==="2"?M=i.getDataByType(d[I].data,O,o,s):M=i.getDataByType(d[I].data,O,o,"0");const F=i.getDataIndex(t,n,d[I].index);g.push({data:M,index:F})}const m=e.date,f=[];if(m)for(let I=0;I<m.length;I++){const y=i.getLenS(m[I].index,u),O=m[I].index.length*l+y;let M;s==="1"||s==="3"?M=i.getDataByType(m[I].data,O,o,s,"date"):s==="8"?M=i.getDataByType(m[I].data,O,o,"0"):M=i.getDataByType(m[I].data,O,o,s);const F=i.getDataIndex(t,n,m[I].index);f.push({data:M,index:F})}const p=e.chnNumber,b=[];if(p)for(let I=0;I<p.length;I++){const y=i.getLenS(p[I].index,u),O=p[I].index.length*l+y;let M;s==="1"||s==="3"?M=i.getDataByType(p[I].data,O,o,s,"chnNumber"):s==="2"||s==="8"?M=i.getDataByType(p[I].data,O,o,s):M=i.getDataByType(p[I].data,O,o,"0");const F=i.getDataIndex(t,n,p[I].index);b.push({data:M,index:F})}const v=e.chnWeek2,w=[];if(v)for(let I=0;I<v.length;I++){const y=i.getLenS(v[I].index,u),O=v[I].index.length*l+y;let M;s==="1"||s==="3"?M=i.getDataByType(v[I].data,O,o,s,"chnWeek2"):s==="2"?M=i.getDataByType(v[I].data,O,o,s):M=i.getDataByType(v[I].data,O,o,"0");const F=i.getDataIndex(t,n,v[I].index);w.push({data:M,index:F})}const S=e.chnWeek3,T=[];if(S)for(let I=0;I<S.length;I++){const y=i.getLenS(S[I].index,u),O=S[I].index.length*l+y;let M;s==="1"||s==="3"?M=i.getDataByType(S[I].data,O,o,s,"chnWeek3"):s==="2"?M=i.getDataByType(S[I].data,O,o,s):M=i.getDataByType(S[I].data,O,o,"0");const F=i.getDataIndex(t,n,S[I].index);T.push({data:M,index:F})}const D=e.other,R=[];if(D)for(let I=0;I<D.length;I++){const y=i.getLenS(D[I].index,u),O=D[I].index.length*l+y;let M;s==="2"||s==="3"?M=i.getDataByType(D[I].data,O,o,s):M=i.getDataByType(D[I].data,O,o,"0");const F=i.getDataIndex(t,n,D[I].index);R.push({data:M,index:F})}for(let I=1;I<=n;I++){if(h.length>0)for(let y=0;y<h.length;y++)I in h[y].index&&a.push(h[y].data[h[y].index[I]]);if(g.length>0)for(let y=0;y<g.length;y++)I in g[y].index&&a.push(g[y].data[g[y].index[I]]);if(f.length>0)for(let y=0;y<f.length;y++)I in f[y].index&&a.push(f[y].data[f[y].index[I]]);if(b.length>0)for(let y=0;y<b.length;y++)I in b[y].index&&a.push(b[y].data[b[y].index[I]]);if(w.length>0)for(let y=0;y<w.length;y++)I in w[y].index&&a.push(w[y].data[w[y].index[I]]);if(T.length>0)for(let y=0;y<T.length;y++)I in T[y].index&&a.push(T[y].data[T[y].index[I]]);if(R.length>0)for(let y=0;y<R.length;y++)I in R[y].index&&a.push(R[y].data[R[y].index[I]])}return a}static getCopyData(e,t,n,s,o,i){const a=this,l=[];let u=0,c=0,h=0,d=0;i===ee.BOTTOM||i===ee.TOP?(u=s,c=o,h=t,d=n):(i===ee.RIGHT||i===ee.LEFT)&&(u=t,c=n,h=s,d=o);for(let g=u;g<=c;g++){const m={};let f=[],p=[],b="",v=null,w=null,S=!0;for(let T=h,D=0;T<=d;T++,D++){const R=e[D];let I;if(!!R&&!!R.v&&!R.f)if(!!R.fm&&R.fm.t===aa.NUMBER)I="number",v=null,w=null;else if(!!R.fm&&R.fm.t===aa.DATE)I="date",v=null,w=null;else if(a.isExtendNumber(R.m)[0]){I="extendNumber";const y=a.isExtendNumber(R.m);v===null||w===null?(S=!0,v=y[2],w=y[3]):y[2]!==v||y[3]!==w?(S=!1,v=y[2],w=y[3]):S=!0}else a.isChnNumber(R.m)?(I="chnNumber",v=null,w=null):a.isChnWeek2(R.m)?(I="chnWeek2",v=null,w=null):a.isChnWeek3(R.m)?(I="chnWeek3",v=null,w=null):(I="other",v=null,w=null);else I="other",v=null,w=null;I==="extendNumber"?T===h?h===d?(b=I,f.push(R),p.push(T-h+1),m[b]=[],m[b].push({data:f,index:p})):(b=I,f.push(R),p.push(T-h+1)):T===d?b===I&&S?(f.push(R),p.push(T-h+1),b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p}))):(b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p})),b=I,f=[],f.push(R),p=[],p.push(T-h+1),b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p}))):b===I&&S?(f.push(R),p.push(T-h+1)):(b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p})),b=I,f=[],f.push(R),p=[],p.push(T-h+1)):T===h?h===d?(b=I,f.push(R),p.push(T-h+1),m[b]=[],m[b].push({data:f,index:p})):(b=I,f.push(R),p.push(T-h+1)):T===d?b===I?(f.push(R),p.push(T-h+1),b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p}))):(b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p})),b=I,f=[],f.push(R),p=[],p.push(T-h+1),b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p}))):b===I?(f.push(R),p.push(T-h+1)):(b in m?m[b].push({data:f,index:p}):(m[b]=[],m[b].push({data:f,index:p})),b=I,f=[],f.push(R),p=[],p.push(T-h+1))}l.push(m)}return l}static ChineseToNumber(e){const t=this;let n=0,s=0,o=0,i=!1;const a=e.split("");for(let l=0;l<a.length;l++){const u=t.chnNumChar[a[l]];if(typeof u!="undefined")o=u,l===a.length-1&&(s+=o);else{const c=t.chnNameValue[a[l]].value;i=t.chnNameValue[a[l]].secUnit,i?(s=(s+o)*c,n+=s,s=0):s+=o*c,o=0}}return n+s}static NumberToChinese(e){const t=this;let n=0,s="",o="",i=!1;if(e===0)return t.chnNumChar2[0];for(;e>0;){const a=e%1e4;i&&(o=t.chnNumChar2[0]+o),s=t.SectionToChinese(a),s+=a!==0?t.chnUnitSection[n]:t.chnUnitSection[0],o=s+o,i=a<1e3&&a>0,e=Math.floor(e/1e4),n++}return o}static SectionToChinese(e){const t=this;let n="",s="",o=0,i=!0;for(;e>0;){const a=e%10;a===0?i||(i=!0,s=t.chnNumChar2[a]+s):(i=!1,n=t.chnNumChar2[a],n+=t.chnUnitChar[o],s=n+s),o++,e=Math.floor(e/10)}return s}static getLenS(e,t){let n=0;for(let s=0;s<e.length&&e[s]<=t;s++)n++;return n}static getDataByType(e,t,n,s,o){const i=this;let a=[];if(s===ia.ALTERNATE_SERIES)(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(s===ia.DEFAULT_SERIES)if(o==="number")a=i.FillSeries(e,t,n);else if(o==="extendNumber")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillExtendNumber(e,t,l)}else{const l=[];for(let u=0;u<e.length;u++){const c=e[u].m;l.push(Number(i.isExtendNumber(c)[1]))}if((n===ee.TOP||n===ee.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const u=l[1]-l[0];a=i.FillExtendNumber(e,t,u)}else a=i.FillCopy(e,t)}else if(o==="date")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillDays(e,t,l)}else{(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=i.judgeDate(e);if(l[0]&&l[3]){const u=me(e[1].m).diff(me(e[0].m),"months");a=i.FillMonths(e,t,u)}else if(!l[0]&&l[2]){const u=me(e[1].m).diff(me(e[0].m),"days");a=i.FillDays(e,t,u)}else a=i.FillCopy(e,t)}else if(o==="chnNumber")if(e.length===1)if(e[0].m==="\u65E5"||i.ChineseToNumber(e[0].m)<7){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillChnWeek(e,t,l)}else{let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillChnNumber(e,t,l)}else{let l=!1;for(let h=0;h<e.length;h++)if(e[h].m==="\u65E5"){l=!0;break}const u=[];let c=0;for(let h=0;h<e.length;h++)e[h].m==="\u65E5"?h===0?u.push(0):(c++,u.push(c*7)):l&&i.ChineseToNumber(e[h].m)>0&&i.ChineseToNumber(e[h].m)<7?u.push(i.ChineseToNumber(e[h].m)+c*7):u.push(i.ChineseToNumber(e[h].m));if((n===ee.TOP||n===ee.LEFT)&&(e.reverse(),u.reverse()),i.isEqualDiff(u))if(l||u[u.length-1]<6&&u[0]>0||u[0]<6&&u[u.length-1]>0){const h=u[1]-u[0];a=i.FillChnWeek(e,t,h)}else{const h=u[1]-u[0];a=i.FillChnNumber(e,t,h)}else a=i.FillCopy(e,t)}else if(o==="chnWeek2")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillChnWeek2(e,t,l)}else{const l=[];let u=0;for(let c=0;c<e.length;c++){const h=e[c].m.substr(e[c].m.length-1,1);e[c].m==="\u5468\u65E5"?c===0?l.push(0):(u++,l.push(u*7)):l.push(i.ChineseToNumber(h)+u*7)}if((n===ee.TOP||n===ee.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const c=l[1]-l[0];a=i.FillChnWeek2(e,t,c)}else a=i.FillCopy(e,t)}else if(o==="chnWeek3")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillChnWeek3(e,t,l)}else{const l=[];let u=0;for(let c=0;c<e.length;c++){const h=e[c].m.substr(e[c].m.length-1,1);e[c].m==="\u661F\u671F\u65E5"?c===0?l.push(0):(u++,l.push(u*7)):l.push(i.ChineseToNumber(h)+u*7)}if((n===ee.TOP||n===ee.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const c=l[1]-l[0];a=i.FillChnWeek3(e,t,c)}else a=i.FillCopy(e,t)}else(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(s==="2")(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillOnlyFormat(e,t);else if(s==="3"){const l=i.getDataByType(e,t,n,"1",o);a=i.FillWithoutFormat(l)}else if(s==="4")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillDays(e,t,l)}else if(e.length===2){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"days");a=i.FillDays(e,t,l)}else{(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=i.judgeDate(e);if(l[0]&&l[3]){const u=me(e[1].m).diff(me(e[0].m),"months");a=i.FillMonths(e,t,u)}else if(!l[0]&&l[2]){const u=me(e[1].m).diff(me(e[0].m),"days");a=i.FillDays(e,t,u)}else a=i.FillCopy(e,t)}else if(s==="5")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1);const u=Math.round(t*1.5);for(let c=1;c<=u;c++){const h={...e[c]},d=me(h.m).add(c,"days").day();if(d===0||d===6)continue;const g=me(h.m).add(l*c,"days").format("YYYY-MM-DD");if(h.m=g,h.v=nn(g)[2],a.push(h),a.length===t)break}}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).diff(me(e[0].m),"months")!==0){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"months");for(let u=1;u<=t;u++){const c=(u-1)%e.length,h={...e[c]},d=me(e[e.length-1]).add(l*u,"months").day();let g;d===0?g=me(e[e.length-1]).add(l*u,"months").subtract(2,"days").format("YYYY-MM-DD"):d===6?g=me(e[e.length-1]).add(l*u,"months").subtract(1,"days").format("YYYY-MM-DD"):g=me(e[e.length-1]).add(l*u,"months").format("YYYY-MM-DD"),h.m=g,h.v=nn(g)[2],a.push(h)}}else if(Math.abs(me(e[1].m).diff(me(e[0].m)))>7){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,d={...e[h]},g=Math.ceil(c/e.length);h===0&&(u=me(d.m).add(l*g,"months").diff(me(d.m),"days"));const m=me(d.m).add(u,"days").day();let f;m===0?f=me(d.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?f=me(d.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):f=me(d.m).add(u,"days").format("YYYY-MM-DD"),d.m=f,d.v=nn(f)[2],a.push(d)}}else{let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=7:(n===ee.TOP||n===ee.LEFT)&&(l=-7,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,d={...e[h]},g=Math.ceil(c/e.length);h===0&&(u=me(d.m).add(l*g,"days").diff(me(d.m),"days"));const m=me(d.m).add(u,"days").day();let f;m===0?f=me(d.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?f=me(d.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):f=me(d.m).add(u,"days").format("YYYY-MM-DD"),d.m=f,d.v=nn(f)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[3]){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"months");for(let c=1;c<=t;c++){const h=(c-1)%e.length,d={...e[h]},g=me(e[e.length-1].m).add(u*c,"months").day();let m;g===0?m=me(e[e.length-1].m).add(u*c,"months").subtract(2,"days").format("YYYY-MM-DD"):g===6?m=me(e[e.length-1].m).add(u*c,"months").subtract(1,"days").format("YYYY-MM-DD"):m=me(e[e.length-1].m).add(u*c,"months").format("YYYY-MM-DD"),d.m=m,d.v=nn(m)[2],a.push(d)}}else if(!l[0]&&l[2])if(Math.abs(me(e[1].m).diff(me(e[0].m)))>7){let u=0;n===ee.BOTTOM||n===ee.RIGHT?u=1:(n===ee.TOP||n===ee.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(c=me(g.m).add(u*m,"months").diff(me(g.m),"days"));const f=me(g.m).add(c,"days").day();let p;f===0?p=me(g.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):f===6?p=me(g.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):p=me(g.m).add(c,"days").format("YYYY-MM-DD"),g.m=p,g.v=nn(p)[2],a.push(g)}}else{let u=0;n===ee.BOTTOM||n===ee.RIGHT?u=7:(n===ee.TOP||n===ee.LEFT)&&(u=-7,e.reverse());let c=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(c=me(g.m).add(u*m,"days").diff(me(g.m),"days"));const f=me(g.m).add(c,"days").day();let p;f===0?p=me(g.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):f===6?p=me(g.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):p=me(g.m).add(c,"days").format("YYYY-MM-DD"),g.m=p,g.v=nn(p)[2],a.push(g)}}else(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="6")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillMonths(e,t,l)}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).diff(me(e[0].m),"months")!==0){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"months");a=i.FillMonths(e,t,l)}else{let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,d={...e[h]},g=Math.ceil(c/e.length);h===0&&(u=me(d.m).add(l*g,"months").diff(me(d.m),"days"));const m=me(d.m).add(u,"days").format("YYYY-MM-DD");d.m=m,d.v=nn(m)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[3]){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"months");a=i.FillMonths(e,t,u)}else if(!l[0]&&l[2]){let u=0;n===ee.BOTTOM||n===ee.RIGHT?u=1:(n===ee.TOP||n===ee.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(c=me(g.m).add(u*m,"months").diff(me(g.m),"days"));const f=me(g.m).add(c,"days").format("YYYY-MM-DD");g.m=f,g.v=nn(f)[2],a.push(g)}}else(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="7")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillYears(e,t,l)}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).month()===me(e[0].m).month()&&me(e[1].m).diff(me(e[0].m),"years")!==0){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"years");a=i.FillYears(e,t,l)}else{let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,d={...e[h]},g=Math.ceil(c/e.length);h===0&&(u=me(d.m).add(l*g,"years").diff(me(d.m),"days"));const m=me(d.m).add(u,"days").format("YYYY-MM-DD");d.m=m,d.v=nn(m)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[1]&&l[4]){(n===ee.TOP||n===ee.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"years");a=i.FillYears(e,t,u)}else if(l[0]&&l[3]||l[2]){let u=0;n===ee.BOTTOM||n===ee.RIGHT?u=1:(n===ee.TOP||n===ee.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(c=me(g.m).add(u*m,"years").diff(me(g.m),"days"));const f=me(g.m).add(c,"days").format("YYYY-MM-DD");g.m=f,g.v=nn(f)[2],a.push(g)}}else(n===ee.TOP||n===ee.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="8")if(e.length===1){let l=0;n===ee.BOTTOM||n===ee.RIGHT?l=1:(n===ee.TOP||n===ee.LEFT)&&(l=-1),a=i.FillChnNumber(e,t,l)}else{const l=[];for(let u=0;u<e.length;u++)l.push(i.ChineseToNumber(e[u].m));if((n===ee.TOP||n===ee.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const u=l[1]-l[0];a=i.FillChnNumber(e,t,u)}else a=i.FillCopy(e,t)}return a}static getDataIndex(e,t,n){const s={},o=Math.floor(t/e),i=t%e;let a=0;if(o>0){for(let l=1;l<=o;l++)for(let u=0;u<n.length;u++)s[n[u]+(l-1)*e]=a,a++;for(let l=0;l<n.length&&n[l]<=i;l++)s[n[l]+e*o]=a,a++}else for(let l=0;l<n.length&&n[l]<=i;l++)s[n[l]]=a,a++;return s}static FillCopy(e,t){const n=[];for(let s=1;s<=t;s++){const o=(s-1)%e.length,i={...e[o]};n.push(i)}return n}static FillSeries(e,t,n){const s=this,o=[],i=[];for(let a=0;a<e.length;a++)i.push(Number(e[a].v));if(e.length>2&&s.isEqualRatio(i))for(let a=1;a<=t;a++){const l=(a-1)%e.length,u={...e[l]};let c;n===ee.BOTTOM||n===ee.RIGHT?c=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**a:(n===ee.TOP||n===ee.LEFT)&&(c=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**a),u.v=c,u.m=c,o.push(u)}else{const a=s.getXArr(e.length);for(let l=1;l<=t;l++){const u=(l-1)%e.length,c={...e[u]};let h;n===ee.BOTTOM||n===ee.RIGHT?h=s.forecast(e.length+l,i,a):(n===ee.TOP||n===ee.LEFT)&&(h=s.forecast(1-l,i,a)),c.v=h,c.m=h,o.push(c)}}return o}static FillExtendNumber(e,t,n){const s=[],o=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]},u=e[e.length-1].m,c=u.match(o),h=c[c.length-1],d=Math.abs(Number(h)+n*i),g=u.lastIndexOf(h),m=u.substr(0,g)+d.toString()+u.substr(g+h.length);l.v=m,l.m=m,s.push(l)}return s}static FillOnlyFormat(e,t){const n=[];for(let s=1;s<=t;s++){const o=(s-1)%e.length,i={...e[o]};delete i.f,delete i.m,delete i.v,n.push(i)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const s={...e[n]};let o;s.f===null?o={m:s.v.toString(),v:s.v}:o={f:s.f,m:s.v.toString(),v:s.v},t.push(o)}return t}static FillDays(e,t,n){const s=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let l=hs("yyyy-MM-dd",a.v);l=me(l).add(n*o,"days").format("YYYY-MM-DD"),a.v=nn(l)[2],a.m=hs(a.fm.f,a.v),s.push(a)}return s}static FillMonths(e,t,n){const s=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let l=hs("yyyy-MM-dd",a.v);l=me(l).add(n*o,"months").format("YYYY-MM-DD"),a.v=nn(l)[2],a.m=hs(a.fm.f,a.v),s.push(a)}return s}static FillYears(e,t,n){const s=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let l=hs("yyyy-MM-dd",a.v);l=me(l).add(n*o,"years").format("YYYY-MM-DD"),a.v=nn(l)[2],a.m=hs(a.fm.t,a.v),s.push(a)}return s}static FillChnWeek(e,t,n){const s=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let u;e[e.length-1].m==="\u65E5"?u=7+n*i:u=s.ChineseToNumber(e[e.length-1].m)+n*i,u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u65E5",l.v="\u65E5"):c===1?(l.m="\u4E00",l.v="\u4E00"):c===2?(l.m="\u4E8C",l.v="\u4E8C"):c===3?(l.m="\u4E09",l.v="\u4E09"):c===4?(l.m="\u56DB",l.v="\u56DB"):c===5?(l.m="\u4E94",l.v="\u4E94"):c===6&&(l.m="\u516D",l.v="\u516D"),o.push(l)}return o}static FillChnWeek2(e,t,n){const s=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let u;if(e[e.length-1].m==="\u5468\u65E5")u=7+n*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);u=s.ChineseToNumber(d)+n*i}u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u5468\u65E5",l.v="\u5468\u65E5"):c===1?(l.m="\u5468\u4E00",l.v="\u5468\u4E00"):c===2?(l.m="\u5468\u4E8C",l.v="\u5468\u4E8C"):c===3?(l.m="\u5468\u4E09",l.v="\u5468\u4E09"):c===4?(l.m="\u5468\u56DB",l.v="\u5468\u56DB"):c===5?(l.m="\u5468\u4E94",l.v="\u5468\u4E94"):c===6&&(l.m="\u5468\u516D",l.v="\u5468\u516D"),o.push(l)}return o}static FillChnWeek3(e,t,n){const s=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let u;if(e[e.length-1].m==="\u661F\u671F\u65E5")u=7+n*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);u=s.ChineseToNumber(d)+n*i}u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u661F\u671F\u65E5",l.v="\u661F\u671F\u65E5"):c===1?(l.m="\u661F\u671F\u4E00",l.v="\u661F\u671F\u4E00"):c===2?(l.m="\u661F\u671F\u4E8C",l.v="\u661F\u671F\u4E8C"):c===3?(l.m="\u661F\u671F\u4E09",l.v="\u661F\u671F\u4E09"):c===4?(l.m="\u661F\u671F\u56DB",l.v="\u661F\u671F\u56DB"):c===5?(l.m="\u661F\u671F\u4E94",l.v="\u661F\u671F\u4E94"):c===6&&(l.m="\u661F\u671F\u516D",l.v="\u661F\u671F\u516D"),o.push(l)}return o}static FillChnNumber(e,t,n){const s=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]},u=s.ChineseToNumber(e[e.length-1].m)+n*i;let c;u<=0?c="\u96F6":c=s.NumberToChinese(u),l.v=c,l.m=c.toString(),o.push(l)}return o}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let s=1;s<e.length;s++)if(e[s]-e[s-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(e.length===1)e==="\u65E5"||e in t.chnNumChar?n=!0:n=!1;else{const s=e.split("");for(let o=0;o<s.length;o++)if(!(s[o]in t.chnNumChar||s[o]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const s=e.match(t),o=s[s.length-1],i=e.lastIndexOf(o),a=e.substr(0,i),l=e.substr(i+o.length);return[n,Number(o),a,l]}return[n]}static isChnWeek1(e){const t=this;let n;return e.length===1&&(e==="\u65E5"||t.ChineseToNumber(e)<7)?n=!0:n=!1,n}static isChnWeek2(e){let t;return e.length===2&&(e==="\u5468\u4E00"||e==="\u5468\u4E8C"||e==="\u5468\u4E09"||e==="\u5468\u56DB"||e==="\u5468\u4E94"||e==="\u5468\u516D"||e==="\u5468\u65E5")?t=!0:t=!1,t}static isChnWeek3(e){let t;return e.length===3&&(e==="\u661F\u671F\u4E00"||e==="\u661F\u671F\u4E8C"||e==="\u661F\u671F\u4E09"||e==="\u661F\u671F\u56DB"||e==="\u661F\u671F\u4E94"||e==="\u661F\u671F\u516D"||e==="\u661F\u671F\u65E5")?t=!0:t=!1,t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let s=1;s<e.length;s++)if(e[s]/e[s-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function s(h){let d=0;for(let g=0;g<h.length;g++)d+=h[g];return d/h.length}const o=s(n),i=s(t);let a=0,l=0;for(let h=0;h<n.length;h++)a+=(n[h]-o)*(t[h]-i),l+=(n[h]-o)*(n[h]-o);let u;l===0?u=1:u=a/l;const c=i-u*o;return Math.round((c+u*e)*1e5)/1e5}static judgeDate(e){let t=!0,n=!0,s=!0,o=!0,i=!0;const a=me(e[0].m).date(),l=me(e[0].m).month(),u=me(e[1].m).diff(me(e[0].m),"days"),c=me(e[1].m).diff(me(e[0].m),"months"),h=me(e[1].m).diff(me(e[0].m),"years");for(let d=1;d<e.length;d++)me(e[d].m).date()!==a&&(t=!1),me(e[d].m).month()!==l&&(n=!1),me(e[d].m).diff(me(e[d-1].m),"days")!==u&&(s=!1),me(e[d].m).diff(me(e[d-1].m),"months")!==c&&(o=!1),me(e[d].m).diff(me(e[d-1].m),"years")!==h&&(i=!1);return u===0&&(s=!1),c===0&&(o=!1),h===0&&(i=!1),[t,n,s,o,i]}}let St=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");class of{constructor(e,t){this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach(n=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(n).rangeData)}),this._rangeList[0].startRow===-1&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return this._rangeList[0].startRow===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l,g=new _e;for(let f=u;f<=h;f++)for(let p=c;p<=d;p++)g.setValue(u,c,{m:`${e}`,v:e});return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:g.getData()}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeList:o}=this;let i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};ot.checkup(e,ot.OBJECT_TYPE)&&(i=e[0]);const a=o.map(u=>({sheetId:n.getSheetId(),actionName:$.CLEAR_RANGE_ACTION,options:i,rangeData:u}));let l=new ge({WorkBookUnit:t.getWorkBook()},...a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:n,_context:s,_commandManager:o,_worksheet:i}=this;const a=n.map(u=>{let{startRow:c,startColumn:h,endRow:d,endColumn:g}=u;const m={[t]:e},f=W.fillObjectMatrix(d-c+1,g-h+1,m);return{sheetId:i.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:f,rangeData:u}});let l=new ge({WorkBookUnit:s.getWorkBook()},...a);return o.invoke(l),this}setBackground(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l;const g={bg:{rgb:e}},m=W.fillObjectMatrix(h-u+1,d-c+1,g);return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setBackgroundRGB(e,t,n){const s=`RGB(${e},${t},${n})`;let{_rangeList:o,_context:i,_commandManager:a,_worksheet:l}=this;const u=o.map(h=>{let{startRow:d,startColumn:g,endRow:m,endColumn:f}=h;const p={bg:{rgb:s}},b=W.fillObjectMatrix(m-d+1,f-g+1,p);return{sheetId:l.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:b,rangeData:h}});let c=new ge({WorkBookUnit:i.getWorkBook()},...u);return a.invoke(c),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l;const g={cl:{rgb:e}},m=W.fillObjectMatrix(h-u+1,d-c+1,g);return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?te.TRUE:te.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?te.TRUE:te.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l,g=new _e;for(let f=u;f<=h;f++)for(let p=c;p<=d;p++)g.setValue(f,p,e);return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMULA_ACTION,cellFormula:g.getData(),rangeData:l}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l;const g={tr:{v:0,a:Number(e)}},m=W.fillObjectMatrix(h-u+1,d-c+1,g);return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:o}=this;const i=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:d}=l;const g={tr:{v:e,a:0}},m=W.fillObjectMatrix(h-u+1,d-c+1,g);return{sheetId:o.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new ge({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:s}=this;const o=e.map(a=>{let{startRow:l,startColumn:u,endRow:c,endColumn:h}=a;const d=this._worksheet.getCellMatrix(),g=/\s+/g;let m=new _e;for(let p=l;p<c+1;p++)for(let b=u;b<h+1;b++){const w=d.getValue(p,b).m.replace(g,"");m.setValue(p,b,w||"")}return{sheetId:s.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:m.getData(),rangeData:a}});let i=new ge({WorkBookUnit:t.getWorkBook()},...o);return n.invoke(i),this}}class af{constructor(e,t){this._workSheet=e,this._rowData=new nt(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new nt;for(let s=e;s<e+t;s++){const o=this.getRowOrCreate(s);n.push(o)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,s=t.getConfig();let o=0;if(e.length===1)o=n.obtain(e[0],{hd:te.FALSE,h:s.defaultRowHeight}).h;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)o+=n.obtain(i,{hd:te.FALSE,h:s.defaultRowHeight}).h;return o}setRowHeight(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:$.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},i=new ge({WorkBookUnit:n.getWorkBook()},o);s.invoke(i)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,s=n.get(e);if(s)return s;const o=t.getConfig(),i={hd:te.FALSE,h:o.defaultRowHeight};return n.set(e,i),i}}class vn{_initialize(){this._merges=new tf(this,this._config.mergeData)}constructor(...e){var t;if(W.hasLength(e,1)){const n=e[0],s=W.commonExtend({},Wr);e=[n,s]}if(W.hasLength(e,2)){this._context=e[0],this._config=W.commonExtend1(Wr,e[1]);const{columnData:n,rowData:s,cellData:o}=this._config;this._sheetId=(t=this._config.id)!=null?t:St(6),this._initialized=!1,this._cellData=new _e(o),this._commandManager=this._context.getCommandManager(),this._rowManager=new af(this,s),this._columnManager=new Md(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===te.TRUE)return this;const{_context:e,_commandManager:t}=this,n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),s=e.getContextObserver("onAfterChangeActiveSheetObservable"),o={sheetId:this._sheetId,actionName:$.SET_WORKSHEET_ACTIVATE_ACTION,status:te.TRUE},i=new ge({WorkBookUnit:e.getWorkBook()},o);return n.notifyObservers({sheet:this}),t.invoke(i),s.notifyObservers({sheet:this}),this}setConfig(e){return this._config=W.commonExtend(Wr,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o=t.getContextObserver("onBeforeChangeSheetNameObservable"),i=t.getContextObserver("onAfterChangeSheetNameObservable"),a={actionName:$.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:s},u=t.getWorkBook().getSheets();for(let h=0;h<u.length;h++){const d=u[h];if(d!==this&&d.getName()===e)return console.warn("Duplicate name"),this}o.notifyObservers();const c=new ge({WorkBookUnit:t.getWorkBook()},a);return n.invoke(c),i.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=W.deepClone(e);return new vn(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){if(W.hasLength(e,1))return new at(this,e[0]);if(W.hasLength(e,2))return new at(this,{row:[e[0],e[0]],column:[e[1],e[1]]});if(W.hasLength(e,3))return new at(this,{row:[e[0],e[2]],column:[e[1],e[1]]});if(W.hasLength(e,4))return new at(this,{row:[e[0],e[2]],column:[e[1],e[3]]})}getRangeList(e){return new of(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o={actionName:$.SET_WORKSHEET_STATUS_ACTION,sheetId:s,sheetStatus:e},i=new ge({WorkBookUnit:t.getWorkBook()},o);return n.invoke(i),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n,_commandManager:s}=this,o={actionName:$.SET_ZOOM_RATIO_ACTION,sheetId:n,zoom:e},i=new ge({WorkBookUnit:t.getWorkBook()},o);s.invoke(i),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,s=W.deepClone(t);return s.name=e,s.status=te.FALSE,s.id=St(),new vn(n,s)}getConfig(){return this._config}insertRows(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]),W.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new _e(new nt(n)).toJSON()},l={actionName:$.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},u=new ge({WorkBookUnit:s.getWorkBook()},a,l);return o.invoke(u),this}insertRowAfter(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]+1),W.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new _e(new nt(n)).toJSON()},l={actionName:$.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},u=new ge({WorkBookUnit:s.getWorkBook()},a,l);return o.invoke(u),this}insertRowBefore(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]-1),W.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new _e(new nt(n)).toJSON()},l={actionName:$.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},u=new ge({WorkBookUnit:s.getWorkBook()},a,l);return o.invoke(u),this}insertColumns(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]),W.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a=new _e;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:$.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},u={actionName:$.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new ge({WorkBookUnit:s.getWorkBook()},u,l);return o.invoke(c),this}insertColumnBefore(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]-1),W.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:o,_sheetId:i}=this,a=new _e;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:$.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},u={actionName:$.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new ge({WorkBookUnit:s.getWorkBook()},u,l);return o.invoke(c),this}insertColumnAfter(...e){let t=0,n=1;W.hasLength(e,1)&&(t=e[0]+1),W.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a=new _e;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:$.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},u={actionName:$.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new ge({WorkBookUnit:s.getWorkBook()},l,u);return o.invoke(c),this}clear(...e){const{_context:t,_commandManager:n}=this,s={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let o={formatOnly:!0,contentsOnly:!0};ot.checkup(e,ot.OBJECT_TYPE)&&(o=e[0]);const i={sheetId:this._sheetId,actionName:$.CLEAR_RANGE_ACTION,options:o,rangeData:s},a=new ge({WorkBookUnit:t.getWorkBook()},i);return n.invoke(a),this}setTabColor(e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onSheetTabColorChangeObservable"),o={sheetId:this._sheetId,actionName:$.SET_TAB_COLOR_ACTION,color:e},i=new ge({WorkBookUnit:t.getWorkBook()},o);return n.invoke(i),s.notifyObservers(),this}hideSheet(){const{_context:e,_commandManager:t}=this,n=e.getWorkBook();if(!this._config.hidden){const s=e.getContextObserver("onHideSheetObservable"),o={sheetId:this._sheetId,actionName:$.HIDE_SHEET_ACTION,hidden:te.TRUE},i=new ge({WorkBookUnit:e.getWorkBook()},o);if(t.invoke(i),this.getStatus()===te.TRUE){const l=n.getSheetIndex(this),u=n.nextSheet(l);u&&u.activate()}s.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,n={sheetId:this._sheetId,actionName:$.HIDE_SHEET_ACTION,hidden:te.FALSE},s=new ge({WorkBookUnit:e.getWorkBook()},n);return t.invoke(s),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o={actionName:$.REMOVE_COLUMN_DATA_ACTION,sheetId:s,columnCount:1,columnIndex:e},i={actionName:$.REMOVE_COLUMN_ACTION,sheetId:s,columnCount:1,columnIndex:e},a=new ge({WorkBookUnit:t.getWorkBook()},o,i);return n.invoke(a),this}deleteColumns(e,t){const{_context:n,_commandManager:s,_sheetId:o}=this,i={actionName:$.REMOVE_COLUMN_DATA_ACTION,sheetId:o,columnCount:t,columnIndex:e},a={actionName:$.REMOVE_COLUMN_ACTION,sheetId:o,columnCount:t,columnIndex:e},l=new ge({WorkBookUnit:n.getWorkBook()},i,a);return s.invoke(l),this}deleteRow(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o={actionName:$.REMOVE_ROW_DATA_ACTION,sheetId:s,rowCount:1,rowIndex:e},i={actionName:$.REMOVE_ROW_ACTION,sheetId:s,rowCount:1,rowIndex:e},a=new ge({WorkBookUnit:t.getWorkBook()},o,i);return n.invoke(a),this}deleteRows(e,t){const{_context:n,_commandManager:s,_sheetId:o}=this,i={actionName:$.REMOVE_ROW_DATA_ACTION,sheetId:o,rowCount:t,rowIndex:e},a={actionName:$.REMOVE_ROW_ACTION,sheetId:o,rowCount:t,rowIndex:e},l=new ge({WorkBookUnit:n.getWorkBook()},i,a);return s.invoke(l),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_commandManager:s,_sheetId:o}=this,i=this.getContext(),a=this.getCellMatrix(),l=i.getWorkBook(),u=l.getStyles(),c=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),h=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),d=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),g=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),m=this.getRange(e),f=new _e,p=new _e,b=new _e,v=new _e,w=new _e;c.forEach((R,I)=>{const y=a.getValue(R,I);if(y){const O=u.getStyleByCell(y);if(O){const M=W.deepClone(O);M.bd&&delete M.bd.b,f.setValue(R,I,M)}}}),d.forEach((R,I)=>{const y=a.getValue(R,I);if(y){const O=u.getStyleByCell(y);if(O){const M=W.deepClone(O);M.bd&&delete M.bd.t,b.setValue(R,I,M)}}}),h.forEach((R,I)=>{const y=a.getValue(R,I);if(y){const O=u.getStyleByCell(y);if(O){const M=W.deepClone(O);M.bd&&delete M.bd.r,p.setValue(R,I,M)}}}),g.forEach((R,I)=>{const y=a.getValue(R,I);if(y){const O=u.getStyleByCell(y);if(O){const M=W.deepClone(O);M.bd&&delete M.bd.l,v.setValue(R,I,M)}}}),m.forEach((R,I)=>{w.setValue(R,I,t)});const S=[];if(n.includes(ee.TOP)){const R={sheetId:o,actionName:$.SET_BORDER_ACTION,styles:b.toJSON()};S.push(R)}if(n.includes(ee.BOTTOM)){const R={sheetId:o,actionName:$.SET_BORDER_ACTION,styles:f.toJSON()};S.push(R)}if(n.includes(ee.LEFT)){const R={sheetId:o,actionName:$.SET_BORDER_ACTION,styles:v.toJSON()};S.push(R)}if(n.includes(ee.RIGHT)){const R={sheetId:o,actionName:$.SET_BORDER_ACTION,styles:p.toJSON()};S.push(R)}const T={sheetId:o,actionName:$.SET_BORDER_ACTION,styles:w.toJSON()};S.push(T);const D=new ge({WorkBookUnit:l},...S);return s.invoke(D),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex(n=>n&&n.getSheetId()===this._sheetId);return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:o,_commandManager:i,_sheetId:a}=this,l={actionName:$.SET_HIDE_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},u=new ge({WorkBookUnit:o.getWorkBook()},l);return i.invoke(u),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.SET_HIDE_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},l=new ge({WorkBookUnit:s.getWorkBook()},a);return o.invoke(l),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:o,_commandManager:i,_sheetId:a}=this,l={actionName:$.SET_HIDE_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},u=new ge({WorkBookUnit:o.getWorkBook()},l);return i.invoke(u),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.SET_HIDE_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},l=new ge({WorkBookUnit:s.getWorkBook()},a);return o.invoke(l),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:o,_commandManager:i,_sheetId:a}=this,l={actionName:$.SET_SHOW_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},u=new ge({WorkBookUnit:o.getWorkBook()},l);return i.invoke(u),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:o,_commandManager:i,_sheetId:a}=this,l={actionName:$.SET_SHOW_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},u=new ge({WorkBookUnit:o.getWorkBook()},l);return i.invoke(u),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.SET_SHOW_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},l=new ge({WorkBookUnit:s.getWorkBook()},a);return o.invoke(l),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:o,_sheetId:i}=this,a={actionName:$.SET_SHOW_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},l=new ge({WorkBookUnit:s.getWorkBook()},a);return o.invoke(l),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return t===0}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(W.hasLength(e,2)&&(t=e[0],n=[e[1]]),W.hasLength(e,3)){t=e[0];for(let s=0;s<e[1];s++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const s=[];for(let o=0;o<t;o++)s.push(n);return this.getRowManager().setRowHeight(e,s),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o={actionName:$.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:s},i=new ge({WorkBookUnit:t.getWorkBook()},o);return n.invoke(i),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:n,_sheetId:s}=this,o={actionName:$.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:s},i=new ge({WorkBookUnit:t.getWorkBook()},o);return n.invoke(i),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=W.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,s){return new at(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+s-1}).getValues()}getDataRange(){return new at(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:s}=e.getRangeData(),o=this._cellData.spliceRows(n,s-n+1);return this._cellData.insertRows(t,o),this}moveColumns(e,t){const n=e.getRangeData().startColumn,s=e.getRangeData().endColumn,o=this._cellData.spliceColumns(n,s-n+1);return this._cellData.insertColumns(t,o),this}}class at{static foreach(e,t){const{startRow:n,startColumn:s,endRow:o,endColumn:i}=e;for(let a=n;a<=o;a++)for(let l=s;l<=i;l++)t(a,l)}constructor(e,t){this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,o=[];for(let i=e;i<=t;i++){const a=[];for(let l=n;l<=s;l++)a.push(this.getMatrix().getValue(i,l)||null);o.push(a)}return o}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,o=this._worksheet.getCellMatrix(),i=new _e;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)i.setValue(a,l,o.getValue(a,l)||null);return i}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,o=this._worksheet.getCellMatrix(),i=new _e;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)i.setValue(a-e,l-n,o.getValue(a,l)||{});return i}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map(e=>e.map(t=>t&&t.p?t.p:t&&t.m?t.m:""))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;let o,i;return n<s?(o=W.numToWord(n+1)+(e+1),i=W.numToWord(s+1)+(t+1)):(o=W.numToWord(s+1)+(t+1),i=W.numToWord(n+1)+(e+1)),o===i?`${o}`:`${o}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map(e=>e.map(t=>{var o,i,a;const n=this._context.getWorkBook().getStyles();let s=(o=us.bg)==null?void 0:o.rgb;return s=(a=(i=n.getStyleByCell(t))==null?void 0:i.bg)==null?void 0:a.rgb,s}))}getCell(e,t){const{startRow:n,endRow:s,startColumn:o,endColumn:i}=this._rangeData,a={startRow:n+e,endRow:n+e,startColumn:o+t,endColumn:o+t};return new at(this._worksheet,a)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=this._rangeData,i=this._worksheet.getCellMatrix().getFragments(t,n,s,o).getData();if(e.isIncludeStyle){const a=this._context.getWorkBook().getStyles();for(let l=0;l<=n-t;l++)for(let u=0;u<=o-s;u++){if(!i[l][u])continue;const c=i[l][u].s;c&&(i[l][u].s=a.get(c))}}return i}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map(e=>e.map(t=>{var o,i;const s=this._context.getWorkBook().getStyles().getStyleByCell(t);return((o=s==null?void 0:s.cl)==null?void 0:o.rgb)||((i=us.cl)==null?void 0:i.rgb)}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map(t=>t.map(n=>{const s=this._context.getWorkBook().getStyles(),o=s&&s.getStyleByCell(n);return o&&o[e]||us[e]}))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:s}=e;let o=0;for(let i=0;i<=s-n;i++)o+=t.getRowHeight(i);return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:s}).map(o=>new at(this._worksheet,o))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:s,startColumn:o,endColumn:i}=this._rangeData,a=t.getMaxRows(),l=t.getMaxColumns();if(e===ee.BOTTOM){for(let u=0;u<a-o;u++)this._worksheet.getCellMatrix().getValue(n+u,o)&&t.getRange(n+u,o,n+u,o);return t.getRange(a,o,a,o)}if(e===ee.TOP){for(let u=0;u<n;u++)this._worksheet.getCellMatrix().getValue(n-u,o)&&t.getRange(n-u,o,n-u,n);return t.getRange(0,o,0,o)}if(e===ee.RIGHT){for(let u=0;u<l-o;u++)this._worksheet.getCellMatrix().getValue(n,o+u)&&t.getRange(n,o+u,n,o+u);return t.getRange(n,l,n,l)}if(e===ee.LEFT){for(let u=0;u<a-o;u++)this._worksheet.getCellMatrix().getValue(n,o-u)&&t.getRange(n,o-u,n,o-u);return t.getRange(n,0,n,0)}return t.getRange(Id)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(t=>(t==null?void 0:t.p)||""))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map(e=>e.map(t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:s}=e;let o=0;for(let i=0;i<=s-n;i++)o+=t.getColumnWidth(i);return o}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some(t=>t.some(n=>(n==null?void 0:n.m)===""))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,s)}_setStyle(e,t){const{_context:n,_worksheet:s,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:l,endColumn:u}=this._rangeData,c={[t]:e},h=W.fillObjectMatrix(a-i+1,u-l+1,c),d={sheetId:s.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},g=new ge({WorkBookUnit:n.getWorkBook()},d);return o.invoke(g),this}_setStyles(e,t){const{_context:n,_worksheet:s,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:l,endColumn:u}=this._rangeData,c=new _e;for(let g=0;g<a-i+1;g++)for(let m=0;m<u-l+1;m++)c.setValue(g,m,{[t]:e[g][m]});const h={sheetId:s.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},d=new ge({WorkBookUnit:n.getWorkBook()},h);return o.invoke(d),this}setBackground(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={bg:{rgb:e}},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=new _e;for(let d=0;d<i-o+1;d++)for(let g=0;g<l-a+1;g++)u.setValue(d,g,{bg:{rgb:e[d][g]}});const c={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new ge({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setBackgroundRGB(e,t,n){const{_context:s,_worksheet:o,_commandManager:i}=this,{startRow:a,endRow:l,startColumn:u,endColumn:c}=this._rangeData,d={bg:{rgb:`RGB(${e},${t},${n})`}},g=W.fillObjectMatrix(l-a+1,c-u+1,d),m={sheetId:o.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:g,rangeData:this._rangeData},f=new ge({WorkBookUnit:s.getWorkBook()},m);return i.invoke(f),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=new _e;for(let d=0;d<i-o+1;d++)for(let g=0;g<l-a+1;g++)u.setValue(d,g,{cl:{rgb:e[d][g]}});const c={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new ge({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:l,endColumn:u}=t,c=new _e;for(let g=i;g<=l;g++)for(let m=a;m<=u;m++)c.setValue(g,m,e);const h={sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},d=new ge({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setFormulas(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:l,endColumn:u}=t,c=new _e;for(let g=0;g<=l-i;g++)for(let m=0;m<=u-a;m++)c.setValue(g+i,m+a,e[g][m]);const h={sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},d=new ge({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={tr:{v:0,a:Number(e)}},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=new _e;for(let d=0;d<i-o+1;d++)for(let g=0;g<l-a+1;g++)u.setValue(d,g,{tr:{v:0,a:e[d][g]}});u.getData();const c={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new ge({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={...e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=new _e;for(let d=0;d<i-o+1;d++)for(let g=0;g<l-a+1;g++)u.setValue(d,g,{...e[d][g]});const c={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new ge({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={tr:{v:e,a:90}},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:s,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:l,endColumn:u}=this._rangeData,{startRow:c,endRow:h,startColumn:d,endColumn:g}=e._rangeData;let m=ee.BOTTOM,f=0,p=0;const b=i,v=a,w=l,S=u,T=c,D=h,R=d,I=g,y=new _e;if(R===w&&I===S?D>v?m=ee.BOTTOM:m=ee.TOP:I>S?m=ee.RIGHT:m=ee.LEFT,m===ee.BOTTOM||m===ee.TOP){f=v-b+1,p=D-T+1;for(let F=0;F<=u-l;F++){const x=this.getColumnMatrix(F).toArray();ei.getCopyData(x,b,v,w,S,m).forEach(N=>{ei.getApplyData(N,f,p,t,m).forEach((L,ne)=>{y.setValue(ne,F,L)})})}}else if(m===ee.RIGHT||m===ee.LEFT){p=I-R,f=S-w;for(let F=0;F<=a-i;F++){const x=this.getRowMatrix(F).toArray();ei.getCopyData(x,b,v,w,S,m).forEach(N=>{ei.getApplyData(N,f,p,t,m)})}}const O={sheetId:n.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:y.getData()},M=new ge({WorkBookUnit:s.getWorkBook()},O);return o.invoke(M),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=this._rangeData;let i,a;const l=this._worksheet.getCellMatrix();if(W.isNumber(e[0])){const u=e[0];if(u===Ur.COLUMNS){let c=t,h=t;const d=this._worksheet.getRowCount();for(let m=1;m<t;m++)if(!l.getValue(t-m,s)){c=t-m+1;break}const g=0;for(;g<d-t;)if(!l.getValue(t+g,s)){h=t-g-1;break}return a=c-h,i=0,this._worksheet.getRange(t,c,i,a)}if(u===Ur.ROWS){let c=t,h=t;const d=this._worksheet.getColumnCount();for(let m=1;m<t;m++)if(!l.getValue(t,s-m)){c=t-m+1;break}const g=0;for(;g<d-s;)if(!l.getValue(t,s+g)){h=t-g-1;break}return a=0,i=c-h,this._worksheet.getRange(c,s,i,a)}}else{let u=t,c=t;const h=this._worksheet.getRowCount();for(let b=1;b<t;b++)if(!l.getValue(t-b,s)){u=t-b+1;break}const d=0;for(;d<h-t;)if(!l.getValue(t+d,s)){c=t-d-1;break}let g=t,m=t;const f=this._worksheet.getColumnCount();for(let b=1;b<t;b++)if(!l.getValue(t,s-b)){g=t-b+1;break}const p=0;for(;p<f-s;)if(!l.getValue(t,s+p)){m=t-p-1;break}return a=g-m,a=u-c,i=t,this._worksheet.getRange(u,g,i,a)}return this}trimWhitespace(){var g;const{_context:e,_worksheet:t,_commandManager:n}=this,{startRow:s,endRow:o,startColumn:i,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),u=/\s+/g,c=new _e;for(let m=0;m<=o-s;m++)for(let f=0;f<=a-i;f++){const p=(g=l.getValue(m,f).m)==null?void 0:g.replace(u,"");c.setValue(m+s,f+i,p||"")}const h={sheetId:t.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},d=new ge({WorkBookUnit:e.getWorkBook()},h);return n.invoke(d),this}activate(){var e;return((e=this._rangeData)==null?void 0:e.startRow)===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,s=this._rangeData.startColumn,o=this._rangeData.endColumn,i=e.getRangeData().startRow,a=e.getRangeData().endRow,l=e.getRangeData().startColumn,u=e.getRangeData().endColumn,c=Math.abs(s+o-l-u),h=Math.abs(s-o)+Math.abs(l-u),d=Math.abs(t+n-i-a),g=Math.abs(t-n)+Math.abs(i-a);return c<=h&&d<=g}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={cl:{rgb:e}},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:s}=this,o=e[0],[i,a]=this._handleCopyRange(this,o),{startRow:l,startColumn:u,endRow:c,endColumn:h}=a;if(ot.checkup(e,at,ot.BOOLEAN_TYPE)){const d=e[1];if(e[2],d===Xs.PASTE_NORMAL){const g=new _e;i.forEach((p,b)=>p.forEach((v,w)=>{v=v,g.setValue(b+l,w+u,v||{})}));const m={sheetId:n.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:g.getData()},f=new ge({WorkBookUnit:t.getWorkBook()},m);s.invoke(f)}else if(d===Xs.PASTE_FORMAT){const g=t.getWorkBook().getStyles(),m=new _e;i.map((b,v)=>b.forEach((w,S)=>{w=w,m.setValue(v,S,g.getStyleByCell(w)||{})}));const f={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:m.getData(),rangeData:a},p=new ge({WorkBookUnit:t.getWorkBook()},f);s.invoke(p)}else if(d===Xs.PASTE_VALUES){const g=new _e;i.forEach((p,b)=>p.forEach((v,w)=>{v=v,g.setValue(b+l,w+u,(v==null?void 0:v.v)||"")}));const m={sheetId:n.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:g.getData(),rangeData:a},f=new ge({WorkBookUnit:t.getWorkBook()},m);s.invoke(f)}else if(d===Xs.PASTE_COLUMN_WIDTHS){const g=this._rangeData.startColumn;for(let m=0;m<h-g;m++){const f=n.getColumnWidth(g+m);n.setColumnWidth(g+m,f)}}}else if(ot.checkup(e,at,ot.OBJECT_TYPE)){const d=e[1],g=new _e;i.forEach((p,b)=>p.forEach((v,w)=>{v=v,g.setValue(b+l,w+u,v||{})}));const m={sheetId:n.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:g.getData(),options:d},f=new ge({WorkBookUnit:t.getWorkBook()},m);s.invoke(f)}else if(ot.checkup(e,at)){const d=new _e;i.forEach((f,p)=>f.forEach((b,v)=>{b=b,d.setValue(p+l,v+u,b||{})}));const g={sheetId:n.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:d.getData()},m=new ge({WorkBookUnit:t.getWorkBook()},g);s.invoke(m)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],o=e[2],i=e[3],a=e[4],l=W.isAssignableFrom(e[0],vn)?e[0].getSheetId():e[0],[u,c]=this._handleCopyRange(this,{startRow:s,endRow:o,startColumn:i,endColumn:a}),h=t.getWorkBook().getStyles(),d=new _e;u.map((f,p)=>f.map((b,v)=>(b=b,d.setValue(p,v,h.getStyleByCell(b)||{}),h.getStyleByCell(b)||{})));const g={sheetId:l,actionName:$.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:c},m=new ge({WorkBookUnit:t.getWorkBook()},g);n.invoke(m)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],o=e[2],i=e[3],a=e[4],l=W.isAssignableFrom(e[0],vn)?e[0].getSheetId():e[0],[u,c]=this._handleCopyRange(this,{startRow:s,endRow:o,startColumn:i,endColumn:a}),h=new _e;u.forEach((m,f)=>m.forEach((p,b)=>{p=p,h.setValue(f+c.startRow,b+c.startColumn,(p==null?void 0:p.v)||"")}));const d={sheetId:l,actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:c},g=new ge({WorkBookUnit:t.getWorkBook()},d);n.invoke(g)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:o}=this,i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},a={sheetId:n.getSheetId(),actionName:$.CLEAR_RANGE_ACTION,options:i,rangeData:o},l=this.getMatrix(),{startRow:u,endRow:c,startColumn:h,endColumn:d}=this._rangeData,{startRow:g,startColumn:m}=e.getRangeData(),f=new _e;for(let v=u;v<=c;v++)for(let w=h;w<=d;w++)f.setValue(g+(v-u),m+(w-h),l.getValue(v,w)||{});const p={sheetId:n.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:f.getData()},b=new ge({WorkBookUnit:t.getWorkBook()},a,p);s.invoke(b)}offset(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=this._rangeData,i=e[0],a=e[1],l=e[2],u=e[3],c={startRow:t+i,endRow:n+i,startColumn:s+a,endColumn:o+a};return W.isNumber(l)&&(c.endRow=c.startRow+l-1),W.isNumber(u)&&(c.endColumn=c.endColumn+u-1),new at(this._worksheet,c)}setBorder(...e){const t=e[0],n=e[1],s=e[2],o=e[3],i=e[4],a=e[5],l=e[6]?e[6]:"black",u=e[7]?e[7]:C.DASH_DOT,{_context:c,_worksheet:h,_commandManager:d}=this,g=c.getWorkBook(),m=this._rangeData,f=h.getSheetId(),p={startRow:m.startRow-1,startColumn:m.startColumn,endRow:m.startRow-1,endColumn:m.endColumn},b={startRow:m.startRow,startColumn:m.startColumn-1,endRow:m.endRow,endColumn:m.startColumn-1},v={startRow:m.endRow+1,startColumn:m.startColumn,endRow:m.endRow+1,endColumn:m.endColumn},w={startRow:m.startRow,startColumn:m.endColumn+1,endRow:m.endRow,endColumn:m.endColumn+1},S={startRow:m.startRow,startColumn:m.startColumn,endRow:m.startRow,endColumn:m.endColumn},T={startRow:m.startRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.startColumn},D={startRow:m.endRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.endColumn},R={startRow:m.startRow,startColumn:m.endColumn,endRow:m.endRow,endColumn:m.endColumn},I=new at(h,p),y=new at(h,b),O=new at(h,v),M=new at(h,w),F=new at(h,S),x=new at(h,T),E=new at(h,D),N=new at(h,R),X=new _e,L=new _e,ne=new _e,G=new _e,Q=new _e,P=[],V={s:u,cl:{rgb:l}};if(t===!0||t===!1){if(I.isValid()){I.forEach((ie,be)=>{X.setValue(ie,be,{bd:{b:null}})});const Z={sheetId:f,actionName:$.SET_RANGE_STYLE_ACTION,value:X.getArrayData(),rangeData:p};P.push(Z)}F.forEach((Z,ie)=>{if(t===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{t:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(t===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{t:null}});Q.setValue(Z,ie,be)}})}if(s===!0||s===!1){if(O.isValid()){O.forEach((ie,be)=>{ne.setValue(ie,be,{bd:{t:null}})});const Z={sheetId:f,actionName:$.SET_RANGE_STYLE_ACTION,value:ne.getArrayData(),rangeData:v};P.push(Z)}E.forEach((Z,ie)=>{if(s===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{b:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(s===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{b:null}});Q.setValue(Z,ie,be)}})}if(n===!0||n===!1){if(y.isValid()){y.forEach((ie,be)=>{L.setValue(ie,be,{bd:{r:null}})});const Z={sheetId:f,actionName:$.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:b};P.push(Z)}x.forEach((Z,ie)=>{if(n===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{l:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(n===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{l:null}});Q.setValue(Z,ie,be)}})}if(o===!0||o===!1){if(M.isValid()){M.forEach((ie,be)=>{G.setValue(ie,be,{bd:{l:null}})});const Z={sheetId:f,actionName:$.SET_RANGE_STYLE_ACTION,value:G.getArrayData(),rangeData:w};P.push(Z)}N.forEach((Z,ie)=>{if(o===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{r:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(o===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{r:null}});Q.setValue(Z,ie,be)}})}(i===!0||i===!1)&&this.forEach((Z,ie)=>{if(ie!==m.endColumn){if(i===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{r:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(i===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{r:null}});Q.setValue(Z,ie,be)}}if(ie!==m.startColumn){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{l:null}});Q.setValue(Z,ie,be)}}),(a===!0||a===!1)&&this.forEach((Z,ie)=>{if(Z!==m.endRow){if(a===!0){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{b:W.deepClone(V)}});Q.setValue(Z,ie,be)}else if(a===!1){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{b:null}});Q.setValue(Z,ie,be)}}if(Z!==m.startRow){const be=W.deepMerge(Q.getValue(Z,ie)||{},{bd:{t:null}});Q.setValue(Z,ie,be)}});const pe={sheetId:f,actionName:$.SET_RANGE_STYLE_ACTION,value:Q.getArrayData(),rangeData:Q.getDataRange()};P.push(pe);const oe=new ge({WorkBookUnit:g},...P);return d.invoke(oe),this}setBorderByType(e,t,n){let s=null,o=null,i=null,a=null,l=null,u=null;switch(e){case Rn.TOP:s=!0;break;case Rn.BOTTOM:i=!0;break;case Rn.LEFT:o=!0;break;case Rn.RIGHT:a=!0;break;case Rn.NONE:s=!1,o=!1,i=!1,a=!1,l=!1,u=!1;break;case Rn.ALL:s=!0,o=!0,i=!0,a=!0,l=!0,u=!0;break;case Rn.OUTSIDE:s=!0,o=!0,i=!0,a=!0;break;case Rn.INSIDE:l=!0,u=!0;break;case Rn.HORIZONTAL:u=!0;break;case Rn.VERTICAL:l=!0;break}this.setBorder(s,o,i,a,l,u,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={ff:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={fs:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={ht:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={vt:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={td:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u={tb:e},c=W.fillObjectMatrix(i-o+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:$.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},d=new ge({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:l,endColumn:u}=t,c=new _e;for(let g=i;g<=l;g++)for(let m=a;m<=u;m++)c.setValue(g,m,e);const h={sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},d=new ge({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,i=e[0];if(ot.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:u,endColumn:c}=t,h=new _e;for(let m=0;m<=u-a;m++)for(let f=0;f<=c-l;f++)h.setValue(m+a,f+l,i[m][f]);const d={sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},g=new ge({WorkBookUnit:n.getWorkBook()},d);s.invoke(g)}else if(ot.checkup(e,_e)){const a={sheetId:o.getSheetId(),actionName:$.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:i,rangeData:this._rangeData},l=new ge({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,{startRow:i,startColumn:a}=t,l={sheetId:o.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:{[i]:{[a]:e}}},u=new ge({WorkBookUnit:n.getWorkBook()},l);return s.invoke(u),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,i=e[0];if(ot.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:u,endColumn:c}=t,h=new _e;for(let m=0;m<=u-a;m++)for(let f=0;f<=c-l;f++)h.setValue(m+a,f+l,i[m][f]);const d={sheetId:o.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:h.getData()},g=new ge({WorkBookUnit:n.getWorkBook()},d);s.invoke(g)}else if(ot.checkup(e,_e)){const a={sheetId:o.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:i},l=new ge({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:o}=this;let i={formatOnly:!0,contentsOnly:!0};ot.checkup(e,ot.OBJECT_TYPE)&&(i=e[0]);const a={sheetId:n.getSheetId(),actionName:$.CLEAR_RANGE_ACTION,options:i,rangeData:o},l=new ge({WorkBookUnit:t.getWorkBook()},a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this,i={sheetId:o.getSheetId(),actionName:$.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},a=new ge({WorkBookUnit:n.getWorkBook()},i);s.invoke(a)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:s,_context:o,_commandManager:i,_worksheet:a}=this,{startRow:l,endRow:u,startColumn:c,endColumn:h}=this._rangeData;let d=this._rangeData,g=new _e;if(n){g=n.getMatrixObject();const p=n.getRangeData();d={startRow:l,endRow:l+p.endRow-p.startRow,startColumn:c,endColumn:l+p.endColumn-p.startColumn}}else for(let p=l;p<=u;p++)for(let b=c;b<=h;b++)g.setValue(p,b,{m:"",v:""});const m={sheetId:a.getSheetId(),actionName:$.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:d,cellValue:g.getData()},f=new ge({WorkBookUnit:o.getWorkBook()},m);return i.invoke(f),this}merge(){const{_worksheet:e}=this,t=e.getContext(),n=e.getSheetId(),s=e.getCommandManager(),o={actionName:$.ADD_MERGE_ACTION,sheetId:n,rectangles:[this._rangeData]},i=new ge({WorkBookUnit:t.getWorkBook()},o);return s.invoke(i),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=[];for(let d=o;d<=i;d++){const g={startRow:d,endRow:d,startColumn:a,endColumn:l};u.push(g)}const c={actionName:$.ADD_MERGE_ACTION,sheetId:s,rectangles:u},h=new ge({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:o,endRow:i,startColumn:a,endColumn:l}=this._rangeData,u=[];for(let d=a;d<=l;d++){const g={startRow:o,endRow:i,startColumn:d,endColumn:d};u.push(g)}const c={actionName:$.ADD_MERGE_ACTION,sheetId:s,rectangles:u},h=new ge({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),o=this._worksheet.getMerges().getMergedRanges(this._rangeData),i={actionName:$.REMOVE_MERGE_ACTION,sheetId:s,rectangles:o},a=new ge({WorkBookUnit:n.getWorkBook()},i);return t.invoke(a),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:o}=this;Array.isArray(e[0])&&e[0];const i=this.getMatrix().getData(),a=[];for(let d=0;d<=t.endColumn-t.startColumn;d++){const g=[],m={},f=this.getColumnMatrix(d).getData();for(const p in f){const b=f[p][d].m;m.hasOwnProperty(b)||(m[b]=1,g.push(d))}a.push(g)}const l=Array.from(new Set(a.flat())),u={};l.forEach((d,g)=>{u[g]=i[d]});const c=[{sheetId:o.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:u}],h=new ge({WorkBookUnit:n.getWorkBook()},...c);return s.invoke(h),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new _e;for(let i=e;i<=e;i++)for(let a=t;a<=n;a++)o.setValue(i,a,s.getValue(i,a)||{});return o}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new _e;for(let i=t;i<=n;i++)for(let a=e;a<=e;a++)o.setValue(i,a,s.getValue(i,a)||{});return o}_handleCopyRange(...e){const t=e[0];let n=e[1];n=ot.checkup(e,at,at)?n.getRangeData():n;const s=t._worksheet.getCellMatrix(),{startRow:o,endRow:i,startColumn:a,endColumn:l}=t.getRangeData();let{startRow:u,endRow:c,startColumn:h,endColumn:d}=n;const g=i-o+1,m=l-a+1,f=c-u+1,p=d-h+1;let b=[],v;if(f%g===0&&p%m===0){for(let w=0;w<f;w++){const S=[];for(let T=0;T<p;T++){const D=s.getValue((w+o)%g,(T+a)%m)||{};S.push(D)}b.push(S)}v=n}else b=s.getFragments(o,i,a,l).getData(),c+=g-f,d+=m-p,v={startRow:u,endRow:c,startColumn:h,endColumn:d};return[b,v]}forEach(e){at.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:s}=this,{startRow:o,startColumn:i}=s,a=new _e;W.randSort(this.getMatrix().toArray()).forEach((h,d)=>h.forEach((g,m)=>{g=g,a.setValue(d+o,m+i,g||{})}));const u={sheetId:t.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:a.getData()},c=new ge({WorkBookUnit:e.getWorkBook()},u);n.invoke(c)}isValid(){return!Object.values(this._rangeData).includes(-1)}}class Cu{constructor(e={}){this._styles=e}each(e){return Object.entries(this._styles).forEach(e),this}search(e){const{_styles:t}=this;for(const n in t)if(W.diffValue(t[n],e))return n;return"-1"}get(e){return e=String(e),typeof e!="string"?e:this._styles[e]}add(e){const t=St(6);return this._styles[t]=e,t}setValue(e){if(e==null)return;const t=this.search(e);return t!=="-1"?t:this.add(e)}toJSON(){return this._styles}getStyleByCell(e){let t;return e&&W.isObject(e.s)?t=e.s:t=(e==null?void 0:e.s)&&this.get(e.s),t}}class Sb{constructor(e){this._workbook=e,this._commandManager=this._workbook.getCommandManager(),this._context=this._workbook.getContext()}addNamedRange(e){const{_workbook:t,_context:n,_commandManager:s}=this,o={actionName:$.ADD_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},i=new ge({WorkBookUnit:t},o);s.invoke(i)}setNamedRange(e){const{_workbook:t,_commandManager:n}=this,s={actionName:$.SET_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},o=new ge({WorkBookUnit:t},s);n.invoke(o)}remove(e){const{_context:t,_workbook:n,_commandManager:s}=this,o={actionName:$.DELETE_NAMED_RANGE_ACTION,namedRangeId:e,sheetId:n.getActiveSheet().getSheetId()},i=new ge({WorkBookUnit:n},o);s.invoke(i)}}class ha{constructor(e={},t){var s;this._config=W.commonExtend(xd,e),this._context=t;const{styles:n}=this._config;this._unitId=(s=this._config.id)!=null?s:St(6),this._styles=new Cu(n),this._worksheets=new Map,this._commandManager=t.getCommandManager(),this._getDefaultWorkSheet(),this._namedRange=new Sb(this)}_getDefaultWorkSheet(){const{_context:e,_config:t,_worksheets:n}=this,{sheets:s,sheetOrder:o}=t;W.isEmptyObject(s)&&(s[Wr.id]=Object.assign(Wr,{status:te.TRUE}));let i=null;for(let a in s){let l=s[a];l.name=mr.getSheetName(l.name);const u=new vn(e,l);n.set(a,u),o.includes(a)||o.push(a),i==null&&(i=u)}i&&i.activate()}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach(e=>{e.setStatus(te.FALSE)}),this._worksheets[0].setStatus(te.TRUE))}_getCellRange(e){var u,c,h,d,g;let t="",n="";if(e.indexOf("!")>-1){const m=e.split("!");t=m[0],n=m[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substring(0,1)==="'"&&t.substring(t.length-1,1)==="'"&&(t=t.substring(1,t.length-1))}else n=e;if(n.indexOf(":")===-1){const m=parseInt(n.replace(/[^0-9]/g,""),10)-1,f=W.ABCatNum(n.replace(/[^A-Za-z]/g,""));return!Number.isNaN(m)&&!Number.isNaN(f)?{sheetId:t,rangeData:{startRow:m,endRow:m,startColumn:f,endColumn:f}}:Qo}n=n.split(":");const s=[0,0],o=[0,0],i=((u=this.getSheetBySheetName(t))==null?void 0:u.getMaxRows())||((c=this.getActiveSheet())==null?void 0:c.getMaxRows()),a=((h=this.getSheetBySheetName(t))==null?void 0:h.getMaxColumns())||((d=this.getActiveSheet())==null?void 0:d.getMaxColumns());return s[0]=parseInt(n[0].replace(/[^0-9]/g,""),10)-1,s[1]=parseInt(n[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(s[0])&&(s[0]=0),Number.isNaN(s[1])&&(s[1]=i),s[0]>s[1]||(o[0]=W.ABCatNum(n[0].replace(/[^A-Za-z]/g,"")),o[1]=W.ABCatNum(n[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(o[0])&&(o[0]=0),Number.isNaN(o[1])&&(o[1]=a),o[0]>o[1])?Qo:{sheetId:((g=this.getSheetBySheetName(t))==null?void 0:g.getSheetId())||"",rangeData:{startRow:s[0],endRow:s[1],startColumn:o[0],endColumn:o[1]}}}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}getNamedRang(){return this._namedRange}nextSheet(e){if(e>=0){const{sheetOrder:t}=this._config;for(let n=e;n<t.length;n++){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}if(e<t.length)for(let n=e-1;n>=0;n--){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}return this._worksheets.get(t[t.length-1])}}setContext(e){this._context=e}setCommandManager(e){this._commandManager=e}insertSheet(...e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onBeforeInsertSheetObservable"),o=t.getContextObserver("onAfterInsertSheetObservable");if(W.hasLength(e,0)){const i={name:mr.getSheetName(),status:0,id:St(6)},a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:i.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:i.id,index:a,sheet:i})),o.notifyObservers({index:a,sheetId:i.id}),i.id}if(W.hasLength(e,1)){if(W.isAssignableFrom(e[0],vn)){const i=e[0],a=this.getSheetSize(),l=i.getConfig();return l.id=St(6),s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),o.notifyObservers({index:a,sheetId:l.id}),l.id}if(W.isNumber(e[0])){const i=e[0],a={name:mr.getSheetName(),status:0,id:St(6)};return s.notifyObservers({index:i,sheetId:a.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}if(W.isString(e[0])){const i=e[0],a=this.getSheetSize(),l={status:0,name:i,id:St(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),o.notifyObservers({index:a,sheetId:l.id}),l.id}if(W.isPlainObject(e[0])){const i=e[0],a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:i.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:i.id,index:a,sheet:i})),o.notifyObservers({index:a,sheetId:i.id}),i.id}}if(W.hasLength(e,2)){if(W.isString(e[0])){const i=e[0],a=e[1],l={status:0,name:i,id:St(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),o.notifyObservers({index:a,sheetId:l.id}),l.id}if(W.isNumber(e[0])){if(W.isAssignableFrom(e[1],vn)){const i=e[0],l=e[1].getConfig();return l.id=St(6),s.notifyObservers({index:i,sheetId:l.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:l.id,index:i,sheet:l})),o.notifyObservers({index:i,sheetId:l.id}),l.id}if(W.isPlainObject(e[1])){const i=e[0],a=e[1];return s.notifyObservers({index:i,sheetId:a.id}),n.invoke(new ge({WorkBookUnit:t.getWorkBook()},{actionName:$.INSERT_SHEET_ACTION,sheetId:a.id,index:i,sheet:a})),o.notifyObservers({index:i,sheetId:a.id}),a.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...e){if(W.hasLength(e,1)){const{_context:t}=this,n=e[0],s={...Wr,name:n},o=new vn(t,s);return this.insertSheet(o),o}if(W.hasLength(e,3)){const{_context:t}=this,n=e[0],s=e[1],o=e[2],i={...Wr,name:n,rowCount:s,columnCount:o},a=new vn(t,i);return this.insertSheet(a),a}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>n===e)}getActiveSheet(){const{sheetOrder:e}=this._config,t=e.find(n=>this._worksheets.get(n).getStatus()===te.TRUE);return t?this._worksheets.get(t):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:e}=this._config;return e.findIndex(t=>this._worksheets.get(t).getStatus()===1)}getActiveRange(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRange():null}setActiveRange(e){const t=this.getActiveSheet();return t?t.setActiveSelection(e):null}setActiveRangeList(e){const t=this.getActiveSheet();if(t){const n=t.getRangeList(e);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRangeList():null}getSelection(){const e=this.getActiveSheet();if(e)return e.getSelection()}getCurrentCell(){const e=this.getSelection();if(e)return e.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(e){return e.activateAsCurrentCell()}flush(){}setSheetOrder(e,t){const{_context:n,_commandManager:s}=this,o=n.getContextObserver("onSheetOrderObservable"),i={actionName:$.SET_SHEET_ORDER_ACTION,sheetId:e,order:t},a=new ge({WorkBookUnit:n.getWorkBook()},i);s.invoke(a),o.notifyObservers()}getSheets(){const{sheetOrder:e}=this._config;return e.map(t=>this._worksheets.get(t))}getSheetIndex(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>e.getSheetId()===n)}removeSheetBySheetId(e){const{_commandManager:t,_config:n}=this,{sheetOrder:s}=n,o=this.getSheetBySheetId(e);if(s.length>1&&o!=null){const i=this.getSheetIndex(o),a=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),l=this.getContext().getContextObserver("onAfterRemoveSheetObservable");if(a.notifyObservers({index:i}),t.invoke(new ge({WorkBookUnit:this},{actionName:$.REMOVE_SHEET_ACTION,sheetId:e})),o.getStatus()===te.TRUE){const c=this.nextSheet(i);c&&c.activate()}l.notifyObservers({index:i,sheetId:e})}}getSheetBySheetName(e){const{sheetOrder:t}=this._config,n=t.find(s=>this._worksheets.get(s).getName()===e);return this._worksheets.get(n)}getSheetBySheetId(e){return this._worksheets.get(e)}setActiveSheet(...e){let t=!1;const n=e[0];return ot.checkup(e,vn,ot.BOOLEAN_TYPE)&&(t=e[1]),n.activate(),t&&n.setActiveSelection(),n}getCommandManager(){return this._commandManager}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[e]=t}static isIRangeType(e){return typeof e=="string"||"startRow"in e||"row"in e}transformRangeType(e){return typeof e=="string"?this._getCellRange(e):typeof e!="string"&&"row"in e?{sheetId:"",rangeData:{startRow:e.row[0],startColumn:e.column[0],endRow:e.row[1],endColumn:e.column[1]}}:typeof e!="string"&&"startRow"in e?{sheetId:"",rangeData:e}:Qo}static rangeDataToRangeStringData(e){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=e;return`${W.chatAtABC(s)+(t+1)}:${W.chatAtABC(o)}${n+1}`}load(e){this._config=e}save(){return this._config}}class Eu{constructor(e){this._workSheet=e,this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._workbook=e.getContext().getWorkBook(),this._activeRangeList=this._workSheet.getRangeList([Zs]),this._activeRange=this._workSheet.getRange(Zs),this._currentCell=this._workSheet.getRange(Zs)}setWorkSheet(e){this._workSheet=e}setSelection({selection:e,cell:t}={}){var d;let n,s,o;e instanceof at?(s=e.getRangeData(),s.startRow===-1&&console.error("Invalid selection, default set startRow -1"),n=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e&&ha.isIRangeType(e)?(s=this._workbook.transformRangeType(e).rangeData,s.startRow===-1&&console.error("Invalid selection, default set startRow -1"),n=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e instanceof Array?(n=e.map(g=>{const m=this._workbook.transformRangeType(g).rangeData;return m.startRow===-1&&console.error("Invalid selection, default set startRow -1"),m}),s=n[n.length-1],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):(n=this._activeRangeList.getRangeList(),s=this._activeRange.getRangeData(),o=this._currentCell.getRangeData()),t&&(o=this._workbook.transformRangeType(t).rangeData,Eu.cellInRange(n,o)||(s=o,n=[s]));const{_context:i,_workSheet:a,_commandManager:l}=this,u={sheetId:a.getSheetId(),actionName:$.SET_SELECTION_ACTION,activeRangeList:n,activeRange:s,currentCell:o},c=new ge({WorkBookUnit:i.getWorkBook()},u);l.invoke(c);const h=`${W.chatAtABC(s.startColumn)+(s.startRow+1)}:${W.chatAtABC(s.endColumn)}${s.endRow+1}`;return(d=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable"))==null||d.notifyObservers(h),this._activeRange}getSelection(){return W.deepClone(this._activeRange.getRangeData())}getActiveRange(){return this._activeRange}getActiveRangeList(){return this._activeRangeList}getActiveSheet(){return this._workbook.getActiveSheet()}getCurrentCell(){return this._currentCell}setCurrentCell(e){if(W.isAssignableFrom(e,at)&&(e=e.getRangeData()),(e==null?void 0:e.startRow)===-1)return console.error("Invalid range,default set startRow -1"),this;if(!(e.startRow===e.endRow&&e.startColumn===e.endColumn))return console.error("Exception: Range must have a single cell."),this;const t=this._activeRangeList.getRangeList(),{_context:n,_workSheet:s,_commandManager:o}=this,i={sheetId:s.getSheetId(),actionName:$.SET_SELECTION_ACTION,activeRangeList:t,activeRange:e,currentCell:e},a=new ge({WorkBookUnit:n.getWorkBook()},i);return o.invoke(a),this}setRanges(e,t,n){this._activeRangeList=this._workSheet.getRangeList(e),this._activeRange=this._workSheet.getRange(t),this._currentCell=this._workSheet.getRange(n)}getNextDataRange(e){const t=this._expandRange(e);return this.setSelection({selection:t}),this.getActiveRange()}_expandRange(e){const t=this._workSheet.getColumnCount(),n=this._workSheet.getRowCount(),s=this._activeRange.getRangeData();let o=Zs;const i=this.getCurrentCell().getRangeData();if(e===ee.RIGHT)if(i.startColumn===s.startColumn){const a=this._workSheet.getCellMatrix().getValue(i.startRow,s.endColumn);let l;if(a&&a.v===void 0)for(let u=s.endColumn+1;u<=t;u++){if(u===t){l=t;break}const c=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(c&&c.v!==void 0){l=u;break}}else for(let u=s.endColumn+1;u<=t;u++){if(u===t){l=t;break}const c=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(c&&c.v===void 0){const h=this._workSheet.getCellMatrix().getValue(i.startRow,u-1);if(h&&h.v!==void 0){l=u-1;break}}}o={startRow:s.startRow,endRow:s.endRow,startColumn:s.startColumn,endColumn:l!==void 0?l:s.endColumn}}else{const a=this._workSheet.getCellMatrix().getValue(i.startRow,s.startColumn);let l;if(a&&a.v===void 0)for(let u=s.startColumn+1;u<=i.startColumn;u++){if(u===i.startColumn){l=i.startColumn;break}const c=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(c&&c.v!==void 0){l=u;break}}else for(let u=s.startColumn+1;u<=i.startColumn;u++){if(u===i.startColumn){l=i.startColumn;break}const c=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(c&&c.v===void 0){const h=this._workSheet.getCellMatrix().getValue(i.startRow,u-1);if(h&&h.v!==void 0){l=u-1;break}}}o={startRow:s.startRow,endRow:s.endRow,startColumn:l||i.startColumn,endColumn:s.endColumn}}if(e===ee.LEFT){let a,l;if(i.endColumn===s.endColumn){const u=this._workSheet.getCellMatrix().getValue(i.startRow,s.startColumn);if(u&&u.v===void 0)for(let c=s.startColumn-1;c>=0;c--){if(c===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(h&&h.v!==void 0){a=c;break}}else for(let c=s.startColumn-1;c>=0;c--){if(c===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(i.startRow,c-1);if(d&&d.v!==void 0){a=c-1;break}}}}else{const u=this._workSheet.getCellMatrix().getValue(i.startRow,s.endColumn);if(u&&u.v===void 0)for(let c=s.endColumn-1;c>=i.startColumn;c--){if(c===i.startColumn){l=c;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(h&&h.v!==void 0){l=c;break}}else for(let c=s.endColumn-1;c>=i.startColumn;c--){if(c===i.startColumn){l=c;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(i.startRow,c-1);if(d&&d.v!==void 0){l=c-1;break}}}}o={startRow:s.startRow,endRow:s.endRow,startColumn:a!==void 0?a:s.startColumn,endColumn:l!==void 0?l:s.endColumn}}if(e===ee.TOP){let a,l;if(i.endRow===s.endRow){const u=this._workSheet.getCellMatrix().getValue(s.startRow,i.startColumn);if(u&&u.v===void 0)for(let c=s.endRow-1;c>=0;c--){const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v!==void 0||c===0){a=c;break}}else for(let c=s.startRow-1;c>=0;c--){if(c===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(c-1,i.startColumn);if(d&&d.v!==void 0){a=c-1;break}}}}else{const u=this._workSheet.getCellMatrix().getValue(s.endRow,i.startColumn);if(u&&u.v===void 0)for(let c=s.endRow-1;c>=i.startRow;c--){if(c===i.startRow){l=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v!==void 0){l=c;break}}else for(let c=s.endRow-1;c>=i.startRow;c--){const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(c===i.startRow){l=i.startRow;break}else if(h&&h.v===void 0&&c!==s.endRow-1){const d=this._workSheet.getCellMatrix().getValue(c+1,i.startColumn);if(d&&d.v!==void 0){l=c+1;break}}}}o={startRow:a!==void 0?a:s.startRow,endRow:l!==void 0?l:s.endRow,startColumn:s.startColumn,endColumn:s.endColumn}}if(e===ee.BOTTOM){let a,l;if(i.startRow===s.startRow){const u=this._workSheet.getCellMatrix().getValue(s.endRow,i.startColumn);if(u&&u.v===void 0)for(let c=s.endRow+1;c<=n;c++){if(c===n){l=n;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v!==void 0){l=c;break}}else for(let c=s.endRow+1;c<=n;c++){if(c===n){l=n;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(c+1,i.startColumn);if(d&&d.v!==void 0){l=c+1;break}}}}else{const u=this._workSheet.getCellMatrix().getValue(s.startRow+1,i.startColumn);if(u&&u.v===void 0)for(let c=s.startRow+1;c<=i.startRow;c++){if(c===i.startRow){a=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v!==void 0){a=c;break}}else for(let c=s.startRow+1;c<=i.startRow;c++){if(c===i.startRow){a=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(c,i.startColumn);if(h&&h.v===void 0&&c!==s.startRow+1){const d=this._workSheet.getCellMatrix().getValue(c-1,i.startColumn);if(d&&d.v!==void 0){a=c-1;break}}}}o={startRow:a!==void 0?a:s.startRow,endRow:l!==void 0?l:s.endRow,startColumn:s.startColumn,endColumn:s.endColumn}}return o}static cellInRange(e,t){for(const n of e)if(n.startRow<=t.startRow&&t.endRow<=n.endRow&&n.startColumn<=t.startColumn&&t.endColumn<=n.endColumn)return n;return null}}function Qs(r){if(!r)return;let{row:e,column:t,startY:n,endY:s,startX:o,endX:i,isMerged:a,mergeInfo:l}=r,u=e,c=t,h=e,d=t;if(a&&l){const{startRow:g,startColumn:m,endRow:f,endColumn:p,startY:b,endY:v,startX:w,endX:S}=l;u=g,c=m,h=f,d=p,n=b,s=v,o=w,i=S}return{startRow:u,startColumn:c,endRow:h,endColumn:d,startY:n,endY:s,startX:o,endX:i}}function wu(r){return!r||((r==null?void 0:r.m)||"").length===0&&!r.p}function Ft(r){if(r){if(r.rgb)return r.rgb;if(r.th)return new js().setThemeColor(r.th).asThemeColor().asRgbColor().getCssString()}return null}function lf(r){return W.isString(r)&&r.indexOf("=")===0&&r.length>1}class yb{}class Ab{}function Rb(r,...e){for(const t of e)if(t)for(const n in t)t.hasOwnProperty(n)&&xb(t[n])&&(r[n]=t[n]);return r}function Ib(r){if(Db(r))return"";let e="";for(const t in r)r.hasOwnProperty(t)&&r[t]!==void 0&&r[t]!==null&&(e+=`${t}=${r[t]}&`);return e=e.substring(0,e.length-1),e?`?${encodeURI(e)}`:""}function xb(r){return r!=null}function Db(r){return r==null}function Ob(r){return Object.prototype.toString.apply(r)==="[object String]"}function Fb(r){return r?Object.getPrototypeOf(r)===Object.getPrototypeOf({}):!1}function Mb(r){return Object.prototype.toString.apply(r)==="[object Array]"}function uf(r){return r instanceof FormData}const ti=()=>{},cf=r=>r;var hf=(r=>(r.POST="POST",r.GET="GET",r.PUT="PUT",r.DELETE="DELETE",r))(hf||{}),df=(r=>(r[r.UNSENT=0]="UNSENT",r[r.OPENED=1]="OPENED",r[r.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",r[r.LOADING=3]="LOADING",r[r.DONE=4]="DONE",r))(df||{}),gf=(r=>(r.ARRAY_BUFFER="arraybuffer",r.BLOB="blob",r.TEXT="text",r.DOCUMENT="document",r.JSON="json",r.STREAM="stream",r))(gf||{});const Nb={type:"POST",url:"",async:!0,header:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:ti,beforeSend:cf,dataFilter:cf,success:ti,complete:ti};function fr(r){return new Promise((e,t)=>{const n=Rb({},Nb,r),s=new XMLHttpRequest;switch(n.beforeSend(n),s.responseType=n.dataType,s.timeout=n.timeout,s.addEventListener("readystatechange",o=>{if(s.readyState===4)if(s.status===200){const i=n.dataFilter(s.response);n.success(i),n.complete(),e(i)}else n.error(o),t(o)}),s.addEventListener("timeout",o=>{n.error(o)}),s.open(n.type,n.url,n.async,n.username,n.password),Object.keys(n.header).forEach(o=>{const i=n.header[o];s.setRequestHeader(o,i)}),uf(n.data)?s.setRequestHeader("Content-Type","multipart/form-data"):n.contentType&&s.setRequestHeader("Content-Type",n.contentType),n.type){case"DELETE":case"GET":{s.send();break}case"POST":case"PUT":{if(Fb(n.data)){s.send(JSON.stringify(n.data));return}if(Ob(n.data)){s.send(n.data);return}if(Mb(n.data)){s.send(JSON.stringify(n.data));return}uf(n.data)&&s.send(n.data);break}}})}function kb(r,e={},t=ti){return fr({url:r,type:"POST",data:e,success:t})}function Bb(r,e={},t=ti){return r+=Ib(e),fr({url:r,type:"GET",success:t})}function Lb(r){return r==null}function Pb(r){return Lb(r)||r.toString()===""}var dn=(r=>(r.MESSAGE="message",r.OPEN="open",r.CLOSE="close",r.ERROR="error",r.RETRY="retry",r.DESTROY="destroy",r))(dn||{});const Hb={url:"",heartbeatTime:1e3*30},Tu="heart_beat_message";class Su{constructor(e){const t=Object.assign(Hb,e);if(Pb(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=t}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message.bind(this)),this._socket.addEventListener("open",this._open.bind(this)),this._socket.addEventListener("close",this._close.bind(this)),this._socket.addEventListener("error",this._error.bind(this))}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message.bind(this)),this._socket.removeEventListener("open",this._open.bind(this)),this._socket.removeEventListener("close",this._close.bind(this)),this._socket.removeEventListener("error",this._error.bind(this))}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;function s(){e.send(Tu)}this._timer=setInterval(s,n)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens.set(e,t)}close(){this._socket&&this._socket.close()}}const Ub=Object.keys(cu).reduce((r,e)=>[...r,...cu[e]],[]);function ff(r){return Ub.indexOf(r)===-1}const zb={},Wb={};class ni{initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(W.getLanguage())?bn.ZH:bn.EN,locales:{zh:zb,en:Wb}}}get(e){if(e){const{locales:t,currentLocale:n}=this.options;return ni.getValue(t[n],e)||""}return String()}getObject(e){const{locales:t,currentLocale:n}=this.options;return ni.getValue(t[n],e)}load(e){W.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce((n,s)=>n[s],e)}catch{console.error("Key %s not found",t)}}}class eo{static log(...e){console&&console.log(...e)}static info(...e){console&&console.info(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){eo.info(`
`)}static capsule(e,t,n="",s=""){console&&console.log(`%c${n}%c${e}%c${t}%c${s}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class ri{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}}const dt=Symbol("newer"),zt=Symbol("older");class mf{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[dt],{done:!1,value:e.key}):{done:!0,value:void 0}}}class pf{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[dt],{done:!1,value:e.value}):{done:!0,value:void 0}}}class _f{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[dt],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class yu{constructor(e,t){this.key=e,this.value=t,this[dt]=void 0,this[zt]=void 0}toJSON(){return{key:this.key,value:this.value}}}class bf{_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[dt]&&(e===this.oldest&&(this.oldest=e[dt]),e[dt][zt]=e[zt]),e[zt]&&(e[zt][dt]=e[dt]),e[dt]=void 0,e[zt]=this.newest,this.newest&&(this.newest[dt]=e),this.newest=e)}constructor(...e){if(ri.hasLength(e,1)){if(ri.isNumber(e[0])){const t=e[0];this._initialize(t,void 0);return}if(ri.isIterable(e[0])){const t=e[0];this._initialize(0,t);return}return}if(ri.hasLength(e,2)){const t=e[0],n=e[1];this._initialize(t,n)}}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let s=e[Symbol.iterator]();for(let o=s.next();!o.done;o=s.next()){let i=new yu(o.value[0],o.value[1]);if(this._keymap.set(i.key,i),t?(t[dt]=i,i[zt]=t):this.oldest=i,t=i,n--===0)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,n=new yu(e,t)),this.newest?(this.newest[dt]=n,n[zt]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[dt]?(this.oldest=this.oldest[dt],this.oldest[zt]=void 0):(this.oldest=void 0,this.newest=void 0),e[dt]=e[zt]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}get(e){const t=this._keymap.get(e);if(!!t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(!!t)return this._keymap.delete(t.key),t[dt]&&t[zt]?(t[zt][dt]=t[dt],t[dt][zt]=t[zt]):t[dt]?(t[dt][zt]=void 0,this.oldest=t[dt]):t[zt]?(t[zt][dt]=void 0,this.newest=t[zt]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new mf(this.oldest)}values(){return new pf(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new _f(this.oldest)}forEach(e,t){typeof t!="object"&&(t=this);let n=this.oldest;for(;n;)e.call(t,n.value,n.key,this),n=n[dt]}toJSON(){let e=new Array(this.size),t=0,n=this.oldest;for(;n;)e[t++]={key:n.key,value:n.value},n=n[dt];return e}toString(){let e=String(),t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[dt],t&&(e+=" < ");return e}}function Vb(r,e){var t,n,s,o,i,a,l,u,c,h,d,g,m,f,p,b,v,w,S,T,D,R,I,y,O,M,F,x,E,N,X,L,ne,G,Q,P,V,pe,oe,Z,ie,be,Ce,fe,Te,Le,Ze,Ne,A,se,re,B,k,Y,le,ae,j,he,H,z,J,ue,de,ze,De,Be;r.cellData={};for(let ce of e.config.borderInfo)if(ce.rangeType==="cell"){const Se=ce.value.row_index,ve=ce.value.col_index;r.cellData[String(Se)]||(r.cellData[String(Se)]={}),r.cellData[String(Se)][String(ve)]||(r.cellData[String(Se)][String(ve)]={}),r.cellData[String(Se)][String(ve)].s||(r.cellData[String(Se)][String(ve)].s={});const $e={};ce.value.l&&($e.l={s:ce.value.l.style,cl:{rgb:ce.value.l.color}},r.cellData[String(Se)]&&((s=(n=(t=r.cellData[String(Se)][String(ve-1)])==null?void 0:t.s)==null?void 0:n.bd)==null?void 0:s.r)&&delete r.cellData[String(Se)][String(ve-1)].s.bd.r),ce.value.r&&($e.r={s:ce.value.r.style,cl:{rgb:ce.value.r.color}},r.cellData[String(Se)]&&((a=(i=(o=r.cellData[String(Se)][String(Number(ve)+1)])==null?void 0:o.s)==null?void 0:i.bd)==null?void 0:a.l)&&delete r.cellData[String(Se)][String(ve-1)].s.bd.l),ce.value.t&&($e.t={s:ce.value.t.style,cl:{rgb:ce.value.t.color}},r.cellData[String(Se-1)]&&((c=(u=(l=r.cellData[String(Se)][String(ve)])==null?void 0:l.s)==null?void 0:u.bd)==null?void 0:c.b)&&delete r.cellData[String(Se)][String(ve-1)].s.bd.b),ce.value.b&&($e.b={s:ce.value.b.style,cl:{rgb:ce.value.b.color}},r.cellData[String(Number(Se)+1)]&&((g=(d=(h=r.cellData[String(Se)][String(ve)])==null?void 0:h.s)==null?void 0:d.bd)==null?void 0:g.t)&&delete r.cellData[String(Se)][String(ve-1)].s.bd.t),r.cellData[String(Se)][String(ve)].s.bd=Object.assign(r.cellData[String(Se)][String(ve)].s.bd||{},$e)}else if(ce.rangeType==="range")for(const Se of ce.range){const ve=Se.row[0],$e=Se.row[1],Ve=Se.column[0],qe=Se.column[1];switch(ce.borderType){case"border-left":for(let U=ve;U<=$e;U++)for(let q=Ve;q<Ve+1;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.l={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve;U<=$e;U++)for(let q=Ve-1;q<Ve;q++)r.cellData[String(U)]&&((p=(f=(m=r.cellData[String(U)][String(q)])==null?void 0:m.s)==null?void 0:f.bd)==null?void 0:p.r)&&delete r.cellData[String(U)][String(q)].s.bd.r;break;case"border-right":for(let U=ve;U<=$e;U++)for(let q=qe;q<qe+1;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.r={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve;U<=$e;U++)for(let q=qe+1;q<qe+2;q++)r.cellData[String(U)]&&((w=(v=(b=r.cellData[String(U)][String(q)])==null?void 0:b.s)==null?void 0:v.bd)==null?void 0:w.l)&&delete r.cellData[String(U)][String(q)].s.bd.l;break;case"border-top":for(let U=ve;U<ve+1;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.t={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve-1;U<ve;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((D=(T=(S=r.cellData[String(U)][String(q)])==null?void 0:S.s)==null?void 0:T.bd)==null?void 0:D.b)&&delete r.cellData[String(U)][String(q)].s.bd.b;break;case"border-bottom":for(let U=$e;U<$e+1;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.b={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=$e+1;U<$e+2;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((y=(I=(R=r.cellData[String(U)][String(q)])==null?void 0:R.s)==null?void 0:I.bd)==null?void 0:y.t)&&delete r.cellData[String(U)][String(q)].s.bd.t;break;case"border-all":for(let U=ve;U<=$e;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.l={s:ce.style,cl:{rgb:ce.color}},Je.t={s:ce.style,cl:{rgb:ce.color}},q===qe&&(Je.r={s:ce.style,cl:{rgb:ce.color}}),U===$e&&(Je.b={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(U)][String(q)].s.bd=Je}for(let U=ve;U<=$e;U++)for(let q=Ve-1;q<Ve;q++)r.cellData[String(U)]&&((F=(M=(O=r.cellData[String(U)][String(q)])==null?void 0:O.s)==null?void 0:M.bd)==null?void 0:F.r)&&delete r.cellData[String(U)][String(q)].s.bd.r;for(let U=ve;U<=$e;U++)for(let q=qe+1;q<qe+2;q++)r.cellData[String(U)]&&((N=(E=(x=r.cellData[String(U)][String(q)])==null?void 0:x.s)==null?void 0:E.bd)==null?void 0:N.l)&&delete r.cellData[String(U)][String(q)].s.bd.l;for(let U=ve-1;U<ve;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((ne=(L=(X=r.cellData[String(U)][String(q)])==null?void 0:X.s)==null?void 0:L.bd)==null?void 0:ne.b)&&delete r.cellData[String(U)][String(q)].s.bd.b;for(let U=$e+1;U<$e+2;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((P=(Q=(G=r.cellData[String(U)][String(q)])==null?void 0:G.s)==null?void 0:Q.bd)==null?void 0:P.t)&&delete r.cellData[String(U)][String(q)].s.bd.t;break;case"border-outside":for(let U=ve;U<=$e;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};U===ve&&(Je.t={s:ce.style,cl:{rgb:ce.color}}),U===$e&&(Je.b={s:ce.style,cl:{rgb:ce.color}}),q===Ve&&(Je.l={s:ce.style,cl:{rgb:ce.color}}),q===qe&&(Je.r={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve;U<=$e;U++)for(let q=Ve-1;q<Ve;q++)r.cellData[String(U)]&&((oe=(pe=(V=r.cellData[String(U)][String(q)])==null?void 0:V.s)==null?void 0:pe.bd)==null?void 0:oe.r)&&delete r.cellData[String(U)][String(q)].s.bd.r;for(let U=ve;U<=$e;U++)for(let q=qe+1;q<qe+2;q++)r.cellData[String(U)]&&((be=(ie=(Z=r.cellData[String(U)][String(q)])==null?void 0:Z.s)==null?void 0:ie.bd)==null?void 0:be.l)&&delete r.cellData[String(U)][String(q)].s.bd.l;for(let U=ve-1;U<ve;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((Te=(fe=(Ce=r.cellData[String(U)][String(q)])==null?void 0:Ce.s)==null?void 0:fe.bd)==null?void 0:Te.b)&&delete r.cellData[String(U)][String(q)].s.bd.b;for(let U=$e+1;U<$e+2;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((Ne=(Ze=(Le=r.cellData[String(U)][String(q)])==null?void 0:Le.s)==null?void 0:Ze.bd)==null?void 0:Ne.t)&&delete r.cellData[String(U)][String(q)].s.bd.t;break;case"border-inside":for(let U=ve;U<=$e;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};U===ve&&q===Ve||(U===ve?Je.l={s:ce.style,cl:{rgb:ce.color}}:q===Ve?Je.t={s:ce.style,cl:{rgb:ce.color}}:(Je.l={s:ce.style,cl:{rgb:ce.color}},Je.t={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(U)][String(q)].s.bd=Je)}break;case"border-horizontal":for(let U=ve;U<$e;U++)for(let q=Ve;q<=qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.b={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve+1;U<=$e;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((re=(se=(A=r.cellData[String(U)][String(q)])==null?void 0:A.s)==null?void 0:se.bd)==null?void 0:re.t)&&delete r.cellData[String(U)][String(q)].s.bd.t;break;case"border-vertical":for(let U=ve;U<=$e;U++)for(let q=Ve;q<qe;q++){r.cellData[String(U)]||(r.cellData[String(U)]={}),r.cellData[String(U)][String(q)]||(r.cellData[String(U)][String(q)]={}),r.cellData[String(U)][String(q)].s||(r.cellData[String(U)][String(q)].s={});const Je={};Je.r={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(U)][String(q)].s.bd=Object.assign(r.cellData[String(U)][String(q)].s.bd||{},Je)}for(let U=ve;U<=$e;U++)for(let q=Ve+1;q<=qe;q++)r.cellData[String(U)]&&((Y=(k=(B=r.cellData[String(U)][String(q)])==null?void 0:B.s)==null?void 0:k.bd)==null?void 0:Y.l)&&delete r.cellData[String(U)][String(q)].s.bd.l;break;case"border-none":for(let U=ve;U<=$e;U++)for(let q=Ve;q<=qe;q++){if(!r.cellData[String(U)]||!r.cellData[String(U)][String(q)]||!r.cellData[String(U)][String(q)].s)continue;const Je={};r.cellData[String(U)][String(q)].s.bd=Je}for(let U=ve;U<=$e;U++)for(let q=Ve-1;q<Ve;q++)r.cellData[String(U)]&&((j=(ae=(le=r.cellData[String(U)][String(q)])==null?void 0:le.s)==null?void 0:ae.bd)==null?void 0:j.r)&&delete r.cellData[String(U)][String(q)].s.bd.r;for(let U=ve;U<=$e;U++)for(let q=qe+1;q<qe+2;q++)r.cellData[String(U)]&&((z=(H=(he=r.cellData[String(U)][String(q)])==null?void 0:he.s)==null?void 0:H.bd)==null?void 0:z.l)&&delete r.cellData[String(U)][String(q)].s.bd.l;for(let U=ve-1;U<ve;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((de=(ue=(J=r.cellData[String(U)][String(q)])==null?void 0:J.s)==null?void 0:ue.bd)==null?void 0:de.b)&&delete r.cellData[String(U)][String(q)].s.bd.b;for(let U=$e+1;U<$e+2;U++)for(let q=Ve;q<=qe;q++)r.cellData[String(U)]&&((Be=(De=(ze=r.cellData[String(U)][String(q)])==null?void 0:ze.s)==null?void 0:De.bd)==null?void 0:Be.t)&&delete r.cellData[String(U)][String(q)].s.bd.t;break}}}function vf(r){var t;const e={};if(e.styles={},r.hasOwnProperty("lang")&&(e.locale=r.lang),r.hasOwnProperty("data")){e.sheets={};for(let n of r.data){const s={};if(s.id=St(6),n.hasOwnProperty("zoomRatio")&&(s.zoomRatio=n.zoomRatio),n.hasOwnProperty("row")&&(s.rowCount=n.row),n.hasOwnProperty("column")&&(s.columnCount=n.column),n.hasOwnProperty("status")&&(s.status=parseInt(n.status)),n.hasOwnProperty("name")&&(s.name=n.name),n.hasOwnProperty("universheet_select_save")&&(s.selections=[],n.universheet_select_save.forEach(o=>{var i;(i=s.selections)==null||i.push({startRow:o.row[0],endRow:o.row[1],startColumn:o.column[0],endColumn:o.column[1]})})),n.hasOwnProperty("scrollLeft")&&(s.scrollLeft=n.scrollLeft),n.hasOwnProperty("scrollTop")&&(s.scrollTop=n.scrollTop),n.hasOwnProperty("config")){if(n.config.merge){s.mergeData=[];for(const o of Object.keys(n.config.merge)){const i=n.config.merge[o],a={startRow:i.r,endRow:i.r+i.rs-1,startColumn:i.c,endColumn:i.c+i.cs-1};s.mergeData.push(a)}}if(n.config.borderInfo&&Vb(s,n),n.config.rowlen){s.rowData={};for(const[o,i]of Object.entries(n.config.rowlen))s.rowData[String(o)]={h:i,hd:0}}if(n.config.columnlen){s.columnData={};for(const[o,i]of Object.entries(n.config.columnlen))s.columnData[String(o)]={w:i,hd:0}}if(n.config.rowhidden){s.rowData||(s.rowData={});for(const[o,i]of Object.entries(n.config.rowhidden))s.rowData[String(o)]||(s.rowData[String(o)]={}),s.rowData[String(o)].hd=i}if(n.config.colhidden){s.columnData||(s.columnData={});for(const[o,i]of Object.entries(n.config.colhidden))s.columnData[String(o)]||(s.columnData[String(o)]={}),s.columnData[String(o)].hd=i}}if(n.hasOwnProperty("celldata")){s.cellData||(s.cellData={});for(const o of n.celldata){s.cellData[o.r]||(s.cellData[o.r]={}),s.cellData[o.r][o.c]||(s.cellData[o.r][o.c]={});const i=o.v,a=s.cellData[o.r][o.c];if(((t=i==null?void 0:i.ct)==null?void 0:t.t)==="inlineStr"){const l={},u=[];i.ct.s.forEach(c=>{const h={};c.hasOwnProperty("bg")&&(h.bg={rgb:c.fc}),c.hasOwnProperty("ff")&&(h.ff=c.ff),c.hasOwnProperty("fc")&&(h.cl={rgb:c.fc}),c.hasOwnProperty("fs")&&(h.fs=c.fs),c.hasOwnProperty("bl")&&(h.bl=c.bl),c.hasOwnProperty("it")&&(h.it=c.it),c.hasOwnProperty("cl")&&(h.st={s:1}),c.hasOwnProperty("un")&&(h.ul={s:c.un});const d=St(6);l[d]={eId:d,st:0,ed:c.v.length-1,et:0,tr:{ct:c.v,ts:h}},u.push({elementId:d,paragraphElementType:0})}),a.p={documentId:St(6),body:{blockElements:{p1:{blockId:"p1",st:0,ed:i.ct.s.length-1,blockType:0,paragraph:{elements:l,elementOrder:u}}},blockElementOrder:["p1"]},documentStyle:{}}}else{i.hasOwnProperty("v")&&(a.v=i.v),i.hasOwnProperty("m")?a.m=i.m:a.m=String(i.v||"");const l={};i.hasOwnProperty("bg")&&(l.bg={rgb:i.bg}),i.hasOwnProperty("ff")&&(l.ff=i.ff),i.hasOwnProperty("fc")&&(l.cl={rgb:i.fc}),i.hasOwnProperty("fs")&&(l.fs=i.fs),i.hasOwnProperty("bl")&&(l.bl=i.bl),i.hasOwnProperty("it")&&(l.it=i.it),i.hasOwnProperty("cl")&&(l.st={s:i.cl}),i.hasOwnProperty("un")&&(l.ul={s:i.un});const u={0:2,1:1,2:3};if(i.hasOwnProperty("vt")&&(l.vt=u[String(i.vt)]),i.hasOwnProperty("ht")&&(l.ht=u[String(i.ht)]),i.hasOwnProperty("tr"))switch(i.tr){case"0":l.tr={a:0,v:0};break;case"1":l.tr={a:45,v:0};break;case"2":l.tr={a:-45,v:0};break;case"3":l.tr={a:0,v:1};break;case"4":l.tr={a:90,v:0};break;case"5":l.tr={a:-90,v:0};break}i.hasOwnProperty("rt")&&(l.tr={a:i.tr,v:0}),i.hasOwnProperty("tb")&&(l.tb=u[String(i.tb)]),a.s=Object.assign(a.s||{},l)}}}e.sheets[s.id]=s}}return e}const Cf=[];let $b=0;class mr{static _generateName(){return`sheet${++$b}`}static _checkedName(e){const t=Cf.includes(e);return t||Cf.push(e),t}static getSheetName(e){for(e===void 0&&(e=mr._generateName());mr._checkedName(e);)e=mr._generateName();return e}}const Gb=":",Xb=/[^0-9]/g,Yb=/[^A-Za-z]/g;function Au(r){let e=parseInt(r.replace(Xb,""))-1,t=W.ABCatNum(r.replace(Yb,""));return{row:e,column:t}}function da(r){const e=r.indexOf("!");let t="",n="";e>-1?(t=r.substring(0,e),n=r.substring(e)):n=r;let s=n.indexOf(Gb);if(s===-1){const m=Au(n),f=m.row,p=m.column;return{sheetName:t,rangeData:{startRow:f,startColumn:p,endRow:f,endColumn:p}}}const o=n.substring(0,s),i=n.substring(s+1),a=Au(o),l=Au(i),u=a.row,c=a.column,h=l.row,d=l.column;return{sheetName:t,rangeData:{startRow:u,startColumn:c,endRow:h,endColumn:d}}}function jb(r){if(r==null||r.length===0)return NaN;let e=r.toLowerCase().split(""),t=e.length,n=i=>i.charCodeAt(0)-96,s=0,o=0;for(let i=0;i<t;i++)o=n(e[i]),s+=o*26**(t-i-1);return s===0?NaN:s-1}const ga="A".charCodeAt(0),Ef="Z".charCodeAt(0),Kb="a".charCodeAt(0);function wf(r){const e=Ef-ga+1;let t="";for(;r>=0;)t=String.fromCharCode(r%e+ga)+t,r=Math.floor(r/e)-1;return t}function Tf(r,e){let t="";for(;e>0;)t+=r,e--;return t}function Ru(r,e=!1){const t=Ef-ga+1;let n=Kb;e&&(n=ga);const s=String.fromCharCode(r%t+n);let o=Math.floor(r/t)+1;return Tf(s,o)}class Zb{constructor(){this._storage=new Map}addSerializer(...e){if(W.hasLength(e,1)){const t=e[0];this._storage.set(t.name,t);return}if(W.hasLength(e,2)){const t=e[0],n=e[1];this._storage.set(n,t)}}fromSequence(e){if(W.isObject(e))return this._storage.get(e.className).fromSequence(e);if(W.isArray(e)){let t=new Array;for(let n of e)t.push(this.fromSequence(n));return t}return[]}toSequence(e){if(W.isObject(e))return e.toSequence();if(W.isArray(e)){let t=new Array;for(let n of e)t.push(this.toSequence(n));return t}return[]}fromStringifyParse(e){return this.fromSequence(JSON.parse(e))}}class to{static fromSequence(e){if(W.isObject(e)&&to.requiredNewInstance(this))return this.newInstance(e);if(W.isArray(e)&&to.requiredNewInstance(this)){const t=this;return e.map(n=>t.newInstance(n))}return[]}toSequence(){return{className:W.getClassName(this)}}}(r=>{function e(t){if(W.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}r.requiredNewInstance=e})(to||(to={}));function yt(r,e){return r.zIndex>e.zIndex?1:r.zIndex===e.zIndex?0:-1}function Iu(r,e){return r.zIndex>e.zIndex?-1:r.zIndex===e.zIndex?0:1}class Sf{static GetClass(e){return this.RegisteredTypes&&this.RegisteredTypes[e]?this.RegisteredTypes[e]:null}}Sf.RegisteredTypes={};function yf(r){let e=0;for(let t=0;t<r.length;t++)e=r.charCodeAt(t)+(e<<6)+(e<<16)-e;return e>>>0}class xu{constructor(e,t,n){this.path=e,this.namespace=t,this.observable=n}}class Af{constructor(){this._observableArray=[]}hasObserver(e,t){return this.getObserver(e,t)!=null}getObserver(...e){if(e.length===1){const t=e[0],n=this._observableArray.find(s=>s.path===t);return n?n.observable:null}if(e.length===2){const t=e[0],n=e[1],s=this._observableArray.find(o=>o.path===t&&o.namespace===n);return s?s.observable:null}}requiredObserver(...e){if(W.hasLength(e,1)){const t=e[0],n=this.getObserver(t);if(n==null)throw new Error(`not found observable ${t}`);return n}if(W.hasLength(e,2)){const t=e[0],n=e[1],s=this.getObserver(t,n);if(s==null)throw new Error(`not found observable ${t}`);return s}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(W.hasLength(e,1)){const t=e[0],n=this._observableArray.findIndex(s=>s.path===t);n>-1&&this._observableArray.splice(n,1);return}if(W.hasLength(e,2)){const t=e[0],n=e[1],s=this._observableArray.findIndex(o=>o.path===t&&o.namespace===n);s>-1&&this._observableArray.splice(s,1)}}addObserver(...e){if(e.length===1){const t=e[0],n=e[1];this.hasObserver(t,t)&&this.removeObserver(t),this._observableArray.push(new xu(t,t,n));return}if(e.length===3){const t=e[0],n=e[1],s=e[2];this.hasObserver(t,t)&&this.removeObserver(t,n),this._observableArray.push(new xu(t,n,s))}}}var Ee=(r=>(r[r.REDO=0]="REDO",r[r.UNDO=1]="UNDO",r))(Ee||{});class Rf extends ye{}class Du{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Du}}const qb=Du.create();class Jb{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(yt)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...qb.getData().sort(yt))}}class If{getRegister(){return this._register}constructor(){this._register=new Jb,this._register.initialize()}handle(e){var n;const t=(n=this._register)==null?void 0:n.actionExtensionFactoryList;!t||(this._actionExtensionFactoryList=t,e.length!==0&&this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach(t=>{const n=t.check(e);n!==!1&&n.execute()})}}class Qb extends ye{}class e2 extends ye{}class He{getActionExtensionManager(){return this._actionExtensionManager}constructor(e){this._undoManager=e.getUndoManager(),this._actionExtensionManager=new If}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new Rf,this._commandObservers=new Qb,this._commandInjectorObservers=new e2}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this,{_actionDataList:n,_unit:s,_actionList:o}=e;this._actionExtensionManager.handle(n),n.forEach(i=>{const a=He.getAction(i.actionName),l=He.getActionObservers(),u=new a(i,s,l);o.push(u)}),e.invoke(),t.push(e)}}He.staticInitialize();class t2{}class ge{constructor(e,...t){this._unit=e,this._actionDataList=t,this._actionList=[]}getDoData(){return this._actionList.map(e=>e.getDoActionData())}getOldData(){return this._actionList.map(e=>e.getOldActionDaa())}getInjector(){const e=this;return new class{injectAction(t){e._actionList.push(t)}getActions(){return e._actionList.concat([])}include(t){for(let n=0;n<e._actionList.length;n++)if(e._actionList[n]instanceof t)return e._actionList[n];return null}}}redo(){this._actionList.forEach(e=>e.redo()),He.getCommandObservers().notifyObservers({type:Ee.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach(e=>e.undo()),He.getCommandObservers().notifyObservers({type:Ee.UNDO,actions:this._actionList})}invoke(){He.getCommandInjectorObservers().notifyObservers(this.getInjector()),He.getCommandObservers().notifyObservers({type:Ee.REDO,actions:this._actionList})}}class xf{constructor(){this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}class si{constructor(e,t){this.actionDataList=e,this._plugin=t}getActionDataList(){return this.actionDataList}push(e){this.actionDataList.push(e)}setValue(){}execute(){}}class fa{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new si(e,this._plugin)}check(e){return this.create(e)}}class pr{static hasObserver(e){return e.operation?(e.operation&en.OBSERVER_ACTION)===en.OBSERVER_ACTION:!1}static hasUndo(e){return e.operation?(e.operation&en.UNDO_ACTION)===en.UNDO_ACTION:!1}static hasCollaboration(e){return e.operation?(e.operation&en.SERVER_ACTION)===en.SERVER_ACTION:!1}static hasExtension(e){return e.operation?(e.operation&en.EXTENSION_ACTION)===en.EXTENSION_ACTION:!1}static make(e){return e.operation=en.DEFAULT_ACTION,new pr(e)}constructor(e){this._action=e}removeObserver(){return this._action.operation&&(this._action.operation&=~en.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~en.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~en.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~en.EXTENSION_ACTION),this}getAction(){return this._action}}var ds=(r=>(r.INSERT_TEXT_ACTION_NAME="InsertTextAction",r.DELETE_TEXT_ACTION_NAME="DeleteTextAction",r))(ds||{});class Df extends hd{constructor(e,t,n){if(super(e,n),t.DocumentUnit==null)throw new Error("action document domain can not be null!");this._document=t.DocumentUnit}getDocument(){return this._document}}var Of=(r=>(r[r.TAB=0]="TAB",r[r.SPACE=1]="SPACE",r[r.NOTHING=2]="NOTHING",r))(Of||{}),Wt=(r=>(r[r.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",r[r.NONE=1]="NONE",r[r.DECIMAL=2]="DECIMAL",r[r.ZERO_DECIMAL=3]="ZERO_DECIMAL",r[r.UPPER_ALPHA=4]="UPPER_ALPHA",r[r.ALPHA=5]="ALPHA",r[r.UPPER_ROMAN=6]="UPPER_ROMAN",r[r.ROMAN=7]="ROMAN",r))(Wt||{}),vt=(r=>(r[r.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",r[r.START=1]="START",r[r.CENTER=2]="CENTER",r[r.END=3]="END",r))(vt||{}),Fe=(r=>(r[r.PARAGRAPH=0]="PARAGRAPH",r[r.TABLE=1]="TABLE",r[r.SECTION_BREAK=2]="SECTION_BREAK",r[r.CUSTOM=3]="CUSTOM",r))(Fe||{}),gn=(r=>(r[r.DEFAULT=0]="DEFAULT",r[r.LINES=1]="LINES",r[r.LINES_AND_CHARS=2]="LINES_AND_CHARS",r[r.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",r))(gn||{}),Gr=(r=>(r[r.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",r[r.CONTINUOUS=1]="CONTINUOUS",r[r.NEXT_PAGE=2]="NEXT_PAGE",r[r.EVEN_PAGE=3]="EVEN_PAGE",r[r.ODD_PAGE=4]="ODD_PAGE",r))(Gr||{}),Pn=(r=>(r[r.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",r[r.NONE=1]="NONE",r[r.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",r))(Pn||{}),ma=(r=>(r[r.NORMAL=0]="NORMAL",r[r.TBRL=1]="TBRL",r[r.LRTBV=2]="LRTBV",r))(ma||{}),K=(r=>(r[r.TEXT_RUN=0]="TEXT_RUN",r[r.AUTO_TEXT=1]="AUTO_TEXT",r[r.PAGE_BREAK=2]="PAGE_BREAK",r[r.COLUMN_BREAK=3]="COLUMN_BREAK",r[r.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",r[r.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",r[r.EQUATION=6]="EQUATION",r[r.DRAWING=7]="DRAWING",r[r.PERSON=8]="PERSON",r[r.RICH_LINK=9]="RICH_LINK",r))(K||{}),Hn=(r=>(r[r.BOTH_SIDES=0]="BOTH_SIDES",r[r.LEFT=1]="LEFT",r[r.RIGHT=2]="RIGHT",r[r.LARGEST=3]="LARGEST",r))(Hn||{}),rn=(r=>(r[r.INLINE=0]="INLINE",r[r.WRAP_NONE=1]="WRAP_NONE",r[r.WRAP_POLYGON=2]="WRAP_POLYGON",r[r.WRAP_SQUARE=3]="WRAP_SQUARE",r[r.WRAP_THROUGH=4]="WRAP_THROUGH",r[r.WRAP_TIGHT=5]="WRAP_TIGHT",r[r.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",r))(rn||{}),pa=(r=>(r[r.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",r[r.NORMAL_TEXT=1]="NORMAL_TEXT",r[r.TITLE=2]="TITLE",r[r.SUBTITLE=3]="SUBTITLE",r[r.HEADING_1=4]="HEADING_1",r[r.HEADING_2=5]="HEADING_2",r[r.HEADING_3=6]="HEADING_3",r[r.HEADING_4=7]="HEADING_4",r[r.HEADING_5=8]="HEADING_5",r[r.HEADING_6=9]="HEADING_6",r))(pa||{}),no=(r=>(r[r.AUTO=0]="AUTO",r[r.AT_LEAST=1]="AT_LEAST",r[r.EXACT=2]="EXACT",r))(no||{}),Ff=(r=>(r[r.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",r[r.SOLID=1]="SOLID",r[r.DOT=2]="DOT",r[r.DASH=3]="DASH",r))(Ff||{}),Mf=(r=>(r[r.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",r[r.START=1]="START",r[r.CENTER=2]="CENTER",r[r.END=3]="END",r))(Mf||{}),Nf=(r=>(r.EVENLY_DISTRIBUTED="0",r.FIXED_WIDTH="1",r))(Nf||{}),kf=(r=>(r[r.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",r[r.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",r[r.TOP=2]="TOP",r[r.MIDDLE=3]="MIDDLE",r[r.BOTTOM=4]="BOTTOM",r))(kf||{}),ro=(r=>(r.NORMAL="normal",r.BOLD="bold",r.ITALIC="italic",r))(ro||{}),lt=(r=>(r[r.CHARACTER=0]="CHARACTER",r[r.COLUMN=1]="COLUMN",r[r.INSIDE_MARGIN=2]="INSIDE_MARGIN",r[r.LEFT_MARGIN=3]="LEFT_MARGIN",r[r.MARGIN=4]="MARGIN",r[r.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",r[r.PAGE=6]="PAGE",r[r.RIGHT_MARGIN=7]="RIGHT_MARGIN",r))(lt||{}),ct=(r=>(r[r.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",r[r.INSIDE_MARGIN=1]="INSIDE_MARGIN",r[r.LINE=2]="LINE",r[r.MARGIN=3]="MARGIN",r[r.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",r[r.PAGE=5]="PAGE",r[r.PARAGRAPH=6]="PARAGRAPH",r[r.TOP_MARGIN=7]="TOP_MARGIN",r))(ct||{}),Ou=(r=>(r[r.POINT=0]="POINT",r[r.LINE=1]="LINE",r[r.CHARACTER=2]="CHARACTER",r))(Ou||{}),_r=(r=>(r[r.CENTER=0]="CENTER",r[r.INSIDE=1]="INSIDE",r[r.LEFT=2]="LEFT",r[r.OUTSIDE=3]="OUTSIDE",r[r.RIGHT=4]="RIGHT",r))(_r||{}),gs=(r=>(r[r.BOTTOM=0]="BOTTOM",r[r.CENTER=1]="CENTER",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE",r[r.TOP=4]="TOP",r))(gs||{}),Bf=(r=>(r[r.compressPunctuation=0]="compressPunctuation",r[r.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",r[r.doNotCompress=2]="doNotCompress",r))(Bf||{}),oi=(r=>(r[r.PORTRAIT=0]="PORTRAIT",r[r.LANDSCAPE=1]="LANDSCAPE",r))(oi||{});function Lf(r){let e=r-1;return e=e<0?0:e,e}function n2(r,e,t){return r.slice(0,e)+t+r.slice(e)}function r2(r,e,t){const n=e-t<0?0:e-t;return r.slice(0,n)+r.slice(e)}function Pf(r,e=0){r!=null&&(r.st+=e,r.ed+=e)}function Hf(r,e=0){r!=null&&(r.st+=e,r.ed+=e)}function Uf(r,e){const t=r.getSnapshot(),{text:n,start:s,length:o,segmentId:i}=e,a=Lf(s);let l=t.body;if(o===0)return;if(i){const{headers:d,footers:g}=t;d!=null&&d[i]?l=d[i].body:g!=null&&g[i]&&(l=g[i].body)}if(l==null)throw new Error("no body has changed");const{blockElements:u,blockElementOrder:c}=l;let h=!1;for(let d of c){const g=u[d];if(g==null)continue;const{blockType:m}=g;switch(m){case Fe.PARAGRAPH:h=s2(n,s,a,o,g,g.paragraph,h)}}}function s2(r,e,t,n,s,o,i=!1){i&&Hf(s,n);const{st:a,ed:l}=s;let u=!1;if(t>l||o==null)return u;const{elements:c,elementOrder:h}=o;for(let d of h){const{elementId:g,paragraphElementType:m}=d,f=c[g];if(m===K.DRAWING)continue;const{st:p,ed:b,tr:v}=f;if((u||i)&&t>b&&Pf(f,n),v!=null&&!(t<p||t>b||i)&&(console.log("paragraphApply",t,p,b,i,f,t<p||t>b||i),m===K.TEXT_RUN)){let w=t-p+1;if(e===0&&(w=0),u=!0,v.tab===te.TRUE)continue;const S=n2(v.ct||"",w,r);v.ct=S,f.ed+=n}}return u===!0&&i===!1&&(s.ed+=n),i?!0:u}function zf(r,e){const t=r.getSnapshot(),{start:n,length:s,segmentId:o}=e,i=Lf(n);let a=t.body;if(s===0)return;if(o){const{headers:h,footers:d}=t;h!=null&&h[o]?a=h[o].body:d!=null&&d[o]&&(a=d[o].body)}if(a==null)throw new Error("no body has changed");const{blockElements:l,blockElementOrder:u}=a;let c=!1;for(let h of u){const d=l[h];if(d==null)continue;const{blockType:g}=d;switch(g){case Fe.PARAGRAPH:c=o2(n,i,s,d,d.paragraph,c)}}}function o2(r,e,t,n,s,o=!1){o&&Hf(n,-t);const{st:i,ed:a}=n;let l=!1;if(e>a||s==null)return l;const{elements:u,elementOrder:c}=s;for(let h of c){const{elementId:d,paragraphElementType:g}=h,m=u[d];if(g===K.DRAWING)continue;const{st:f,ed:p,tr:b}=m;if((l||o)&&e>p&&Pf(m,-t),b!=null&&!(e<f||e>p||o)&&g===K.TEXT_RUN){let v=e-f+1;if(r===0&&(v=0),l=!0,b.tab===te.TRUE)continue;const w=r2(b.ct||"",v,t);b.ct=w,m.ed-=t}}return l===!0&&o===!1&&(n.ed-=t),o?!0:l}class i2 extends Df{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do();const{length:s,start:o}=e;this._oldActionData={...e,start:o+s}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{text:n,start:s,length:o,segmentId:i}=e;Uf(t,{text:n,start:s,length:o,segmentId:i}),this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{length:n,start:s,segmentId:o}=e;zf(t,{length:n,start:s,segmentId:o}),this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class a2 extends Df{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do();const{length:s,start:o}=e;this._oldActionData={...e,start:o-s}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{length:n,start:s}=e;zf(t,{length:n,start:s})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{text:n,start:s,length:o}=e;Uf(t,{text:n,start:s,length:o})}validate(){return!1}}class Wf{constructor(e,t){var n;this._context=t,this._snapshot={...Dd,...e},this._unitId=(n=this._snapshot.id)!=null?n:St(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}insertText(e,t,n){const{_context:s}=this,o=s.getCommandManager(),i={actionName:ds.INSERT_TEXT_ACTION_NAME,text:e,start:t,length:e.length,segmentId:n},a=new ge({DocumentUnit:this},i);return o.invoke(a),this}deleteText(e,t,n){const{_context:s}=this,o=s.getCommandManager(),i={actionName:ds.DELETE_TEXT_ACTION_NAME,text:e,start:t,length:e.length,segmentId:n},a=new ge({DocumentUnit:this},i);return o.invoke(a),this}updateText(e,t,n,s){const{_context:o}=this,i=o.getCommandManager(),a={actionName:ds.DELETE_TEXT_ACTION_NAME,text:t,start:n+t.length,length:t.length,segmentId:s},l={actionName:ds.INSERT_TEXT_ACTION_NAME,text:e,start:n,length:e.length,segmentId:s},u=new ge({DocumentUnit:this},a,l);return i.invoke(u),this}}He.register($.INSERT_ROW_DATA_ACTION,Ag),He.register($.INSERT_ROW_ACTION,mu),He.register($.REMOVE_ROW_DATA_ACTION,Dg),He.register($.REMOVE_ROW_ACTION,_u),He.register($.SET_RANGE_STYLE_ACTION,Wg),He.register($.SET_WORKSHEET_STATUS_ACTION,Qg),He.register($.SET_SELECTION_ACTION,jg),He.register($.SET_RANGE_DATA_ACTION,Pg),He.register($.SET_RANGE_FORMATTED_VALUE_ACTION,Vg),He.register($.DELETE_RANGE_ACTION,gu),He.register($.CLEAR_RANGE_ACTION,wg),He.register($.INSERT_RANGE_ACTION,yg),He.register($.SET_TAB_COLOR_ACTION,Kg),He.register($.HIDE_SHEET_ACTION,qg),He.register($.SET_WORKSHEET_ACTIVATE_ACTION,Zg),He.register($.SET_HIDE_ROW_ACTION,Xg),He.register($.SET_SHOW_ROW_ACTION,Yg),He.register($.SET_HIDE_COLUMN_ACTION,Mg),He.register($.SET_SHOW_COLUMN_ACTION,Ng),He.register($.ADD_MERGE_ACTION,Bd),He.register($.REMOVE_MERGE_ACTION,xg),He.register($.SET_WORKSHEET_NAME_ACTION,Jg),He.register($.SET_HIDDEN_GRIDLINES_ACTION,Bg),He.register($.SET_COLUMN_WIDTH_ACTION,kg),He.register($.SET_ROW_HEIGHT_ACTION,Gg),He.register($.SET_BORDER_ACTION,Fg),He.register($.SET_RIGHT_TO_LEFT_ACTION,$g),He.register($.INSERT_COLUMN_DATA_ACTION,Sg),He.register($.REMOVE_COLUMN_DATA_ACTION,Ig),He.register($.INSERT_COLUMN_ACTION,fu),He.register($.REMOVE_COLUMN_ACTION,pu),He.register($.DELETE_NAMED_RANGE_ACTION,Tg),He.register($.SET_NAMED_RANGE_ACTION,Lg),He.register($.ADD_NAMED_RANGE_ACTION,Hd),He.register($.SET_RANGE_FORMAT_ACTION,Hg),He.register($.SET_RANGE_FORMULA_ACTION,Ug),He.register($.SET_RANGE_NOTE_ACTION,zg),He.register($.INSERT_SHEET_ACTION,Rg),He.register($.REMOVE_SHEET_ACTION,Og),He.register($.SET_SHEET_ORDER_ACTION,bu),He.register($.SET_SHEET_ORDER_ACTION,bu),He.register($.SET_ZOOM_RATIO_ACTION,ef),He.register(ds.INSERT_TEXT_ACTION_NAME,i2),He.register(ds.DELETE_TEXT_ACTION_NAME,a2);class sn{constructor(e){this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{this._observeNames.includes(n)||this._observeNames.push(n),t.addObserver(n,this._name,new ye)})}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{t.removeObserver(n,this._name)})}}class Vf{_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach(e=>{e.onCreate(this._context),e.onMounted(this._context)}))}constructor(e,t=[]){this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,n=t.findIndex(s=>s.getPluginName()===e);if(n>-1){const s=t.splice(n,1)[0];s&&s.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}}class $f{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class _a{constructor(){this._undoManager=new xf,this._commandManager=new He(this),this._environment=new $f,this._hooksManager=new fd,this._locale=new ni,this._pluginManager=new Vf(this),this._observerManager=new Af}onUniver(e){this._univer=e}getHook(e){return this._hooksManager.getHooks(e)}getLocale(){return this._locale}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}}class Gf extends _a{constructor(e={}){super(),this._locale.initialize(e.locale),this._document=new Wf(e,this)}_setObserver(){}getDocument(){return this._document}}class Un{constructor(){this._data=[]}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Un}}class ba{constructor(){this._data=new Map}add(e,t){this._data.has(e)||this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}static create(){return new ba}}class Xf{install(e){e.addObserver("onAfterSetSelectionObservable","core",new ye),e.addObserver("onBeforeChangeNameObservable","core",new ye),e.addObserver("onAfterChangeNameObservable","core",new ye),e.addObserver("onBeforeChangeActiveSheetObservable","core",new ye),e.addObserver("onAfterChangeActiveSheetObservable","core",new ye),e.addObserver("onBeforeChangeSheetNameObservable","core",new ye),e.addObserver("onAfterChangeSheetNameObservable","core",new ye),e.addObserver("onBeforeInsertSheetObservable","core",new ye),e.addObserver("onAfterInsertSheetObservable","core",new ye),e.addObserver("onBeforeRemoveSheetObservable","core",new ye),e.addObserver("onAfterRemoveSheetObservable","core",new ye),e.addObserver("onBeforeChangeSheetColorObservable","core",new ye),e.addObserver("onAfterChangeSheetColorObservable","core",new ye),e.addObserver("onBeforeChangeSheetDataObservable","core",new ye),e.addObserver("onAfterChangeSheetDataObservable","core",new ye),e.addObserver("onSheetBarDidMountObservable","core",new ye),e.addObserver("onInfoBarDidMountObservable","core",new ye),e.addObserver("onRightMenuDidMountObservable","core",new ye),e.addObserver("onAfterChangeSheetScrollObservable","core",new ye),e.addObserver("onAfterChangeUILocaleObservable","core",new ye),e.addObserver("onSheetRenderDidMountObservable","core",new ye),e.addObserver("onAfterChangeUISkinObservable","core",new ye),e.addObserver("onHideSheetObservable","core",new ye),e.addObserver("onShowSheetObservable","core",new ye),e.addObserver("onSheetTabColorChangeObservable","core",new ye),e.addObserver("onSheetOrderObservable","core",new ye),e.addObserver("onZoomRatioSheetObservable","core",new ye)}}class Yf extends _a{constructor(e={}){super(),this._locale.initialize(e.locale),this._setObserver(),this._workbook=new ha(e,this)}_setObserver(){const e=this.getObserverManager();new Xf().install(e)}getWorkBook(){return this._workbook}getContextObserver(e){return this.getObserverManager().requiredObserver(e,"core")}refreshWorkbook(e={}){this._workbook=new ha(e,this)}}const l2={namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:Zs}};var br=(r=>(r[r.SLIDE=0]="SLIDE",r[r.MASTER=1]="MASTER",r[r.LAYOUT=2]="LAYOUT",r[r.HANDOUT_MASTER=3]="HANDOUT_MASTER",r[r.NOTES_MASTER=4]="NOTES_MASTER",r))(br||{}),Ie=(r=>(r[r.SHAPE=0]="SHAPE",r[r.IMAGE=1]="IMAGE",r[r.TEXT=2]="TEXT",r[r.SPREADSHEET=3]="SPREADSHEET",r[r.DOCUMENT=4]="DOCUMENT",r))(Ie||{}),jf=(r=>(r[r.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",r[r.NEXT_SLIDE=1]="NEXT_SLIDE",r[r.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",r[r.FIRST_SLIDE=3]="FIRST_SLIDE",r[r.LAST_SLIDE=4]="LAST_SLIDE",r))(jf||{});class u2{constructor(e,t){var n;this._context=t,this._snapshot={...Od,...e},this._unitId=(n=this._snapshot.id)!=null?n:St(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const t=this.getPages();return t==null?void 0:t[e]}getElementsByPage(e){var t;return(t=this.getPage(e))==null?void 0:t.pageElements}getElement(e,t){var n;return(n=this.getElementsByPage(e))==null?void 0:n[t]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:br.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}}class Kf extends _a{constructor(e={}){super(),this._locale.initialize(e.locale),this._slide=new u2(e,this)}_setObserver(){}getSlide(){return this._slide}}var c2={name:"@univer/core",version:"0.0.1",description:"",author:"",main:"./src/index.ts",module:"./src/index.ts",types:"./src/Types/index.d.ts",publishConfig:{main:"./lib/univer-core.js",module:"./lib/univer-core.mjs",types:"./lib/index.d.ts"},exports:{".":"./src/index.ts","./*":"./src/*"},files:["lib"],directories:{lib:"lib"},scripts:{test:"cross-env NODE_ENV=--experimental-vm-modules jest --config=jest.config.js",dev:"vite",build:"tsc && vite build",watch:"vite build",link:"pnpm link ./",api:"node ./api.js",tsc:"tsc",serve:"node test/Server/server.js"},license:"MIT",dependencies:{dayjs:"^1.11.5","es6-proxy-polyfill":"^2.1.1",nanoid:"4.0.0",numeral:"^2.0.6","reflect-metadata":"^0.1.13"},devDependencies:{"@types/jest":"^28.1.8","@types/node":"^18.7.12","@typescript-eslint/eslint-plugin":"^5.34.0","@typescript-eslint/parser":"^5.34.0",debug:"^4.3.4",jest:"29.0.0","jest-dev-server":"^6.1.1","jest-environment-jsdom":"^29.0.3",less:"^4.1.3","ts-jest":"29.0.1","ts-node":"^10.9.1",typescript:"^4.7.4",vite:"^3.0.9","vite-plugin-external":"1.2.3"}};const va="dev",Ca=c2.version;class Ea{constructor(e={}){this.univerDocConfig=e,this._context=new Gf(e)}static newInstance(e={}){return eo.capsule(va,Ca,"powered by :: UniverDoc :: "),new Ea(e)}static get(e){return fr({...e,type:"GET"})}static post(e){return fr({...e,type:"POST"})}get context(){return this._context}getUnitId(){return this._context.getDocument().getUnitId()}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}class wa{constructor(e={}){this.univerSheetConfig=e,this._context=new Yf(e)}static newInstance(e={}){return eo.capsule(va,Ca,"powered by :: universheet :: "),new wa(e)}static get(e){return fr({...e,type:"GET"})}static post(e){return fr({...e,type:"POST"})}static load(e,t){e.getWorkBook().load(t.workbookConfig),e.context.getPluginManager().getPlugins().forEach(n=>{n.load(t[`${n.getPluginName()}Config`])})}static newColor(){return new js}get context(){return this._context}getUnitId(){return this.getWorkBook().getUnitId()}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}getWorkBook(){return this._context.getWorkBook()}static toJson(e){const t=e.getWorkBook().save(),n={};return e.context.getPluginManager().getPlugins().forEach(s=>{n[`${s.getPluginName()}Config`]=s.save()}),{workbookConfig:t,...n}}refreshWorkbook(e={}){this._context.refreshWorkbook(e)}}class Ta{constructor(e={}){this.UniverSlideConfig=e,this._context=new Kf(e)}static newInstance(e={}){return eo.capsule(va,Ca,"powered by :: UniverSlide :: "),new Ta(e)}static get(e){return fr({...e,type:"GET"})}static post(e){return fr({...e,type:"POST"})}static newColor(){return new js}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}/*! *****************************************************************************
    Copyright (C) Microsoft. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var Zf;(function(r){(function(e){var t=typeof Vr=="object"?Vr:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=s(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=s(t.Reflect,n),e(n);function s(o,i){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),i&&i(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",i=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!i&&!a,u={create:i?function(){return he(Object.create(null))}:a?function(){return he({__proto__:null})}:function(){return he({})},has:l?function(H,z){return t.call(H,z)}:function(H,z){return z in H},get:l?function(H,z){return t.call(H,z)?H[z]:void 0}:function(H,z){return H[z]}},c=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",d=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:le(),g=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:ae(),m=!h&&typeof WeakMap=="function"?WeakMap:j(),f=new m;function p(H,z,J,ue){if(P(J)){if(!Te(H))throw new TypeError;if(!Ze(z))throw new TypeError;return O(H,z)}else{if(!Te(H))throw new TypeError;if(!oe(z))throw new TypeError;if(!oe(ue)&&!P(ue)&&!V(ue))throw new TypeError;return V(ue)&&(ue=void 0),J=fe(J),M(H,z,J,ue)}}e("decorate",p);function b(H,z){function J(ue,de){if(!oe(ue))throw new TypeError;if(!P(de)&&!Ne(de))throw new TypeError;L(H,z,ue,de)}return J}e("metadata",b);function v(H,z,J,ue){if(!oe(J))throw new TypeError;return P(ue)||(ue=fe(ue)),L(H,z,J,ue)}e("defineMetadata",v);function w(H,z,J){if(!oe(z))throw new TypeError;return P(J)||(J=fe(J)),x(H,z,J)}e("hasMetadata",w);function S(H,z,J){if(!oe(z))throw new TypeError;return P(J)||(J=fe(J)),E(H,z,J)}e("hasOwnMetadata",S);function T(H,z,J){if(!oe(z))throw new TypeError;return P(J)||(J=fe(J)),N(H,z,J)}e("getMetadata",T);function D(H,z,J){if(!oe(z))throw new TypeError;return P(J)||(J=fe(J)),X(H,z,J)}e("getOwnMetadata",D);function R(H,z){if(!oe(H))throw new TypeError;return P(z)||(z=fe(z)),ne(H,z)}e("getMetadataKeys",R);function I(H,z){if(!oe(H))throw new TypeError;return P(z)||(z=fe(z)),G(H,z)}e("getOwnMetadataKeys",I);function y(H,z,J){if(!oe(z))throw new TypeError;P(J)||(J=fe(J));var ue=F(z,J,!1);if(P(ue)||!ue.delete(H))return!1;if(ue.size>0)return!0;var de=f.get(z);return de.delete(J),de.size>0||f.delete(z),!0}e("deleteMetadata",y);function O(H,z){for(var J=H.length-1;J>=0;--J){var ue=H[J],de=ue(z);if(!P(de)&&!V(de)){if(!Ze(de))throw new TypeError;z=de}}return z}function M(H,z,J,ue){for(var de=H.length-1;de>=0;--de){var ze=H[de],De=ze(z,J,ue);if(!P(De)&&!V(De)){if(!oe(De))throw new TypeError;ue=De}}return ue}function F(H,z,J){var ue=f.get(H);if(P(ue)){if(!J)return;ue=new d,f.set(H,ue)}var de=ue.get(z);if(P(de)){if(!J)return;de=new d,ue.set(z,de)}return de}function x(H,z,J){var ue=E(H,z,J);if(ue)return!0;var de=Y(z);return V(de)?!1:x(H,de,J)}function E(H,z,J){var ue=F(z,J,!1);return P(ue)?!1:be(ue.has(H))}function N(H,z,J){var ue=E(H,z,J);if(ue)return X(H,z,J);var de=Y(z);if(!V(de))return N(H,de,J)}function X(H,z,J){var ue=F(z,J,!1);if(!P(ue))return ue.get(H)}function L(H,z,J,ue){var de=F(J,ue,!0);de.set(H,z)}function ne(H,z){var J=G(H,z),ue=Y(H);if(ue===null)return J;var de=ne(ue,z);if(de.length<=0)return J;if(J.length<=0)return de;for(var ze=new g,De=[],Be=0,ce=J;Be<ce.length;Be++){var Se=ce[Be],ve=ze.has(Se);ve||(ze.add(Se),De.push(Se))}for(var $e=0,Ve=de;$e<Ve.length;$e++){var Se=Ve[$e],ve=ze.has(Se);ve||(ze.add(Se),De.push(Se))}return De}function G(H,z){var J=[],ue=F(H,z,!1);if(P(ue))return J;for(var de=ue.keys(),ze=se(de),De=0;;){var Be=B(ze);if(!Be)return J.length=De,J;var ce=re(Be);try{J[De]=ce}catch(Se){try{k(ze)}finally{throw Se}}De++}}function Q(H){if(H===null)return 1;switch(typeof H){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return H===null?1:6;default:return 6}}function P(H){return H===void 0}function V(H){return H===null}function pe(H){return typeof H=="symbol"}function oe(H){return typeof H=="object"?H!==null:typeof H=="function"}function Z(H,z){switch(Q(H)){case 0:return H;case 1:return H;case 2:return H;case 3:return H;case 4:return H;case 5:return H}var J=z===3?"string":z===5?"number":"default",ue=A(H,s);if(ue!==void 0){var de=ue.call(H,J);if(oe(de))throw new TypeError;return de}return ie(H,J==="default"?"number":J)}function ie(H,z){if(z==="string"){var J=H.toString;if(Le(J)){var ue=J.call(H);if(!oe(ue))return ue}var de=H.valueOf;if(Le(de)){var ue=de.call(H);if(!oe(ue))return ue}}else{var de=H.valueOf;if(Le(de)){var ue=de.call(H);if(!oe(ue))return ue}var ze=H.toString;if(Le(ze)){var ue=ze.call(H);if(!oe(ue))return ue}}throw new TypeError}function be(H){return!!H}function Ce(H){return""+H}function fe(H){var z=Z(H,3);return pe(z)?z:Ce(z)}function Te(H){return Array.isArray?Array.isArray(H):H instanceof Object?H instanceof Array:Object.prototype.toString.call(H)==="[object Array]"}function Le(H){return typeof H=="function"}function Ze(H){return typeof H=="function"}function Ne(H){switch(Q(H)){case 3:return!0;case 4:return!0;default:return!1}}function A(H,z){var J=H[z];if(J!=null){if(!Le(J))throw new TypeError;return J}}function se(H){var z=A(H,o);if(!Le(z))throw new TypeError;var J=z.call(H);if(!oe(J))throw new TypeError;return J}function re(H){return H.value}function B(H){var z=H.next();return z.done?!1:z}function k(H){var z=H.return;z&&z.call(H)}function Y(H){var z=Object.getPrototypeOf(H);if(typeof H!="function"||H===c||z!==c)return z;var J=H.prototype,ue=J&&Object.getPrototypeOf(J);if(ue==null||ue===Object.prototype)return z;var de=ue.constructor;return typeof de!="function"||de===H?z:de}function le(){var H={},z=[],J=function(){function De(Be,ce,Se){this._index=0,this._keys=Be,this._values=ce,this._selector=Se}return De.prototype["@@iterator"]=function(){return this},De.prototype[o]=function(){return this},De.prototype.next=function(){var Be=this._index;if(Be>=0&&Be<this._keys.length){var ce=this._selector(this._keys[Be],this._values[Be]);return Be+1>=this._keys.length?(this._index=-1,this._keys=z,this._values=z):this._index++,{value:ce,done:!1}}return{value:void 0,done:!0}},De.prototype.throw=function(Be){throw this._index>=0&&(this._index=-1,this._keys=z,this._values=z),Be},De.prototype.return=function(Be){return this._index>=0&&(this._index=-1,this._keys=z,this._values=z),{value:Be,done:!0}},De}();return function(){function De(){this._keys=[],this._values=[],this._cacheKey=H,this._cacheIndex=-2}return Object.defineProperty(De.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),De.prototype.has=function(Be){return this._find(Be,!1)>=0},De.prototype.get=function(Be){var ce=this._find(Be,!1);return ce>=0?this._values[ce]:void 0},De.prototype.set=function(Be,ce){var Se=this._find(Be,!0);return this._values[Se]=ce,this},De.prototype.delete=function(Be){var ce=this._find(Be,!1);if(ce>=0){for(var Se=this._keys.length,ve=ce+1;ve<Se;ve++)this._keys[ve-1]=this._keys[ve],this._values[ve-1]=this._values[ve];return this._keys.length--,this._values.length--,Be===this._cacheKey&&(this._cacheKey=H,this._cacheIndex=-2),!0}return!1},De.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=H,this._cacheIndex=-2},De.prototype.keys=function(){return new J(this._keys,this._values,ue)},De.prototype.values=function(){return new J(this._keys,this._values,de)},De.prototype.entries=function(){return new J(this._keys,this._values,ze)},De.prototype["@@iterator"]=function(){return this.entries()},De.prototype[o]=function(){return this.entries()},De.prototype._find=function(Be,ce){return this._cacheKey!==Be&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Be)),this._cacheIndex<0&&ce&&(this._cacheIndex=this._keys.length,this._keys.push(Be),this._values.push(void 0)),this._cacheIndex},De}();function ue(De,Be){return De}function de(De,Be){return Be}function ze(De,Be){return[De,Be]}}function ae(){return function(){function H(){this._map=new d}return Object.defineProperty(H.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),H.prototype.has=function(z){return this._map.has(z)},H.prototype.add=function(z){return this._map.set(z,z),this},H.prototype.delete=function(z){return this._map.delete(z)},H.prototype.clear=function(){this._map.clear()},H.prototype.keys=function(){return this._map.keys()},H.prototype.values=function(){return this._map.values()},H.prototype.entries=function(){return this._map.entries()},H.prototype["@@iterator"]=function(){return this.keys()},H.prototype[o]=function(){return this.keys()},H}()}function j(){var H=16,z=u.create(),J=ue();return function(){function ce(){this._key=ue()}return ce.prototype.has=function(Se){var ve=de(Se,!1);return ve!==void 0?u.has(ve,this._key):!1},ce.prototype.get=function(Se){var ve=de(Se,!1);return ve!==void 0?u.get(ve,this._key):void 0},ce.prototype.set=function(Se,ve){var $e=de(Se,!0);return $e[this._key]=ve,this},ce.prototype.delete=function(Se){var ve=de(Se,!1);return ve!==void 0?delete ve[this._key]:!1},ce.prototype.clear=function(){this._key=ue()},ce}();function ue(){var ce;do ce="@@WeakMap@@"+Be();while(u.has(z,ce));return z[ce]=!0,ce}function de(ce,Se){if(!t.call(ce,J)){if(!Se)return;Object.defineProperty(ce,J,{value:u.create()})}return ce[J]}function ze(ce,Se){for(var ve=0;ve<Se;++ve)ce[ve]=Math.random()*255|0;return ce}function De(ce){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(ce)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(ce)):ze(new Uint8Array(ce),ce):ze(new Array(ce),ce)}function Be(){var ce=De(H);ce[6]=ce[6]&79|64,ce[8]=ce[8]&191|128;for(var Se="",ve=0;ve<H;++ve){var $e=ce[ve];(ve===4||ve===6||ve===8)&&(Se+="-"),$e<16&&(Se+="0"),Se+=$e.toString(16).toLowerCase()}return Se}}function he(H){return H.__=void 0,delete H.__,H}})})(Zf||(Zf={}));function qf(r){return typeof r=="function"}function Xr(r){return r!=null}function Jf(r){return r==null}function h2(r){return typeof r=="object"}function d2(r){return typeof r=="string"}function g2(r){return r instanceof Fu}const Sa=class{static register(r,e){let t=Sa.sMap.get(r);t?t.push(e):(t=new Array,t.push(e),Sa.sMap.set(r,t))}static getTable(r){var n;let e=new Array,t=r;for(;t!=null;){const s=(n=Sa.sMap.get(t))!=null?n:[];e=e.concat(s),t=Object.getPrototypeOf(t)}return e}};let vr=Sa;vr.sMap=new Map;class Fu{constructor(e={}){this._config=e,this._value=e.value}getValue(){return this._value}setValue(e){this._value=e}}class fs{static postDestroy(e){if(e){const t=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t);for(const s of n){const o=Reflect.getMetadata("PreDestroy",t,s);if(Xr(o)){const i=t[s];qf(i)&&i.apply(e)}}}}static postConstruct(e,t){if(e){const n=Object.getPrototypeOf(e),s=Object.getOwnPropertyNames(n);for(const o of s){const i=Reflect.getMetadata("PostConstruct",n,o);if(Xr(i)){const a=n[o];qf(a)&&a.apply(e,t)}}}}_printCirculate(){let e="The dependencies of some of the instance in the application context form a cycle\uFF1A";return e+=`
`,this._circulate.reverse().forEach(t=>{const{baseClass:n}=t,s=this._mappings.get(n),{name:o}=s;e+=`
`,e+=`Class: ${o} Field: ${n}`}),e}_clearCirculate(){this._circulate=[]}_addCirculate(e,t){this._circulate.forEach(n=>{if(n.baseClass===e&&n.scope===t&&t===zn.prototype)throw this._circulate.push({baseClass:e,scope:t}),new Error(this._printCirculate())}),this._circulate.push({baseClass:e,scope:t})}_popCirculate(){this._circulate.pop()}_inject(e,t){const n=Object.getPrototypeOf(e),s=vr.getTable(n);for(const o of s){const i=Reflect.getMetadata("Container",n,o),a=Reflect.getMetadata("Inject",n,o),l=Reflect.getMetadata("Attribute",n,o),u=Reflect.getMetadata("AttributeValue",n,o);switch(typeof a){case"string":{const c=e;c[o]=this._getInstance(a,t,zn.nothing,[]);break}case"object":{const c=a,{mapping:h}=c,{scope:d}=c,{argument:g}=c,m=e;m[o]=this._getInstance(h,t,d,g)}}if(i){const c=e;c[o]=this}if(l){const c=e;c[o]=this._attribute}if(u){const c=e;c[o]=this._attribute.getValue()}}}_getInstance(e,t,n,s){const o=this._mappings.get(e);if(o){if(n===zn.nothing){const i=this._configure.get(e);i?n=i.scope:n=zn.prototype}switch(n){case zn.singleton:{const i=this._instance.get(e);if(Xr(i))return i;const a=Xr(s)?new o(...s):new o;return this._instance.set(e,a),this._addCirculate(e,n),this._inject(a,t),this._popCirculate(),t.push([a,s]),a}case zn.prototype:{const i=Xr(s)?new o(...s):new o;return this._addCirculate(e,n),this._inject(i,t),this._popCirculate(),t.push([i,s]),i}}}}constructor(e={}){this._mappings=new Map,this._instance=new Map,this._configure=new Map,this._attribute=g2(e)?e:new Fu(e),this._circulate=[]}inject(e){if(e){const t=[[e,[]]];this._inject(e,t),this._clearCirculate();for(const n of t.reverse())fs.postConstruct(n[0],n[1])}}getAttribute(){return this._attribute}getInstance(e,...t){const n=[],s=this._getInstance(e,n,zn.prototype,t);this._clearCirculate();for(const o of n.reverse())fs.postConstruct(o[0],o[1]);return s}getSingleton(e,...t){const n=[],s=this._getInstance(e,n,zn.singleton,t);this._clearCirculate();for(const o of n.reverse())fs.postConstruct(o[0],o[1]);return s}getBaseClassByInstance(e){if(h2(e)){const{constructor:t}=e,n=this._mappings.entries();for(const[s,o]of n)if(t===o)return s}}removeMapping(e){this._mappings.delete(e);const t=this._instance.get(e),n=s=>{const o=Object.keys(s);for(const i of o){const a=s[i];this.getBaseClassByInstance(a)&&(n(a),fs.postDestroy(s))}fs.postDestroy(s)};Xr(t)&&n(t),this._instance.delete(e)}addMapping(e,t,n){this._mappings.set(e,t),Xr(n)&&this._configure.set(e,n)}addSingletonMapping(e,t){return this.addMapping(e,t,{scope:zn.singleton})}addClass(e,t){this.addMapping(e.name,e,t)}removeClass(e){this.removeMapping(e.name)}addSingletonClass(e){this.addSingletonMapping(e.name,e)}}var zn=(r=>(r[r.singleton=0]="singleton",r[r.prototype=1]="prototype",r[r.nothing=2]="nothing",r))(zn||{});function Qf(){return(r,e,t)=>{vr.register(r,e),Reflect.defineMetadata("PostConstruct",t,r,e)}}function f2(){return(r,e,t)=>{vr.register(r,e),Reflect.defineMetadata("PreDestroy",t,r,e)}}function m2(r){return(e,t)=>{if(vr.register(e,t),d2(r)){Reflect.defineMetadata("Inject",r,e,t);return}Xr(r)&&(Jf(r.argument)&&(r.argument=[]),Jf(r.scope)&&(r.scope=1),Reflect.defineMetadata("Inject",r,e,t))}}function p2(){return(r,e)=>{vr.register(r,e),Reflect.defineMetadata("Attribute",{},r,e)}}function _2(){return(r,e)=>{vr.register(r,e),Reflect.defineMetadata("Container",{},r,e)}}function e0(){return(r,e)=>{vr.register(r,e),Reflect.defineMetadata("AttributeValue",{},r,e)}}const t0="MessageQueue";class n0{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(t0,e)}load(){const e=localStorage.getItem(t0);e&&(this._messages=JSON.parse(e))}}var r0=(r=>(r.MESSAGE_RESPONSE="message_response",r))(r0||{});class Mu{static isMessageResponseReceive(e){return e.type==="message_response"}packMessage(e){return{changed:e,version:W.generateRandomId()}}}class b2 extends Mu{pushMessageQueue(e){throw new Error("Method not implemented.")}}var v2=Object.defineProperty,C2=Object.getOwnPropertyDescriptor,s0=(r,e,t,n)=>{for(var s=n>1?void 0:n?C2(e,t):e,o=r.length-1,i;o>=0;o--)(i=r[o])&&(s=(n?i(e,t,s):i(s))||s);return n&&s&&v2(e,t,s),s},o0=(r=>(r.WAIT="wait",r.WORK="work",r))(o0||{});const i0=class extends Mu{initialize(){this.messageQueue=new n0,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Su({url:this.config.socketUrl}),this.socket.on(dn.MESSAGE,r=>{this.checkupReceiveMessage(r.data)}),this.socket.on(dn.ERROR,()=>{}),this.socket.on(dn.OPEN,()=>{}),this.socket.on(dn.CLOSE,()=>{}),this.socket.on(dn.RETRY,()=>{}),this.socket.on(dn.DESTROY,()=>{}),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const r=this.getTopMessage();return(e=JSON.stringify(r))!=null?e:""}checkupReceiveMessage(r){i0.isMessageResponseReceive(r)&&this.getTopMessage().version===r.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(r){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(r)),this.sendMessageQueue())}async sendTopMessage(){const r=this.serializeTopMessage();return this.socket.send(r),new Promise(e=>this.globalSendResolve=e)}async sendMessageQueue(){const{messageQueue:r,status:e}=this;if(e==="wait"){for(this.status="work";r.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let Nu=i0;s0([e0()],Nu.prototype,"config",2),s0([Qf()],Nu.prototype,"initialize",1);var E2=Object.freeze(Object.defineProperty({__proto__:null,ContextBase:_a,DocContext:Gf,Environment:$f,Registry:Un,RegistryAsMap:ba,SheetContext:Yf,SlideContext:Kf,UniverDoc:Ea,UniverSheet:wa,UniverSlide:Ta,VersionEnv:va,VersionCode:Ca,WorkBookObserverImpl:Xf,SheetActionBase:Qe,ActionType:Ee,ActionObservers:Rf,CommandUnit:t2,Command:ge,CommandManager:He,UndoManager:xf,ActionExtensionManager:If,BaseActionExtension:si,BaseActionExtensionFactory:fa,AddMergeAction:Bd,AddNamedRangeAction:Hd,ClearRangeAction:wg,DeleteNamedRangeAction:Tg,DeleteRangeAction:gu,InsertColumnAction:fu,InsertColumnDataAction:Sg,InsertRangeAction:yg,InsertRowAction:mu,InsertRowDataAction:Ag,InsertSheetAction:Rg,RemoveColumnAction:pu,RemoveColumnDataAction:Ig,RemoveMergeAction:xg,RemoveRowAction:_u,RemoveRowDataAction:Dg,RemoveSheetAction:Og,SetBorderAction:Fg,SetColumnHideAction:Mg,SetColumnShowAction:Ng,SetColumnWidthAction:kg,SetHiddenGridlinesAction:Bg,SetNamedRangeAction:Lg,SetRangeDataAction:Pg,SetRangeFormatAction:Hg,SetRangeFormulaAction:Ug,SetRangeNoteAction:zg,SetRangeStyleAction:Wg,SetRangeFormattedValueAction:Vg,SetRightToLeftAction:$g,SetRowHeightAction:Gg,SetRowHideAction:Xg,SetRowShowAction:Yg,SetSelectionActivateAction:jg,SetSheetOrderAction:bu,SetTabColorAction:Kg,SetWorkSheetActivateAction:Zg,SetWorkSheetHideAction:qg,SetWorkSheetNameAction:Jg,SetWorkSheetStatusAction:Qg,SetZoomRatioAction:ef,ActionOperation:pr,ACTION_NAMES:$,DEFAULT_RANGE_ARRAY:Qo,DEFAULT_RANGE:Id,DEFAULT_SELECTION:Zs,DEFAULT_WORKBOOK:xd,DEFAULT_WORKSHEET:Wr,DEFAULT_STYLES:us,DEFAULT_DOC:Dd,DEFAULT_SLIDE:Od,EXTENSION_NAMES:Fd,KEYBOARD_KEYS:cu,PLUGIN_NAMES:Pe,THEME_COLORS:Ad,Color:nr,HLSColor:Rd,RgbColor:Jo,ThemeColor:uu,ColorBuilder:js,ColumnManager:Md,Merges:tf,Range:at,RangeList:of,RowManager:af,Selection:Eu,Styles:Cu,Workbook:ha,Worksheet:vn,DocumentModel:Wf,AutoFillSeries:ia,BooleanCriteria:_d,BorderStyleTypes:C,BorderType:Rn,ColorType:In,CommonHideTypes:bd,ConditionType:vd,CopyPasteType:Xs,DeveloperMetadataVisibility:Cd,Dimension:Ur,Direction:ee,FormatType:aa,InterpolationPointType:Ed,KeyCode:gr,KeyboardKeyType:lu,LocaleType:bn,ProtectionType:wd,RelativeDate:Td,SheetTypes:Dt,TextDirection:Ys,TextDecoration:Tt,HorizontalAlign:ut,VerticalAlign:tn,WrapStrategy:kt,FontItalic:Sd,FontWeight:yd,BaselineOffset:cn,BooleanNumber:te,CellValueType:xn,ThemeColorType:hn,ThemeColors:la,ShapeType:Ot,FollowNumberWithType:Of,GlyphType:Wt,BulletAlignment:vt,BlockType:Fe,GridType:gn,SectionType:Gr,ColumnSeparatorType:Pn,TextDirectionType:ma,ParagraphElementType:K,WrapTextType:Hn,PositionedObjectLayoutType:rn,NamedStyleType:pa,SpacingRule:no,DashStyleType:Ff,TabStopAlignment:Mf,WidthType:Nf,ContentAlignment:kf,FontStyleType:ro,ObjectRelativeFromH:lt,ObjectRelativeFromV:ct,NumberUnitType:Ou,AlignTypeH:_r,AlignTypeV:gs,characterSpacingControlType:Bf,PageOrientType:oi,DEFAULT_NAMED_RANGE:l2,PageType:br,PageElementType:Ie,RelativeSlideLink:jf,AttributeMap:vr,IOCAttribute:Fu,IOCContainer:fs,IOCScope:zn,PostConstruct:Qf,PreDestroy:f2,Inject:m2,Attribute:p2,Container:_2,AttributeValue:e0,EventState:dd,Observer:au,Observable:ye,ObservableHooks:db,PathObservableHooks:gd,HooksManager:fd,PathObservable:xu,ObserverManager:Af,Plugin:sn,PluginManager:Vf,MessageQueue:n0,ServerReceiveType:r0,ServerBase:Mu,ServerHttp:b2,MessageQueueStatus:o0,ServerSocket:Nu,binarySearchArray:md,orderSearchArray:pd,searchArray:Ln,makeCellToSelection:Qs,isEmptyCell:wu,getColorStyle:Ft,isFormulaString:lf,DateTime:yb,DropCell:ei,ExcelDateTime:Ab,error:vu,datenum_local:sf,generate:nn,update:hs,IOHttpRequestType:hf,IOHttpReadyState:df,IOHttpResponseType:gf,IOHttp:fr,Post:kb,Get:Bb,IOSocketListenType:dn,HEART_BEAT_MESSAGE:Tu,IOSocket:Su,isKeyPrintable:ff,Locale:ni,Logger:eo,LRUHelper:ri,KeyIterator:mf,ValueIterator:pf,EntryIterator:_f,Entry:yu,LRUMap:bf,migrate:vf,NameGen:mr,ObjectArray:nt,ObjectArrayIterableIterator:oa,ObjectMatrix:_e,Rectangle:Zt,referenceToGrid:da,ABCToNumber:jb,numberToABC:wf,repeatStringNumTimes:Tf,numberToListABC:Ru,SerializeManager:Zb,get Serializer(){return to},sortRules:yt,sortRulesByDesc:Iu,Tools:W,Tuples:ot,TypeStoreBase:Sf,hashAlgorithm:yf},Symbol.toStringTag,{value:"Module"})),a0={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],defaultFontSize:14,unit:"pt"}},l0={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const w2="rgb(",T2="rgba(",Wn={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var u0=(r=>(r.rect="rect",r))(u0||{}),Bt=(r=>(r.PointerMove="PointerMove",r.PointerDown="PointerDown",r.PointerUp="PointerUp",r.PointerOut="PointerOut",r.PointerLeave="PointerLeave",r.PointerOver="PointerOver",r.PointerEnter="PointerEnter",r.wheel="MouseWheel",r.KeyDown="KeyDown",r.KeyUp="KeyUp",r))(Bt||{}),c0=(r=>(r[r.XY=0]="XY",r[r.X=1]="X",r[r.Y=2]="Y",r))(c0||{});const ku=1,h0='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',d0={lines:[],drawings:new Map,height:0,st:0,ed:0,marginLeft:0},S2={...d0,marginTop:20},y2={...d0,marginBottom:20},g0="0",Bu=1,f0=14;var ht=(r=>(r.DEFAULT="default",r.AUTO="auto",r.CROSSHAIR="crosshair",r.POINTER="pointer",r.MOVE="move",r.EAST_RESIZE="e-resize",r.NORTH_EAST_RESIZE="ne-resize",r.NORTH_WEST_RESIZE="nw-resize",r.NORTH_RESIZE="n-resize",r.SOUTH_EAST_RESIZE="se-resize",r.SOUTH_WEST_RESIZE="sw-resize",r.SOUTH_RESIZE="s-resize",r.WEST_RESIZE="w-resize",r.TEXT="text",r.WAIT="wait",r.HELP="help",r.CELL="cell",r.NONE="none",r.VERTICAL_TEXT="vertical-text",r.NO_DROP="no-drop",r.GRAB="grab",r.GRABBING="grabbing",r.ALL_SCROLL="all-scroll",r.COLUMN_RESIZE="col-resize",r.ROW_RESIZE="row-resize",r.PROGRESS="progress",r.NOT_ALLOWED="not-allowed",r.ZOOM_IN="zoom-in",r.ZOOM_OUT="zoom-out",r))(ht||{}),m0=(r=>(r[r.noClip=0]="noClip",r[r.DOC_SIZE=1]="DOC_SIZE",r[r.CONTENT_SIZE_LEFT=2]="CONTENT_SIZE_LEFT",r[r.CONTENT_SIZE_CENTER=3]="CONTENT_SIZE_CENTER",r[r.CONTENT_SIZE_Right=4]="CONTENT_SIZE_Right",r))(m0||{});const Cr="rgb(0,0,0)";var Vt=(r=>(r.TOP="t",r.BOTTOM="b",r.LEFT="l",r.RIGHT="r",r))(Vt||{}),ms=(r=>(r[r.UP=0]="UP",r[r.DOWN=1]="DOWN",r))(ms||{}),Xe=(r=>(r.ENGINE="Engine",r.SCENE="Scene",r.BASE_OBJECT="BaseObject",r.SCENE_VIEWER="SceneViewer",r.CANVAS="Canvas",r.VIEWPORT="Viewport",r.LAYER="Layer",r.GROUP="Group",r))(Xe||{});const p0=r=>({sbr:.5,sbo:r,spr:.5,spo:r});class ps{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,n){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=n}static clearFontMeasureCache(e){var n;const t=e.split("/");if(t.length===1){const s=t[0];this._globalFontMeasureCache.delete(s)}else if(t.length===2){const s=t[0],o=t[1];(n=this._globalFontMeasureCache.get(s))==null||n.delete(o)}else return!1;return!0}static getFontMeasureCache(e,t){var n;return(n=this._globalFontMeasureCache[e])==null?void 0:n[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,n=!1;for(let s of this._globalFontMeasureCache){const[,o]=s;if(t+=o.size,t>e){n=!0;break}}if(n){let s=0;for(let o of this._globalFontMeasureCache){const[i,a]=o;if(s+=a.size,s>e/2){const l=s-e/2;this._clearMeasureCache(l,a);break}this._globalFontMeasureCache.delete(i)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(this._fontDataMap.size===0)return p0(t);const n=e.split(",");for(let s of n){s=s.replace(/'/g,"");const o=this._fontDataMap.get(s);if(!o)continue;const{subscriptSizeRatio:i,subscriptOffset:a,superscriptSizeRatio:l,superscriptOffset:u}=o;return{sbr:i,sbo:a*t,spr:l,spo:u*t}}return p0(t)}static _clearMeasureCache(e,t){let n=0;for(let s of t){const[o]=s;if(n>e)break;t.delete(o),n++}return!0}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let n=document.getElementById("universheetTextSizeTest");const s="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`${s};${t}`,n.innerText=e;const o=n.getBoundingClientRect(),i={width:o.width,height:o.height};return this._getTextHeightCache[t]=i,i}static _getBoundingBoxByFont(e,t=28,n=""){const s=this._fontDataMap.get(e);if(!s)return;const{notDefWidth:o,ascender:i,descender:a,typoAscender:l,typoDescender:u,strikeoutPosition:c,subscriptSizeRatio:h,subscriptOffset:d,superscriptSizeRatio:g,superscriptOffset:m,hdmxData:f,glyphHorizonMap:p}=s,b=f==null?void 0:f.indexOf(Math.floor(t)),v=p.get(n.charCodeAt(0));let w=o;if(v){const{width:S,pixelsPerEm:T=[]}=v;b?w=T[b]:w=S}return{width:w*t,ba:i*t,bd:a*t,aba:l*t,abd:u*t,sp:c*t,sbr:h,sbo:d*t,spr:g,spo:m*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:n,fontBoundingBoxAscent:s,fontBoundingBoxDescent:o,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a}=e;return{width:n,ba:s,bd:o,aba:i,abd:a,sp:(s+o)/2,sbr:.5,sbo:t,spr:.5,spo:t}}static getTextSize(e,t){const{fontString:n,fontSize:s,fontFamily:o}=t;let i=this._getBoundingBoxByFont(o,s);if(!i){const a=this.getMeasureText(e,n);i=this._calculateBoundingBoxByMeasureText(a,s)}return i}static getMeasureText(e,t){if(!this._context){const d=document.createElement("canvas");this._context=d.getContext("2d")}const n=this._context,s=this.getFontMeasureCache(t,e);if(s!=null)return s;n.font=t;const o=n.measureText(e),{width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c}=o,h={width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c};if(a==null||l==null||Number.isNaN(a)||Number.isNaN(l)){let d=this.getTextSizeByDom(g0,t)[1];n.textBaseline==="top"?(h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d,h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0):n.textBaseline==="middle"?(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=d/2,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d/2):(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d)}return this.setFontMeasureCache(t,e,h),h}}ps._globalFontMeasureCache=new Map,ps._getTextHeightCache={},ps._fontDataMap=new Map;var _0=(r=>(r[r.SPAN=0]="SPAN",r[r.DIVIDE=1]="DIVIDE",r[r.LINE=2]="LINE",r[r.COLUMN=3]="COLUMN",r[r.SECTION=4]="SECTION",r[r.PAGE=5]="PAGE",r[r.DRAWING=6]="DRAWING",r[r.BULLET=7]="BULLET",r[r.HEADER=8]="HEADER",r[r.FOOTER=9]="FOOTER",r[r.ALL=10]="ALL",r))(_0||{}),so=(r=>(r[r.SECTION=0]="SECTION",r[r.PAGE=1]="PAGE",r[r.COLUMN=2]="COLUMN",r))(so||{}),ii=(r=>(r[r.PARAGRAPH=0]="PARAGRAPH",r[r.BLOCK=1]="BLOCK",r))(ii||{}),on=(r=>(r[r.LETTER=0]="LETTER",r[r.WORD=1]="WORD",r[r.LIST=2]="LIST",r[r.TAB=3]="TAB",r[r.IMAGE=4]="IMAGE",r[r.AT=5]="AT",r[r.MATH=6]="MATH",r[r.MULTI_LINE=7]="MULTI_LINE",r[r.CUSTOM=8]="CUSTOM",r))(on||{}),rr=(r=>(r[r.VERTICAL=0]="VERTICAL",r[r.HORIZONTAL=1]="HORIZONTAL",r[r.AUTO=2]="AUTO",r))(rr||{}),b0=(r=>(r[r.PointerMove=0]="PointerMove",r[r.PointerDown=1]="PointerDown",r[r.PointerUp=2]="PointerUp",r))(b0||{});class ya{}ya.DOM_DELTA_PIXEL=0,ya.DOM_DELTA_LINE=1,ya.DOM_DELTA_PAGE=2;var Cn=(r=>(r[r.Generic=0]="Generic",r[r.Keyboard=1]="Keyboard",r[r.Mouse=2]="Mouse",r[r.Touch=3]="Touch",r))(Cn||{}),ke=(r=>(r[r.Horizontal=0]="Horizontal",r[r.Vertical=1]="Vertical",r[r.LeftClick=2]="LeftClick",r[r.MiddleClick=3]="MiddleClick",r[r.RightClick=4]="RightClick",r[r.BrowserBack=5]="BrowserBack",r[r.BrowserForward=6]="BrowserForward",r[r.MouseWheelX=7]="MouseWheelX",r[r.MouseWheelY=8]="MouseWheelY",r[r.MouseWheelZ=9]="MouseWheelZ",r[r.DeltaHorizontal=10]="DeltaHorizontal",r[r.DeltaVertical=11]="DeltaVertical",r[r.FakeMove=12]="FakeMove",r))(ke||{}),At=(r=>(r[r.translate=0]="translate",r[r.resize=1]="resize",r[r.scale=2]="scale",r[r.skew=3]="skew",r[r.flip=4]="flip",r[r.all=5]="all",r))(At||{});class v0{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new C0(e)}sampleFrame(e=this.Now()){if(!!this._enabled){if(this._lastFrameTimeMs!=null){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class C0{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let n=this._samples[this._pos];t=n-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(n-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}const A2=Math.PI/180,R2=180/Math.PI,E0="rgb(",I2="rgba(",pt=(r,e)=>r?e!=null?`${I2+r.join(",")},${e})`:`${E0+r.join(",")})`:`${E0}0,0,0)`,Er=(r,e)=>{if(W.isNumber(r))return r;if(e&&r&&W.isString(r)&&r.substr(r.length-1,1)==="%"){const t=parseFloat(r)/100;return e*t}return 0},ai=(r,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(r):e.requestAnimationFrame?e.requestAnimationFrame(r):e.msRequestAnimationFrame?e.msRequestAnimationFrame(r):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(r):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(r):e.oRequestAnimationFrame?e.oRequestAnimationFrame(r):window.setTimeout(r,16)),w0=(r,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(r):e.requestAnimationFrame?e.cancelAnimationFrame(r):e.msRequestAnimationFrame?e.msCancelAnimationFrame(r):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(r):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(r):e.oRequestAnimationFrame?e.oCancelAnimationFrame(r):window.clearTimeout(r)),Lu=()=>{let r=document.createElement("canvas");try{r.style=r.style||{}}catch(e){console.error(e)}return r},x2=()=>document.createElement("img"),T0=r=>r*R2,oo=r=>r*A2,Pu=()=>{let r="pointer";return typeof window!="undefined"&&!window.PointerEvent&&typeof navigator!="undefined"&&!navigator.pointerEnabled&&(r="mouse"),W.isTablet()&&!W.isIPhone()&&!(document&&"ontouchend"in document)&&(r="mouse"),r},S0=()=>W.getBrowserType()==="safari",y0=(r="obj",e=4)=>{let t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),n="";for(let o=0;o<e;o++)n+=t[Math.round(Math.random()*(t.length-1))];let s=new Date().getTime();return`${r}_${n}_${s}`};function Yr(r){return Object.prototype.toString.apply(r)}function Aa(r){return Yr(r)==="[object Function]"}function D2(r){return Yr(r)==="[object Date]"}function O2(r){return Yr(r)==="[object RegExp]"}function F2(r){return Yr(r)==="[object Array]"}function Hu(r){return Yr(r)==="[object String]"}function M2(r){return Yr(r)==="[object Number]"}function N2(r){return Yr(r)==="[object Object]"}function Ra(r,e){return e=10**e,Math.round(r*e)/e}function Ue(r,e){return Math.round(r*e)/e}function Ia(r,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:t,defaultFontSize:n}=e;if(!r)return{fontString:`${n}px  ${t[0]}`,fontSize:n,fontFamily:t[0]};let s=ro.ITALIC;(r.it===0||r.it===void 0)&&(s=ro.NORMAL);let o=ro.BOLD;(r.bl===0||r.bl===void 0)&&(o=ro.NORMAL);let i=n;r.fs&&(i=Math.ceil(r.fs));let a=t[0];if(r.ff){let c=r.ff;c=c.replace(/"/g,"").replace(/'/g,""),c.indexOf(" ")>-1&&(c=`"${c}"`),c==null&&(c=t[0]),a=c}const{va:l}=r;if(l===cn.SUBSCRIPT||l===cn.SUPERSCRIPT){const c=ps.getBaselineOffsetInfo(a,i),{sbr:h,spr:d}=c;i*=l===cn.SUBSCRIPT?h:d}return{fontString:`${s} ${o} ${i}px ${a}, ${h0} `,fontSize:i,fontFamily:a}}function k2(r){return r.measureText("\u7530").actualBoundingBoxAscent!=null}function A0(r){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(r)}function R0(r){return!!/[-]+|[-]+|[-]+|[a-zA-Z0-9]+|[---]+|[]+/giu.exec(r)}function B2(r){return!!/[^a-zA-Z0-9\p{Hangul}]/gi.exec(r)}function Uu(r){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(r)}function L2(r){return A0(r)||R0(r)}function P2(r){return!!/[\u0000-\u024F]/gi.exec(r)}function H2(r){return!!/[\u0000-\u007F]/gi.exec(r)}function U2(r){return!!/[\u0080-\u00FF]/gi.exec(r)}function z2(r){return!!/[\u0100-\u017F]/gi.exec(r)}function W2(r){return!!/[\u0180-\u024F]/gi.exec(r)}function zu(r){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(r)}function Wu(r){return!!/[\u0180-\u024F]/gi.exec(r)}function I0(r){return!!/\s+|\t+/g.exec(r)}let xa;function li(){if(xa)return xa;let r=56;for(;r<2e3;r++)if(matchMedia(`(max-resolution: ${r}dpi)`).matches===!0)return r;return xa=r,setTimeout(()=>{xa=null},1e3),r}const x0=72,V2=25.4;function $2(r){return r/(x0/li())}function D0(r){return r*(x0/li())}function G2(r){return r*(li()/V2)}function X2(r){return r*li()}function _s(r){const{scaleX:e=1,scaleY:t=1}=r;return Math.max(e,t)}function ui(r,e,t,n){const s=r-1,o=e-1;let i=t[s]||0,a=t[r],l=n[o]||0,u=n[e];return{startY:i,endY:a,startX:l,endX:u}}function io(r,e,t,n,s){let{startY:o,endY:i,startX:a,endX:l}=ui(r,e,t,n);const{isMerged:u,isMergedMainCell:c,newEndRow:h,newEndColumn:d,mergeRow:g,mergeColumn:m}=O0(r,e,s);let f={startRow:g,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(u&&g!==-1&&m!==-1){let p=t[g-1]||0,b=t[h],v=n[m-1]||0,w=n[d];f={...f,startY:p,endY:b,startX:v,endX:w}}else!u&&h!==-1&&d!==-1&&(i=t[h]||0,l=n[d]||0);return{isMerged:u,isMergedMainCell:c,row:r,column:e,startY:o,endY:i,startX:a,endX:l,mergeInfo:f}}function O0(r,e,t){let n=!1,s=!1,o=-1,i=-1,a=-1,l=-1;return t==null||t.forEach((u,c)=>{let h=!1;if(c==null||c.forEach((d,g)=>{const{startRow:m,endRow:f,startColumn:p,endColumn:b}=g;if(r===m&&e===p)return o=f,i=b,a=m,l=p,h=!0,s=!0,!1;if(r>=m&&r<=f&&e>=p&&e<=b)return o=f,i=b,a=m,l=p,h=!0,n=!0,!1}),h)return!1}),{isMergedMainCell:s,isMerged:n,newEndRow:o,newEndColumn:i,mergeRow:a,mergeColumn:l}}function Vu(r,e,t,n,s){const{startY:o,endY:i,startX:a,endX:l}=r;return r.startY=Ue(o+t,s),r.endY=Ue(i+t,s),r.startX=Ue(a+e,n),r.endX=Ue(l+e,n),{...r}}function F0(r,e){return!(r.left>e.right||r.top>e.bottom||e.left>r.right||e.top>r.bottom)}function M0(r){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet;for(let n of r)t==null||t.insertRule(n,t.cssRules.length)}function N0(r){for(let e=0,t=document.head.childNodes.length;e<t;e++){const n=document.head.childNodes[e];if(n.nodeName==="STYLE"&&n.textContent&&n.textContent.indexOf(r)>-1)return!0}return!1}function bs(r){return Number(r.replace(/px/gi,""))}function k0(r){const e=getComputedStyle(r),{borderTopWidth:t,borderLeftWidth:n,borderRightWidth:s,borderBottomWidth:o,width:i,height:a}=e;return{top:bs(t),left:bs(n),right:bs(s),bottom:bs(o),width:bs(i),height:bs(a)}}class xe{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return xe.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new xe(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new xe(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new xe(this.x-e.x,this.y-e.y)}subtractByPoint(e,t){return new xe(this.x-e,this.y-t)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new xe(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new xe(this.x*e,this.y*t)}divide(e){return new xe(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new xe(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new xe(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new xe(Math.floor(this.x),Math.floor(this.y))}fract(){return new xe(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=t*this.x-n*this.y,o=n*this.x+t*this.y;return this.x=s,this.y=o,this}rotateToRef(e,t){const n=Math.cos(e),s=Math.sin(e);return t.x=n*this.x-s*this.y,t.y=s*this.x+n*this.y,this}rotateByPoint(e,t=xe.create(0,0)){const n=Math.cos(e),s=Math.sin(e),o=t.x+(this.x-t.x)*n-(this.y-t.y)*s,i=t.y+(this.x-t.x)*s+(this.y-t.y)*n;return this.x=o,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=Math.atan2(this.y,this.x),s=-e+n;return this.x=t*Math.cos(s),this.y=t*Math.sin(s),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return xe.NormalizeToRef(this,this),this}clone(){return new xe(this.x,this.y)}static Zero(){return new xe(0,0)}static One(){return new xe(1,1)}static FromArray(e,t=0){return new xe(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,s,o){let i=o*o,a=o*i,l=.5*(2*t.x+(-e.x+n.x)*o+(2*e.x-5*t.x+4*n.x-s.x)*i+(-e.x+3*t.x-3*n.x+s.x)*a),u=.5*(2*t.y+(-e.y+n.y)*o+(2*e.y-5*t.y+4*n.y-s.y)*i+(-e.y+3*t.y-3*n.y+s.y)*a);return new xe(l,u)}static Clamp(e,t,n){let s=e.x;s=s>n.x?n.x:s,s=s<t.x?t.x:s;let o=e.y;return o=o>n.y?n.y:o,o=o<t.y?t.y:o,new xe(s,o)}static Hermite(e,t,n,s,o){let i=o*o,a=o*i,l=2*a-3*i+1,u=-2*a+3*i,c=a-2*i+o,h=a-i,d=e.x*l+n.x*u+t.x*c+s.x*h,g=e.y*l+n.y*u+t.y*c+s.y*h;return new xe(d,g)}static Hermite1stDerivative(e,t,n,s,o){let i=xe.Zero();return this.Hermite1stDerivativeToRef(e,t,n,s,o,i),i}static Hermite1stDerivativeToRef(e,t,n,s,o,i){const a=o*o;i.x=(a-o)*6*e.x+(3*a-4*o+1)*t.x+(-a+o)*6*n.x+(3*a-2*o)*s.x,i.y=(a-o)*6*e.y+(3*a-4*o+1)*t.y+(-a+o)*6*n.y+(3*a-2*o)*s.y}static Lerp(e,t,n){let s=e.x+(t.x-e.x)*n,o=e.y+(t.y-e.y)*n;return new xe(s,o)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=xe.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();n!==0&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,s=e.y<t.y?e.y:t.y;return new xe(n,s)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,s=e.y>t.y?e.y:t.y;return new xe(n,s)}static Transform(e,t,n=!1){const s=t,o=e;return n?new xe(s[0]*o.x+s[2]*o.y,s[1]*o.x+s[3]*o.y):new xe(s[0]*o.x+s[2]*o.y+s[4],s[1]*o.x+s[3]*o.y+s[5])}static PointInTriangle(e,t,n,s){let o=.5*(-n.y*s.x+t.y*(-n.x+s.x)+t.x*(n.y-s.y)+n.x*s.y),i=o<0?-1:1,a=(t.y*s.x-t.x*s.y+(s.y-t.y)*e.x+(t.x-s.x)*e.y)*i,l=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return a>0&&l>0&&a+l<2*o*i}static Distance(e,t){return Math.sqrt(xe.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,s=e.y-t.y;return n*n+s*s}static Center(e,t){return xe.CenterToRef(e,t,xe.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let s=xe.DistanceSquared(t,n);if(s===0)return xe.Distance(e,t);let o=n.subtract(t),i=Math.max(0,Math.min(1,xe.Dot(e.subtract(t),o)/s)),a=t.add(o.multiplyByFloats(i,i));return xe.Distance(e,a)}static create(e,t){return new xe(e,t)}}const Da=[1,0,0,1,0,0];class Lt{constructor(e=Da){this.dirty=!1,this._m=e&&e.slice()||Da}static create(e=Da){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new Lt(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const n=this._m;let s=n[0]*e.x+n[2]*e.y,o=n[1]*e.x+n[3]*e.y;return t?new xe(s,o):new xe(s+n[4],o+n[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=oo(e);let n=Math.cos(t),s=Math.sin(t),o=this._m[0]*n+this._m[2]*s,i=this._m[1]*n+this._m[3]*s,a=this._m[0]*-s+this._m[2]*n,l=this._m[1]*-s+this._m[3]*n;return this._m[0]=o,this._m[1]=i,this._m[2]=a,this._m[3]=l,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let n=this._m[0]+this._m[2]*t,s=this._m[1]+this._m[3]*t,o=this._m[2]+this._m[0]*e,i=this._m[3]+this._m[1]*e;return this._m[0]=n,this._m[1]=s,this._m[2]=o,this._m[3]=i,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],n=this._m[1]*e._m[0]+this._m[3]*e._m[1],s=this._m[0]*e._m[2]+this._m[2]*e._m[3],o=this._m[1]*e._m[2]+this._m[3]*e._m[3],i=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],a=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=o,this._m[4]=i,this._m[5]=a,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,n=-this._m[1]*e,s=-this._m[2]*e,o=this._m[0]*e,i=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),a=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=o,this._m[4]=i,this._m[5]=a,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(t=>Ra(t,e))}setAbsolutePosition(e){let t=this._m[0],n=this._m[1],s=this._m[2],o=this._m[3],i=this._m[4],a=this._m[5],l=(t*(e.y-a)-n*(e.x-i))/(t*o-n*s),u=(e.x-i-s*l)/t;return this.translate(u,l)}decompose(){let e=this._m[0],t=this._m[1],n=this._m[2],s=this._m[3],o=this._m[4],i=this._m[5],a=e*s-t*n,l={x:o,y:i,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||t!==0){let u=Math.sqrt(e*e+t*t);l.angle=t>0?Math.acos(e/u):-Math.acos(e/u),l.scaleX=u,l.scaleY=a/u,l.skewX=(e*n+t*s)/a,l.skewY=0}else if(n!==0||s!==0){let u=Math.sqrt(n*n+s*s);l.angle=Math.PI/2-(s>0?Math.acos(-n/u):-Math.acos(n/u)),l.scaleX=a/u,l.scaleY=u,l.skewX=0,l.skewY=(e*n+t*s)/a}return l.angle=T0(l.angle),l}makeBoundingBoxFromPoints(e){if(this)for(let c=0;c<e.length;c++)e[c]=this.applyPoint(e[c]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],n=Math.min(...t),o=Math.max(...t)-n,i=[e[0].y,e[1].y,e[2].y,e[3].y],a=Math.min(...i),u=Math.max(...i)-a;return{left:n,top:a,width:o,height:u,points:e}}composeMatrix(e){const t=new Lt([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}_calcDimensionsMatrix(e){var o,i;const t=(o=e.scaleX)!=null?o:1,n=(i=e.scaleY)!=null?i:1,s=new Lt([e.flipX?-t:t,0,0,e.flipY?-n:n,0,0]);return e.skewX&&s.multiply(new Lt([1,0,Math.tan(oo(e.skewX)),1,0,0])),e.skewY&&s.multiply(new Lt([1,Math.tan(oo(e.skewY)),0,1,0,0])),s}clone(){return new Lt([...this._m])}}function $u(r,e,t){let n=0,s=0,o=0,i=0;const{startX:a,startY:l,endX:u,endY:c}=t;e===Vt.TOP?(n=a,s=l,o=u,i=l):e===Vt.BOTTOM?(n=a,s=c,o=u,i=c):e===Vt.LEFT?(n=a,s=l,o=a,i=c):e===Vt.RIGHT&&(n=u,s=l,o=u,i=c),r.beginPath(),r.moveTo(n,s),r.lineTo(o,i),r.stroke()}function Gu(r,e){e===C.HAIR?r.setLineDash([1,2]):e===C.DASH_DOT_DOT||e===C.MEDIUM_DASH_DOT_DOT?r.setLineDash([2,2,5,2,2]):e===C.DASH_DOT||e===C.MEDIUM_DASH_DOT||e===C.SLANT_DASH_DOT?r.setLineDash([2,5,2]):e===C.DOTTED?r.setLineDash([2]):e===C.DASHED||e===C.MEDIUM_DASHED?r.setLineDash([3]):r.setLineDash([0])}function Xu(r){let e=1;return r===C.MEDIUM||r===C.MEDIUM_DASH_DOT||r===C.MEDIUM_DASHED||r===C.MEDIUM_DASH_DOT_DOT?e=2:r===C.THICK&&(e=3),e}function wr(r,e,t,n,s=xe.create(0,0)){const o=r.add(e).rotateByPoint(n),i=o.subtract(e),a=n-t;return i.rotateByPoint(a,o).add(s).transformCoordinateOnRotate(a)}function Yu(r){return r>0?ms.DOWN:ms.UP}function ju(r,e,t){const n=[];let s=0,o=0,i=0,a=0,l=0;const u=Yu(t),c=r.length;t=Math.abs(t);const h=Math.tan(t),d=Math.sin(t),g=Math.cos(t);if(u===ms.UP){let m=0;for(let f=0;f<c;f++){const p=r[f],{lineHeight:b=0}=p;m+=f===0?0:b;const v=(b/h+e)*d;n.push(m/h),v>o&&(o=v),f===0&&(i+=b*d,l+=b*g)}i+=m/d+e*g,l-=o}else{let m=0,f=-1;const p=[];for(let w=c-1;w>=0;w--){const S=r[w],{lineHeight:T=0}=S,D=T/h,R=(e+D)*d;p.unshift(T/h),R>o&&(o=R,m=D,f=w),w===0?i+=T*d:w===c-1?i+=e*g+T/d:i+=T/d}let b=r[f].lineHeight||0,v=0;for(let w=f+1;w<=c-1;w++){const S=r[w],{lineHeight:T=0}=S;b+=T,v+=p[w]||0,n[w]=-v}v=0;for(let w=f-1;w>=0;w--){const S=r[w],{lineHeight:T=0}=S;v+=p[w+1]||0,n[w]=v,s+=T}n[f]=0,c===1&&(i+=e*g),a=b/d-m*g}return{rotateTranslateXList:n,rotatedHeight:o,rotatedWidth:i,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:s}}const B0=[new xe(0,0),new xe(1,1)];class L0{constructor(e=B0){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let n=1;n<this._lines.length;n++){const s=this._lines[n-1],o=this._lines[n];for(let i=1;i<e.length;i++){const a=this._lines[n-1],l=this._lines[n],u=this._intersection({from:s,to:o},{from:a,to:l});u&&t.push(u)}}return t}_intersection(e,t){const n=e.from,s=e.to,o=t.from,i=t.to;let a=(n.x-o.x)*(s.y-o.y)-(n.y-o.y)*(s.x-o.x),l=(n.x-i.x)*(s.y-i.y)-(n.y-i.y)*(s.x-i.x);if(a*l>=0)return!1;let u=(o.x-n.x)*(i.y-n.y)-(o.y-n.y)*(i.x-n.x),c=u+a-l;if(u*c>=0)return!1;let h=u/(l-a),d=h*(s.x-n.x),g=h*(s.y-n.y);return new xe(n.x+d,n.y+g)}}class Y2 extends sn{dealWidthCustomBlock(e,t,n,s,o){return[]}onMapping(e){}onMounted(e){}onDestroy(){}}class j2 extends sn{dealWidthCustomBulletOrderedSymbol(e,t,n){return""}onMapping(e){}onMounted(e){}onDestroy(){}}const K2="documentCustomBlock",Z2="documentCustomBullet";function P0(r,e,t,n,s,o){if(!o)return[];const i=o.getPluginManager().getPluginByName(K2);return i?i.dealWidthCustomBlock(r,e,t,n,s):[]}function H0(r,e,t,n){if(!n)return"";const s=n.getPluginManager().getPluginByName(Z2);return s?s.dealWidthCustomBulletOrderedSymbol(r,e,t):""}const Oa=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class jr{constructor(e){this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new Lt,this._dirty=!0,this._cursor=ht.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this.isInGroup=!1,this.onTransformChangeObservable=new ye,this.onPointerDownObserver=new ye,this.onPointerMoveObserver=new ye,this.onPointerUpObserver=new ye,this.onDblclickObserver=new ye,this.onMouseWheelObserver=new ye,this.onPointerOutObserver=new ye,this.onPointerLeaveObserver=new ye,this.onPointerOverObserver=new ye,this.onPointerEnterObserver=new ye,this.onIsAddedToParentObserver=new ye,this.onDisposeObserver=new ye,e?this._oKey=e:this._oKey=y0()}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout(()=>{var t;(t=this.parent)==null||t.makeDirty(e)},0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&((t=this.parent)==null||t.makeDirty(e)),this}isDirty(){return this._dirty}get transform(){return this._transform}set transform(e){this._transform=e}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return Xe.BASE_OBJECT}translate(e,t){const n=this.top;t!==void 0&&(this.top=t);const s=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:s}}),this}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:s}}),this}skew(e,t){const n=e;e!==void 0&&(this.skewX=e);const s=t;return t!==void 0&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:s}}),this}flip(e,t){const n=e;e!==void 0&&(this.flipX=e);const s=t;return t!==void 0&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:s}}),this}transformByState(e){const t=Object.keys(e),n={};if(t.length!==0)return t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.all,value:e,preValue:n}),this}isRender(e){return this._forceRender?!1:e&&!this.isInGroup}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}_setTransForm(){const e=Lt.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}get top(){return this._top}set top(e){var t;this._topOrigin=e,this._top=Er(e,(t=this._parent)==null?void 0:t.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Er(e,(t=this._parent)==null?void 0:t.width)}get width(){return this._width}set width(e){var t;this._widthOrigin=e,this._width=Er(e,(t=this._parent)==null?void 0:t.width)}get height(){return this._height}set height(e){var t;this._heightOrigin=e,this._height=Er(e,(t=this._parent)==null?void 0:t.height)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e}get angle(){return this._angle}set angle(e){this._angle=e}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}get ancestorScaleX(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}set skewX(e){this._skewX=e}get skewY(){return this._skewY}set skewY(e){this._skewY=e}get flipX(){return this._flipX}set flipX(e){this._flipX=e}get flipY(){return this._flipY}set flipY(e){this._flipY=e}get parent(){return this._parent}set parent(e){this._parent=e}getParent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}get evented(){return this._evented}set evented(e){this._evented=e}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}set debounceParentDirty(e){this._debounceParentDirty=e}get isTransformer(){return this._isTransformer}set isTransformer(e){this._isTransformer=e}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,n;return(t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerMove(e),!1)}triggerPointerDown(e){var t,n;return(t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerDown(e),!1)}triggerPointerUp(e){var t,n;return(t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerUp(e),!1)}triggerDblclick(e){var t,n;return(t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerDblclick(e),!1)}triggerMouseWheel(e){var t,n;return(t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerMouseWheel(e),!1)}triggerPointerOut(e){var t,n;return(t=this.onPointerOutObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t,n;return(t=this.onPointerLeaveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return this.onPointerOverObserver.notifyObservers(e)?!0:((t=this._parent)==null||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t,n;return(t=this.onPointerEnterObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return Oa.forEach(t=>{this[t]&&(e[t]=this[t])}),e}getScene(){let e=this.parent;if(e!=null){if(e.classType===Xe.SCENE)return e;for(;e;){if(e.classType===Xe.SCENE)return e;e=e.getParent()}}}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(ht.DEFAULT)}setCursor(e){var t;this._cursor=e,(t=this.getScene())==null||t.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===Xe.ENGINE)return e;e=e.getParent()}return null}}function ao(r){const e=r.getScene(),t=r.getViewportByCoord(e);let n=0,s=0;if(!t)return{scrollX:n,scrollY:s};const o=t.getActualScroll(t.scrollX,t.scrollY);return{scrollX:o.x,scrollY:o.y}}function q2(r){let e=r.getBoundingClientRect(),t=document.body,n=document.documentElement,s=window.pageYOffset||n.scrollTop||t.scrollTop,o=window.pageXOffset||n.scrollLeft||t.scrollLeft,i=n.clientTop||t.clientTop,a=n.clientLeft||t.clientLeft,l=e.top+s-i,u=e.left+o-a;return{top:l,left:u}}function ci(r,e){const t=r.transform.clone().invert().applyPoint(e.tl),n=r.transform.clone().invert().applyPoint(e.tr),s=r.transform.clone().invert().applyPoint(e.bl),o=r.transform.clone().invert().applyPoint(e.br),i=[t.x,n.x,s.x,o.x],a=[t.y,n.y,s.y,o.y],l=Math.max(...i),u=Math.min(...i),c=Math.max(...a),h=Math.min(...a);return{minX:u,maxX:l,minY:h,maxY:c}}class J2 extends jr{constructor(e,t=s=>{},n){super(e),this._render=t,this._isHitCustom=n}toJson(){return{...super.toJson()}}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const{minX:s,maxX:o,minY:i,maxY:a}=ci(this,t);if(this.width+this.strokeWidth<s||o<0||this.height+this.strokeWidth<i||a<0)return this}const n=this.transform.getMatrix();return e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._render(e),e.restore(),this.makeDirty(!1),this}isHit(e){return this._isHitCustom?this._isHitCustom(e):super.isHit(e)}}function Ku(){let r=1,t=Lu().getContext("2d");return r=(()=>{let n=window.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/s})(),r<1?1:Math.ceil(r*10)/10}class Tr{constructor(e){this._pixelRatio=1,this._width=0,this._height=0,this.isCache=!1,e=e||{},this._canvasEle=Lu(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,n){this._pixelRatio=n||Ku(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch{try{return this._canvasEle.toDataURL()}catch(s){const{message:o}=s;return console.error(`Unable to get data URL. ${o} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class Q2 extends Tr{constructor(e={width:0,height:0}){super(e),this.setSize(e.width,e.height)}}class ev extends Tr{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.setSize(e.width,e.height)}}class Zu{constructor(e=100,t=100){this._canvas=new Tr,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onInputChangedObservable=new ye,this.renderEvenInBackground=!0,this._usingSafari=S0(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new v0,this.onBeginFrameObservable=new ye,this.onEndFrameObservable=new ye,this.onTransformChangeObservable=new ye,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=navigator.userAgent.indexOf("Firefox")!==-1,this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return Xe.ENGINE}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return this._activeScene!=null}get activeScene(){return this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:e,height:t}=k0(this._container);this.resizeBySize(e,t)}resizeBySize(e,t){const n=this.width,s=this.height;this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:At.resize,value:{width:e,height:t},preValue:{width:n,height:s}})}dispose(){const e=this.getScenes();Object.keys(e).forEach(s=>{e[s].dispose()});const n=Pu();this._canvasEle.removeEventListener(`${n}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${n}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${n}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(e){const t=this.getScenes();if(t[e]){const n=t[e];return delete t[e],n}}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=ai(this._renderFunction)))}get requestNewFrameHandler(){return this._requestNewFrameHandler}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=ai(this._renderFunction):this._renderingQueueLaunched=!1}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}get frameId(){return this._frameId}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){let t=this._activeRenderLoops[e];t()}}_handleKeyboardAction(){const e=n=>{let s=n;s.deviceType=Cn.Keyboard,s.inputIndex=n.keyCode,s.previousState=0,s.currentState=1,this.onInputChangedObservable.notifyObservers(s)},t=n=>{let s=n;s.deviceType=Cn.Keyboard,s.inputIndex=n.keyCode,s.previousState=1,s.currentState=0,this.onInputChangedObservable.notifyObservers(s)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",t)}_handlePointerAction(){const e=Pu();this._pointerMoveEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[ke.Horizontal],o=this.__pointer[ke.Vertical],i=this.__pointer[ke.DeltaHorizontal],a=this.__pointer[ke.DeltaVertical];this.__pointer[ke.Horizontal]=t.clientX,this.__pointer[ke.Vertical]=t.clientY,this.__pointer[ke.DeltaHorizontal]=t.movementX,this.__pointer[ke.DeltaVertical]=t.movementY;let l=t;l.deviceType=n,s!==t.clientX&&(l.inputIndex=ke.Horizontal,l.previousState=s,l.currentState=this.__pointer[ke.Horizontal],this.onInputChangedObservable.notifyObservers(l)),o!==t.clientY&&(l.inputIndex=ke.Vertical,l.previousState=o,l.currentState=this.__pointer[ke.Vertical],this.onInputChangedObservable.notifyObservers(l)),this.__pointer[ke.DeltaHorizontal]!==0&&(l.inputIndex=ke.DeltaHorizontal,l.previousState=i,l.currentState=this.__pointer[ke.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(l)),this.__pointer[ke.DeltaVertical]!==0&&(l.inputIndex=ke.DeltaVertical,l.previousState=a,l.currentState=this.__pointer[ke.DeltaVertical],this.onInputChangedObservable.notifyObservers(l)),!this._usingSafari&&t.button!==-1&&(l.inputIndex=t.button+2,l.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,l.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(l))},this._pointerDownEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[ke.Horizontal],o=this.__pointer[ke.Vertical],i=this.__pointer[t.button+2];n===Cn.Mouse?(this.__mouseId===-1&&(t.pointerId===void 0?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[ke.Horizontal]=t.clientX,this.__pointer[ke.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let a=t;a.deviceType=n,s!==t.clientX&&(a.inputIndex=ke.Horizontal,a.previousState=s,a.currentState=this.__pointer[ke.Horizontal],this.onInputChangedObservable.notifyObservers(a)),o!==t.clientY&&(a.inputIndex=ke.Vertical,a.previousState=o,a.currentState=this.__pointer[ke.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=i,a.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(a)},this._pointerUpEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[ke.Horizontal],o=this.__pointer[ke.Vertical],i=this.__pointer[t.button+2];this.__pointer[ke.Horizontal]=t.clientX,this.__pointer[ke.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let a=t;a.deviceType=n,s!==t.clientX&&(a.inputIndex=ke.Horizontal,a.previousState=s,a.currentState=this.__pointer[ke.Horizontal],this.onInputChangedObservable.notifyObservers(a)),o!==t.clientY&&(a.inputIndex=ke.Vertical,a.previousState=o,a.currentState=this.__pointer[ke.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=i,a.currentState=this.__pointer[t.button+2],n===Cn.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(a),n!==Cn.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const n=Cn.Mouse;let s=this.__pointer[ke.MouseWheelX],o=this.__pointer[ke.MouseWheelY],i=this.__pointer[ke.MouseWheelZ];this.__pointer[ke.MouseWheelX]=t.deltaX||0,this.__pointer[ke.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[ke.MouseWheelZ]=t.deltaZ||0;let a=t;a.deviceType=n,this.__pointer[ke.MouseWheelX]!==0&&(a.inputIndex=ke.MouseWheelX,a.previousState=s,a.currentState=this.__pointer[ke.MouseWheelX],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[ke.MouseWheelY]!==0&&(a.inputIndex=ke.MouseWheelY,a.previousState=o,a.currentState=this.__pointer[ke.MouseWheelY],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[ke.MouseWheelZ]!==0&&(a.inputIndex=ke.MouseWheelZ,a.previousState=i,a.currentState=this.__pointer[ke.MouseWheelZ],this.onInputChangedObservable.notifyObservers(a))},this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const n={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,n),this._canvasEle.removeEventListener("test",t,n)}catch{}return e}__getPointerType(e){let t=Cn.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(t=Cn.Touch),t}}class lo{constructor(e,t=[],n=1){this._scene=e,this._zIndex=n,this._objects=[],this.addObjects(t)}static create(e,t=[],n=1e3){return new this(e,t,n)}get scene(){return this._scene}get zIndex(){return this._zIndex}getObjectsByOrder(){const e=[];this._objects.sort(yt);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(yt);for(let t of this._objects)t.classType!==Xe.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===Xe.GROUP){const t=e.getObjects();for(let n of t)this.scene.getObject(n.oKey)||(this._objects.push(n),this.scene.setObjectBehavior(n))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),this}removeObject(e){const t=this.getObjects(),n=t.length;if(e instanceof jr){for(let s=0;s<n;s++)if(t[s]===e){t.splice(s,1);return}}else for(let s=0;s<n;s++)if(t[s].oKey===e){t.splice(s,1);return}}addObjects(e){return e.forEach(t=>{this.addObject(t)}),this}clear(){this._objects=[]}dispose(){this.getObjects().forEach(e=>{e.dispose()}),this.clear()}}const Fa=class{constructor(r){this._alreadyAttached=!1,this._startingPosition=new xe(1/0,1/0),this._doubleClickOccurred=0,this._scene=r}_getCurrentObject(r,e){var t;return(t=this._scene)==null?void 0:t.pick(xe.FromArray([r,e]))}_checkDirectSceneEventTrigger(r,e){let t=!1;e==null&&(t=!0);let n=!0;if(e&&e.classType===Xe.BASE_OBJECT){const s=e.getScene();s&&(n=s.getParent().classType!==Xe.SCENE_VIEWER)}return!this._scene.evented&&r&&n||t}mouseLeaveEnterHandler(r,e){var t;if(r==null)(t=this._currentMouseEnterPicked)==null||t.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(r!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=r,n==null||n.triggerPointerLeave(e),r==null||r.triggerPointerEnter(e)}}attachControl(r=!0,e=!0,t=!0,n=!0){const s=this._scene.getEngine();!s||(this._onPointerMove=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerMove(o);this.mouseLeaveEnterHandler(i,o),this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(o)},this._onPointerDown=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerDown(o);this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(o)},this._onPointerUp=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerUp(o);this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(o),this._prePointerDoubleClick(o)},this._onMouseWheel=o=>{const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerMouseWheel(o);this._scene.getViewports().forEach(l=>{l.onMouseWheelObserver.hasObservers()&&l.onMouseWheelObserver.notifyObservers(o)}),this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(o)},this._onKeyDown=o=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(o)},this._onKeyUp=o=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(o)},this._onInputObserver=s.onInputChangedObservable.add(o=>{const i=o;o.deviceType===Cn.Keyboard&&(o.currentState===1&&this._onKeyDown(i),o.currentState===0&&this._onKeyUp(i)),(o.deviceType===Cn.Mouse||o.deviceType===Cn.Touch)&&(r&&o.inputIndex>=ke.LeftClick&&o.inputIndex<=ke.RightClick&&o.currentState===1&&this._onPointerDown(i),e&&o.inputIndex>=ke.LeftClick&&o.inputIndex<=ke.RightClick&&o.currentState===0&&this._onPointerUp(i),t&&(o.inputIndex===ke.Horizontal||o.inputIndex===ke.Vertical||o.inputIndex===ke.DeltaHorizontal||o.inputIndex===ke.DeltaVertical)?this._onPointerMove(i):n&&(o.inputIndex===ke.MouseWheelX||o.inputIndex===ke.MouseWheelY||o.inputIndex===ke.MouseWheelZ)&&this._onMouseWheel(i))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const r=this._scene.getEngine();!r||(r.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_isPointerSwiping(r,e){return Math.abs(this._startingPosition.x-r)>Fa.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>Fa.DragMovementThreshold}_prePointerDoubleClick(r){var s,o;const{clientX:e,clientY:t}=r;if(this._doubleClickOccurred===0&&(this._startingPosition.x=e,this._startingPosition.y=t),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout(()=>{this._resetDoubleClickParam()},Fa.DoubleClickDelay),this._doubleClickOccurred<2)return;if(this._isPointerSwiping(e,t)){this._resetDoubleClickParam();return}(o=(s=this._scene)==null?void 0:s.pick(xe.FromArray([r.offsetX,r.offsetY])))==null||o.triggerDblclick(r),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(r),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",r)}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let uo=Fa;uo.DragMovementThreshold=10,uo.LongPressDelay=500,uo.DoubleClickDelay=300,uo.ExclusiveDoubleClickMode=!1;class hi extends jr{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}set cursor(e){this.setCursor(e)}get classType(){return Xe.GROUP}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(Hu(e)){const n=this.getScene();if(t=n==null?void 0:n.getObject(e),!t){console.info("No object be added");return}t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),n=t.length;if(Hu(e))for(let s=0;s<n;s++){const o=t[s];if(o.oKey===e){t.splice(s,1),this.parent.removeObject(o);return}}else for(let s=0;s<n;s++){const o=t[s];if(o===e){t.splice(s,1),this.parent.removeObject(o);return}}}getObjectsByOrder(){const e=[];this._objects.sort(yt);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const n=this.transform.getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(yt);for(let s of this._objects)s.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}_transformBounds(e){return e}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}}class Kr{constructor(e,t,n=.05,s=.05){this._scene=e,this._padding=t,this._smoothRatioX=n,this._smoothRatioY=s,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:20})}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(e==null?void 0:e.top)||0,n=t+((e==null?void 0:e.height)||0),s=(e==null?void 0:e.left)||0,o=s+((e==null?void 0:e.width)||0),{t:i=0,b:a=0,r:l=0,l:u=0}=this._padding;let c=0,h=0;this._moveX<s+u&&(c=(this._moveX-s-u)*this._smoothRatioX),this._moveX>o-l&&(c=(this._moveX-o+l)*this._smoothRatioX),this._moveY<t+i&&(h=(this._moveY-t-i)*this._smoothRatioY),this._moveY>n-a&&(h=(this._moveY-n+a)*this._smoothRatioY);const d=e==null?void 0:e.scrollBy({x:c,y:h}),g=e==null?void 0:e.getActualScroll(c,h);if(this._scrollX=(g==null?void 0:g.x)||0,this._scrollY=(g==null?void 0:g.y)||0,d){const m=this._findAncestorScene(e==null?void 0:e.scene),f=this.getViewportByCoord(m);f&&this._scroll(f)}}scrolling(e,t,n){this._moveX=e,this._moveY=t,this._scrollFunction=n}stopScroll(){w0(this._requestNewFrameNumber)}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=ai(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=e==null?void 0:e.getParent();for(;t;){if(t.classType===Xe.SCENE)return t;t=(t==null?void 0:t.getParent)&&(t==null?void 0:t.getParent())}}getViewportByCoord(e){const t=e==null?void 0:e.getViewports();return t==null?void 0:t.find(n=>n.isHit(xe.FromArray([this._offsetX,this._offsetY])))}getScene(){return this._scene}static create(e,t){return new Kr(e,t)}}const U0=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class co extends jr{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new Tr,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:s,maxX:o,minY:i,maxY:a}=ci(this,t);if(this.width+this.strokeWidth<s||o<0||this.height+this.strokeWidth<i||a<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const s=this._cacheCanvas.getContext();this._cacheCanvas.clear(),s.save(),s.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(s),s.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const n={};let s=!1;t.forEach(o=>{if(e[o]===void 0)return!0;Oa.indexOf(o)>-1?(n[o]=e[o],s=!0):this[`_${o}`]=e[o]}),s&&this.transformByState(n),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(n=>{if(e[n]===void 0)return!0;Oa.indexOf(n)===-1&&(this[`_${n}`]=e[n])}),this.makeDirty(!0),this}resizeCacheCanvas(){var e;(e=this._cacheCanvas)==null||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var n,s,o;let e=((n=this.getParent())==null?void 0:n.ancestorScaleX)||1,t=((s=this.getParent())==null?void 0:s.ancestorScaleX)||1;(o=this._cacheCanvas)==null||o.setPixelRatio(Math.max(e,t)*Ku()),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}static _renderPaintInOrder(e,t){t.paintFirst==="stroke"?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){!t.fill||(e.save(),this.__setFillStyles(e,t),t.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:n,strokeWidth:s,shadowEnabled:o,shadowForStrokeEnabled:i,strokeScaleEnabled:a,scaleX:l,scaleY:u,parent:c}=t;if(!(!n||s===0)){if(o&&!i&&this.__removeShadow(e),e.save(),a&&c){let h=this.__getObjectScaling();e.scale(1/h.scaleX,1/h.scaleY)}else a&&(l=l!=null?l:1,u=u!=null?u:1,e.scale(1/l,1/u));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:n,strokeLineCap:s,strokeDashOffset:o,strokeLineJoin:i,strokeMiterLimit:a,stroke:l}=t;e.lineWidth=n,e.lineCap=s,e.lineDashOffset=o,e.lineJoin=i,e.miterLimit=a,e.strokeStyle=l}static __setLineDash(e){}static drawWith(e,t){}toJson(){const e={};return U0.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const z0=["radius"];class tt extends co{constructor(e,t){super(e,t),t!=null&&t.radius&&(this._radius=t==null?void 0:t.radius)}get radius(){return this._radius}_draw(e){tt.drawWith(e,this)}static drawWith(e,t){let{radius:n,width:s,height:o}=t;if(n=n!=null?n:0,s=s!=null?s:30,o=o!=null?o:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),!n)e.rect(0,0,s,o);else{let i=0,a=0,l=0,u=0;i=a=l=u=Math.min(n,s/2,o/2),e.moveTo(i,0),e.lineTo(s-a,0),e.arc(s-a,a,a,Math.PI*3/2,0,!1),e.lineTo(s,o-u),e.arc(s-u,o-u,u,0,Math.PI/2,!1),e.lineTo(l,o),e.arc(l,o-l,l,Math.PI/2,Math.PI,!1),e.lineTo(0,i),e.arc(i,i,i,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return z0.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}class tv{}class nv{}class rv{}const W0=["pointsGroup"];class Ma extends co{constructor(e,t){super(e,t),this._pointsGroup=(t==null?void 0:t.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:o,preValue:i}=n;(s===At.resize||s===At.all)&&this.resizePolygon(i)})}get pointsGroup(){return this._pointsGroup}_draw(e){Ma.drawWith(e,this)}static drawWith(e,t){let{pointsGroup:n}=t;n=n!=null?n:[[]],t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath();for(let s of n){e.moveTo(s[0].x,s[0].y);for(let o=1;o<s.length;o++){const i=s[o];e.lineTo(i.x,i.y)}}e.closePath(),this._renderPaintInOrder(e,t)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:t,top:n,width:s,height:o}=this._getSelfRect(),{width:i,height:a}=e;let l,u;i?l=this.width-i:l=0,a?u=this.height-a:u=0;const c=l/s,h=u/o;this.scaleX+=c,this.scaleY+=h,this.left=this.left-t*c,this.top=this.top-n*h,this._setTransForm()}toJson(){const e={};return W0.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:n,height:s}=this.getRect();return{left:e,top:t,width:n,height:s,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:s}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:s*this.scaleY}}_setFixBoundingBox(){const{width:e,height:t,left:n,top:s}=this._getSelfRect();this.left=this.left+n,this.top=this.top+s,this.width=e,this.height=t;const o=this.pointsGroup;for(let i of o)for(let a of i)a.x-=n,a.y-=s;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let t=e[0][0].x,n=e[0][0].x,s=e[0][0].y,o=e[0][0].y;for(let i of e)for(let a of i)t=Math.min(t,a.x),n=Math.max(n,a.x),s=Math.min(s,a.y),o=Math.max(o,a.y);return{left:t,top:s,width:n-t,height:o-s}}}const ho=17;class Zr{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=pt(Wn.black,.2),this._thumbHoverBackgroundColor=pt(Wn.black,.35),this._thumbActiveBackgroundColor=pt(Wn.black,.4),this._barSize=14,this._barBackgroundColor=pt(Wn.white),this._barBorder=1,this._barBorderColor=pt([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}setProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{e[n]!==void 0&&(this[`_${n}`]=e[n])})}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new tt("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new tt("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new tt("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new tt("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new tt("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(n,s)=>(o,i)=>{if(this._isHorizonMove||this._isVerticalMove)return;s.setProps({fill:n}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(Bt.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(Bt.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(Bt.PointerDown,(n,s)=>{const o=n;this._view.scrollTo({x:o.offsetX-this._view.left-this._horizontalThumbWidth/2}),s.stopPropagation()}),this._horizonThumbRect.on(Bt.PointerDown,(n,s)=>{const o=n;this._isHorizonMove=!0,this._lastX=o.offsetX,this._lastY=o.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),e.disableEvent(),s.stopPropagation()}),e.on(Bt.PointerMove,(n,s)=>{const o=n;!this._isHorizonMove||(this._view.scrollBy({x:o.offsetX-this._lastX}),this._lastX=o.offsetX)}),e.on(Bt.PointerUp,(n,s)=>{const o=this._horizonThumbRect;this._isHorizonMove=!1,e.enableEvent(),o.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})),this._enableVertical&&(this._verticalThumbRect.on(Bt.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(Bt.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(Bt.PointerDown,(n,s)=>{const o=n;this._view.scrollTo({y:o.offsetY-this._view.top-this._verticalThumbHeight/2}),s.stopPropagation()}),this._verticalThumbRect.on(Bt.PointerDown,(n,s)=>{const o=n,i=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=o.offsetX,this._lastY=o.offsetY,i.setProps({fill:this._thumbActiveBackgroundColor}),e.disableEvent(),this.makeViewDirty(!0),s.stopPropagation()}),e.on(Bt.PointerMove,(n,s)=>{const o=n;!this._isVerticalMove||(this._view.scrollBy({y:o.offsetY-this._lastY}),this._lastY=o.offsetY)}),e.on(Bt.PointerUp,(n,s)=>{const o=this._verticalThumbRect;this._isVerticalMove=!1,e.enableEvent(),o.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))}render(e,t=0,n=0){let{scrollX:s,scrollY:o}=this._view;e.save();const a=new Lt([1,0,0,1,t,n]).getMatrix();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(s).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,o).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,n=0,s=0){var o,i,a,l,u,c,h,d,g,m,f;e===0&&e===0||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<ho&&(this._horizontalMinusMiniThumb=ho-this._horizontalThumbWidth,this._horizontalThumbWidth=ho),(o=this._horizonBarRect)==null||o.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?(i=this._horizonThumbRect)==null||i.setProps({visible:!1}):((a=this._horizonThumbRect)!=null&&a.visible||(l=this._horizonThumbRect)==null||l.setProps({visible:!0}),(u=this._horizonThumbRect)==null||u.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-this._thumbMargin*2}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/s*this._thumbLengthRatio,this._verticalThumbHeight<ho&&(this._verticalMinusMiniThumb=ho-this._verticalThumbHeight,this._verticalThumbHeight=ho),(c=this._verticalBarRect)==null||c.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?(h=this._verticalThumbRect)==null||h.setProps({visible:!1}):((d=this._verticalThumbRect)!=null&&d.visible||(g=this._verticalThumbRect)==null||g.setProps({visible:!0}),(m=this._verticalThumbRect)==null||m.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-this._thumbMargin*2,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&((f=this._placeholderBarRect)==null||f.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}get ratioScrollX(){return this._horizontalThumbWidth===void 0||this._horizontalBarWidth===void 0?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return this._verticalThumbHeight===void 0||this._verticalBarHeight===void 0?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}makeDirty(e){var t,n,s,o,i;(t=this._horizonBarRect)==null||t.makeDirty(e),(n=this._horizonThumbRect)==null||n.makeDirty(e),(s=this._verticalBarRect)==null||s.makeDirty(e),(o=this._verticalThumbRect)==null||o.makeDirty(e),(i=this._placeholderBarRect)==null||i.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===Xe.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,n,s,o;return(t=this._horizonThumbRect)!=null&&t.isHit(e)?this._horizonThumbRect:(n=this._verticalThumbRect)!=null&&n.isHit(e)?this._verticalThumbRect:(s=this._horizonBarRect)!=null&&s.isHit(e)?this._horizonBarRect:(o=this._verticalBarRect)!=null&&o.isHit(e)?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}static attachTo(e,t){return new Zr(e,t)}}class vs extends co{constructor(e,t){super(e,t),this._props={autoWidth:!1,autoHeight:!1,...t},t.image?(this._native=t.image,this._init()):t.url&&(this._native=document.createElement("img"),this._native.src=t.url,this._native.onload=()=>{var n;(n=t.success)==null||n.call(t),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{t.fail?t.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(e,t){if(t._native.complete){const{width:n,height:s}=t;try{e.drawImage(t._native,0,0,n,s)}catch(o){console.error(o)}}}static create(e,t,n){return new vs(e,{url:t,success:n})}_draw(e){vs.drawWith(e,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const V0=["dataArray"];class fn extends co{constructor(e,t){super(e,t),this.pathLength=0,this._reCalculateCache=!0,t!=null&&t.data?this._dataArray=fn.parsePathData(t.data):t!=null&&t.dataArray&&(this._dataArray=t.dataArray);for(let n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:o,preValue:i}=n;if(s===At.resize||s===At.all){this._reCalculateCache=!0;const{left:a,top:l,width:u,height:c}=this._getSelfRect(),{width:h,height:d}=i;let g,m;h?g=this.width-h:g=0,d?m=this.height-d:m=0;const f=g/u,p=m/c;this.scaleX+=f,this.scaleY+=p,this.left=this.left-a*f,this.top=this.top-l*p,this._setTransForm()}})}get dataArray(){return this._dataArray}_draw(e){fn.drawWith(e,this)}static drawWith(e,t){const n=t.dataArray;if(!!n){e.beginPath();for(let s=0;s<n.length;s++){let o=n[s].command,i=n[s].points;switch(o){case"L":e.lineTo(i[0],i[1]);break;case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":{const a=i[0],l=i[1],u=i[2],c=i[3],h=i[4],d=i[5],g=i[6],m=i[7],f=u>c?u:c,p=u>c?1:u/c,b=u>c?c/u:1;e.translate(a,l),e.rotate(g),e.scale(p,b),e.arc(0,0,f,h,h+d,!!(1-m)),e.scale(1/p,1/b),e.rotate(-g),e.translate(-a,-l);break}case"z":e.closePath();break}}this._renderPaintInOrder(e,t)}}_setFixBoundingBox(){const{left:e,top:t,width:n,height:s}=this._getSelfRect(),o=this.width/n,i=this.height/s;this.left=this.left-e*o,this.top=this.top-t*i,this.scaleX=o,this.scaleY=i,this.width=n,this.height=s,this._setTransForm()}toJson(){const e={};return V0.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:n,height:s}=this.getRect();return{left:e,top:t,width:n,height:s,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:s}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:s*this.scaleY}}_getSelfRect(){if(!this._reCalculateCache)return this._selfRectCache;let e=[];this.dataArray.forEach(u=>{if(u.command==="A"){let c=u.points[4],h=u.points[5],d=u.points[4]+h,g=Math.PI/180;if(Math.abs(c-d)<g&&(g=Math.abs(c-d)),h<0)for(let m=c-g;m>d;m-=g){const f=fn.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);e.push(f.x,f.y)}else for(let m=c+g;m<d;m+=g){const f=fn.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);e.push(f.x,f.y)}}else if(u.command==="C")for(let c=0;c<=1;c+=.01){const h=fn.getPointOnCubicBezier(c,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(h.x,h.y)}else e=e.concat(u.points)});let t=e[0],n=e[0],s=e[1],o=e[1],i,a;for(let u=0;u<e.length/2;u++)i=e[u*2],a=e[u*2+1],isNaN(i)||(t=Math.min(t,i),n=Math.max(n,i)),isNaN(a)||(s=Math.min(s,a),o=Math.max(o,a));const l={left:t,top:s,width:n-t,height:o-s};return this._selfRectCache=l,l}getLength(){return this.pathLength}getPointAtLength(e){let t,n=0,s=this.dataArray.length;if(!s)return null;for(;n<s&&e>this.dataArray[n].pathLength;)e-=this.dataArray[n].pathLength,++n;if(n===s)return t=this.dataArray[n-1].points.slice(-2),{x:t[0],y:t[1]};if(e<.01)return t=this.dataArray[n].points.slice(0,2),{x:t[0],y:t[1]};let o=this.dataArray[n],i=o.points;switch(o.command){case"L":return fn.getPointOnLine(e,o.start.x,o.start.y,i[0],i[1]);case"C":return fn.getPointOnCubicBezier(e/o.pathLength,o.start.x,o.start.y,i[0],i[1],i[2],i[3],i[4],i[5]);case"Q":return fn.getPointOnQuadraticBezier(e/o.pathLength,o.start.x,o.start.y,i[0],i[1],i[2],i[3]);case"A":{let a=i[0],l=i[1],u=i[2],c=i[3],h=i[4],d=i[5],g=i[6];return h+=d*e/o.pathLength,fn.getPointOnEllipticalArc(a,l,u,c,h,g)}}return null}static getLineLength(e,t,n,s){return Math.sqrt((n-e)*(n-e)+(s-t)*(s-t))}static getPointOnLine(e,t,n,s,o,i,a){i===void 0&&(i=t),a===void 0&&(a=n);let l=(o-n)/(s-t+1e-8),u=Math.sqrt(e*e/(1+l*l));s<t&&(u*=-1);let c=l*u,h;if(s===t)h={x:i,y:a+c};else if((a-n)/(i-t+1e-8)===l)h={x:i+u,y:a+c};else{let d,g,m=this.getLineLength(t,n,s,o),f=(i-t)*(s-t)+(a-n)*(o-n);f/=m*m,d=t+f*(s-t),g=n+f*(o-n);let p=this.getLineLength(i,a,d,g),b=Math.sqrt(e*e-p*p);u=Math.sqrt(b*b/(1+l*l)),s<t&&(u*=-1),c=l*u,h={x:d+u,y:g+c}}return h}static getPointOnCubicBezier(e,t,n,s,o,i,a,l,u){function c(p){return p*p*p}function h(p){return 3*p*p*(1-p)}function d(p){return 3*p*(1-p)*(1-p)}function g(p){return(1-p)*(1-p)*(1-p)}let m=l*c(e)+i*h(e)+s*d(e)+t*g(e),f=u*c(e)+a*h(e)+o*d(e)+n*g(e);return{x:m,y:f}}static getPointOnQuadraticBezier(e,t,n,s,o,i,a){function l(g){return g*g}function u(g){return 2*g*(1-g)}function c(g){return(1-g)*(1-g)}let h=i*l(e)+s*u(e)+t*c(e),d=a*l(e)+o*u(e)+n*c(e);return{x:h,y:d}}static getPointOnEllipticalArc(e,t,n,s,o,i){let a=Math.cos(i),l=Math.sin(i),u={x:n*Math.cos(o),y:s*Math.sin(o)};return{x:e+(u.x*a-u.y*l),y:t+(u.x*l+u.y*a)}}static parsePathData(e){if(!e)return[];let t=e,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let h=0,d=n.length;h<d;h++)t=t.replace(new RegExp(n[h],"g"),`|${n[h]}`);let s=t.split("|"),o=[],i=[],a=0,l=0,u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,c;for(let h=1,d=s.length;h<d;h++){let g=s[h],m=g.charAt(0);for(g=g.slice(1),i.length=0;c=u.exec(g);)i.push(c[0]);let f=[];for(let p=0,b=i.length;p<b;p++){if(i[p]==="00"){f.push(0,0);continue}let v=parseFloat(i[p]);isNaN(v)?f.push(0):f.push(v)}for(;f.length>0&&!isNaN(f[0]);){let p,b=[],v=a,w=l,S,T,D,R,I,y,O,M,F,x;switch(m){case"l":a+=f.shift()||0,l+=f.shift()||0,p="L",b.push(a,l);break;case"L":a=f.shift()||0,l=f.shift()||0,b.push(a,l);break;case"m":{let E=f.shift()||0,N=f.shift()||0;if(a+=E,l+=N,p="M",o.length>2&&o[o.length-1].command==="z"){for(let X=o.length-2;X>=0;X--)if(o[X].command==="M"){a=o[X].points[0]+E,l=o[X].points[1]+N;break}}b.push(a,l),m="l";break}case"M":a=f.shift()||0,l=f.shift()||0,p="M",b.push(a,l),m="L";break;case"h":a+=f.shift()||0,p="L",b.push(a,l);break;case"H":a=f.shift()||0,p="L",b.push(a,l);break;case"v":l+=f.shift()||0,p="L",b.push(a,l);break;case"V":l=f.shift()||0,p="L",b.push(a,l);break;case"C":b.push(f.shift()||0,f.shift()||0,f.shift()||0,f.shift()||0),a=f.shift()||0,l=f.shift()||0,b.push(a,l);break;case"c":b.push(a+(f.shift()||0),l+(f.shift()||0),a+(f.shift()||0),l+(f.shift()||0)),a+=f.shift()||0,l+=f.shift()||0,p="C",b.push(a,l);break;case"S":T=a,D=l,S=o[o.length-1],S.command==="C"&&(T=a+(a-S.points[2]),D=l+(l-S.points[3])),b.push(T,D,f.shift()||0,f.shift()||0),a=f.shift()||0,l=f.shift()||0,p="C",b.push(a,l);break;case"s":T=a,D=l,S=o[o.length-1],S.command==="C"&&(T=a+(a-S.points[2]),D=l+(l-S.points[3])),b.push(T,D,a+(f.shift()||0),l+(f.shift()||0)),a+=f.shift()||0,l+=f.shift()||0,p="C",b.push(a,l);break;case"Q":b.push(f.shift()||0,f.shift()||0),a=f.shift()||0,l=f.shift()||0,b.push(a,l);break;case"q":b.push(a+(f.shift()||0),l+(f.shift()||0)),a+=f.shift()||0,l+=f.shift()||0,p="Q",b.push(a,l);break;case"T":T=a,D=l,S=o[o.length-1],S.command==="Q"&&(T=a+(a-S.points[0]),D=l+(l-S.points[1])),a=f.shift()||0,l=f.shift()||0,p="Q",b.push(T,D,a,l);break;case"t":T=a,D=l,S=o[o.length-1],S.command==="Q"&&(T=a+(a-S.points[0]),D=l+(l-S.points[1])),a+=f.shift()||0,l+=f.shift()||0,p="Q",b.push(T,D,a,l);break;case"A":R=f.shift()||0,I=f.shift()||0,y=f.shift()||0,O=f.shift()||0,M=f.shift()||0,F=a,x=l,a=f.shift()||0,l=f.shift()||0,p="A",b=this.convertEndpointToCenterParameterization(F,x,a,l,O,M,R,I,y);break;case"a":R=f.shift()||0,I=f.shift()||0,y=f.shift()||0,O=f.shift()||0,M=f.shift()||0,F=a,x=l,a+=f.shift()||0,l+=f.shift()||0,p="A",b=this.convertEndpointToCenterParameterization(F,x,a,l,O,M,R,I,y);break}o.push({command:p||m,points:b,start:{x:v,y:w},pathLength:this.calcLength(v,w,p||m,b)})}(m==="z"||m==="Z")&&o.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return o}static calcLength(e,t,n,s){let o,i,a,l,u=fn;switch(n){case"L":return u.getLineLength(e,t,s[0],s[1]);case"C":for(o=0,i=u.getPointOnCubicBezier(0,e,t,s[0],s[1],s[2],s[3],s[4],s[5]),l=.01;l<=1;l+=.01)a=u.getPointOnCubicBezier(l,e,t,s[0],s[1],s[2],s[3],s[4],s[5]),o+=u.getLineLength(i.x,i.y,a.x,a.y),i=a;return o;case"Q":for(o=0,i=u.getPointOnQuadraticBezier(0,e,t,s[0],s[1],s[2],s[3]),l=.01;l<=1;l+=.01)a=u.getPointOnQuadraticBezier(l,e,t,s[0],s[1],s[2],s[3]),o+=u.getLineLength(i.x,i.y,a.x,a.y),i=a;return o;case"A":{o=0;let c=s[4],h=s[5],d=s[4]+h,g=Math.PI/180;if(Math.abs(c-d)<g&&(g=Math.abs(c-d)),i=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],c,0),h<0)for(l=c-g;l>d;l-=g)a=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),o+=u.getLineLength(i.x,i.y,a.x,a.y),i=a;else for(l=c+g;l<d;l+=g)a=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),o+=u.getLineLength(i.x,i.y,a.x,a.y),i=a;return a=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],d,0),o+=u.getLineLength(i.x,i.y,a.x,a.y),o}}return 0}static convertEndpointToCenterParameterization(e,t,n,s,o,i,a,l,u){let c=u*(Math.PI/180),h=Math.cos(c)*(e-n)/2+Math.sin(c)*(t-s)/2,d=-1*Math.sin(c)*(e-n)/2+Math.cos(c)*(t-s)/2,g=h*h/(a*a)+d*d/(l*l);g>1&&(a*=Math.sqrt(g),l*=Math.sqrt(g));let m=Math.sqrt((a*a*(l*l)-a*a*(d*d)-l*l*(h*h))/(a*a*(d*d)+l*l*(h*h)));o===i&&(m*=-1),isNaN(m)&&(m=0);let f=m*a*d/l,p=m*-l*h/a,b=(e+n)/2+Math.cos(c)*f-Math.sin(c)*p,v=(t+s)/2+Math.sin(c)*f+Math.cos(c)*p,w=O=>Math.sqrt(O[0]*O[0]+O[1]*O[1]),S=(O,M)=>(O[0]*M[0]+O[1]*M[1])/(w(O)*w(M)),T=(O,M)=>(O[0]*M[1]<O[1]*M[0]?-1:1)*Math.acos(S(O,M)),D=T([1,0],[(h-f)/a,(d-p)/l]),R=[(h-f)/a,(d-p)/l],I=[(-1*h-f)/a,(-1*d-p)/l],y=T(R,I);return S(R,I)<=-1&&(y=Math.PI),S(R,I)>=1&&(y=0),i===0&&y>0&&(y-=2*Math.PI),i===1&&y<0&&(y+=2*Math.PI),[b,v,a,l,D,y,c,i]}}const $0=["radius"];class qu extends co{constructor(e,t){super(e,t),this._radius=(t==null?void 0:t.radius)||10,this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:o,preValue:i}=n;if(s===At.resize||s===At.all){const a=Math.min(this.width,this.height);this._radius=a/2,this.width=a,this.height=a,this._setTransForm()}})}get radius(){return this._radius}_setFixBoundingBox(){this.transformByState({width:this._radius*2,height:this._radius*2})}_draw(e){qu.drawWith(e,this)}static drawWith(e,t){let{radius:n}=t;n=n!=null?n:10,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath(),e.arc(n,n,n||0,0,Math.PI*2,!1),e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return $0.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}class Ju{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}_localeInitial(){if(!this._context)return;const e=this._context.getLocale(),t=e.getObject("renderFont");t||e.load({en:l0,zh:a0}),this._fontLocale=t}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}}class Qu{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return _s(e)}}const go=Un.create(),ec=Un.create(),tc=Un.create(),fo=Un.create();class nc extends jr{constructor(){super(...arguments),this._extensions=new Map}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(yt),e}getExtensionByKey(e){return this._extensions.get(e)}get extensions(){return this._extensions}draw(e,t){}}function sv(r=0,e,t=Pn.NONE,n=1/0){const{left:s,width:o,spaceWidth:i}=ov(r,e,n);return{lines:[],left:s,width:o,height:0,spaceWidth:i,separator:t,st:0,ed:0,drawingLRIds:[],isFull:!1}}function ov(r=0,e,t){let n=0,s=0,o=0;for(let i=0;i<=r;i++){const{width:a,paddingEnd:l}=e[i];i===e.length-1?(n=t===1/0?t-n:a,s=0):(s=l,n=a,o+=n+s)}return{width:n,spaceWidth:s,left:o-n-s}}function G0(r,e,t,n,s=0,o=0,i=!1,a,l,u){const{lineHeight:c=15.6,lineTop:h=0,contentHeight:d=0,paddingLeft:g=0,paddingRight:m=0,paddingTop:f=0,paddingBottom:p=0,marginTop:b=0,spaceBelowApply:v=0}=t,w=dv(e,r);w.lineIndex=s,w.paragraphStart=Na(o,i),w.contentHeight=d,w.top=h,w.lineHeight=c,w.paddingTop=f,w.paddingBottom=p,w.marginTop=b,w.spaceBelowApply=v,w.divides=iv(c,h,n,g,m,a,l,u);for(let S of w.divides)S.parent=w;return w}function X0(r=15.6,e=0,t=0,n,s,o){let i=e;return s==null||s.forEach(a=>{const l=rc(a,r,e);l&&(i=Math.max(i,l))}),o==null||o.forEach(a=>{const l=rc(a,r,e);l&&(i=Math.max(i,l))}),n==null||n.forEach(a=>{const l=rc(a,r,e);l&&(i=Math.max(i,l))}),i}function rc(r,e,t,n){const{aTop:s,height:o,aLeft:i,width:a,angle:l=0,drawingOrigin:u}=r,{layoutType:c,distT:h=0,distB:d=0}=u;if(c!==rn.WRAP_TOP_AND_BOTTOM)return;if(l===0){const f=s-h,p=o+d;return f+p<t||f>e+t?void 0:f+o}let{top:g=0,height:m=0}=j0(l,i,a,s,o);if(g-=h,m+=d,!(g+m<t||g>e+t))return g+m}function iv(r,e,t,n,s,o,i,a){const l=[];return l.push({left:0,width:n},{left:t-s,width:s}),i==null||i.forEach((u,c)=>{const h=sc(u,r,e,t);h&&l.push(h)}),a==null||a.forEach((u,c)=>{const h=sc(u,r,e,t);h&&l.push(h)}),o==null||o.forEach((u,c)=>{const h=sc(u,r,e,t);h&&l.push(h)}),hv(t,l)}function Y0(r,e){r.isFull=e}function av(r,e){r.marginBottom=e}function lv(r){}function sc(r,e,t,n){const{aTop:s,height:o,aLeft:i,width:a,angle:l=0,drawingOrigin:u}=r,{layoutType:c}=u;if(c===rn.WRAP_NONE||c===rn.WRAP_TOP_AND_BOTTOM)return;if(c===rn.WRAP_POLYGON){const{start:d=[0,0],lineTo:g}=u;if(!g)return;let m=[];m.push(new xe(d[0],d[1]));for(let f=0;f<g.length;f++){const p=g[f];m.push(new xe(p[0],p[1]))}if(l!==0){const f=new Lt().rotate(l);for(let p=0;p<m.length;p++){const b=m[p];m[p]=f.applyPoint(b)}}return K0(m,t,e,n)}if(l===0)return Z0(s,o,i,a,t,e,n,u);const h=j0(l,i,a,s,o);if(c===rn.WRAP_SQUARE){const{left:d,width:g,top:m,height:f}=h;return Z0(m,f,d,g,t,e,n,u)}return K0(h.points,t,e,n)}function j0(r,e,t,n,s){const o=new Lt().rotate(r),i=new xe(e,n),a=new xe(e,n+s),l=new xe(e+t,n),u=new xe(e+t,n+s);return o.makeBoundingBoxFromPoints([i,a,l,u])}function K0(r,e,t,n){const s=new L0(r),o=s.intersection([new xe(0,e),new xe(n,e)]),i=s.intersection([new xe(0,e+t),new xe(n,e+t)]);if(!o&&!i)return;const a=uv([...r,...o||[],...i||[]]);return{left:a.min,width:a.max}}function uv(r,e=0){const t=[];for(let n=0;n<r.length;n++){const s=r[n];e===0?t.push(s.x):t.push(s.y)}return{max:Math.max(...t),min:Math.min(...t)}}function Z0(r,e,t,n,s,o,i,a){const{layoutType:l,wrapText:u=Hn.BOTH_SIDES,distL:c=0,distR:h=0,distT:d=0,distB:g=0}=a,m=r-(l===rn.WRAP_SQUARE?d:0),f=e+(l===rn.WRAP_SQUARE?g:0);if(m+f<s||m>o+s)return;let p=t-c,b=n+h,v=cv(u,p,b,i);return v===1?b=i-p:v===2&&(p=0,b=t+n+h),{left:p,width:b}}function cv(r,e,t,n){let s=0;return r===Hn.LEFT?s=1:r===Hn.RIGHT?s=2:r===Hn.LARGEST&&(e>n-e-t?s=1:s=2),s}function hv(r,e){e.sort((o,i)=>o.left>i.left?1:-1);const t=[];let n=0;const s=e.length;for(let o=0;o<s;o++){const i=e[o],{left:a,width:l}=i;if(a>n){let u=a-n;u=u<r?u:r-n;const c=q0(n,u);t.push(c)}if(n=Math.max(a+l,n),o===s-1&&a+l<r){const u=q0(a+l,r-a-l);t.push(u)}}return t}function q0(r,e){return{spanGroup:[],width:e,left:r,paddingLeft:0,isFull:!1,st:0,ed:0}}function dv(r,e){return{blockId:e,type:r,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function Na(r,e){return r===0&&e===!0}function J0(r,e,t,n){if(!!n)if(n.has(r)){const s=n.get(r);s==null||s.elements.push(e)}else n.set(r,{elements:[e],blockId:r,top:t})}function ka(r,e){const t=r.parent;if(t!=null){const n=t.divides[0].spanGroup[0]==null,s=e[0],o=s.content||" ";if(n&&o===" "){const i=s.width;s.width=0;for(let a of e)a!==s&&(a.left-=i)}}r.spanGroup.push(...e)}function oc(r=[],e=Pn.NONE,t=0,n=0,s=1/0,o=1/0){const i=[];let a=0,l=0;if(r.length===0)i.push(ic(n,s,0,Pn.NONE));else for(let c=0;c<r.length;c++){const{width:h,paddingEnd:d}=r[c];l=d,a=h,i.push(ic(n,a,l,e)),n+=a+l,c===r.length-1&&(a=s!==1/0?s-a:h,l=0,i.push(ic(n,a,l,e)))}const u={columns:i,colCount:(r==null?void 0:r.length)||1,height:o,top:t,st:0,ed:0};return i.forEach(c=>{c.parent=u}),u}function di(r,e){r.isFull=e}function ic(r,e,t,n){return{lines:[],left:r,width:e,height:0,spaceWidth:t,separator:n,st:0,ed:0,drawingLRIds:[],isFull:!1}}function Q0(r,e,t,n){return t in Wt?gv(r,e,t):H0(r,e,t,n)}function gv(r,e,t){return t===Wt.DECIMAL?e6(r,e):t===Wt.ZERO_DECIMAL?fv(r,e):t===Wt.UPPER_ALPHA?mv(r,e):t===Wt.ALPHA?pv(r,e):t===Wt.UPPER_ROMAN?_v(r,e):t===Wt.ROMAN?bv(r,e):e6(r,e)}function e6(r,e){return(r+e).toString()}function fv(r,e){const t=r+e;return t<10?`0${t}`:t.toString()}function mv(r,e){return Ru(r+e-1,!0)}function pv(r,e){return Ru(r+e-1,!1)}function _v(r,e){return t6(r+e,!0)}function bv(r,e){return t6(r+e,!1)}function t6(r,e=!1){const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let s={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(s=t);let o="";for(let i in s)for(;r>=s[i];)o+=i,r-=s[i];return o}function n6(r,e,t,n,s){var h,d;if(!r||!e)return;const{listId:o,nestingLevel:i=0,textStyle:a}=r,l=e[o];return!l||!l.nestingLevel?ac(o,(h=t==null?void 0:t[i])==null?void 0:h.startIndexItem,n):l.nestingLevel[i]?vv(o,i,l.nestingLevel,t,a,n,s):ac(o,(d=t==null?void 0:t[i])==null?void 0:d.startIndexItem,n)}function ac(r,e=1,t){return{listId:r,symbol:"\u25CF",ts:{ff:(t==null?void 0:t.fontList[0])||"Arial",fs:(t==null?void 0:t.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function vv(r,e,t,n,s,o,i){var D,R;const a=t[e],{bulletAlignment:l,glyphFormat:u,textStyle:c,startNumber:h,glyphType:d,glyphSymbol:g,indentFirstLine:m,hanging:f,indentStart:p}=a,b={...s,...c},v=Ia(b,o);let w;g?w=g:w=Cv(u,e,t,n,i);const S=ps.getTextSize(w,v),T=(R=(D=n==null?void 0:n[e])==null?void 0:D.startIndexItem)!=null?R:1;return{listId:r,symbol:w,ts:b,fontStyle:v,startIndexItem:T+1,bBox:S,nestingLevel:a,bulletAlign:l,bulletType:g?!1:!!d,indentFirstLine:m,hanging:f,indentStart:p}}function Cv(r,e,t,n,s){var l;const o=r.split("%"),a=[o[0]];for(let u=1;u<o.length;u++){const c=o[u],{level:h,suffix:d}=wv(c);let g=((l=n==null?void 0:n[h])==null?void 0:l.startIndexItem)||1;h!==e&&(n==null?void 0:n[h])!==null&&(g-=1);const m=Ev(g,t[h],s);a.push(m,d)}return a.join("")}function Ev(r=1,e,t){const{startNumber:n,glyphType:s,glyphSymbol:o}=e;return o||(s?Q0(r,n,s,t):"\u25CF")}function wv(r){if(r==="")return{level:0,suffix:""};const e=r.split("");let t="",n="",s=!1;const o=/[0-9]/g;return e.forEach(i=>{!s&&o.test(`${t}${i}`)?t+=i:(s=!0,n+=i)}),{level:parseInt(t)-1,suffix:n}}function Tv(r,e,t,n,s,o){return[]}function lc(r,e,t){return uc(on.WORD,r,e,t)}function Ba(r,e,t){return uc(on.LETTER,r,e,t)}function r6(r,e){return uc(on.TAB," ",r,e)}function uc(r,e,t,n){const{fontStyle:s,textStyle:o,charSpace:i=1,gridType:a=gn.LINES,snapToGrid:l=te.FALSE}=t,u=ps.getTextSize(e,s),{width:c=0}=u;let h=n!=null?n:c,d=0;return dc(a,l)&&(h=Math.ceil(c/i)*i,a===gn.LINES_AND_CHARS&&(d=(h-c)/2)),{content:e,ts:o,fontStyle:s,width:h,bBox:u,paddingLeft:d,left:0,spanType:r}}function s6(r,e,t){const{bBox:n,symbol:s,ts:o,fontStyle:i,bulletAlign:a=vt.START,bulletType:l=!1}=e,u=n.width,c=Math.ceil(u/t);let h=(c<2?2:c)*t,d=0;l&&(a===vt.CENTER?(d=-u/2,h-=d):a===vt.END&&(d=-u,h-=d));const g=yv(r,e);return{content:s,ts:o,fontStyle:i,width:h,paddingLeft:0,bBox:g,left:d,spanType:on.LIST}}function o6(r,e=0){const t=r.length;let n;for(let s=0;s<t;s++){const o=r[s];o.left=n?n.left+n.width:e,n=o}}function Sv(r,e=0){r.left=e}function yv(r,e){const{ba:t,bd:n}=r.bBox,{ba:s,bd:o}=e.bBox;return t+n>s+o?r.bBox:e.bBox}function i6(r,e,t,n){if(zu(r))return Rv(r,e,t,n);if(Wu(r))return Iv(r,e,t,n);if(!Uu(r))return Av(r,e,t,n)}function Av(r,e,t,n){const{pageWidth:s=1/0}=n,o=Ba(r,n),i=[o];let a=o.width,l=e;for(let u=e+1;u<t.length;u++){const c=t[u];if(!Uu(c)&&!I0(c)){const h=Ba(c,n),d=h.width;if(a+d>s)break;i.push(h),a+=d,l=u}else break}return{charIndex:l,spanGroup:i}}function Rv(r,e,t,n){const s=[r];let o=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(zu(a))s.unshift(a),o=i;else break}return{charIndex:o,spanGroup:[Ba(s.join(""),n)]}}function Iv(r,e,t,n){const s=[r];let o=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(Wu(a))s.push(a),o=i;else break}return{charIndex:o,spanGroup:[lc(s.join(""),n)]}}function Cs(r){return r==null?void 0:r[r.length-1]}function mo(r){var e;return(e=r==null?void 0:r.sections)==null?void 0:e[r.sections.length-1]}function xv(r){const e=mo(r).columns;return e==null?void 0:e[e.length-1]}function a6(r){var t;const e=(t=gi(r))==null?void 0:t.column.lines;return e==null?void 0:e[e.length-1]}function l6(r){return r.lines[r.lines.length-1]}function u6(r){const{width:e,marginLeft:t,marginRight:n}=r;return e-t-n}function Dv(r){const e=r.parent,t=e==null?void 0:e.lines.indexOf(r);if(!(!t||t===-1||t-1<0))return e==null?void 0:e.lines[t-1]}function c6(r){var t;const e=(t=r.parent)==null?void 0:t.parent;if(e)return e}function gi(r){const e=mo(r);for(let t=0;t<e.columns.length;t++){const n=e.columns[t];if(!n.isFull)return{column:n,isLast:t===e.columns.length-1,index:t}}}function cc(r){const e=a6(r);if(!!e)for(let t=0;t<e.divides.length;t++){const n=e.divides[t];if(!n.isFull)return{divide:n,isLast:t===e.divides.length-1,index:t}}}function Ov(r,e){const t=r.divides.indexOf(e);if(t!==-1)return r.divides[t+1]}function Fv(r){if(!!r)for(let e=0;e<r.divides.length;e++){const t=r.divides[e],n=r.divides[e+1];if(t.spanGroup.length===0||!n||n.spanGroup.length===0)return t}}function Mv(r){var t;const e=(t=cc(r))==null?void 0:t.divide.spanGroup;return e==null?void 0:e[e.length-1]}function h6(r){const e=mo(r),t=e.columns.length;for(let n=0;n<t;n++)if(!e.columns[n].isFull)return!1;return!0}function d6(r){if(r.sections.length>1)return!1;const e=mo(r),t=e.columns.length;for(let n=0;n<t;n++){const s=e.columns[n];if(!hc(s))return!1}return!0}function hc(r){const e=r.lines;if(e.length>1)return!1;const t=e[e.length-1];return Nv(t)}function Nv(r){if(!r)return!0;for(let e=0;e<r.divides.length;e++){const t=r.divides[e].spanGroup.length;if(t>1)return!1;if(t===1){const n=r.divides[e].spanGroup[0],{spanType:s}=n;if(s!==on.TAB&&s!==on.LIST)return!1}}return!0}function kv(){}function Sr(r,e){if(r instanceof Object){const{v:t,u:n}=r;return n===Ou.POINT?t:t*e}return r}function La(r=0,e,t=gn.LINES,n=te.TRUE){let s=1;return dc(t,n)&&(s=r),s*=e,s}function dc(r=gn.LINES,e=te.FALSE){return e===te.TRUE&&(r===gn.LINES_AND_CHARS||r===gn.SNAP_TO_CHARS)}function gc(r,e){const{paragraphStyle:t={}}=e,{linePitch:n=15.6,gridType:s=gn.LINES,paragraphLineGapDefault:o=0}=r,{lineSpacing:i=1,spacingRule:a=no.AUTO,snapToGrid:l=te.TRUE}=t;return{paragraphLineGapDefault:o,linePitch:n,gridType:s,lineSpacing:i,spacingRule:a,snapToGrid:l}}function g6(r,e){const{paragraphStyle:t={}}=e,{charSpace:n=0,gridType:s=gn.LINES,defaultTabStop:o=36,documentTextStyle:i={}}=r,{fs:a=f0}=i,{snapToGrid:l=te.TRUE}=t;return{charSpace:n,documentFontSize:a,defaultTabStop:o,gridType:s,snapToGrid:l}}function Pa(r,e=-1){r[0];let t=e;for(let n of r){const{sections:s}=n;let o=t,i=o,a=-1/0,l=0;for(let u of s){const{columns:c}=u;let h=i,d=h,g=-1/0;for(let m of c){const{lines:f}=m;let p=d,b=p,v=0,w=-1/0,S=null;for(let T of f){const{divides:D,lineHeight:R}=T;let I=b,y=I,O=0,M=0;v+=R;const F=D.length;for(let x=0;x<F;x++){const E=D[x],{spanGroup:N}=E;if(N.length===0)continue;let X=y,L=X;for(let ne of N){L+=ne.spanType===on.LIST?0:ne.count||1;const Q=ne.bBox,{ba:P}=Q;M=Math.max(M,P),x===F-1&&E.width===1/0&&(O+=ne.width)}x===F-1&&(E.width===1/0?E.width=O:O+=E.width,O+=E.left),E.st=X===0?0:X+1,E.ed=L>=E.st?L:E.st,y=E.ed}T.st=I===0?0:I+1,T.ed=y>=T.st?y:T.st,T.width=O,T.asc=M,w=Math.max(w,O),T.top=((S==null?void 0:S.top)||0)+((S==null?void 0:S.lineHeight)||0),S=T,b=T.ed}m.st=p===0?0:p+1,m.ed=b>=m.st?b:m.st,m.height=v,m.width===1/0&&(m.width=w),a=Math.max(a,w),g=Math.max(g,m.height),d=m.ed}u.st=h===0?0:h+1,u.ed=d>=u.st?d:u.st,u.height=g,l+=g,i=u.ed}n.st=o===0?0:o+1,n.ed=i>=n.st?i:n.st,n.height=l,n.width=a,t=n.ed}}function Bv(r,e){for(let t of r){const{sections:n}=t;for(let s of n){const{columns:o}=s;for(let i of o){const{lines:a}=i;for(let l of a){const{divides:u,lineHeight:c}=l,h=u.length;for(let d=0;d<h;d++){const g=u[d],{spanGroup:m}=g;for(let f of m)e&&Aa(e)&&e(f)}}}}}}function f6(r,e){for(let t of r){const{sections:n}=t;for(let s of n){const{columns:o}=s;for(let i of o){const{lines:a}=i;for(let l of a)e&&Aa(e)&&e(l)}}}}function m6(r,e){for(let t of r){const{sections:n}=t;for(let s of n){const{columns:o}=s;for(let i of o)e&&Aa(e)&&e(i)}}}function p6(r,e,t,n,s=!1){const{relativeFrom:o,align:i,posOffset:a,percent:l}=r;if(i!=null)if(i===_r.INSIDE||i===_r.OUTSIDE)o===lt.MARGIN||lt.PAGE;else{if(o===lt.COLUMN){const{width:u,left:c}=e;let h=0;return i===_r.LEFT?h=c:i===_r.RIGHT?h=c+u-n:i===_r.CENTER&&(h=c+u/2-n/2),h}if(o!==lt.LEFT_MARGIN){if(o!==lt.MARGIN){if(o!==lt.RIGHT_MARGIN){if(o!==lt.INSIDE_MARGIN){if(o!==lt.OUTSIDE_MARGIN){if(o===lt.PAGE){const{width:u}=t;let c=0;return i===_r.RIGHT?c=u-n:i===_r.CENTER&&(c=u/2-n/2),c}}}}}}}else if(a){const{width:u,marginLeft:c,marginRight:h}=t,d=u-h;let g=0;return o===lt.COLUMN?g=(s?0:(e==null?void 0:e.left)||0)+a:o===lt.LEFT_MARGIN||(o===lt.MARGIN?g=a+c:o===lt.RIGHT_MARGIN||o===lt.INSIDE_MARGIN||o===lt.OUTSIDE_MARGIN||o===lt.PAGE&&(g=a)),g+n>d&&(g=d-n),g}else if(l){const{width:u,marginLeft:c,marginRight:h}=t;if(o!==lt.LEFT_MARGIN){if(o!==lt.MARGIN){if(o!==lt.RIGHT_MARGIN){if(o!==lt.INSIDE_MARGIN){if(o!==lt.OUTSIDE_MARGIN){if(o===lt.PAGE)return l*u}}}}}}}function _6(r,e,t,n,s,o,i=!1){const{relativeFrom:a,align:l,posOffset:u,percent:c}=r;if(l!=null){if(a===ct.LINE){let h=0;return l===gs.BOTTOM?h=t+n-s:l===gs.TOP?h=t:l===gs.CENTER&&(h=t+n/2-s/2),h}if(a!==ct.TOP_MARGIN){if(a!==ct.MARGIN){if(a!==ct.BOTTOM_MARGIN){if(a!==ct.INSIDE_MARGIN){if(a!==ct.OUTSIDE_MARGIN){if(a===ct.PAGE){const{height:h}=e;let d=0;return l===gs.BOTTOM?d=h-s:l===gs.CENTER&&(d=h/2-s/2),d}}}}}}}else if(u){let h=0;return a===ct.LINE?h=t||0+u:a===ct.TOP_MARGIN||a===ct.MARGIN||a===ct.BOTTOM_MARGIN||a===ct.INSIDE_MARGIN||a===ct.OUTSIDE_MARGIN||(a===ct.PAGE?h=u:a===ct.PARAGRAPH&&(h=(i?0:o==null?t:o)+u)),h}else if(c){const{height:h,marginBottom:d,marginTop:g}=e;if(a!==ct.TOP_MARGIN){if(a!==ct.MARGIN){if(a!==ct.BOTTOM_MARGIN){if(a!==ct.INSIDE_MARGIN){if(a!==ct.OUTSIDE_MARGIN){if(a===ct.PAGE)return c*h}}}}}}}function Lv(r,e){}function b6(r){const e=r.spanGroup;let t=0;for(let n of e)t+=n.width;return t}function fc(r,e,t,n,s=0,o=!1){if(Na(s,o))if(n.bulletSkeleton){const{bulletSkeleton:i,paragraphStyle:a={}}=n,{gridType:l=gn.LINES,charSpace:u=0,defaultTabStop:c=1}=t,{snapToGrid:h=te.TRUE}=a,d=La(u,c,l,h);Xv(a,i,d);const g=s6(r[0],i,d);po([g,...r],e,t,n,s,o)}else po(r,e,t,n,s,o);else fi(r,e,t,n,s,o);return[...e]}function fi(r,e,t,n,s=0,o=!1,i){var u,c;const a=Cs(e),l=cc(a);if(l){const h=Vv(r),d=l.divide,g=(u=d==null?void 0:d.spanGroup)==null?void 0:u[d.spanGroup.length-1],m=(g==null?void 0:g.width)||0,f=(g==null?void 0:g.left)||0,p=u6(a);if(m+f+h>d.width){Y0(d,!0);const b=c6(d);h>p?d6(a)?(ka(d,r),Uv((c=b==null?void 0:b.parent)==null?void 0:c.columns)):pc(r,e,t,n,s,o,i):b&&h>b.width?(di(b,!0),hc(b)?(console.log(r),ka(d,r)):mc(r,e,t,n,s,o,i)):l.isLast?po(r,e,t,n,s,o,i):fi(r,e,t,n,s,o,i)}else{const b=d.parent,v=$v(r);if(b&&v){const{paragraphLineGapDefault:w,linePitch:S,lineSpacing:T,spacingRule:D,snapToGrid:R,gridType:I}=gc(t,n),{boundingBoxAscent:y,boundingBoxDescent:O}=v,M=y+O,{contentHeight:F}=v6(M,w,S,I,T,D,R);if(b.contentHeight<F){const x=Gv(b),E=x.length;let N=[],X=1;x[0].spanType===on.LIST&&E>2?(N=[x[0],x[1]],X=2):N=[x[0]];const L=b.parent;L==null||L.lines.pop(),po(N,e,t,n,s,o,y+O);for(let ne=X;ne<x.length;ne++)fi([x[ne]],e,t,n,s,o);fi(r,e,t,n,s,o);return}}o6(r,m+f);for(let w of r)w.parent=d;ka(d,r)}}else po(r,e,t,n,s,o,i)}function po(r,e,t,n,s=0,o=!1,i){var Ve,qe,U,q,Je;let a=Cs(e),l=gi(a);if((!l||!l.column)&&(pc(r,e,t,n,s),a=Cs(e),l=gi(a)),!l)return;const u=l.column,c=l6(u),{ba:h,bd:d}=r[0].bBox,g=i||h+d,{paragraphStyle:m={},paragraphAffectSkeDrawings:f,skeHeaders:p,skeFooters:b,blockAnchor:v,blockId:w}=n,{namedStyleType:S=pa.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:T=ut.UNSPECIFIED,direction:D,spaceAbove:R=0,spaceBelow:I=0,borderBetween:y,borderTop:O,borderBottom:M,borderLeft:F,borderRight:x,indentFirstLine:E=0,hanging:N=0,indentStart:X=0,indentEnd:L=0,tabStops:ne=[],keepLines:G=te.FALSE,keepNext:Q=te.FALSE,wordWrap:P=te.FALSE,widowControl:V=te.FALSE,shading:pe}=m,{paragraphLineGapDefault:oe,linePitch:Z,lineSpacing:ie,spacingRule:be,snapToGrid:Ce,gridType:fe}=gc(t,n),Te=Na(s,o),{paddingTop:Le,paddingBottom:Ze,contentHeight:Ne,lineSpacingApply:A}=v6(g,oe,Z,fe,ie,be,Ce),{marginTop:se,spaceBelowApply:re}=Hv(A,R,I,Te,c),B=se+Le+Ne+Ze;let k=u.parent;k||(k=mo(a));const Y=(c==null?void 0:c.lineHeight)||0,le=(c==null?void 0:c.top)||0,ae=Y+le,{width:j,headerId:he,footerId:H}=a,z=(qe=(Ve=p==null?void 0:p.get(he))==null?void 0:Ve.get(j))==null?void 0:qe.skeDrawings,J=(q=(U=b==null?void 0:b.get(H))==null?void 0:U.get(j))==null?void 0:q.skeDrawings;zv(ae,B,u,(Je=v==null?void 0:v.get(w))==null?void 0:Je.top,f);const ue=X0(B,ae,s,a.skeDrawings,z,J);if(B+ue>k.height&&u.lines.length>0&&a.sections.length>0){di(u,!0),mc(r,e,t,n,s,o,i);return}const de=c?c.lineIndex+1:0,{charSpace:ze,defaultTabStop:De}=g6(t,n),Be=La(ze,De,fe,Ce),{paddingLeft:ce,paddingRight:Se,changeBulletWidth:ve}=Pv(r[0],E,N,X,L,Be);ve.state&&(r[0].width=ve.hangingNumber);const $e=G0(w,ii.PARAGRAPH,{lineHeight:B,contentHeight:Ne,lineTop:ue,paddingLeft:ce,paddingRight:Se,paddingTop:Le,paddingBottom:Ze,marginTop:se,spaceBelowApply:re},u.width,de,s,o,a.skeDrawings,z,J);u.lines.push($e),$e.parent=u,J0(w,$e,ae,v),fi(r,e,t,n,s,o,i)}function mc(r,e,t,n,s=0,o=!1,i){const a=Cs(e);h6(a)===!0?pc(r,e,t,n,s,o,i):po(r,e,t,n,s,o,i)}function pc(r,e,t,n,s=0,o=!1,i){const a=Cs(e),{skeHeaders:l,skeFooters:u}=n;e.push(_o(t,{skeHeaders:l,skeFooters:u},a==null?void 0:a.pageNumber)),mc(r,e,t,n,s,o,i)}function Pv(r,e=0,t=0,n=0,s=0,o){const{spanType:i=on.LETTER,bBox:a}=r;let l=Sr(e,o),u=Sr(t,o),c=Sr(n,o),h=Sr(s,o),d=c,g=h,m={state:!1,hangingNumber:0};if(i===on.LIST){const{width:f}=a;l>0?d+=l:u>0&&u>f&&(m.state=!0,m.hangingNumber=u)}else d+=u;return{paddingLeft:d,paddingRight:g,changeBulletWidth:m}}function Hv(r=0,e=0,t=0,n,s){let o=0,i=0;if(!n)return{marginTop:o,spaceBelowApply:i};if(o=Sr(e,r),i=Sr(t,r),s){const{spaceBelowApply:a}=s;a>o&&(o=0,s.lineHeight+=a,s.marginBottom=a)}return{marginTop:o,spaceBelowApply:i}}function Uv(r=[]){for(let e=0;e<r.length;e++){const t=r[e];di(t,!0)}}function v6(r,e,t,n,s,o,i){let a=e,l=e;if(n===gn.DEFAULT||i===te.FALSE)return o===no.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:s*r,lineSpacingApply:r}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(s,r),lineSpacingApply:s};let u=0;return o===no.AUTO?u=s*t:u=s,r+e*2<u&&(a=l=(u-r)/2),{paddingTop:a,paddingBottom:l,contentHeight:r,lineSpacingApply:u}}function zv(r,e,t,n,s){var l;if(!s)return;const o=(l=t.parent)==null?void 0:l.parent;if(!o)return;const i=new Map,a=Wv(t);s.forEach(u=>{if(!u)return;const{initialState:c,drawingOrigin:h}=u;if(c||!h)return;const{objectProperties:d}=h,{positionH:g,positionV:m,size:f,angle:p}=d,{width:b=0,height:v=0}=f;u.aLeft=p6(g,t,o,b,a)||0,u.aTop=_6(m,o,r,e,v,n,a)||0,u.width=b,u.height=v,u.angle=p,u.initialState=!0,i.set(u.objectId,u)}),o.skeDrawings=new Map([...o.skeDrawings,...i])}function Wv(r){const e=r.parent;if(!e)return!1;const t=e==null?void 0:e.columns;if(!t)return!1;const n=t.length;for(let s=n-1;s>=0;s--){const i=t[s].lines,a=i.length;if(!(a<=0)){for(let l=a-1;l>=0;l--)if(i[l].paragraphStart)return!1}}return!0}function Vv(r){const e=r.length;let t=0;for(let n=0;n<e;n++)t+=r[n].width;return t}function $v(r){const e=r.length;let t=-1/0,n;for(let s=0;s<e;s++){const o=r[s],{ba:i,bd:a}=o.bBox;t<i+a&&(n={boundingBoxAscent:i,boundingBoxDescent:a}),t=i+a}return n}function Gv(r){const e=r.divides,t=e.length,n=[];for(let s=0;s<t;s++){const o=e[s];n.push(...o.spanGroup)}return n}function Xv(r,e,t){const{hanging:n,indentStart:s}=r,{hanging:o,indentStart:i}=e;n===void 0&&(r.hanging=o),s===void 0&&(r.indentStart=Sr(i||0,t)-Sr(o||0,t))}function C6(r,e,t,n,s,o){const{pageNumberStart:i,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:u=0,columnProperties:c=[],columnSeparatorType:h=Pn.NONE,contentDirection:d,sectionType:g,sectionTypeNext:m,textDirection:f,lists:p,drawings:b={},fontLocale:v}=n,{elements:w,elementOrder:S,paragraphStyle:T={},bullet:D}=e,{skeHeaders:R,skeFooters:I,skeListLevel:y,blockAnchor:O}=s,M={blockId:r,paragraphStyle:T,skeHeaders:R,skeFooters:I,blockAnchor:O},F=[t];let x=t;const E=new Map,N=Yv(D,y),X=n6(D,p,N,v,o);return jv(D,X,y),M.bulletSkeleton=X,S.forEach((L,ne)=>{const{elementId:G,paragraphElementType:Q}=L;if(Q===K.DRAWING){const P=b[G];P.layoutType===rn.INLINE||E.set(G,Kv(P))}}),S.forEach((L,ne)=>{const{elementId:G,paragraphElementType:Q}=L;let P=[];if(Q===K.TEXT_RUN){const V=w[G],{tr:pe,st:oe,ed:Z}=V;if(!pe)return!1;P=w6(pe,ne,n,x,{...M,paragraphAffectSkeDrawings:E},v)}else if(Q===K.PAGE_BREAK)P=[_o(n,s,E6(x),so.PAGE)],E.clear();else if(Q===K.COLUMN_BREAK){const V=gi(x);V&&!V.isLast?di(V.column,!0):P=[_o(n,s,E6(x),so.COLUMN)]}x=Zv(F,P)}),F}function Yv(r,e){if(!r||!e)return;const{listId:t,nestingLevel:n}=r,s=e==null?void 0:e.get(t);let o=n;o<0&&(o=0);const i=[];for(let a=o;a>=0;a--){const l=s==null?void 0:s[a];i[a]=l||null}return i}function jv(r,e,t){if(!r||!e)return;const{listId:n,nestingLevel:s}=r,o=[...(t==null?void 0:t.get(n))||[]];o[s]=e,o.splice(s+1),t==null||t.set(n,o)}function Kv(r){return{objectId:r.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:r}}function Zv(r,e){const t=r.slice(-1)[0],n=e[0];if(t===n){if(e.length===1)return t;e.shift()}return r.push(...e),r.slice(-1)[0]}function E6(r){return r.pageNumber+1}function w6(r,e=0,t,n,s,o){const{ct:i="",ts:a={},tab:l=!1}=r,u=Ia(a,o),{paragraphStyle:c={}}=s,{gridType:h=gn.LINES,charSpace:d=0,documentTextStyle:g={},defaultTabStop:m=10.5,pageSize:f={width:1/0,height:1/0},marginLeft:p=0,marginRight:b=0}=t,{namedStyleType:v=pa.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:w=ut.UNSPECIFIED,lineSpacing:S=1,spacingRule:T=no.AUTO,snapToGrid:D=te.TRUE,direction:R,spaceAbove:I=0,spaceBelow:y=0,borderBetween:O,borderTop:M,borderBottom:F,borderLeft:x,borderRight:E,indentFirstLine:N=0,hanging:X=0,indentStart:L=0,indentEnd:ne=0,tabStops:G=[],keepLines:Q=te.FALSE,keepNext:P=te.FALSE,wordWrap:V=te.FALSE,widowControl:pe=te.FALSE,shading:oe}=c;let Z=[n];const ie=f.width||1/0-p-b,be={...g,...a},Ce={fontStyle:u,textStyle:be,charSpace:d,gridType:h,snapToGrid:D,pageWidth:ie};if(l){const Te=La(d,m,h,D),Le=r6(Ce,Te);return Z=fc([Le],Z,t,s,e,!0),Z}const fe=i.split("");for(let Te=0;Te<fe.length;Te++){const Le=fe[Te],Ze=Te===0,Ne=i6(Le,Te,fe,Ce);let A=[];if(Ne){const{charIndex:se,spanGroup:re}=Ne;Te=se,A=re}else{const se=lc(Le,Ce);A.push(se)}Z=fc(A,Z,t,s,e,Ze)}return f6(Z,Te=>{qv(Te,w)}),Z}function qv(r,e){if(e===ut.UNSPECIFIED||e===ut.LEFT)return;const{divides:t}=r,n=t.length;for(let s=0;s<n;s++){const o=t[s],{width:i,spanGroup:a}=o,l=b6(o);i!==1/0&&(e===ut.CENTER?o.paddingLeft=(i-l)/2:e===ut.RIGHT?o.paddingLeft=i-l:ut.JUSTIFIED)}}class Jv{}function T6(){return[]}function _c(r,e,t,n,s,o){const i=[],a=new Map;for(let l of r){const{paragraph:u,table:c,tableOfContents:h,blockType:d,customBlock:g,blockId:m}=l;if(s!=null&&s.get(m))continue;let f=[],p=e;i.length>0&&(p=i[i.length-1]),d===Fe.PARAGRAPH&&u?f=C6(l.blockId,u,p,t,n,o):d===Fe.TABLE&&c||d===Fe.SECTION_BREAK&&h||d===Fe.CUSTOM&&(f=P0(l.blockId,g,p,t,n,o)),f.length===0&&(f=T6()),Qv(i,f),a.set(m,!0)}return{pages:i,renderedBlockIdMap:a}}function Qv(r,e){const t=r.length-1,n=r[t],s=e[0];n===s&&e.splice(0,1),r.push(...e)}function eC(){}function _o(r,e,t=1,n=so.SECTION){var Le,Ze,Ne,A;const s=tC(),{pageNumberStart:o=1,pageSize:i={width:1/0,height:1/0},pageOrient:a=oi.PORTRAIT,headerIds:l={},footerIds:u={},useFirstPageHeaderFooter:c,useEvenPageHeaderFooter:h,footers:d,headers:g,columnProperties:m=[],columnSeparatorType:f,marginTop:p=0,marginBottom:b=0,marginHeader:v=0,marginFooter:w=0,marginLeft:S=0,marginRight:T=0,renderConfig:D={}}=r,{skeHeaders:R,skeFooters:I}=e,{width:y=1/0,height:O=1/0}=i;s.pageNumber=t,s.pageNumberStart=o,s.renderConfig=D,s.marginLeft=S,s.marginRight=T,s.breakType=n,s.width=s.pageWidth=y,s.height=s.pageHeight=O,s.pageOrient=a;const{defaultHeaderId:M,evenPageHeaderId:F,firstPageHeaderId:x}=l,{defaultFooterId:E,evenPageFooterId:N,firstPageFooterId:X}=u;let L=M!=null?M:"",ne=E!=null?E:"";t===o&&c?(L=x!=null?x:"",ne=X!=null?X:""):t%2===0&&h&&(L=F!=null?F:"",ne=N!=null?N:"");let G,Q;L&&((Le=R.get(L))!=null&&Le.has(y)?G=(Ze=R.get(L))==null?void 0:Ze.get(y):g&&(G=S6(g[L],r,e),R.set(L,new Map([[y,G]]))),s.headerId=L),ne&&((Ne=I.get(ne))!=null&&Ne.has(y)?Q=(A=I.get(ne))==null?void 0:A.get(y):d&&(Q=S6(d[ne],r,e),I.set(L,new Map([[y,Q]]))),s.footerId=ne),s.marginTop=y6(p,v,G),s.marginBottom=y6(b,w,Q);const P=s.sections,V=P[P.length-1],{marginTop:pe,marginBottom:oe,marginLeft:Z,marginRight:ie}=s,be=y-Z-ie,Ce=O-pe-oe;let fe=0;V&&(fe=V.top+V.height);const Te=oc(m,f,fe,0,be,Ce-fe);return Te.parent=s,P.push(Te),s}function tC(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:oi.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:so.SECTION,st:0,ed:0,skeDrawings:new Map}}function S6(r,e,t,n=!0){const{body:s}=r,{lists:o,headers:i,footers:a,fontLocale:l,pageSize:u,marginLeft:c=0,marginRight:h=0,drawings:d,marginTop:g=0,marginBottom:m=0,marginHeader:f=0,marginFooter:p=0}=e,b=(u==null?void 0:u.width)||1/0,v={lists:o,headers:i,footers:a,pageSize:{width:b-c-h,height:1/0},fontLocale:l,drawings:d},{blockElements:w,blockElementOrder:S}=s,T=[];S.forEach(E=>{const N=w[E];T.push(N)});const D=_o(v,t),R=_c(T,D,v,t).pages[0];Pa([R]);const I=R.sections[0].columns[0],y=I.height||0,{skeDrawings:O,st:M,ed:F}=R,x={lines:I.lines,skeDrawings:O,height:y,st:M,ed:F,marginLeft:c,marginRight:h};return n?{...x,marginTop:nC(g,f,y)}:{...x,marginBottom:rC(m,p,y)}}function y6(r,e,t){return!t||t.lines.length===0?r:Math.max(r,e,(t==null?void 0:t.height)||0)}function nC(r,e,t){const n=Math.max(r,e);return t>n?0:n-t}function rC(r,e,t){const n=Math.max(r,e);return t>n?0:n-t}class bo{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,t=0){this._translateX=e,this._translateY=t}translate(e=0,t=0){this._translateX+=e,this._translateY+=t}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:o=0}=e;this.translate(s,t)}restorePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:o=0}=e;this.translate(-s,-t)}translatePage(e,t=rr.VERTICAL,n=0,s=0,o=0,i=0){const{sections:a,marginTop:l=0,marginBottom:u=0,marginLeft:c=0,marginRight:h=0,pageWidth:d,pageHeight:g,width:m,height:f,pageNumber:p=1,renderConfig:b={}}=e;let v=0,w=0;return t===rr.VERTICAL?v=g+s:t===rr.HORIZONTAL&&(w=d+n),this.translate(w,v),{x:w,y:v}}translateSection(e){const{top:t=0}=e;return this.translate(0,t),{x:0,y:t}}translateColumn(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}translateLine(e,t=!1){const{top:n,marginBottom:s=0,marginTop:o=0,paddingTop:i=0,paddingBottom:a=0}=e,l=n+(t===!0?o:0)+i;return this.translate(0,l),{x:0,y:l}}translateDivide(e){const{left:t,paddingLeft:n}=e,s=t+n;return this.translate(s,0),{x:s,y:0}}translateSpan(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}}var A6=(r=>(r.PENDING="pending",r.CALCULATING="calculating",r.READY="ready",r.INVALID="invalid",r))(A6||{});class Es extends Ju{constructor(e,t){super(t),this._renderedBlockIdMap=new Map,this.onRecalculateChangeObservable=new ye,this._documentData=e}updateDrawing(e,t){const n=this._documentData.drawings;if(!n)return;const s=n[e];if(!s)return;const o=s.objectProperties;o.size.width=t.width,o.size.height=t.height,o.positionH.posOffset=t.left,o.positionV.posOffset=t.top}calculate(e){!this.dirty||(this._skeletonData=this._createSkeleton(e),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(e,t){const n=this._documentData.documentStyle;if(!n.pageSize){e=e!=null?e:1/0,t=t!=null?t:1/0,n.pageSize={width:e,height:t};return}e!==void 0&&(n.pageSize.width=e),t!==void 0&&(n.pageSize.height=t)}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t,blockElementOrder:n}=e;if(!t||n.length===0)return[];const s=[];let o={blockElements:[],sectionBreak:void 0};return n.forEach(i=>{const a=t[i],{sectionBreak:l}=a;l?(o.sectionBreak=l,s.push(o),o={blockElements:[],sectionBreak:void 0}):o.blockElements.push(a)}),o.sectionBreak||(o.sectionBreak={columnProperties:[],columnSeparatorType:Pn.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED},o.blockElements.length>0&&s.push(o)),s}_createSkeleton(e){var ie;const t=this.__getContentMapArr(),n={width:1/0,height:1/0},{documentStyle:s,footers:o,headers:i,lists:a,drawings:l}=this._documentData,{pageNumberStart:u=1,pageSize:c=n,pageOrient:h=oi.PORTRAIT,defaultHeaderId:d,defaultFooterId:g,evenPageHeaderId:m,evenPageFooterId:f,firstPageHeaderId:p,firstPageFooterId:b,useFirstPageHeaderFooter:v,useEvenPageHeaderFooter:w,marginTop:S=0,marginBottom:T=0,marginRight:D=0,marginLeft:R=0,marginHeader:I=0,marginFooter:y=0,charSpace:O=0,linePitch:M=15.6,gridType:F=gn.LINES,paragraphLineGapDefault:x=0,defaultTabStop:E=10.5,textStyle:N={fs:14},renderConfig:X={horizontalAlign:ut.UNSPECIFIED,verticalAlign:tn.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:kt.UNSPECIFIED}}=s,L=this.__getNullSke();if(t.length===0)return L;const ne=this.getFontLocale(),G={footers:o,headers:i,lists:a,drawings:l,charSpace:O,linePitch:M,gridType:F,fontLocale:ne,paragraphLineGapDefault:x,defaultTabStop:E,documentTextStyle:N},{skeHeaders:Q,skeFooters:P,skeListLevel:V,blockAnchor:pe}=L,oe={skeHeaders:Q,skeFooters:P,skeListLevel:V,blockAnchor:pe},Z=[];L.pages=Z;for(let be=0;be<t.length;be++){const Ce=t[be];if(!Ce.sectionBreak)continue;const{pageNumberStart:fe=u,pageSize:Te=c,pageOrient:Le=h,marginTop:Ze=S,marginBottom:Ne=T,marginRight:A=D,marginLeft:se=R,marginHeader:re=I,marginFooter:B=y,defaultHeaderId:k=d,defaultFooterId:Y=g,evenPageHeaderId:le=m,evenPageFooterId:ae=f,firstPageHeaderId:j=p,firstPageFooterId:he=b,useFirstPageHeaderFooter:H=v,useEvenPageHeaderFooter:z=w,columnProperties:J=[],columnSeparatorType:ue=Pn.NONE,contentDirection:de,sectionType:ze,textDirection:De,renderConfig:Be=X}=Ce.sectionBreak,ce=t[be+1],Se=(ie=ce==null?void 0:ce.sectionBreak)==null?void 0:ie.sectionType,ve={defaultHeaderId:k,evenPageHeaderId:le,firstPageHeaderId:j},$e={defaultFooterId:Y,evenPageFooterId:ae,firstPageFooterId:he};Te.width===null&&(Te.width=1/0),Te.height===null&&(Te.height=1/0);const Ve={pageNumberStart:fe,pageSize:Te,pageOrient:Le,marginTop:Ze,marginBottom:Ne,marginRight:A,marginLeft:se,marginHeader:re,marginFooter:B,headerIds:ve,footerIds:$e,useFirstPageHeaderFooter:H,useEvenPageHeaderFooter:z,columnProperties:J,columnSeparatorType:ue,contentDirection:de,sectionType:ze,sectionTypeNext:Se,textDirection:De,renderConfig:Be,...G};let qe=Cs(Z),U=!1;ze===Gr.CONTINUOUS?(Pa(Z),this.__addNewSectionByContinuous(qe,J,ue),U=!0):qe=_o(Ve,oe,qe==null?void 0:qe.pageNumber);const q=this.getContext(),Je=_c(Ce.blockElements,qe,Ve,oe,this._renderedBlockIdMap,q);Se===Gr.CONTINUOUS&&J.length>0;const{pages:Ws,renderedBlockIdMap:ls}=Je;U&&Ws.splice(0,1),Z.push(...Ws)}return Pa(Z),L}__addNewSectionByContinuous(e,t,n){const s=e.sections,o=s[s.length-1],{pageWidth:i,pageHeight:a,marginTop:l,marginBottom:u,marginLeft:c,marginRight:h}=e,d=i-c-h,g=a-l-u,m=((o==null?void 0:o.top)||0)+((o==null?void 0:o.height)||0),f=oc(t,n,m,0,d,g-m);f.parent=e,s.push(f)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}static create(e,t){return new Es(e,t)}}class sC extends nc{constructor(e,t,n=!1){super(e),this._skeleton=t,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new Tr),this.onIsAddedToParentObserver.add(s=>{var o;(o=s==null?void 0:s.getEngine())==null||o.onTransformChangeObservable.add(i=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas()})}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(e,t),e.restore()}_getBounding(e){}_draw(e,t){}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===Xe.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}}var bc=(r=>(r[r.SPAN=0]="SPAN",r[r.LINE=1]="LINE",r))(bc||{});class Ha extends Qu{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}const oC="DefaultDocsFontAndBaseLineExtension";class iC extends Ha{constructor(){super(...arguments),this.uKey=oC,this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var g;if(!((g=n.parent)==null?void 0:g.parent))return;const{ts:o,content:i,fontStyle:a,bBox:l}=n;let{spanPointWithFont:u=xe.create(0,0)}=this.extensionOffset;if(!o){i!=null&&e.fillText(i,u.x,u.y);return}if(i==null)return;this._preFontString!==(a==null?void 0:a.fontString)&&(e.font=this._preFontString=(a==null?void 0:a.fontString)||"");const{cl:c,va:h}=o,d=Ft(c)||Cr;if(d&&this._preFontColor!==d&&(e.fillStyle=d),h===cn.SUBSCRIPT||h===cn.SUPERSCRIPT){let m=l.spo;h===cn.SUPERSCRIPT&&(m=-l.sbo),u.y+=m}e.fillText(i,u.x,u.y)}clearCache(){this._preFontString="",this._preFontColor=""}}fo.add(new iC);const aC="DefaultDocsBackgroundExtension";class lC extends Ha{constructor(){super(...arguments),this.uKey=aC,this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var d;const s=(d=n.parent)==null?void 0:d.parent;if(!s)return;const{lineHeight:o=0}=s,{ts:i,width:a,content:l}=n;if(!i)return;const{bg:u}=i;if(!u)return;const c=Ft(u),{spanStartPoint:h=xe.create(0,0)}=this.extensionOffset;c&&(e.fillStyle=c,e.fillRect(h.x-.5,h.y,a+1,o))}clearCache(){this._preBackgroundColor=""}}fo.add(new lC);const uC="DefaultDocsLineExtension";class cC extends Ha{constructor(){super(...arguments),this.uKey=uC,this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var D;const s=(D=n.parent)==null?void 0:D.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:a,left:l,width:u,bBox:c}=n;if(!a)return;const{sp:h}=c,d=_s(t),{ul:g,st:m,ol:f}=a,{originTranslate:p=xe.create(0,0),centerPoint:b=xe.create(0,0),alignOffset:v=xe.create(0,0),renderConfig:w={}}=this.extensionOffset,{centerAngle:S=0,vertexAngle:T=0}=w;if(g){const{s:R,cl:I,t:y}=g;if(R===te.TRUE){e.beginPath();const O=Ft(I)||Cr;e.strokeStyle=O,this._setLineType(e,y||Tt.SINGLE);const M=Ue(i+Bu-.5,d),F=wr(p.addByPoint(l,M),b,S,T,v),x=wr(p.addByPoint(l+u,M),b,S,T,v);e.moveTo(F.x,F.y),e.lineTo(x.x,x.y),e.stroke()}}if(m){const{s:R,cl:I,t:y}=m;if(R===te.TRUE){e.beginPath();const O=Ft(I)||Cr;e.strokeStyle=O,this._setLineType(e,y||Tt.SINGLE);const M=Ue(h-.5,d),F=wr(p.addByPoint(l,M),b,S,T,v),x=wr(p.addByPoint(l+u,M),b,S,T,v);e.moveTo(F.x,F.y),e.lineTo(x.x,x.y),e.stroke()}}if(f){const{s:R,cl:I,t:y}=f;if(R===te.TRUE){e.beginPath();const O=Ft(I)||Cr;e.strokeStyle=O,this._setLineType(e,y||Tt.SINGLE);const M=Ue(-Bu-.5,d),F=wr(p.addByPoint(l,M),b,S,T,v),x=wr(p.addByPoint(l+u,M),b,S,T,v);e.moveTo(F.x,F.y),e.lineTo(x.x,x.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Tt.DASH_DOT_DOT_HEAVY||t===Tt.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Tt.DASH_DOT_HEAVY||t===Tt.DOT_DASH?e.setLineDash([2,5,2]):t===Tt.DOTTED||t===Tt.DOTTED_HEAVY?e.setLineDash([2]):t===Tt.DASH||t===Tt.DASHED_HEAVY?e.setLineDash([3]):t===Tt.DASH_LONG||t===Tt.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Tt.WAVY_HEAVY||e===Tt.DASHED_HEAVY||e===Tt.DOTTED_HEAVY||e===Tt.DASH_DOT_HEAVY||e===Tt.DASH_LONG_HEAVY||e===Tt.DASH_DOT_DOT_HEAVY?t=2:e===Tt.THICK&&(t=3),t}}fo.add(new cC);const hC="DefaultDocsBorderExtension";class dC extends Ha{constructor(){super(...arguments),this.uKey=hC,this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var m;const s=(m=n.parent)==null?void 0:m.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:a,left:l,width:u}=n;if(!a)return;const{bd:c}=a;if(!c)return;const h=this._getScale(t),d=this._createBorderCache(c),{spanStartPoint:g=xe.create(0,0)}=this.extensionOffset;for(let f of d.keys()){const p=d.get(f);if(!p)continue;const{s:b,cl:v}=p,w=Ft(v)||Cr;b!==this._preBorderStyle&&(Gu(e,b),e.lineWidth=Xu(b)/h,this._preBorderStyle=b),w!==this._preBorderColor&&(e.strokeStyle=w||Cr,this._preBorderColor=w),$u(e,f,{startX:g.x,startY:g.y,endX:g.x+u,endY:g.y+i})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:s,r:o}=e,i=new Map;return t&&i.set(Vt.TOP,t),n&&i.set(Vt.BOTTOM,n),s&&i.set(Vt.LEFT,s),o&&i.set(Vt.RIGHT,o),i}}fo.add(new dC);var Ua=(r=>(r[r.page=0]="page",r[r.section=1]="section",r[r.column=2]="column",r[r.line=3]="line",r[r.divide=4]="divide",r[r.span=5]="span",r))(Ua||{});const vo={page:0,section:1,column:2,line:3,divide:4,span:5},gC="__TestSelectionRange__",fC="__TestSelectionAnchor__";class R6{constructor(e,t,n){this._scene=e,this.startNodePosition=t,this.endNodePosition=n,this._current=!1,this._Liquid=new bo,this._cursor=0,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(e,t){return e.page>t.page?!1:e.page<t.page?!0:e.section>t.section?!1:e.section<t.section?!0:e.column>t.column?!1:e.column<t.column?!0:e.line>t.line?!1:e.line<t.line?!0:e.divide>t.divide?!1:e.divide<t.divide?!0:e.span>t.span?!1:(e.span<t.span,!0)}_compareNodePosition(e,t){return this._compareNodePositionLogic(e,t)?{start:e,end:t}:{start:t,end:e}}_setNodePositionState(e=0,t,n,s){s===t?this._currentStartState[e]=1:this._currentStartState[e]=0,s===n?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let n=e,s;for(;n>=0;){const o=Ua[n];let i;if(t?i=this._currentStartState[o]:i=this._currentEndState[o],i===void 0)return;if(s===void 0&&(s=i),i!==s)return 0;n--}return s}_getSelectionRuler(e,t,n,s,o){let i=0,a=s;const l=Ua[e],u=Ua[e+1];if(u===null||l===null)return{start_nest:i,end_nest:a};const c=t[l],h=n[l];this._setNodePositionState(l,c,h,o);const d=this._checkPreviousNodePositionState(e),g=this._checkPreviousNodePositionState(e,!1);return d===1&&(i=t[u]),g===2&&(a=n[u]),{start_nest:i,end_nest:a}}_pushToPoints(e){const{startX:t,startY:n,endX:s,endY:o}=e,i=[];return i.push({x:t,y:n}),i.push({x:s,y:n}),i.push({x:s,y:o}),i.push({x:t,y:o}),i.push({x:t,y:n}),i}isSamePosition(){const e=this.startNodePosition,t=this.endNodePosition;if(e==null||t==null)return!1;const n=Object.keys(vo);for(let s of n){const o=e[s],i=t[s];if(o!==i)return!1}return!0}_createAndUpdateRange(e,t,n){if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}const s=new Ma(gC+St(6),{pointsGroup:e,fill:pt(Wn.black,.2),left:t,top:n,evented:!1});this._rangeShape=s,this._scene.addObject(s,2)}_getAnchorBounding(e){const t=e[0],n=t[0],s=t[2],{x:o,y:i}=n,{x:a,y:l}=s;return{left:o,top:i,width:a-o,height:l-i}}_createAndUpdateAnchor(e,t,n){const s=this._getAnchorBounding(e),{left:o,top:i,width:a,height:l}=s;if(this._anchorShape){this._anchorShape.transformByState({left:o+t,top:i+n,height:l}),this._anchorShape.show();return}const u=new tt(fC+St(6),{left:o+t,top:i+n,height:l,strokeWidth:1,stroke:pt(Wn.black),evented:!1});this._anchorShape=u,this._scene.addObject(u,2)}_getRangePointData(e,t,n){const s=[],o=[];if(e==null||t==null)return{pointGroup:s,cursorList:o};const{start:i,end:a}=this._compareNodePosition(e,t),l=i.isBack,u=a.isBack;return this._selectionIterator(i,a,n,(c,h,d,g)=>{var N;const{lineHeight:m}=g,{spanGroup:f,st:p}=d,{x:b,y:v}=this._Liquid;let w;const S=f[c],T=f[h],D=(S==null?void 0:S.left)||0,R=(S==null?void 0:S.width)||0,I=(T==null?void 0:T.left)||0,y=(T==null?void 0:T.width)||0;let O=(S==null?void 0:S.spanType)===on.LIST,M=((N=f[0])==null?void 0:N.spanType)===on.LIST,F=c+p,x=h+p;const E=i===a;if(c===0&&h===f.length-1)w={startX:b+D+(O?R:0),startY:v,endX:b+I+y,endY:v+m};else{const X=(l||c===0&&!E)&&!O,L=u&&h!==f.length-1;F+=X?0:1,F-=M?1:0,x+=L?0:1,x-=M?1:0,console.log("span",{hasList:M,isStartBackFin:X,isEndBackFin:L,firstSpan:S,lastSpan:T,start_sp:c,end_sp:h,isStartBack:l,isEndBack:u,cursorStart:F,cursorEnd:x,isCurrentList:O}),w={startX:b+D+(X?0:R),startY:v,endX:b+I+(L?0:y),endY:v+m}}s.push(this._pushToPoints(w)),o.push({cursorStart:F,cursorEnd:x,isCollapse:E})}),{pointGroup:s,cursorList:o}}_selectionIterator(e,t,n,s){const o=n.getSkeleton();if(!o)return[];this._Liquid.reset();const a=o.getSkeletonData().pages,{page:l}=e,{page:u}=t;this._resetCurrentNodePositionState();for(let c=0;c<=l-1;c++){const h=a[c];this._Liquid.translatePage(h,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let c=l;c<=u;c++){const h=a[c],d=h.sections,{start_nest:g,end_nest:m}=this._getSelectionRuler(vo.page,e,t,d.length-1,c);this._Liquid.translatePagePadding(h);for(let f=g;f<=m;f++){const p=d[f],b=p.columns,{start_nest:v,end_nest:w}=this._getSelectionRuler(vo.section,e,t,b.length-1,f);this._Liquid.translateSection(p);for(let S=v;S<=w;S++){const T=b[S],D=T.lines,{start_nest:R,end_nest:I}=this._getSelectionRuler(vo.column,e,t,D.length-1,S);this._Liquid.translateColumn(T);for(let y=R;y<=I;y++){const O=D[y],{divides:M,type:F,lineHeight:x=0}=O,{start_nest:E,end_nest:N}=this._getSelectionRuler(vo.line,e,t,M.length-1,y);this._Liquid.translateSave(),this._Liquid.translateLine(O);for(let X=E;X<=N;X++){const L=M[X];this._Liquid.translateSave(),this._Liquid.translateDivide(L);const ne=L.spanGroup,{start_nest:G,end_nest:Q}=this._getSelectionRuler(vo.divide,e,t,ne.length-1,X);s&&s(G,Q,L,O,T,p,h),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}}}_setCursor(e){if(e.length===0)return;const t=e[0];this._cursor=t.cursorStart,console.log("_setCursor",t.cursorStart,t)}getCursor(){return this._cursor}getAnchor(){return this._anchorShape}activeStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:pt(Wn.black,1)})}deactivateStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:pt(Wn.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return this.startNodePosition==null&&this.endNodePosition==null}isCollapsed(){return!!(this.startNodePosition!=null&&this.endNodePosition==null||this.isSamePosition())}isRange(){const e=this.startNodePosition,t=this.endNodePosition;return!(e==null||t==null||this.isSamePosition())}dispose(){var e,t;(e=this._rangeShape)==null||e.dispose(),this._rangeShape=null,(t=this._anchorShape)==null||t.dispose(),this._anchorShape=null}isIntersection(e){return!1}refresh(e){var a,l;const t=this.startNodePosition,n=this.endNodePosition;if((a=this._anchorShape)==null||a.hide(),(l=this._rangeShape)==null||l.hide(),this.isEmpty())return;if(this.isCollapsed()){const u=this._getRangePointData(t,t,e),{pointGroup:c,cursorList:h}=u;this._setCursor(h),c.length>0&&this._createAndUpdateAnchor(c,e.left,e.top);return}const s=this._getRangePointData(t,n,e),{pointGroup:o,cursorList:i}=s;this._setCursor(i),o.length>0&&this._createAndUpdateRange(o,e.left,e.top)}getStart(){if(this.startNodePosition==null)return this.endNodePosition;if(this.endNodePosition==null)return this.startNodePosition;const{start:e}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return e}}class vc{constructor(e){var t;this._documents=e,this._textSelectionList=[],this._viewPortObserverMap=new Map,this.onKeydownObservable=new ye,this.onInputObservable=new ye,this.onCompositionstartObservable=new ye,this.onCompositionupdateObservable=new ye,this.onCompositionendObservable=new ye,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=(t=this._documents)==null?void 0:t.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}_initialDom(){const e=document.createElement("div");e.style.position="absolute",e.style.position="absolute",e.style.left="0px",e.style.top="0px";const t=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div");t.appendChild(n),e.appendChild(t),e.appendChild(s),this._container=e,this._inputParent=t,this._input=n,this._cursor=s,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(e)}_initialInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.style.cssText=`
            position: absolute; 
            overflow: hidden; 
            opacity: 1; 
            background: #000; 
            color: transparent; 
            outline: none; 
            z-index: -2; 
            caret-color: transparent; 
            white-space: pre-wrap; 
            user-select: text;
        `}_initialCursorDom(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,N0("keyframes univer_cursor_blinkStyle")||M0([`
                @-webkit-keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `])}_getSkeletonData(){var e,t;return(t=(e=this._documents)==null?void 0:e.getSkeleton())==null?void 0:t.getSkeletonData()}_getNodePosition(e){var i;if(e===!1)return;const{node:t,ratioX:n,ratioY:s}=e,o=(i=this._documents)==null?void 0:i.findPositionBySpan(t);if(o!=null)return{...o,isBack:n<.5}}_interactTextSelection(e){const t=[];let n=!1;this._textSelectionList.forEach(s=>{e.isIntersection(s)?(n=!0,s.dispose()):t.push(s)}),n&&(t.push(e),this._textSelectionList=t)}_deleteAllTextSelection(){this._textSelectionList.forEach(e=>{e.dispose()}),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach(e=>{e.deactivate()})}_addTextSelection(e){this._deactivateTextSelection(),e.activate(),this._textSelectionList.push(e)}_updateTextSelection(e){if(!this._documents)return;let t=this._textSelectionList.pop();t||(t=new R6(this._documents.getScene(),e)),this._deleteAllTextSelection(),t.activate(),t.startNodePosition=e,t.endNodePosition=null,this._textSelectionList=[t]}_getActiveTextSelection(){const e=this._textSelectionList;for(let t of e)if(t.isActive())return t}_isEmptyTextSelection(){return this._textSelectionList.length===0}_getCanvasOffset(){var o,i;const e=(o=this._documents)==null?void 0:o.getEngine(),t=(i=e==null?void 0:e.getCanvas())==null?void 0:i.getCanvasEle();if(!t)return{left:0,top:0};const{top:n,left:s}=q2(t);return{left:s,top:n}}_syncDomToSelection(){var u;const e=this._getActiveTextSelection(),t=e==null?void 0:e.getAnchor();if(!t||t&&!t.visible)return;const{height:n,left:s,top:o}=t,i=(u=this._activeViewport)==null?void 0:u.getAbsoluteVector(xe.FromArray([s,o]));this._cursor.style.height=`${n}px`;let{left:a,top:l}=this._getCanvasOffset();a+=(i==null?void 0:i.x)||0,l+=(i==null?void 0:i.y)||0,this.active(a,l)}_moving(e,t,n){if(ao(n),!this._documents)return;const s=this._documents.findNodeByCoord(e,t),o=this._getNodePosition(s);if(!o)return;const i=this._getActiveTextSelection();!i||(i.endNodePosition=o,i.refresh(this._documents),this._interactTextSelection(i))}_attachScrollEvent(e){if(!e)return;const t=e.viewPortKey;if(this._viewPortObserverMap.has(t))return;const n=e.onScrollBeforeObserver.add(o=>{if(!o.viewport)return;const a=this._getActiveTextSelection();a==null||a.activeStatic(),this._cursor.style.display="none"}),s=e.onScrollStopObserver.add(o=>{const i=o.viewport;if(!i)return;const a=i.getBounding(),l=this._getActiveTextSelection(),u=l==null?void 0:l.getAnchor();if(!(!u||u&&!u.visible)){if(a){const{minX:c,maxX:h,minY:d,maxY:g}=ci(u,a);if(u.strokeWidth<c||h<0||u.strokeWidth<d||g<0)return}this._syncDomToSelection(),l==null||l.deactivateStatic(),this._cursor.style.display="revert"}});this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:s})}_attachInputEvent(){this._input.addEventListener("keydown",e=>{if(this._isIMEInputApply)return;const t=this._getActiveTextSelection();this._documents!=null&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:e,content:"",document:this._documents,selection:t}))}),this._input.addEventListener("input",e=>{if(this._isIMEInputApply)return;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onInputObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionstart",e=>{this._isIMEInputApply=!0;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionstartObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionend",e=>{this._isIMEInputApply=!1;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionendObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionupdate",e=>{const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionupdateObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})})}_attachSelectionEvent(e){this._moveInObserver=e.onPointerEnterObserver.add(()=>{e.cursor=ht.TEXT}),this._moveOutObserver=e.onPointerLeaveObserver.add(()=>{e.cursor=ht.DEFAULT,t.resetCursor()});const t=e.getScene();this._downObserver=e.onPointerDownObserver.add((n,s)=>{const{offsetX:o,offsetY:i}=n;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(o,i);const a=this._documents.findNodeByCoord(o,i),l=this._getNodePosition(a);if(console.log(a,o,i),!l){this._deleteAllTextSelection();return}if(n.ctrlKey||this._isEmptyTextSelection()){const d=new R6(this._documents.getScene(),l);this._addTextSelection(d)}else this._updateTextSelection(l);this._activeSelectionRefresh(),this._syncDomToSelection(),t.disableEvent();const u=Kr.create(t);u.startScroll(o,i);const{scrollX:c,scrollY:h}=ao(u);this._viewportScrollX=c,this._viewportScrollY=h,this._moveObserver=t.onPointerMoveObserver.add(d=>{const{offsetX:g,offsetY:m}=d;this._moving(g,m,u),u.scrolling(g,m,()=>{this._moving(g,m,u)}),t.setCursor(ht.TEXT)}),this._upObserver=t.onPointerUpObserver.add(d=>{t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),u.stopScroll()})})}_detachEvent(e){var t;e.onPointerEnterObserver.remove(this._moveInObserver),e.onPointerLeaveObserver.remove(this._moveOutObserver),e.onPointerDownObserver.remove(this._downObserver),(t=e.getSkeleton())==null||t.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const e=this._getActiveTextSelection();e==null||e.refresh(this._documents)}add(e){this._addTextSelection(e)}remain(){const e=this._getActiveTextSelection();if(e==null)return;const t=this._textSelectionList.indexOf(e);return this._textSelectionList.splice(t,1)[0]}sync(){this._syncDomToSelection()}active(e,t){this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout(()=>{this._input.focus()},0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(e){var t;this._documents&&this._detachEvent(this._documents),this._documents=e,this._skeletonObserver=(t=e.getSkeleton())==null?void 0:t.onRecalculateChangeObservable.add(n=>{this._deleteAllTextSelection()}),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}set activeViewport(e){this._attachScrollEvent(e),this._activeViewport=e}static create(e){return new vc(e)}}class ws extends sC{constructor(e,t,n){super(e,t,n==null?void 0:n.allowCache),this._hasEditor=!1,this.isCalculateSkeleton=!0,this.onPageRenderObservable=new ye,(n==null?void 0:n.pageMarginLeft)===void 0?this.pageMarginLeft=17:this.pageMarginLeft=n==null?void 0:n.pageMarginLeft,(n==null?void 0:n.pageMarginTop)===void 0?this.pageMarginTop=14:this.pageMarginTop=n==null?void 0:n.pageMarginTop,this.pageLayoutType=(n==null?void 0:n.pageLayoutType)||rr.VERTICAL,this._drawLiquid=new bo,this._findLiquid=new bo,this._hasEditor=(n==null?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(t),this.makeDirty(!0)}_draw(e,t){this.draw(e,t)}_horizontalHandler(e,t,n,s){let o=0;return s===ut.CENTER?o=(this.width-e)/2:s===ut.RIGHT?o=this.width-e-n:o=t,o}_verticalHandler(e,t,n,s){let o=0;return s===tn.MIDDLE?o=(this.height-e)/2:s===tn.BOTTOM?o=this.height-e-n:o=t,o}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){fo.getData().forEach(e=>{this.register(e)})}_addSkeletonChangeObserver(e){!e||(this._skeletonObserver=e.onRecalculateChangeObservable.add(t=>{const n=t.pages;let s=0,o=0;for(let i=0,a=n.length;i<a;i++){const l=n[i],{pageWidth:u,pageHeight:c}=l;this.pageLayoutType===rr.VERTICAL?(o+=c,i!==a-1&&(o+=this.pageMarginTop),s=Math.max(s,u)):this.pageLayoutType===rr.HORIZONTAL&&(s+=u,i!==a-1&&(s+=this.pageMarginLeft),o=Math.max(o,c))}this.resize(s,o),this.calculatePagePosition()}))}_disposeSkeletonChangeObserver(e){!e||e.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(e){const{pageWidth:t,pageHeight:n}=e;let{x:s,y:o}=this._findLiquid,i=-1,a=-1;return this.pageLayoutType===rr.VERTICAL?(i=t,a=o+n):this.pageLayoutType===rr.HORIZONTAL&&(i=s+t,a=n),{startX:s,startY:o,endX:i,endY:a}}calculatePagePosition(){const e=this.getScene();let t=e==null?void 0:e.getParent();const{width:n,height:s,pageMarginLeft:o,pageMarginTop:i}=this;if(t==null)return;const{width:a,height:l}=t;let u=0,c=0,h=0,d=0;a>n?(u=a/2-n/2,h=a-30):(u=o,h=n+o*2),l>s?(c=l/2-s/2,d=l-30):(c=i,d=s+i*2),e.resize(h,d+200),this.translate(u,c)}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(e,t){return this.getScene().getActiveViewportByCoord(xe.FromArray([e,t]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=vc.create(this),this._hasEditor=!0)}disableEditor(){var e;(e=this._editor)==null||e.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:s,onKeydownObservable:o}=this._editor;return{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:s,onKeydownObservable:o}}remainActiveSelection(){if(!!this._hasEditor)return this._editor.remain()}addSelection(e){if(!!this._hasEditor)return this._editor.add(e)}syncSelection(){if(!!this._hasEditor)return this._editor.sync()}get hasEditor(){return this._hasEditor}draw(e,t){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const s=n.getSkeletonData(),{pages:o}=s,i=this.getParentScale(),a=this.getExtensionsByOrder(),l=_s(i);for(let h of a)h.clearCache();let u=0,c=0;for(let h=0,d=o.length;h<d;h++){const g=o[h],{sections:m,marginTop:f=0,marginBottom:p=0,marginLeft:b=0,marginRight:v=0,width:w,height:S,renderConfig:T={}}=g,{verticalAlign:D=tn.TOP,horizontalAlign:R=ut.LEFT,centerAngle:I=0,vertexAngle:y=0,wrapStrategy:O=kt.UNSPECIFIED,isRotateNonEastAsian:M=te.FALSE}=T,F=this._horizontalHandler(w,b,v,R),x=this._verticalHandler(S,f,p,D),E=xe.create(F,x),N=oo(I),X=oo(y),L=X-N;this.onPageRenderObservable.notifyObservers({page:g,pageLeft:c,pageTop:u,ctx:e}),this._startRotation(e,L);for(let Q of m){const{columns:P}=Q;this._drawLiquid.translateSection(Q);for(let V of P){const{lines:pe,width:oe}=V;this._drawLiquid.translateColumn(V);const Z=pe.length;let ie,be=null;if(X!==0){const{rotateTranslateXList:Ce,rotatedHeight:fe,rotatedWidth:Te,fixOffsetX:Le,fixOffsetY:Ze,rotateTranslateY:Ne}=ju(pe,oe,X);let A=Te;fe>this.height&&O!==kt.WRAP&&(O===kt.OVERFLOW||X>0)&&(A=this.height/Math.tan(Math.abs(X)));const se=this._horizontalHandler(A,b,v,R);let B=this._verticalHandler(fe,f,p,D)-Ze;fe>this.height&&(X<0?B=this.height-(fe+Ze):B=-Ze),ie=xe.create(se+Le,B),this._drawLiquid.translate(0,-Ne),be=Ce}else ie=E;for(let Ce=0;Ce<Z;Ce++){const fe=pe[Ce],{divides:Te,asc:Le=0,type:Ze,lineHeight:Ne=0}=fe;let A=Le;const se=A*Math.sin(N),re=A*Math.cos(N);if(Ze===ii.BLOCK)for(let B of a)B.type===bc.LINE&&(B.extensionOffset={alignOffset:ie,renderConfig:T},B.draw(e,i,fe));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(fe,!0),be&&this._drawLiquid.translate(be[Ce]);const B=Te.length;for(let k=0;k<B;k++){const Y=Te[k],{spanGroup:le}=Y;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(Y);for(let ae of le){if(!ae.content||ae.content.length===0)continue;const{width:j,left:he}=ae,{x:H,y:z}=this._drawLiquid,J=xe.create(Ue(H,l),Ue(z,l)),ue=xe.create(Ue(j/2,l),Ue(Ne/2,l)),de=wr(J.addByPoint(Ue(he,l),0),ue,N,X,ie),ze=wr(J.addByPoint(Ue(he+se,l),Ue(re,l)),ue,N,X,ie),De={originTranslate:J,spanStartPoint:de,spanPointWithFont:ze,centerPoint:ue,alignOffset:ie,renderConfig:T};for(let Be of a)Be.type===bc.SPAN&&(Be.extensionOffset=De,Be.draw(e,i,ae))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,L);const{x:ne,y:G}=this._drawLiquid.translatePage(g,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);c+=ne,u+=G}}changeSkeleton(e){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(e),this._addSkeletonChangeObserver(e),this}findPositionBySpan(e){var m;const t=e.parent,n=t==null?void 0:t.parent,s=n==null?void 0:n.parent,o=s==null?void 0:s.parent,i=o==null?void 0:o.parent,a=(m=this.getSkeleton())==null?void 0:m.getSkeletonData();if(!t||!s||!o||!i||!a)return;let l=t.spanGroup.indexOf(e);const u=n.divides.indexOf(t),c=s.lines.indexOf(n),h=o.columns.indexOf(s),d=i.sections.indexOf(o),g=a.pages.indexOf(i);return{span:l,divide:u,line:c,column:h,section:d,page:g}}findNodeByCharIndex(e){const t=this.getSkeleton();if(!t)return;const s=t.getSkeletonData().pages;for(let o of s){const{sections:i,st:a,ed:l}=o;if(!(e<a||e>l))for(let u of i){const{columns:c,st:h,ed:d}=u;if(!(e<h||e>d))for(let g of c){const{lines:m,st:f,ed:p}=g;if(!(e<f||e>p))for(let b of m){const{divides:v,lineHeight:w,st:S,ed:T}=b,D=v.length;if(!(e<S||e>T))for(let R=0;R<D;R++){const I=v[R],{spanGroup:y,st:O,ed:M}=I;if(e<O||e>M)continue;const F=y[e-O];if(F)return F}}}}}}findNodeByCoord(e,t){const s=this.getScene().transformToSceneCoord(xe.FromArray([e,t]));if(!s)return!1;const o=this._getInverseCoord(s);let{x:i,y:a}=o;const l=this.getSkeleton();if(!l)return!1;this._findLiquid.reset();const c=l.getSkeletonData().pages;for(let h=0,d=c.length;h<d;h++){const g=c[h],{startX:m,startY:f,endX:p,endY:b}=this._getPageBoundingBox(g);if(!(i>=m&&i<=p&&a>=f&&a<=b)){this._translatePage(g);continue}this._findLiquid.translatePagePadding(g);const v=g.sections;for(let w of v){const{columns:S,height:T}=w;this._findLiquid.translateSection(w);const{y:D}=this._findLiquid;if(a>=D&&a<=D+T)for(let R of S){const{lines:I,width:y}=R;this._findLiquid.translateColumn(R);const{x:O}=this._findLiquid;if(!(i>=O&&i<=O+y))continue;const M=I.length;for(let F=0;F<M;F++){const x=I[F],{divides:E,type:N,lineHeight:X=0}=x;if(N!==ii.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(x);const{y:L}=this._findLiquid,ne=L,G=L+X;if(!(a>=ne&&a<=G)){this._findLiquid.translateRestore();continue}const Q=E.length;for(let P=0;P<Q;P++){const V=E[P],{spanGroup:pe,width:oe}=V;this._findLiquid.translateSave(),this._findLiquid.translateDivide(V);const{x:Z}=this._findLiquid;if(!(i>=Z&&i<=Z+oe)){this._findLiquid.translateRestore();continue}for(let ie of pe){if(!ie.content||ie.content.length===0)continue;const{width:be,left:Ce}=ie,fe=Z+Ce,Te=Z+Ce+be;if(i>=fe&&i<=Te)return{node:ie,ratioX:i/(fe+Te),ratioY:a/(ne+G)}}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(g),this._translatePage(g)}return!1}_translatePage(e){this._findLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}static create(e,t,n){return new ws(e,t,n)}}class mC{}class pC{}var I6=(r=>(r[r.OFF=0]="OFF",r[r.ON=1]="ON",r))(I6||{});class Cc extends nc{constructor(e,t){super(e),this._skeleton=t}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,t),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===Xe.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e,t,n){const s=e.length,o=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:o-1};let i=-1,a=-1,l=-1,u=-1;return i=Ln(e,n.tl.y),a=Ln(e,n.bl.y),i===-1&&(i=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=Ln(t,n.tl.x),u=Ln(t,n.tr.x),l===-1&&(l=0),u===-1&&(u=o-1),u>=o&&(u=o-1),{startRow:i-1,endRow:a+1,startColumn:l-1,endColumn:u+1}}_draw(e,t){}}class Ec extends Cc{_draw(e,t){this.draw(e,t)}}var x6=(r=>(r[r.GRID=0]="GRID",r))(x6||{});class Ts extends Qu{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,s,o){return io(e,t,n,s,o)}}const _C="DefaultBackgroundExtension";class D6 extends Ts{constructor(){super(...arguments),this.uKey=_C,this.zIndex=20}draw(e,t,n){const{rowTitleWidth:s,columnTitleHeight:o,dataMergeCache:i,stylesCache:a}=n,{background:l}=a;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:c,columnWidthAccumulation:h,rowTotalHeight:d}=n;if(!u||!h||c===void 0||d===void 0)return;e.save();const{scaleX:g=1,scaleY:m=1}=t;l&&Object.keys(l).forEach(f=>{const p=l[f];e.fillStyle=f||pt([255,255,255]),e.beginPath(),p.forEach((b,v)=>{v.forEach(w=>{let{isMerged:S,startY:T,endY:D,startX:R,endX:I}=this.getCellIndex(b,w,u,h,i);if(S)return!0;T=Ue(T,m),D=Ue(D,m),R=Ue(R,g),I=Ue(I,g),e.moveTo(R,T),e.lineTo(R,D),e.lineTo(I,D),e.lineTo(I,T)})}),e.closePath(),e.fill()}),e.restore()}}go.add(new D6);const bC="DefaultBorderExtension";class O6 extends Ts{constructor(){super(...arguments),this.uKey=bC,this.zIndex=30}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:o,columnTitleHeight:i,dataMergeCache:a,stylesCache:l,overflowCache:u}=n,{border:c}=l;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;e.save();const{scaleX:f=1,scaleY:p=1}=t,b=this._getScale(t);let v,w;c==null||c.forEach((S,T)=>{T==null||T.forEach((D,R)=>{if(!R)return!0;let{isMerged:I,startY:y,endY:O,startX:M,endX:F}=this.getCellIndex(S,D,h,g,a);if(I)return!0;y=Ue(y,p),O=Ue(O,p),M=Ue(M,f),F=Ue(F,f);for(let x in R){const{type:E,style:N,color:X}=R[x];this._getOverflowExclusion(u,E,S,D)||(N!==v&&(Gu(e,N),e.lineWidth=Xu(N)/b,v=N),X!==w&&(e.strokeStyle=X||Cr,w=X),$u(e,E,{startX:M,startY:y,endX:F,endY:O}))}})}),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,s){let o=!1;return t===Vt.TOP||t===Vt.BOTTOM||e&&e.forEach((i,a)=>{if(i!==n)return!0;a.forEach((l,u)=>{const{startColumn:c,endColumn:h}=u;if(t===Vt.LEFT&&l>c&&l<=h||t===Vt.RIGHT&&l>=c&&l<h)return o=!0,!1})}),o}}go.add(new O6);const vC="DefaultBorderAuxiliaryExtension";class F6 extends Ts{constructor(){super(...arguments),this.uKey=vC,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:o=0,columnTitleHeight:i=0,dataMergeCache:a,overflowCache:l,stylesCache:u,showGridlines:c}=n,{startRow:h,endRow:d,startColumn:g,endColumn:m}=s;if(!n||c===te.FALSE)return;const{rowHeightAccumulation:f,columnTotalWidth:p,columnWidthAccumulation:b,rowTotalHeight:v}=n;if(!f||!b||p===void 0||v===void 0)return;e.save();const w=this._getScale(t);e.beginPath(),e.lineWidth=1/w,e.strokeStyle=pt([217,217,217]);let S=Ue(p,w),T=Ue(v,w);const D=b.length,R=f.length;for(let I=h-1;I<=d;I++){if(I<0||I>R-1)continue;const y=Ue(f[I],w);e.moveTo(0,y),e.lineTo(S,y)}for(let I=g;I<=m;I++){if(I<0||I>D-1)continue;const y=Ue(b[I],w);e.moveTo(y,0),e.lineTo(y,T)}e.stroke(),e.closePath(),this._clearRectangle(e,w,f,b,a),this._clearRectangle(e,w,f,b,l),e.restore()}_clearRectangle(e,t,n,s,o){o==null||o.forEach((i,a)=>{a==null||a.forEach((l,u)=>{const{startRow:c,endRow:h,startColumn:d,endColumn:g}=u,m=Ue(n[c-1]||0,t),f=Ue(n[h],t),p=Ue(s[d-1]||0,t),b=Ue(s[g],t);e.clearRect(p,m,b-p,f-m),e.beginPath(),e.moveTo(p,m),e.lineTo(b,m),e.lineTo(b,f),e.lineTo(p,f),e.lineTo(p,m),e.stroke(),e.closePath()})})}}go.add(new F6);const CC="DefaultFontExtension";class M6 extends Ts{constructor(){super(...arguments),this.uKey=CC,this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:o,columnTitleHeight:i,stylesCache:a,dataMergeCache:l,overflowCache:u}=n,{font:c}=a;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;e.save();const f=this._getScale(t),{scaleX:p=1,scaleY:b=1}=t;c&&Object.keys(c).forEach(v=>{c[v].forEach((S,T)=>{T.forEach((D,R)=>{let{isMerged:I,isMergedMainCell:y,startY:O,endY:M,startX:F,endX:x,mergeInfo:E}=this.getCellIndex(S,D,h,g,l);if(I)return!0;O=Ue(O,b),M=Ue(M,b),F=Ue(F,p),x=Ue(x,p);const N=x-F,X=M-O,L=u.getValue(S,D),{horizontalAlign:ne}=R;if(e.save(),e.beginPath(),L){const{startColumn:G,startRow:Q,endColumn:P,endRow:V}=L;G===P&&G===D?e.rect(F,O,N,X):ne===ut.CENTER?this._clipRectangle(e,Q,V,G,P,f,h,g):ne===ut.RIGHT?this._clipRectangle(e,Q,S,G,D,f,h,g):this._clipRectangle(e,S,V,D,P,f,h,g)}else e.rect(F,O,N,X);e.clip(),e.translate(F,O),this._renderDocuments(e,R,F,O,x,M,S,D),e.restore()})})}),e.restore()}_renderDocuments(e,t,n,s,o,i,a,l){const u=this.getDocuments(),{documentSkeleton:c,angle:h,verticalAlign:d,horizontalAlign:g,wrapStrategy:m,content:f}=t,p=o-n,b=i-s;m===kt.WRAP&&h===0&&(c.updateDocumentDataPageSize(p),c.calculate()),c.makeDirty(!1),u.resize(p,b),u.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,s,o,i,a,l){const u=Ue(a[t-1]||0,i),c=Ue(a[n],i),h=Ue(l[s-1]||0,i),d=Ue(l[o],i);e.rect(h,u,d-h,c-u)}}go.add(new M6);const EC="DefaultRowTitleLayoutExtension";class N6 extends Ts{constructor(){super(...arguments),this.uKey=EC,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:o=0,columnTitleHeight:i=0}=n,{startRow:a,endRow:l,startColumn:u,endColumn:c}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;const f=this._getScale(t);e.fillStyle=pt([248,249,250]),e.fillRect(0,0,o,m),e.textAlign="center",e.textBaseline="middle",e.fillStyle=pt([0,0,0]),e.beginPath(),e.lineWidth=1/f,e.strokeStyle=pt([217,217,217]);let p=0;const b=h.length;for(let v=a-1;v<=l;v++){if(v<0||v>b-1)continue;const w=Ue(h[v],f);if(p===w)continue;e.moveTo(0,w),e.lineTo(o,w);const S=p+(w-p)/2;e.fillText(`${v+1}`,o/2,S+ku),p=w}e.moveTo(Ue(o,f),0),e.lineTo(Ue(o,f),m),e.stroke()}}ec.add(new N6);const wC="DefaultColumnTitleLayoutExtension";class k6 extends Ts{constructor(){super(...arguments),this.uKey=wC,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:o=0,columnTitleHeight:i=0}=n,{startRow:a,endRow:l,startColumn:u,endColumn:c}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;const f=this._getScale(t);e.fillStyle=pt([248,249,250]),e.fillRect(0,0,d,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=pt([0,0,0]),e.beginPath(),e.lineWidth=1/f,e.strokeStyle=pt([217,217,217]);let p=0;const b=g.length;for(let w=u-1;w<=c;w++){if(w<0||w>b-1)continue;const S=Ue(g[w],f);if(p===S)continue;e.moveTo(S,0),e.lineTo(S,i);const T=p+(S-p)/2;e.fillText(wf(w),T,i/2+ku),p=S}const v=Ue(i,f);e.moveTo(0,v),e.lineTo(d,v),e.stroke()}}tc.add(new k6);const TC="__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__";class wc extends Cc{constructor(e,t,n=!0){super(e,t),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._documents=new ws(TC,void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new Tr),this.onIsAddedToParentObserver.add(s=>{var o;(o=s==null?void 0:s.getEngine())==null||o.onTransformChangeObservable.add(i=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()}),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}_draw(e,t){this.draw(e,t)}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const o=_s(s),{rowTitleWidth:i,columnTitleHeight:a}=n;e.translate(Ue(i,o)-.5/o,Ue(a,o)-.5/o),this._calculateOverflow();const l=this.getExtensionsByOrder();for(let u of l)u.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:o}=n;return t.x>s&&t.y>o}getNoMergeCellPositionByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:s,columnWidthAccumulation:o,rowTitleWidth:i,columnTitleHeight:a}=n,{scaleX:l=1,scaleY:u=1}=this.getParentScale();let{startY:c,endY:h,startX:d,endX:g}=ui(e,t,s,o);return c=Ue(c+a,u),h=Ue(h+a,u),d=Ue(d+i,l),g=Ue(g+i,l),{startY:c,endY:h,startX:d,endX:g}}calculateCellIndexByPosition(e,t,n){const s=this.getSkeleton();if(!s)return;const{x:o,y:i}=n,{rowHeightAccumulation:a,columnWidthAccumulation:l,rowTitleWidth:u,columnTitleHeight:c,dataMergeCacheAll:h}=s;e+=o-u,t+=i-c;let d=Ln(a,t),g=Ln(l,e);if(d===-1){const R=a.length-1;a[R]<=t?d=a.length-1:d=0}if(g===-1){const R=l.length-1;l[R]<=e?g=l.length-1:g=0}const{scaleX:m=1,scaleY:f=1}=this.getParentScale();let{isMerged:p,startY:b,endY:v,startX:w,endX:S,mergeInfo:T,isMergedMainCell:D}=io(d,g,a,l,h);return b=Ue(b+c,f),v=Ue(v+c,f),w=Ue(w+u,m),S=Ue(S+u,m),T=Vu(T,u,c,m,f),{row:d,column:g,startY:b,endY:v,startX:w,endX:S,isMerged:p,isMergedMainCell:D,mergeInfo:T}}getCellByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{scaleX:s=1,scaleY:o=1}=this.getParentScale(),{rowHeightAccumulation:i,columnWidthAccumulation:a,rowTitleWidth:l,columnTitleHeight:u,dataMergeCacheAll:c}=n;let{isMerged:h,startY:d,endY:g,startX:m,endX:f,mergeInfo:p,isMergedMainCell:b}=io(e,t,i,a,c);return d=Ue(d+u,o),g=Ue(g+u,o),m=Ue(m+l,s),f=Ue(f+l,s),p=Vu(p,l,u,s,o),{row:e,column:t,startY:d,endY:g,startX:m,endX:f,isMerged:h,isMergedMainCell:b,mergeInfo:p}}getAncestorScrollXY(e,t){let n=this.getParent(),s=0,o=0;for(;n;){if(n.classType===Xe.SCENE){const a=n.getViewports().find(l=>l.isHit(xe.FromArray([e,t])));if(a){const l=a.actualScrollX||0,u=a.actualScrollY||0;s+=l,o+=u}}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}return{x:s,y:o}}getSelectionBounding(e,t,n,s){var o;return(o=this.getSkeleton())==null?void 0:o.getMergeBounding(e,t,n,s)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=t;const s=this._cacheCanvas.getContext();if(n){const{dx:o=0,dy:i=0}=n;this._cacheOffsetX=o,this._cacheOffsetY=i}this._cacheCanvas.clear(),s.save(),s.setTransform(e.getTransform()),this._draw(s,n),s.restore(),this._boundsCache=t}this._applyCache(e)}else e.save(),this._draw(e,t),e.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const e=this._getAncestorSize();if(!e||this._cacheCanvas==null)return;const{width:t,height:n}=e,s=this.getSkeleton();s&&(s.rowTitleWidth,s.columnTitleHeight),this._cacheCanvas.setSize(t,n),this.makeDirty(!0)}_getAncestorSize(){const e=this._getAncestorParent();if(!!e){if(e.classType===Xe.ENGINE){const t=e.getCanvas();return{width:t.getWidth(),height:t.getHeight()}}if(e.classType===Xe.SCENE_VIEWER)return{width:e.width,height:e.height}}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===Xe.ENGINE||e.classType===Xe.SCENE_VIEWER)return e;e=(e==null?void 0:e.getParent)&&(e==null?void 0:e.getParent())}}_applyCache(e){!e||(e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),0,0),e.restore())}_initialDefaultExtension(){go.getData().sort(yt).forEach(e=>{this.register(e)}),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,e=>{e.onScrollBeforeObserver.add(()=>{this.makeDirty(!0)})})}_hasScrollViewportOperator(e,t){let n=e.getParent();for(;n;){if(n.classType===Xe.SCENE){const s=n.getViewports();this._getHasScrollViewports(s);for(let o of s)o&&t(o)}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}}_getHasScrollViewports(e){const t=[];for(let n of e)n.getScrollBar()&&t.push(n);return t}getDocsSkeletonPageSize(e,t=0){const n=e==null?void 0:e.getSkeletonData();if(!n)return;const{pages:s}=n,o=s[s.length-1];if(t===0){const{width:g,height:m}=o;return{width:g,height:m}}let i=0,a=0;const l=Yu(t),u=[];m6([o],g=>{const{lines:m,width:f,spaceWidth:p}=g,{rotatedHeight:b,rotatedWidth:v}=ju(m,f,t);a+=b,u.push({rotatedWidth:v,spaceWidth:p})});const c=Math.tan(t),h=Math.sin(t),d=u.length;for(let g=0;g<d;g++){const{rotatedWidth:m,spaceWidth:f}=u[g];g===0&&(i+=m),(l===ms.UP&&g===0||l===ms.DOWN&&g===d-1)&&(i+=(m+f/h)/c)}return{width:i,height:a}}_calculateOverflow(){const e=new _e,t=this.getSkeleton();if(!t)return;const n=t.getColumnCount(),{stylesCache:s,rowHeightAccumulation:o,columnWidthAccumulation:i,dataMergeCache:a}=t,{font:l}=s;l&&Object.keys(l).forEach(u=>{l[u].forEach((h,d)=>{d.forEach((g,m)=>{let{documentSkeleton:f,angle:p=0,verticalAlign:b,horizontalAlign:v,wrapStrategy:w}=m;const S=t.getCellData().getValue(h,g),T=this.getSkeleton();if(!T)return!0;const{t:D=xn.STRING}=S||{};if(w===kt.OVERFLOW&&D!==xn.NUMBER&&D!==xn.BOOLEAN&&v!==ut.JUSTIFIED){let R=this.getDocsSkeletonPageSize(f,p);if(!R)return!0;if(p!==0){let{startY:M,endY:F,startX:x,endX:E}=io(h,g,o,i,a);const N=E-x,X=F-M;R.height>X&&(R={width:X/Math.tan(Math.abs(p))+N,height:X})}const I=t.getOverflowPosition(R,v,h,g,n),{startColumn:y,endColumn:O}=I;e.setValue(h,g,{startRow:h,endRow:h,startColumn:y,endColumn:O})}else if(w===kt.WRAP&&p!==0){let{startY:R,endY:I}=io(h,g,o,i,a);const y=I-R;f.updateDocumentDataPageSize(y),f.calculate();const O=this.getDocsSkeletonPageSize(f,p);if(!O)return!0;const{startColumn:M,endColumn:F}=T.getOverflowPosition(O,v,h,g,T.getColumnCount());e.setValue(h,g,{startRow:h,endRow:h,startColumn:M,endColumn:F})}})})}),t.setOverflowCache(e)}_differentBounds(e){if(!this._boundsCache)return e;const{tl:t,tr:n,bl:s,br:o,dx:i,dy:a}=e,{tl:l,tr:u,bl:c,br:h,dx:d,dy:g}=this._boundsCache,m={tl:t,tr:n,bl:s,br:o,dx:0,dy:0};return t.x===l.x?(t.y>l.y?(m.tl=c,m.tr=h):(m.bl=l,m.br=u),m.dy=l.y-t.y):t.y===l.y&&(t.x>l.x?(m.tl=u,m.bl=h):(m.tr=l,m.br=c),m.dx=l.x-t.x),m}_checkSheetDifferentBounds(e,t){const{tl:n,tr:s,bl:o,br:i}=e,{tl:a,tr:l,bl:u,br:c}=t;return n.x===a.x&&s.x===l.x&&o.x===u.x&&i.x===c.x?n.y>=a.y&&n.y<=u.y||o.y>=a.y&&o.y<=u.y:n.y===a.y&&s.y===l.y&&o.y===u.y&&i.y===c.y?(n.x>=a.x&&n.x<=l.x||s.x>=a.x&&s.x<=l.x,!0):!1}}class Tc extends Ec{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const o=_s(s),{columnTitleHeight:i}=n;e.translate(-.5/o,Ue(i,o)-.5/o);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:o}=n;return t.x>=0&&t.x<=s&&t.y>o}_initialDefaultExtension(){ec.getData().forEach(e=>{this.register(e)}),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class Sc extends Ec{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}_initialDefaultExtension(){tc.getData().forEach(e=>{this.register(e)}),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const o=_s(s),{rowTitleWidth:i}=n;e.translate(Ue(i,o)-.5/o,-.5/o);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:o}=n;return t.x>s&&t.y>=0&&t.y<=o}}class mi extends Ju{constructor(e,t,n,s){super(s),this._config=e,this._cellData=t,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateLayout(),this.updateDataMerge()}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}setOverflowCache(e){this._overflowCache=e}calculate(e){if(!this._config||(this.updateLayout(),!this._rowHeightAccumulation||!this._columnWidthAccumulation))return;const{mergeData:t}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(e),this._dataMergeCache=t&&this._getMergeCells(t,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateLayout(){if(!this.dirty)return;const{rowData:e,columnData:t,defaultRowHeight:n,defaultColumnWidth:s,rowCount:o,columnCount:i,rowTitle:a,columnTitle:l,showGridlines:u}=this._config,{rowTotalHeight:c,rowHeightAccumulation:h}=this._generateRowMatrixCache(o,e,n),{columnTotalWidth:d,columnWidthAccumulation:g}=this._generateColumnMatrixCache(i,t,s);return this._rowTitleWidth=a.hidden!==te.TRUE?a.width:0,this._columnTitleHeight=l.hidden!==te.TRUE?l.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=h,this._columnTotalWidth=d,this._columnWidthAccumulation=g,this._showGridlines=u,this.makeDirty(!0),this}updateDataMerge(){const{mergeData:e}=this._config;this._dataMergeCacheAll=e&&this._getMergeCells(e)}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,t,n,s){const o=this._dataMergeCacheAll;if(!o)return{startRow:e,startColumn:t,endRow:n,endColumn:s};let i=!0,a=new _e;for(;i;)i=!1,o.forEach((l,u)=>{u.forEach((c,h)=>{if(!h||a.getValue(l,c))return!0;const{startRow:d,startColumn:g,endRow:m,endColumn:f}=h;F0({left:t,top:e,right:s,bottom:n},{left:g,top:d,right:f,bottom:m})&&(e=Math.min(e,d),t=Math.min(t,g),n=Math.max(n,m),s=Math.max(s,f),a.setValue(l,c,!0),i=!0)})});return{startRow:e,startColumn:t,endRow:n,endColumn:s}}appendToOverflowCache(e,t,n,s){this._overflowCache.setValue(e,t,{startRow:e,endRow:e,startColumn:n,endColumn:s})}getColumnCount(){return this._columnWidthAccumulation.length}get dataMergeCacheAll(){return this._dataMergeCacheAll}_generateRowMatrixCache(e,t,n){let s=0;const o=[],i=new nt(t);for(let a=0;a<e;a++){let l=n;if(i.get(a)!=null){const u=i.get(a);if(!u)continue;u.h!=null?l=u.h:u.ah!=null&&(l=u.ah),u.hd===te.TRUE&&(l=0)}s+=l,o.push(s)}return{rowTotalHeight:s,rowHeightAccumulation:o}}_generateColumnMatrixCache(e,t,n){let s=0;const o=[],i=new nt(t);for(let a=0;a<e;a++){let l=n;if(i.get(a)!=null){const u=i.get(a);if(!u)continue;u.w!=null&&(l=u.w),u.hd===te.TRUE&&(l=0)}s+=l,o.push(s)}return{columnTotalWidth:s,columnWidthAccumulation:o}}_getBounding(e,t,n){const s=e.length,o=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:o-1};let i=-1,a=-1,l=-1,u=-1;return i=Ln(e,n.tl.y-this.columnTitleHeight),a=Ln(e,n.bl.y-this.columnTitleHeight),i===-1&&(i=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=Ln(t,n.tl.x-this.rowTitleWidth),u=Ln(t,n.tr.x-this.rowTitleWidth),l===-1&&(l=0),u===-1&&(u=o-1),u>=o&&(u=o-1),{startRow:i-1,endRow:a+1,startColumn:l-1,endColumn:u+1}}getOverflowPosition(e,t,n,s,o){const{width:i,height:a}=e;let l=s,u=s;return t===ut.CENTER?(l=this._getOverflowBound(n,s,0,i/2),u=this._getOverflowBound(n,s,o-1,i/2)):t===ut.RIGHT?l=this._getOverflowBound(n,s,0,i):u=this._getOverflowBound(n,s,o-1,i),{startColumn:l,endColumn:u}}_getOverflowBound(e,t,n,s){let o=0;if(t>n){const i=this._columnWidthAccumulation.length-1;for(let a=t;a>=n;a--){const l=a,u=this._cellData.getValue(e,l);if(!wu(u)&&l!==t||this._intersectMergeRange(e,l))return l===t?l:l+1>i?i:l+1;const{startX:c,endX:h}=ui(e,l,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o+=h-c,s<o)return l}return t}for(let i=t;i<=n;i++){const a=i,l=this._cellData.getValue(e,a);if(!wu(l)&&a!==t||this._intersectMergeRange(e,a))return a===t?a:a-1<0?0:a-1;const{startX:u,endX:c}=ui(e,a,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o+=c-u,s<o)return a}return n}_intersectMergeRange(e,t){const n=this.dataMergeCache;let s=!1;return n==null||n.forEach((o,i)=>{i==null||i.forEach((a,l)=>{const{startRow:u,endRow:c,startColumn:h,endColumn:d}=l;if(e>=u&&e<=c&&t>=h&&t<=d)return s=!0,!1})}),s}_calculateStylesCache(){const e={background:{},font:{},border:new _e},t=this.getFontLocale(),n=this._dataMergeCache,s=this._rowColumnSegment,o=this.columnWidthAccumulation,i=this._styles,a=this._cellData,{startRow:l,endRow:u,startColumn:c,endColumn:h}=s;for(let d=l;d<=u;d++){for(let g=c;g<=h;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!1},t);for(let g=0;g<c;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!0},t);for(let g=h+1;g<o.length;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!0},t)}return n&&n.forEach((d,g)=>{g.forEach((m,f)=>{if(!f)return!0;this.__setCellCache(d,m,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!1},t)})}),e}__setCellCache(e,t,n,s){const{cache:o,skipBackgroundAndBorder:i=!1,styles:a,cellData:l}=n;if(!l)return!0;const u=l.getValue(e,t);if(!u)return!0;const c=a&&a.getStyleByCell(u);if(!i&&c&&c.bg&&c.bg.rgb){const D=c.bg.rgb;o.background[D]||(o.background[D]=new _e),o.background[D].setValue(e,t,D)}!i&&c&&c.bd&&(this.___setBorderProps(e,t,Vt.TOP,c,o),this.___setBorderProps(e,t,Vt.BOTTOM,c,o),this.___setBorderProps(e,t,Vt.LEFT,c,o),this.___setBorderProps(e,t,Vt.RIGHT,c,o));const h=u.m||u.v;let d,g="document";const m=this._getOtherStyle(c),f=m.textRotation||{a:0,v:te.FALSE},p=m.horizontalAlign||ut.UNSPECIFIED,b=m.verticalAlign||tn.UNSPECIFIED,v=m.wrapStrategy||kt.UNSPECIFIED;if(u.p){o.font[g]||(o.font[g]=new _e);let{a:D=0,v:R=te.FALSE}=f,I=0,y=D;R===te.TRUE&&(I=90,y=90),d=this._updateRenderConfigAndHorizon(u.p,p,{horizontalAlign:p,verticalAlign:b,centerAngle:I,vertexAngle:y,wrapStrategy:v})}else if(h){const D=this._getFontFormat(c);g=Ia(D,s).fontString,o.font[g]||(o.font[g]=new _e),d=this._getDocumentDataByStyle(h.toString(),D,m)}const w=o.font[g];let{a:S,v:T=te.FALSE}=f;if(T===te.TRUE&&(S=90),d){const D=Es.create(d,this.getContext());(S===0||v!==kt.WRAP)&&D.calculate(),w.setValue(e,t,{documentSkeleton:D,angle:S,verticalAlign:b,horizontalAlign:p,wrapStrategy:v,content:h==null?void 0:h.toString()})}}_updateRenderConfigAndHorizon(e,t,n){var i;if(!n||!((i=e.body)!=null&&i.blockElements))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=n;const s=e.body.blockElements,o=Object.keys(e.body.blockElements);for(let a of o){const l=s[a];if(l.blockType===Fe.PARAGRAPH){if(!l.paragraph)continue;l.paragraph.paragraphStyle||(l.paragraph.paragraphStyle={}),l.paragraph.paragraphStyle.horizontalAlign=t}}return e}_getDocumentDataByStyle(e,t,n){const s=e.length-1,{textRotation:o={a:0,v:te.FALSE},textDirection:i=Ys.UNSPECIFIED,paddingData:a={t:0,r:2,b:0,l:2},horizontalAlign:l=ut.UNSPECIFIED,verticalAlign:u=tn.UNSPECIFIED,wrapStrategy:c=kt.UNSPECIFIED}=n,{a:h=0,v:d=te.FALSE}=o,{t:g,r:m,b:f,l:p}=a;ma.NORMAL;let b=0,v=h;return d===te.TRUE&&(b=90,v=90,ma.TBRL),{id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:s,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:l},elements:{oneElement:{eId:"oneElement",st:0,ed:s,et:K.TEXT_RUN,tr:{ct:e,ts:t}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:g,marginBottom:f,marginRight:m,marginLeft:p,renderConfig:{horizontalAlign:l,verticalAlign:u,centerAngle:b,vertexAngle:v,wrapStrategy:c}}}}___setBorderProps(e,t,n,s,o){var u;const i=(u=s.bd)==null?void 0:u[n];if(!i||!o.border)return!0;const a=Ft(i.cl)||Cr,l=o.border;l.getValue(e,t)||l.setValue(e,t,{[n]:{}}),l.getValue(e,t)[n]={type:n,style:i.s,color:a}}_getFontFormat(e){if(!e)return{};const{ff:t,fs:n,it:s,bl:o,ul:i,st:a,ol:l,cl:u,bg:c,bd:h}=e;return{ff:t,fs:n,it:s,bl:o,ul:i,st:a,ol:l,cl:u}}_getOtherStyle(e){if(!e)return{};const{tr:t,td:n,ht:s,vt:o,tb:i,pd:a}=e;return{textRotation:t,textDirection:n,horizontalAlign:s,verticalAlign:o,wrapStrategy:i,paddingData:a}}_getMergeCells(e,t){const n=this.columnWidthAccumulation.length-1;if(t)t={startRow:t.startRow,endRow:t.endRow,endColumn:n,startColumn:0};else{const u=this.rowHeightAccumulation.length-1;t={startRow:0,startColumn:0,endRow:u,endColumn:n}}const{startRow:s,startColumn:o,endRow:i,endColumn:a}=t,l=new _e;for(let u=0;u<e.length;u++){const{startRow:c,endRow:h,startColumn:d,endColumn:g}=e[u];for(let m=s;m<=i;m++){let f=!1;for(let p=o;p<=a;p++)if(m>=c&&m<=h&&p>=d&&p<=g){l.setValue(c,d,{startRow:c,endRow:h,startColumn:d,endColumn:g}),f=!0;break}if(f)break}}return l}static create(e,t,n,s){return new mi(e,t,n,s)}}class za extends jr{constructor(e,t){super(e),this._subScenes=new Map,this._allowSelectedClipElement=!1,this._initialProps(t)}get classType(){return Xe.SCENE_VIEWER}render(e,t){var s;if(!this.visible)return this.makeDirty(!1),this;if(t){const{minX:o,maxX:i,minY:a,maxY:l}=ci(this,t);if(this.width+this.strokeWidth<o||i<0||this.height+this.strokeWidth<a||l<0)return this}const n=this.transform.getMatrix();return e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),(s=this._activeSubScene)==null||s.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(e){for(let[t,n]of this._subScenes)if(t===e)return n}addSubScene(e){this._activeSubScene=e,this._subScenes.set(e.sceneKey,e),this.makeDirty()}removeSubScene(e){const t=this._subScenes.get(e);this._subScenes.delete(e),this._activeSubScene===t&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(e){if(e==null)return;const t=this._subScenes.get(e);this._activeSubScene!==t&&(this._activeSubScene=t,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(e){var s;if(this._activeSubScene===void 0)return;const n=this.transform.clone().invert().applyPoint(e);return(s=this._activeSubScene)==null?void 0:s.pick(n)}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const n={};let s=!1;t.forEach(o=>{if(e[o]===void 0)return!0;n[o]=e[o],s=!0}),s&&this.transformByState(n),this.makeDirty(!0)}dispose(){super.dispose(),this._subScenes.forEach(e=>{e.dispose()})}}function B6(r,e,t){r.onPointerEnterObserver.add(n=>{e(r,n)}),r.onPointerLeaveObserver.add(n=>{t(r,n)})}var L6=(r=>(r.LEFT="__slideNavigationLeft__",r.RIGHT="__slideNavigationRight__",r))(L6||{});const P6="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m200.746667-478.506667l1.749333-1.664 30.165333-30.165333-330.496-330.581333a42.837333 42.837333 0 0 0-60.288 0 42.538667 42.538667 0 0 0 0 60.330666l270.08 270.165334-270.08 269.952a42.496 42.496 0 0 0 0 60.288c16.64 16.64 43.861333 16.469333 60.288 0.042666l298.581334-298.368z";class H6 extends za{constructor(){super(...arguments),this._navigationEnabled=!1,this.onSlideChangePageByNavigationObservable=new ye}activeFirstPage(){const t=this.getSubScenes().keys().next().value;t!=null&&this.changePage(t)}addPage(e){const t=e.sceneKey;this.getSubScene(t)==null&&(this.addSubScene(e),this.addNavigation())}changePage(e){e!==null&&(this.removeNavigation(),this.activeSubScene(e),this.addNavigation())}hasPage(e){return this.getSubScene(e)}addNavigation(){const e=this.getActiveSubScene();if(e==null||this._navigationEnabled===!1)return;const t=new fn("__slideNavigationLeft__",{data:P6,width:60,height:60,left:90,top:(this.height-30)/2,fill:this._getArrowColor(),flipX:!0}),n=new fn("__slideNavigationRight__",{data:P6,width:60,height:60,left:this.width-90,top:(this.height-30)/2,fill:this._getArrowColor()}),s=(i,a)=>{i.setCursor(ht.POINTER),i.setProps({fill:this._getArrowColor(!0)})},o=(i,a)=>{i.setCursor(ht.DEFAULT),i.setProps({fill:this._getArrowColor()})};B6(t,s,o),B6(n,s,o),this._addNavTrigger(t,n),e.addObjects([t,n],7)}removeNavigation(){var t,n;const e=this.getActiveSubScene();e==null||this._navigationEnabled===!1||((t=e.getObject("__slideNavigationLeft__"))==null||t.dispose(),(n=e.getObject("__slideNavigationRight__"))==null||n.dispose())}enableNav(){this._navigationEnabled=!0}disableNav(){this._navigationEnabled=!1}hiddenNav(){var t,n;const e=this.getActiveSubScene();e==null||this._navigationEnabled===!1||((t=e.getObject("__slideNavigationLeft__"))==null||t.hide(),(n=e.getObject("__slideNavigationRight__"))==null||n.hide())}showNav(){var t,n;const e=this.getActiveSubScene();e==null||this._navigationEnabled===!1||((t=e.getObject("__slideNavigationLeft__"))==null||t.show(),(n=e.getObject("__slideNavigationRight__"))==null||n.show())}renderToThumb(e,t,n=1,s=1){const o=this.getSubScene(t);o!=null&&(e.save(),e.scale(n,s),o.makeDirtyNoParent(!0).render(e),e.restore())}_getSubScenesIndex(e){if(e==null)return;const t=Array.from(this.getSubScenes()),n=t.length;let s=0;for(let a=0;a<n;a++){const[l]=t[a];if(e===l){s=a;break}}let o=s+1,i=s-1;return o=o>=n?0:o,i=i<0?n-1:i,{nextScene:t[o][1],previousScene:t[i][1]}}_addNavTrigger(e,t){e.onPointerDownObserver.add(()=>{var o;const n=this._getSubScenesIndex((o=this.getActiveSubScene())==null?void 0:o.sceneKey),s=n==null?void 0:n.previousScene.sceneKey;this.changePage(s),this.onSlideChangePageByNavigationObservable.notifyObservers(s)}),t.onPointerDownObserver.add(()=>{var o;const n=this._getSubScenesIndex((o=this.getActiveSubScene())==null?void 0:o.sceneKey),s=n==null?void 0:n.nextScene.sceneKey;this.changePage(s),this.onSlideChangePageByNavigationObservable.notifyObservers(s)})}_getArrowColor(e=!1){return e?pt(Wn.white,.8):pt(Wn.white,.5)}}const yc=["text","richText"];class U6 extends jr{constructor(e,t,n){super(t),this._allowCache=!1,n!=null&&n.richText?this._documentData=n.richText:n&&(this._fs=n.fs,this._ff=n.ff,this._it=n.it,this._bl=n.bl,this._ul=n.ul,this._st=n.st,this._ol=n.ol,this._bg=n.bg,this._bd=n.bd,this._cl=n.cl,this._documentData=this.convertToDocumentData(n.text||"")),this._allowCache&&(this._cacheCanvas=new Tr,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._context=e,this._documentSkeleton=Es.create(this._documentData,this._context),this._documents=new ws(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(n),this.onTransformChangeObservable.add(s=>{const{type:o,value:i,preValue:a}=s;if(o===At.resize||o===At.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const l=this.getDocsSkeletonPageSize();this.height=(l==null?void 0:l.height)||this.height,this._setTransForm()}})}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var i;const e=(i=this._documentSkeleton)==null?void 0:i.getSkeletonData();if(!e)return;const{pages:t}=e,n=t[t.length-1],{width:s,height:o}=n;return{width:s,height:o}}convertToDocumentData(e){const t=e.length;return{id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:t,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:t,et:K.TEXT_RUN,tr:{ct:e,ts:{fs:this._fs||14,ff:this._ff,it:this._it,bl:this._bl,ul:this._ul,st:this._st,ol:this._ol,bg:this._bg,bd:this._bd,cl:this._cl}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(e){this._documentSkeleton.updateDocumentDataPageSize(e==null?void 0:e.width,e==null?void 0:e.height),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.transformByState({width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0,left:(e==null?void 0:e.left)||0,top:(e==null?void 0:e.top)||0,angle:e==null?void 0:e.angle}),this.setProps(e),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(n=>{if(e[n]===void 0)return!0;yc.indexOf(n)===-1&&(this[`_${n}`]=e[n])}),this.makeDirty(!0),this}_draw(e){this._documents.render(e)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:s,maxX:o,minY:i,maxY:a}=ci(this,t);if(this.width+this.strokeWidth<s||o<0||this.height+this.strokeWidth<i||a<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const s=this._cacheCanvas.getContext();this._cacheCanvas.clear(),s.save(),s.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(s),s.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}getContext(){return this._context}toJson(){const e={};return yc.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const SC=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];class yC{constructor(e,t){this._scene=e,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this.onChangeStartObservable=new ye,this.onChangingObservable=new ye,this.onChangeEndObservable=new ye,this.onClearControlObservable=new ye,this.onCreateControlObservable=new ye,this._initialProps(t)}_initialProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{if(e[n]===void 0)return!0;this[n]=e[n]})}_updateControlChildren(){this._updateControlIterator((e,t)=>{const{left:n,top:s,width:o,height:i,scaleX:a,scaleY:l}=t.getState();e.getObjects().forEach(c=>{const h=c.oKey,d=this._checkTransformerType(h);if(!d)return!0;if(d==="__SpreadsheetTransformerOutline__")c.transformByState(this._getOutlinePosition(o,i,a,l));else{const{left:g,top:m}=this._getRotateAnchorPosition(d,i,o,a,l);c.transformByState({left:g,top:m})}}),e.transformByState({left:n,top:s})})}_anchorMoving(e,t,n,s){const{scrollX:o,scrollY:i}=ao(s),a=t-this._viewportScrollX+o,l=n-this._viewportScrollY+i,u=a-this._startOffsetX,c=l-this._startOffsetY;this._selectedObjectMap.forEach(h=>{const{left:d,top:g,width:m,height:f}=h,p={};switch(e){case"__SpreadsheetTransformerResizeLT__":p.left=d+u,p.top=g+c,p.width=m-u,p.height=f-c;break;case"__SpreadsheetTransformerResizeCT__":p.top=g+c,p.height=f-c;break;case"__SpreadsheetTransformerResizeRT__":p.top=g+c,p.width=m+u,p.height=f-c;break;case"__SpreadsheetTransformerResizeLM__":p.left=d+u,p.width=m-u;break;case"__SpreadsheetTransformerResizeRM__":p.width=u+m;break;case"__SpreadsheetTransformerResizeLB__":p.left=d+u,p.width=m-u,p.height=f+c;break;case"__SpreadsheetTransformerResizeCB__":p.height=c+f;break;case"__SpreadsheetTransformerResizeRB__":p.width=u+m,p.height=c+f;break}h.transformByState(p)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:u,moveY:c,type:1}),this._startOffsetX=a,this._startOffsetY=l}_attachEventToAnchor(e,t="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((n,s)=>{const{offsetX:o,offsetY:i}=n;this._startOffsetX=o,this._startOffsetY=i;const a=this._getTopScene();if(a==null)return;a.disableEvent();const l=Kr.create(a);l.startScroll(o,i);const{scrollX:u,scrollY:c}=ao(l);this._viewportScrollX=u,this._viewportScrollY=c;const h=this._getRotateAnchorCursor(t);this._moveObserver=a.onPointerMoveObserver.add(d=>{const{offsetX:g,offsetY:m}=d;this._anchorMoving(t,g,m,l),l.scrolling(g,m,()=>{this._anchorMoving(t,g,m,l)}),a.setCursor(h)}),this._upObserver=a.onPointerUpObserver.add(d=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),a.resetCursor(),l.stopScroll()}),s.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=this._getTopScene();i!=null&&(i.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=i.onPointerMoveObserver.add(a=>{}),this._upObserver=i.onPointerUpObserver.add(a=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent()}),n.stopPropagation())})}_getOutlinePosition(e,t,n,s){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:t+this.borderSpacing*2}}_getRotateAnchorCursor(e){let t=ht.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":t=ht.MOVE;break;case"__SpreadsheetTransformerRotateLine__":t=ht.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":t=ht.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":t=ht.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":t=ht.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":t=ht.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":t=ht.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":t=ht.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":t=ht.SOUTH_EAST_RESIZE;break}return t}_getRotateAnchorPosition(e,t,n,s,o){let i=-this.anchorSize/2,a=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":i=n/2-this.rotateSize/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":i=n/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":i+=n/2,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeRM__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeLB__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":i+=n/2,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break}return{left:i,top:a}}_createResizeAnchor(e,t,n){let{height:s,width:o,scaleX:i,scaleY:a}=t.getState();const{left:l,top:u}=this._getRotateAnchorPosition(e,s,o,i,a),c=this._getRotateAnchorCursor(e),h=new tt(`${e}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:l,top:u});return this._attachHover(h,c,ht.DEFAULT),h}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((t,n)=>{const s=this._selectedObjectMap.get(n);if(!s)return!0;e(t,s)})}_updateControl(){this._updateControlIterator((e,t)=>{const{left:n,top:s}=t.getState();e.transformByState({left:n,top:s}),e.show(),e.makeDirty(!0)})}_hiddenControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,t,n){e.onPointerEnterObserver.add(()=>{e.cursor=t}),e.onPointerLeaveObserver.add(()=>{e.cursor=n})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(e){let{left:t,top:n,height:s,width:o,angle:i,scaleX:a,scaleY:l,skewX:u,skewY:c,flipX:h,flipY:d}=e.getState();const g=e.oKey,m=this._selectedObjectMap.size,f=[];if(this.borderEnabled){const v=new tt(`__SpreadsheetTransformerOutline___${m}`,{zIndex:m-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(o,s,a,l)});f.push(v)}if(this.resizeEnabled){const{left:v,top:w}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",s,o,a,l),S=new tt(`__SpreadsheetTransformerRotateLine___${m}`,{zIndex:m-1,evented:!1,left:v,top:w,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:T,top:D}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",s,o,a,l),R=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),I=new tt(`__SpreadsheetTransformerRotate___${m}`,{zIndex:m-1,left:T,top:D,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(I),this._attachHover(I,R,ht.DEFAULT),f.push(S,I)}if(this.resizeEnabled)for(let v=0,w=this.enabledAnchors.length;v<w;v++){if(this.enabledAnchors[v]!==1)continue;const T=SC[v],D=this._createResizeAnchor(T,e,m);this._attachEventToAnchor(D,T),f.push(D)}const p=new hi(`__SpreadsheetTransformer___${m}`,...f);p.zIndex=m,p.evented=!1,p.transformByState({left:t,top:n});const b=this.getScene();return b.addObject(p,2),console.log(b,e),this._transformerControlMap.set(g,p),this.onCreateControlObservable.notifyObservers(p),p}getScene(){return this._scene}_getTopScene(){var t;return(t=this.getScene().getEngine())==null?void 0:t.activeScene}_moving(e,t,n){const{scrollX:s,scrollY:o}=ao(n),i=e-this._viewportScrollX+s,a=t-this._viewportScrollY+o,l=i-this._startOffsetX,u=a-this._startOffsetY;this._selectedObjectMap.forEach(c=>{c.translate(l+c.left,u+c.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:u,type:1}),this._startOffsetX=i,this._startOffsetY=a}_updateActiveObjectList(e,t){this._selectedObjectMap.has(e.oKey)||(t.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add(t=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)})}attachTo(e){if(!!e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:o}=t;this._startOffsetX=s,this._startOffsetY=o;const i=this._getTopScene();if(!i)return;this._addCancelObserver(i),i.disableEvent();const a=Kr.create(i);a.startScroll(s,o);const{scrollX:l,scrollY:u}=ao(a);this._viewportScrollX=l,this._viewportScrollY=u,this._updateActiveObjectList(e,t),this._moveObserver=i.onPointerMoveObserver.add(c=>{const{offsetX:h,offsetY:d}=c;this._moving(h,d,a),this._hiddenControl(),a.scrolling(h,d,()=>{this._moving(h,d,a)})}),this._upObserver=i.onPointerUpObserver.add(c=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent(),this._updateControl(),a.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),n.stopPropagation()}),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach(e=>{e.dispose()}),this._selectedObjectMap.forEach(e=>{e.dispose()}),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}}class Ss{constructor(e,t,n){var s;if(this._parent=t,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new Lt,this._isFirstDirty=!0,this._evented=!0,this._cursor=ht.DEFAULT,this._transformerOpenState=!1,this.onPointerDownObserver=new ye,this.onPointerMoveObserver=new ye,this.onPointerUpObserver=new ye,this.onDblclickObserver=new ye,this.onMouseWheelObserver=new ye,this.onKeyDownObservable=new ye,this.onKeyUpObservable=new ye,this.onTransformChangeObservable=new ye,this._sceneKey=e,n&&this.transformByState(n),this._parent.classType===Xe.ENGINE){const o=this._parent;o.addScene(this),o.hasActiveScene()||o.setActiveScene(e),this._inputManager=new uo(this)}else this._parent.classType===Xe.SCENE_VIEWER&&this._parent.addSubScene(this);(s=this._parent)==null||s.onTransformChangeObservable.add(o=>{this._resetViewportSize(),this._setTransForm()})}attachControl(e=!0,t=!0,n=!0,s=!0){var o;if(this._parent.classType===Xe.ENGINE)return(o=this._inputManager)==null||o.attachControl(e,t,n,s),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach(n=>{n.makeDirty(e)}),this._parent.classType===Xe.SCENE_VIEWER&&((t=this._parent)==null||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(t=>{t.makeDirty(e)}),this}isDirty(){for(let e=0;e<this._viewports.length;e++)if(this._viewports[e].isDirty()===!0)return!0;return!1}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(ht.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;const n=t.getCanvas().getCanvasEle();n.style.cursor=e}get classType(){return Xe.SCENE}get transform(){return this._transform}set transform(e){this._transform=e}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===Xe.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===Xe.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}scaleBy(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX+=e);const s=this.scaleY;return t!==void 0&&(this.scaleY+=t),this.scaleX=Ra(this.scaleX,1),this.scaleY=Ra(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}transformByState(e){const t=Object.keys(e),n={};t.length!==0&&(t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:At.all,value:e,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===Xe.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===Xe.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}_createDefaultLayer(e=1){const t=lo.create(this,[],e);return this.addLayer(t),t}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const n=this._layers[t];n.zIndex>=e&&(e=n.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add(t=>{e.scaleCacheCanvas()}),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObjects(e),this}removeObject(e){if(e==null)return;const t=this.getLayers();for(let n of t)n.removeObject(e);return this}getAllObjects(){const e=[];this._layers.sort(yt);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],n=e?Iu:yt;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrder().sort(n));return t}getAllObjectsByOrderForPick(e=!1){const t=[],n=e?Iu:yt;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrderForPick().sort(n));return t}getObject(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let s of n)if(s.oKey===e)return s}}fuzzyMathObjects(e){const t=[];for(let n of this._layers){const s=n.getObjectsByOrder();for(let o of s)o.oKey.indexOf(e)>-1&&s.push(o)}return t}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}get sceneKey(){return this._sceneKey}async requestRender(e){return new Promise((t,n)=>{this.render(e),ai(t)})}renderObjects(e,t){return this.getAllObjectsByOrder().forEach(n=>{n.render(e,t)}),this}render(e){var t,n;!this.isDirty()||(!e&&((t=this.getEngine())==null||t.getCanvas().clear()),(n=this.getViewports())==null||n.forEach(s=>s.render(e)))}_resetViewportSize(){this.getViewports().forEach(e=>{e.resetSize()})}_setTransForm(){const e=Lt.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(t=>{t.resizeScrollBar()}),this.makeDirty(!0)}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}get evented(){return this._evented}openTransformer(e){this._transformer||(this._transformer=new yC(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var t;!this._transformerOpenState||(t=this._transformer)==null||t.attachTo(e)}getTransformer(){return this._transformer}getActiveViewportByCoord(e){return this._viewports.find(t=>t.isHit(e))}transformToSceneCoord(e){const t=this.getActiveViewportByCoord(e);return t==null?void 0:t.getRelativeVector(e)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var e;this.getLayers().forEach(t=>{t.dispose()}),this.getViewports().forEach(t=>{t.dispose()}),this.clearLayer(),this.clearViewports(),this.detachControl(),(e=this._transformer)==null||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let t=this.getActiveViewportByCoord(e);if(t||(t=this._viewports[0]),!this._evented||!t)return;const n=t.pickScrollBar(e);if(n)return n;const s=t.getRelativeVector(e);let o=null;const i=this.getAllObjectsByOrderForPick().reverse(),a=i.length;for(let l=0;l<a;l++){const u=i[l];if(!u.visible||!u.evented||u.classType===Xe.GROUP)continue;let c=s;if(u.isInGroup&&u.parent.classType===Xe.GROUP){const{cumLeft:h,cumTop:d}=this._getGroupCumLeftRight(u);c=c.clone().add(xe.FromArray([-h,-d]))}if(u.isHit(c)){if(u.classType===Xe.SCENE_VIEWER){const h=u.pick(c);h?o=h:o=u.getActiveSubScene()}else o=u;break}else if(u.classType===Xe.SCENE_VIEWER&&u.allowSelectedClipElement()){const h=u.pick(c);if(h){o=h;break}}}return!o&&this._parent.classType===Xe.ENGINE?this:o}_getGroupCumLeftRight(e){let t=e.parent,n=0,s=0;for(;t.classType===Xe.GROUP;){const{left:o,top:i}=t;n+=o,s+=i,t=t.parent}return{cumLeft:n,cumTop:s}}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,n;return!((t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Xe.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var t,n;return!((t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Xe.SCENE_VIEWER?((n=this._parent)==null||n.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var t,n;return!((t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Xe.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerMove(e),!1):!0}triggerDblclick(e){var t,n;return!((t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Xe.SCENE_VIEWER?((n=this._parent)==null||n.triggerDblclick(e),!1):!0}triggerPointerDown(e){var t,n;return!((t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Xe.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var t;return this._parent.classType===Xe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var t;return this._parent.classType===Xe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var t;return this._parent.classType===Xe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var t;return this._parent.classType===Xe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerEnter(e),!1):!0}}class En{constructor(e,t,n){var s;this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this.scrollX=0,this.scrollY=0,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this.onMouseWheelObserver=new ye,this.onScrollAfterObserver=new ye,this.onScrollBeforeObserver=new ye,this.onScrollStopObserver=new ye,this._viewPortKey=e,this._scene=t,this.top=(n==null?void 0:n.top)||0,this.left=(n==null?void 0:n.left)||0,this.bottom=(n==null?void 0:n.bottom)||0,this.right=(n==null?void 0:n.right)||0,n!=null&&n.width&&(this.width=n==null?void 0:n.width,this._widthOrigin=this.width),n!=null&&n.height&&(this.height=n==null?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new Tr),this._isWheelPreventDefaultX=(n==null?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(n==null?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),(s=this._scene)==null||s.getParent().onTransformChangeObservable.add(()=>{this._resizeCacheCanvasAndScrollBar()})}get scene(){return this._scene}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}set top(e){var t,n;this._topOrigin=e,this._top=Er(e,(n=(t=this._scene)==null?void 0:t.getParent())==null?void 0:n.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Er(e,(t=this.scene.getParent())==null?void 0:t.width)}get bottom(){return this._bottom}set bottom(e){var t;this._bottomOrigin=e,this._bottom=Er(e,(t=this.scene.getParent())==null?void 0:t.height)}get right(){return this._right}set right(e){var t;this._rightOrigin=e,this._right=Er(e,(t=this.scene.getParent())==null?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);t.length!==0&&(this._width=void 0,this._height=void 0,t.forEach(n=>{e[n]!==void 0&&(this[n]=e[n])}),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}_resizeCacheCanvasAndScrollBar(e=!1){var i;const{width:t,height:n}=this._getViewPortSize(e);this.width=t,this.height=n;const s=this._scene.width*this._scene.scaleX,o=this._scene.height*this._scene.scaleY;(i=this._scrollBar)==null||i.resize(t,n,s,o),this.makeDirty(!0)}_getViewPortSize(e=!1){var o;const t=(o=this._scene)==null?void 0:o.getParent();let n,s;if(!e&&this._widthOrigin!==void 0)n=this._widthOrigin;else{const i=t.width;n=(t.classType===Xe.SCENE_VIEWER?i*t.scaleX:i)-(this._left+this._right)}if(!e&&this._heightOrigin!==void 0)s=this._heightOrigin;else{const i=t.height;s=(t.classType===Xe.SCENE_VIEWER?i*t.scaleY:i)-(this._top+this._bottom)}return{width:n,height:s}}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var o,i;if(!this._scrollBar)return;const e=((o=this._scrollBar)==null?void 0:o.limitX)||1/0,t=((i=this._scrollBar)==null?void 0:i.limitY)||1/0;let n=!0,s=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>e?this.scrollX=e:n=!1,this.scrollY<0?this.scrollY=0:this.scrollY>t?this.scrollY=t:s=!1,{isLimitedX:n,isLimitedY:s}}_triggerScrollStop(e,t,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout(()=>{var s,o;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:t,y:n,actualScrollX:e.x,actualScrollY:e.y,limitX:(s=this._scrollBar)==null?void 0:s.limitX,limitY:(o=this._scrollBar)==null?void 0:o.limitY})},0)}_scroll(e,t){var a,l,u,c;const{x:n,y:s}=t;n!==void 0&&(e===1?this.scrollX+=n:this.scrollX=n),s!==void 0&&(e===1?this.scrollY+=s:this.scrollY=s);const o=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,limitX:(a=this._scrollBar)==null?void 0:a.limitX,limitY:(l=this._scrollBar)==null?void 0:l.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const i=this.transformScroll();return this.actualScrollX=i.x,this.actualScrollY=i.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,actualScrollX:i.x,actualScrollY:i.y,limitX:(u=this._scrollBar)==null?void 0:u.limitX,limitY:(c=this._scrollBar)==null?void 0:c.limitY}),this._triggerScrollStop(i,n,s),o}getBarScroll(e,t){let n=e,s=t;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,s*=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:i}=this.scene;n=Math.round(n)*o,s=Math.round(s)*i}else this.scrollX!==void 0&&(n=this.scrollX),this.scrollY!==void 0&&(s=this.scrollY);return{x:n,y:s}}getActualScroll(e,t){let n=e,s=t;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,s/=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:i}=this.scene;n=Math.round(n)/o,s=Math.round(s)/i}else this.actualScrollX!==void 0&&(n=this.actualScrollX),this.actualScrollY!==void 0&&(s=this.actualScrollY);return{x:n,y:s}}transformScroll(){let e=this.scrollX,t=this.scrollY;return this.getActualScroll(e,t)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:n,actualScrollX:s,actualScrollY:o}=e;return t!==void 0&&(this.scrollX=t),n!==void 0&&(this.scrollY=n),s!==void 0&&(this.actualScrollX=s),o!==void 0&&(this.actualScrollY=o),this}getScrollBarTransForm(e=!1){const t=Lt.create();return(e||!this._allowCache)&&t.multiply(Lt.create([1,0,0,1,this._left,this._top])),t}render(e){var l;const t=e||((l=this._scene.getEngine())==null?void 0:l.getCanvas().getContext());if(!this.isDirty()&&this._allowCache){this._applyCache(t);return}let n=this._scene.transform.clone();n.multiply(Lt.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=t;if(!s)return;const o=this._getApplyCanvasState();o&&(n.multiply(Lt.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const i=n.getMatrix(),a=this.getScrollBarTransForm().getMatrix();s.save(),!o&&this._renderClipState&&(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(s),s.restore()),o&&this._applyCache(t),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}_calViewportRelativeBounding(){var c,h,d,g;let e=(h=(c=this._scrollBar)==null?void 0:c.ratioScrollX)!=null?h:1,t=(g=(d=this._scrollBar)==null?void 0:d.ratioScrollY)!=null?g:1,n=this.left,s=(this.width||0)+this.left,o=this.top,i=(this.height||0)+this.top,a=0,l=0;this._preScrollX!=null&&(a=(this._preScrollX-this.scrollX)/e),this._preScrollY!=null&&(l=(this._preScrollY-this.scrollY)/t);const u={tl:xe.FromArray([n,o]),tr:xe.FromArray([s,o]),bl:xe.FromArray([n,i]),br:xe.FromArray([s,i]),dx:a,dy:l};return u.tl=this.getRelativeVector(u.tl),u.tr=this.getRelativeVector(u.tr),u.bl=this.getRelativeVector(u.bl),u.br=this.getRelativeVector(u.br),u}getRelativeVector(e){const t=this.scene.transform.clone().invert(),n=this.transformScroll();return t.applyPoint(e).add(xe.FromArray([n.x,n.y]))}getAbsoluteVector(e){const t=this.scene.transform.clone(),n=this.transformScroll();return t.applyPoint(e).subtract(xe.FromArray([n.x,n.y]))}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();t.classType===Xe.SCENE_VIEWER?this._scrollBar.render(e):t.classType===Xe.ENGINE&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,this.left,this.top,this.width||0,this.height||0)}onMouseWheel(e,t){if(!this._scrollBar)return;let n;if(e.inputIndex===ke.MouseWheelX){const s=Math.abs(e.deltaX),o=this._scene.width;let a=(this.width||1)/o*s;e.deltaX>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===Xe.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()}if(e.inputIndex===ke.MouseWheelY){const s=Math.abs(e.deltaY),o=this._scene.height;let a=(this.height||1)/o*s;e.shiftKey?(e.deltaY>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===Xe.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()):(e.deltaY>0?n=this.scrollBy({y:a}):n=this.scrollBy({y:-a}),this._scene.getParent().classType===Xe.SCENE_VIEWER?n!=null&&n.isLimitedY||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():n!=null&&n.isLimitedY||e.preventDefault())}e.inputIndex,ke.MouseWheelZ}isHit(e){const{width:t,height:n}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+n}pickScrollBar(e){if(!this._scrollBar)return;const n=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(n)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),(e=this._scrollBar)==null||e.dispose()}}class Co extends sn{constructor(){super(Pe.BASE_RENDER),this._engine=new Zu}static create(){return new Co}installTo(e){e.installPlugin(this)}getEngine(){return this._engine}}var AC=Object.freeze(Object.defineProperty({__proto__:null,zh:a0,en:l0,RGB_PAREN:w2,RGBA_PAREN:T2,COLORS:Wn,SHAPE_TYPE:u0,EVENT_TYPE:Bt,LINK_VIEW_PORT_TYPE:c0,MIDDLE_CELL_POS_MAGIC_NUMBER:ku,DEFAULT_FONTFACE_PLANE:h0,DEFAULT_SKELETON_HEADER:S2,DEFAULT_SKELETON_FOOTER:y2,DEFAULT_MEASURE_TEXT:g0,DEFAULT_OFFSET_SPACING:Bu,DEFAULT_DOCUMENT_FONTSIZE:f0,CURSOR_TYPE:ht,DOCUMENT_CONTEXT_CLIP_TYPE:m0,COLOR_BLACK_RGB:Cr,BORDER_TYPE:Vt,ORIENTATION_TYPE:ms,RENDER_CLASS_TYPE:Xe,FontCache:ps,SkeletonType:_0,BreakType:so,LineType:ii,SpanType:on,PageLayoutType:rr,DeviceInputEventType:b0,EventConstants:ya,DeviceType:Cn,PointerInput:ke,TRANSFORM_CHANGE_OBSERVABLE_TYPE:At,PerformanceMonitor:v0,RollingAverage:C0,INITIAL_MATRIX:Da,Transform:Lt,drawLineByBorderType:$u,setLineType:Gu,getLineWidth:Xu,calculateRectRotate:wr,getRotateOrientation:Yu,getRotateOffsetAndFarthestHypotenuse:ju,Vector2:xe,INITIAL_Path2:B0,Path2:L0,getColor:pt,toPx:Er,requestNewFrame:ai,cancelRequestFrame:w0,createCanvasElement:Lu,createImageElement:x2,radToDeg:T0,degToRad:oo,getPointerPrefix:Pu,IsSafari:S0,generateRandomKey:y0,getValueType:Yr,isFunction:Aa,isDate:D2,isRegExp:O2,isArray:F2,isString:Hu,isNumber:M2,isObject:N2,precisionTo:Ra,fixLineWidthByScale:Ue,getFontStyleString:Ia,isSupportBoundingBox:k2,hasChineseText:A0,hasJapaneseText:R0,hasKoreanText:B2,hasCJK:Uu,hasWrappableText:L2,hasAllLatin:P2,hasBasicLatin:H2,hasLatinOneSupplement:U2,hasLatinExtendedA:z2,hasLatinExtendedB:W2,hasArabic:zu,hasTibetan:Wu,hasSpaceAndTab:I0,getDPI:li,ptToPx:$2,pxToPt:D0,ptToMM:G2,pxToInch:X2,getScale:_s,getCellPositionByIndex:ui,getCellByIndex:io,mergeCellHandler:O0,mergeInfoOffset:Vu,isRectIntersect:F0,injectStyle:M0,checkStyle:N0,pxToNum:bs,getSizeForDom:k0,BlockPlugin:Y2,BulletPlugin:j2,dealWidthCustomBlock:P0,dealWidthCustomBulletOrderedSymbol:H0,CustomObject:J2,Engine:Zu,BASE_OBJECT_ARRAY:Oa,BaseObject:jr,Layer:lo,Scene:Ss,SceneViewer:za,Viewport:En,getDevicePixelRatio:Ku,Canvas:Tr,SceneCanvas:Q2,HitCanvas:ev,InputManager:uo,Group:hi,SHAPE_OBJECT_ARRAY:U0,Shape:co,RECT_OBJECT_ARRAY:z0,Rect:tt,Control:tv,Drawing:nv,Selection:rv,REGULAR_POLYGON_OBJECT_ARRAY:W0,RegularPolygon:Ma,ScrollBar:Zr,Picture:vs,PATH_OBJECT_ARRAY:V0,Path:fn,CIRCLE_OBJECT_ARRAY:$0,Circle:qu,RICHTEXT_OBJECT_ARRAY:yc,RichText:U6,Skeleton:Ju,ComponentExtension:Qu,SpreadsheetExtensionRegistry:go,SheetRowTitleExtensionRegistry:ec,SheetColumnTitleExtensionRegistry:tc,DocumentsSpanAndLineExtensionRegistry:fo,RenderComponent:nc,createSkeletonColumn:sv,createSkeletonLine:G0,calculateLineTopByDrawings:X0,setDivideFullState:Y0,setLineMarginBottom:av,updateDivideInLine:lv,isParagraphStart:Na,createAndUpdateBlockAnchor:J0,addSpanToDivide:ka,createSkeletonPage:_o,createSkeletonSection:oc,setColumnFullState:di,createSkeletonWordSpan:lc,createSkeletonLetterSpan:Ba,createSkeletonTabSpan:r6,createSkeletonBulletSpan:s6,setSpanGroupLeft:o6,setSpanLeft:Sv,Liquid:bo,getLastPage:Cs,getLastSection:mo,getLastColumn:xv,getLastLine:a6,getLastLineByColumn:l6,getPageContentWidth:u6,getPreLine:Dv,getColumnByDivide:c6,getLastNotFullColumnInfo:gi,getLastNotFullDivideInfo:cc,getNextDivide:Ov,getLastRemainingDivide:Fv,getLastSpan:Mv,isColumnFull:h6,isBlankPage:d6,isBlankColumn:hc,reCalculateLineDivide:kv,getNumberUnitValue:Sr,getCharSpaceApply:La,validationGrid:dc,getLineHeightConfig:gc,getCharSpaceConfig:g6,updateBlockIndex:Pa,spanIterator:Bv,lineIterator:f6,columnIterator:m6,getPositionHorizon:p6,getPositionVertical:_6,getPositionHorizonBySpan:Lv,getSpanGroupWidth:b6,dealWidthBullet:n6,getDefaultBulletSke:ac,getBulletOrderedSymbol:Q0,dealWidthInlineDrawing:Tv,composeCharForLanguage:i6,calculateParagraphLayout:fc,dealWidthParagraph:C6,dealWidthTextRun:w6,TableOfContents:Jv,dealWithBlockError:T6,dealWithBlocks:_c,dealWidthBlocksByMultiColumnAndContinuous:eC,DocumentSkeletonState:A6,DocumentSkeleton:Es,Documents:ws,DocumentHorizonBar:mC,DocumentVerticalBar:pC,ShowGridlinesState:I6,SheetComponent:Cc,SpreadsheetTitle:Ec,SHEET_EXTENSION_TYPE:x6,SheetExtension:Ts,Background:D6,Border:O6,BorderAuxiliary:F6,Font:M6,RowTitleLayout:N6,ColumnTitleLayout:k6,Spreadsheet:wc,SpreadsheetRowTitle:Tc,SpreadsheetColumnTitle:Sc,SpreadsheetSkeleton:mi,SLIDE_NAVIGATION_KEY:L6,Slide:H6,RenderEngine:Co,ScrollTimer:Kr},Symbol.toStringTag,{value:"Module"}));class Wa{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class Ac{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Wa(e,this._plugin)}check(e){return!1}}class z6{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...e){this._clipboardExtensionFactoryList.push(...e),this._clipboardExtensionFactoryList.sort(yt)}delete(e){const t=this._clipboardExtensionFactoryList.indexOf(e);this._clipboardExtensionFactoryList.splice(t,1)}}const Vn=class{static async writeText(r,e){var t;if(Vn.clipboard)return Vn.clipboard.writeText(r).then(()=>!0,n=>console.dir(n));(t=e==null?void 0:e.clipboardData)==null||t.setData("text/html",r)}static async write(r,e){var t,n,s;if(Vn.clipboard){const o=new Blob([r.data],{type:(t=r.type)!=null?t:"text/html"}),i=[new ClipboardItem({"text/html":o})];return Vn.clipboard.write(i).then(()=>!0,()=>!1)}(s=e==null?void 0:e.clipboardData)==null||s.setData((n=r.type)!=null?n:"text/html",r.data)}static async readText(){return Vn.clipboard?Vn.clipboard.readText().then(r=>r,()=>null):Vn.textArea?new Promise((r,e)=>{r(Vn.textArea.value)}).then(r=>r).then(()=>null):null}static async read(r){if(Vn.clipboard){const s=await Vn.clipboard.read(),o=[];for(const i of s)for(const a of i.types){const l=await i.getType(a),u=new FileReader;a==="image/png"?u.readAsDataURL(l):u.readAsText(l);const c=new Promise((h,d)=>{u.onload=g=>{const m={type:a,result:u.result};h(m)}}).then(h=>h,()=>null);o.push(c)}return Promise.all(o)}const e=[],t=r==null?void 0:r.clipboardData,n=t==null?void 0:t.types;if(!n)return null;for(let s=0;s<n.length;s++)e.push({type:n[s],result:t.getData(n[s])});return e}};let Rc=Vn;Rc.clipboard=window.navigator.clipboard;class W6{getRegister(){return this._register}constructor(){this._register=new z6}handle(e){var s;const t=(s=this._register)==null?void 0:s.clipboardExtensionFactoryList;if(!t)return;this._clipboardExtensionFactoryList=t;const n=this._checkExtension(e);n&&n.execute()}_checkExtension(e){if(!this._clipboardExtensionFactoryList)return!1;let t=!1;for(let n=0;n<this._clipboardExtensionFactoryList.length&&(t=this._clipboardExtensionFactoryList[n].check(e),t===!1);n++);return t}pasteResolver(e){return new Promise((t,n)=>{Rc.read(e).then(s=>{var l,u;if(!s)return[];const o=s.findIndex((c,h)=>c&&c.type==="text/html"),i=s.findIndex((c,h)=>c&&c.type==="text/plain"),a={};if(o>-1){const c=(l=s[o])==null?void 0:l.result;a.html=c}if(i>-1){const c=(u=s[i])==null?void 0:u.result;a.plain=c}t(a)})})}}class Ic{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class V6{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Ic(e,this._plugin)}check(e){return!1}}class $6{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...e){this._DragAndDropExtensionFactoryList.push(...e),this._DragAndDropExtensionFactoryList.sort(yt)}delete(e){const t=this._DragAndDropExtensionFactoryList.indexOf(e);this._DragAndDropExtensionFactoryList.splice(t,1)}}class G6{getRegister(){return this._register}constructor(){this._register=new $6}handle(e){var n;const t=(n=this._register)==null?void 0:n.DragAndDropExtensionFactoryList;!t||(this._DragAndDropExtensionFactoryList=t,this._checkExtension(e))}_checkExtension(e){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach(t=>{const n=t.check(e);n!==!1&&n.execute()})}dragResolver(e){return new Promise((t,n)=>{if(!e.dataTransfer)return;const s=[];e.dataTransfer.items?[...e.dataTransfer.items].forEach((o,i)=>{if(o.kind==="file"){const a=o.getAsFile();a&&s.push({kind:o.kind,type:o.type,file:a})}}):[...e.dataTransfer.files].forEach((o,i)=>{o&&s.push({kind:"file",type:o.type,file:o})}),t(s)})}}var pi,Ge,X6,_i,Y6,j6,Va={},K6=[],RC=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function yr(r,e){for(var t in e)r[t]=e[t];return r}function Z6(r){var e=r.parentNode;e&&e.removeChild(r)}function _(r,e,t){var n,s,o,i={};for(o in e)o=="key"?n=e[o]:o=="ref"?s=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?pi.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(o in r.defaultProps)i[o]===void 0&&(i[o]=r.defaultProps[o]);return bi(r,i,n,s,null)}function bi(r,e,t,n,s){var o={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s==null?++X6:s};return s==null&&Ge.vnode!=null&&Ge.vnode(o),o}function Ae(){return{current:null}}function Rt(r){return r.children}function Mt(r,e){this.props=r,this.context=e}function vi(r,e){if(e==null)return r.__?vi(r.__,r.__.__k.indexOf(r)+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?vi(r):null}function q6(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return q6(r)}}function xc(r){(!r.__d&&(r.__d=!0)&&_i.push(r)&&!$a.__r++||Y6!==Ge.debounceRendering)&&((Y6=Ge.debounceRendering)||setTimeout)($a)}function $a(){for(var r;$a.__r=_i.length;)r=_i.sort(function(e,t){return e.__v.__b-t.__v.__b}),_i=[],r.some(function(e){var t,n,s,o,i,a;e.__d&&(i=(o=(t=e).__v).__e,(a=t.__P)&&(n=[],(s=yr({},o)).__v=o.__v+1,Dc(a,o,s,t.__n,a.ownerSVGElement!==void 0,o.__h!=null?[i]:null,n,i==null?vi(o):i,o.__h),sm(n,o),o.__e!=i&&q6(o)))})}function J6(r,e,t,n,s,o,i,a,l,u){var c,h,d,g,m,f,p,b=n&&n.__k||K6,v=b.length;for(t.__k=[],c=0;c<e.length;c++)if((g=t.__k[c]=(g=e[c])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?bi(null,g,null,null,g):Array.isArray(g)?bi(Rt,{children:g},null,null,null):g.__b>0?bi(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)!=null){if(g.__=t,g.__b=t.__b+1,(d=b[c])===null||d&&g.key==d.key&&g.type===d.type)b[c]=void 0;else for(h=0;h<v;h++){if((d=b[h])&&g.key==d.key&&g.type===d.type){b[h]=void 0;break}d=null}Dc(r,g,d=d||Va,s,o,i,a,l,u),m=g.__e,(h=g.ref)&&d.ref!=h&&(p||(p=[]),d.ref&&p.push(d.ref,null,g),p.push(h,g.__c||m,g)),m!=null?(f==null&&(f=m),typeof g.type=="function"&&g.__k===d.__k?g.__d=l=Q6(g,l,r):l=em(r,g,d,b,m,l),typeof t.type=="function"&&(t.__d=l)):l&&d.__e==l&&l.parentNode!=r&&(l=vi(d))}for(t.__e=f,c=v;c--;)b[c]!=null&&im(b[c],b[c]);if(p)for(c=0;c<p.length;c++)om(p[c],p[++c],p[++c])}function Q6(r,e,t){for(var n,s=r.__k,o=0;s&&o<s.length;o++)(n=s[o])&&(n.__=r,e=typeof n.type=="function"?Q6(n,e,t):em(t,n,n,s,n.__e,e));return e}function sr(r,e){return e=e||[],r==null||typeof r=="boolean"||(Array.isArray(r)?r.some(function(t){sr(t,e)}):e.push(r)),e}function em(r,e,t,n,s,o){var i,a,l;if(e.__d!==void 0)i=e.__d,e.__d=void 0;else if(t==null||s!=o||s.parentNode==null)e:if(o==null||o.parentNode!==r)r.appendChild(s),i=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<n.length;l+=1)if(a==s)break e;r.insertBefore(s,o),i=o}return i!==void 0?i:s.nextSibling}function IC(r,e,t,n,s){var o;for(o in t)o==="children"||o==="key"||o in e||Ga(r,o,null,t[o],n);for(o in e)s&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||t[o]===e[o]||Ga(r,o,e[o],t[o],n)}function tm(r,e,t){e[0]==="-"?r.setProperty(e,t):r[e]=t==null?"":typeof t!="number"||RC.test(e)?t:t+"px"}function Ga(r,e,t,n,s){var o;e:if(e==="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||tm(r.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||tm(r.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in r?e.toLowerCase().slice(2):e.slice(2),r.l||(r.l={}),r.l[e+o]=t,t?n||r.addEventListener(e,o?rm:nm,o):r.removeEventListener(e,o?rm:nm,o);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in r)try{r[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?r.removeAttribute(e):r.setAttribute(e,t))}}function nm(r){this.l[r.type+!1](Ge.event?Ge.event(r):r)}function rm(r){this.l[r.type+!0](Ge.event?Ge.event(r):r)}function Dc(r,e,t,n,s,o,i,a,l){var u,c,h,d,g,m,f,p,b,v,w,S,T,D,R,I=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,a=e.__e=t.__e,e.__h=null,o=[a]),(u=Ge.__b)&&u(e);try{e:if(typeof I=="function"){if(p=e.props,b=(u=I.contextType)&&n[u.__c],v=u?b?b.props.value:u.__:n,t.__c?f=(c=e.__c=t.__c).__=c.__E:("prototype"in I&&I.prototype.render?e.__c=c=new I(p,v):(e.__c=c=new Mt(p,v),c.constructor=I,c.render=DC),b&&b.sub(c),c.props=p,c.state||(c.state={}),c.context=v,c.__n=n,h=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),I.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=yr({},c.__s)),yr(c.__s,I.getDerivedStateFromProps(p,c.__s))),d=c.props,g=c.state,h)I.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(I.getDerivedStateFromProps==null&&p!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(p,v),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(p,c.__s,v)===!1||e.__v===t.__v){for(c.props=p,c.state=c.__s,e.__v!==t.__v&&(c.__d=!1),c.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(y){y&&(y.__=e)}),w=0;w<c._sb.length;w++)c.__h.push(c._sb[w]);c._sb=[],c.__h.length&&i.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(p,c.__s,v),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,g,m)})}if(c.context=v,c.props=p,c.__v=e,c.__P=r,S=Ge.__r,T=0,"prototype"in I&&I.prototype.render){for(c.state=c.__s,c.__d=!1,S&&S(e),u=c.render(c.props,c.state,c.context),D=0;D<c._sb.length;D++)c.__h.push(c._sb[D]);c._sb=[]}else do c.__d=!1,S&&S(e),u=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++T<25);c.state=c.__s,c.getChildContext!=null&&(n=yr(yr({},n),c.getChildContext())),h||c.getSnapshotBeforeUpdate==null||(m=c.getSnapshotBeforeUpdate(d,g)),R=u!=null&&u.type===Rt&&u.key==null?u.props.children:u,J6(r,Array.isArray(R)?R:[R],e,t,n,s,o,i,a,l),c.base=e.__e,e.__h=null,c.__h.length&&i.push(c),f&&(c.__E=c.__=null),c.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=xC(t.__e,e,t,n,s,o,i,l);(u=Ge.diffed)&&u(e)}catch(y){e.__v=null,(l||o!=null)&&(e.__e=a,e.__h=!!l,o[o.indexOf(a)]=null),Ge.__e(y,e,t)}}function sm(r,e){Ge.__c&&Ge.__c(e,r),r.some(function(t){try{r=t.__h,t.__h=[],r.some(function(n){n.call(t)})}catch(n){Ge.__e(n,t.__v)}})}function xC(r,e,t,n,s,o,i,a){var l,u,c,h=t.props,d=e.props,g=e.type,m=0;if(g==="svg"&&(s=!0),o!=null){for(;m<o.length;m++)if((l=o[m])&&"setAttribute"in l==!!g&&(g?l.localName===g:l.nodeType===3)){r=l,o[m]=null;break}}if(r==null){if(g===null)return document.createTextNode(d);r=s?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,d.is&&d),o=null,a=!1}if(g===null)h===d||a&&r.data===d||(r.data=d);else{if(o=o&&pi.call(r.childNodes),u=(h=t.props||Va).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!a){if(o!=null)for(h={},m=0;m<r.attributes.length;m++)h[r.attributes[m].name]=r.attributes[m].value;(c||u)&&(c&&(u&&c.__html==u.__html||c.__html===r.innerHTML)||(r.innerHTML=c&&c.__html||""))}if(IC(r,d,h,s,a),c)e.__k=[];else if(m=e.props.children,J6(r,Array.isArray(m)?m:[m],e,t,n,s&&g!=="foreignObject",o,i,o?o[0]:t.__k&&vi(t,0),a),o!=null)for(m=o.length;m--;)o[m]!=null&&Z6(o[m]);a||("value"in d&&(m=d.value)!==void 0&&(m!==r.value||g==="progress"&&!m||g==="option"&&m!==h.value)&&Ga(r,"value",m,h.value,!1),"checked"in d&&(m=d.checked)!==void 0&&m!==r.checked&&Ga(r,"checked",m,h.checked,!1))}return r}function om(r,e,t){try{typeof r=="function"?r(e):r.current=e}catch(n){Ge.__e(n,t)}}function im(r,e,t){var n,s;if(Ge.unmount&&Ge.unmount(r),(n=r.ref)&&(n.current&&n.current!==r.__e||om(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){Ge.__e(o,e)}n.base=n.__P=null,r.__c=void 0}if(n=r.__k)for(s=0;s<n.length;s++)n[s]&&im(n[s],e,t||typeof r.type!="function");t||r.__e==null||Z6(r.__e),r.__=r.__e=r.__d=void 0}function DC(r,e,t){return this.constructor(r,t)}function Ar(r,e,t){var n,s,o;Ge.__&&Ge.__(r,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,o=[],Dc(e,r=(!n&&t||e).__k=_(Rt,null,[r]),s||Va,Va,e.ownerSVGElement!==void 0,!n&&t?[t]:s?null:e.firstChild?pi.call(e.childNodes):null,o,!n&&t?t:s?s.__e:e.firstChild,n),sm(o,r)}function am(r,e){Ar(r,e,am)}function qr(r,e,t){var n,s,o,i=yr({},r.props);for(o in e)o=="key"?n=e[o]:o=="ref"?s=e[o]:i[o]=e[o];return arguments.length>2&&(i.children=arguments.length>3?pi.call(arguments,2):t),bi(r.type,i,n||r.key,s||r.ref,null)}function lm(r,e){var t={__c:e="__cC"+j6++,__:r,Consumer:function(n,s){return n.children(s)},Provider:function(n){var s,o;return this.getChildContext||(s=[],(o={})[e]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(i){this.props.value!==i.value&&s.some(xc)},this.sub=function(i){s.push(i);var a=i.componentWillUnmount;i.componentWillUnmount=function(){s.splice(s.indexOf(i),1),a&&a.call(i)}}),n.children}};return t.Provider.__=t.Consumer.contextType=t}pi=K6.slice,Ge={__e:function(r,e,t,n){for(var s,o,i;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(r)),i=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(r,n||{}),i=s.__d),i)return s.__E=s}catch(a){r=a}throw r}},X6=0,Mt.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=yr({},this.state),typeof r=="function"&&(r=r(yr({},t),this.props)),r&&yr(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),xc(this))},Mt.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),xc(this))},Mt.prototype.render=Rt,_i=[],$a.__r=0,j6=0;const Eo=lm({});class um{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onKeyDownObservable","core",new ye),this._observerManager.addObserver("onKeyUpObservable","core",new ye),this._observerManager.addObserver("onKeyCopyObservable","core",new ye),this._observerManager.addObserver("onKeyPasteObservable","core",new ye),this._observerManager.addObserver("onKeyCutObservable","core",new ye),this._observerManager.addObserver("onKeyCompositionStartObservable","core",new ye),this._observerManager.addObserver("onKeyCompositionUpdateObservable","core",new ye),this._observerManager.addObserver("onKeyCompositionEndObservable","core",new ye)}handleKeyboardAction(e){const t=c=>{var h;(h=this._observerManager.requiredObserver("onKeyDownObservable","core"))==null||h.notifyObservers(c)},n=c=>{var h;(h=this._observerManager.requiredObserver("onKeyUpObservable","core"))==null||h.notifyObservers(c)},s=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCopyObservable","core"))==null||h.notifyObservers(c)},o=c=>{var h;(h=this._observerManager.requiredObserver("onKeyPasteObservable","core"))==null||h.notifyObservers(c)},i=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCutObservable","core"))==null||h.notifyObservers(c)},a=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionStartObservable","core"))==null||h.notifyObservers(c)},l=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionUpdateObservable","core"))==null||h.notifyObservers(c)},u=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionEndObservable","core"))==null||h.notifyObservers(c)};e.addEventListener("keydown",t),e.addEventListener("keyup",n),e.addEventListener("copy",s),e.addEventListener("paste",o),e.addEventListener("cut",i),e.addEventListener("compositionstart",a),e.addEventListener("compositionupdate",l),e.addEventListener("compositionend",u)}}class cm{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onDropObservable","core",new ye)}handleDragAction(e){const t=s=>{var o;s.preventDefault(),(o=this._observerManager.requiredObserver("onDropObservable","core"))==null||o.notifyObservers(s)},n=s=>{s.preventDefault()};e.addEventListener("drop",t),e.addEventListener("dragover",n)}}var hm=(r=>(r[r.Button=0]="Button",r[r.SingleButton=1]="SingleButton",r[r.Select=2]="Select",r[r.Container=3]="Container",r[r.CellRangeModal=4]="CellRangeModal",r[r.Modal=5]="Modal",r[r.SiderModal=6]="SiderModal",r[r.Layout=7]="Layout",r[r.Header=8]="Header",r[r.Footer=9]="Footer",r[r.Content=10]="Content",r[r.Sider=11]="Sider",r[r.Demo=12]="Demo",r[r.Checkbox=13]="Checkbox",r[r.CheckboxGroup=14]="CheckboxGroup",r[r.ColorPicker=15]="ColorPicker",r[r.ColorPickerCircleButton=16]="ColorPickerCircleButton",r[r.Input=17]="Input",r[r.Radio=18]="Radio",r[r.RadioGroup=19]="RadioGroup",r[r.Tab=20]="Tab",r[r.TabPane=21]="TabPane",r[r.Avatar=22]="Avatar",r[r.Tooltip=23]="Tooltip",r[r.Ul=24]="Ul",r[r.Collapse=25]="Collapse",r[r.Panel=26]="Panel",r[r.FormatModal=27]="FormatModal",r[r.RichText=28]="RichText",r[r.NextIcon=29]="NextIcon",r[r.RightIcon=30]="RightIcon",r[r.OrderIcon=31]="OrderIcon",r[r.CommentIcon=32]="CommentIcon",r[r.ConditionalFormatIcon=33]="ConditionalFormatIcon",r[r.ScreenshotIcon=34]="ScreenshotIcon",r[r.CheckIcon=35]="CheckIcon",r[r.SearchIcon=36]="SearchIcon",r[r.ReplaceIcon=37]="ReplaceIcon",r[r.FreezeIcon=38]="FreezeIcon",r[r.PivotableIcon=39]="PivotableIcon",r[r.FillColorIcon=40]="FillColorIcon",r[r.BoldIcon=41]="BoldIcon",r[r.FullBorderIcon=42]="FullBorderIcon",r[r.TopBorderIcon=43]="TopBorderIcon",r[r.BottomBorderIcon=44]="BottomBorderIcon",r[r.LeftBorderIcon=45]="LeftBorderIcon",r[r.RightBorderIcon=46]="RightBorderIcon",r[r.NoneBorderIcon=47]="NoneBorderIcon",r[r.OuterBorderIcon=48]="OuterBorderIcon",r[r.InnerBorderIcon=49]="InnerBorderIcon",r[r.StripingBorderIcon=50]="StripingBorderIcon",r[r.VerticalBorderIcon=51]="VerticalBorderIcon",r[r.MergeIcon=52]="MergeIcon",r[r.SumIcon=53]="SumIcon",r[r.OrderDESCIcon=54]="OrderDESCIcon",r[r.OrderASCIcon=55]="OrderASCIcon",r[r.FilterIcon=56]="FilterIcon",r[r.FilterRankIcon=57]="FilterRankIcon",r[r.CleanIcon=58]="CleanIcon",r[r.DeleteIcon=59]="DeleteIcon",r[r.DeleteLineIcon=60]="DeleteLineIcon",r[r.UnderLineIcon=61]="UnderLineIcon",r[r.ItalicIcon=62]="ItalicIcon",r[r.TextColorIcon=63]="TextColorIcon",r[r.BackIcon=64]="BackIcon",r[r.ForwardIcon=65]="ForwardIcon",r[r.FormatIcon=66]="FormatIcon",r[r.CorrectIcon=67]="CorrectIcon",r[r.LtIcon=68]="LtIcon",r[r.CloseIcon=69]="CloseIcon",r[r.DropDownIcon=70]="DropDownIcon",r[r.MenuIcon=71]="MenuIcon",r[r.HideIcon=72]="HideIcon",r[r.PhotoIcon=73]="PhotoIcon",r[r.LinkIcon=74]="LinkIcon",r[r.ChartIcon=75]="ChartIcon",r[r.LoadingIcon=76]="LoadingIcon",r[r.LogoIcon=77]="LogoIcon",r[r.AddNumIcon=78]="AddNumIcon",r[r.ReduceNumIcon=79]="ReduceNumIcon",r[r.PercentIcon=80]="PercentIcon",r[r.MoneyIcon=81]="MoneyIcon",r[r.FxIcon=82]="FxIcon",r[r.AddIcon=83]="AddIcon",r[r.ReduceIcon=84]="ReduceIcon",r[r.DivideIcon=85]="DivideIcon",r[r.LockIcon=86]="LockIcon",r[r.LocationIcon=87]="LocationIcon",r[r.PageIcon=88]="PageIcon",r[r.RegularIcon=89]="RegularIcon",r[r.LayoutIcon=90]="LayoutIcon",r[r.TableIcon=91]="TableIcon",r[r.ImageIcon=92]="ImageIcon",r[r.LeftAlignIcon=93]="LeftAlignIcon",r[r.CenterAlignIcon=94]="CenterAlignIcon",r[r.RightAlignIcon=95]="RightAlignIcon",r[r.TopVerticalIcon=96]="TopVerticalIcon",r[r.CenterVerticalIcon=97]="CenterVerticalIcon",r[r.BottomVerticalIcon=98]="BottomVerticalIcon",r[r.TextRotateIcon=99]="TextRotateIcon",r[r.TextRotateAngleUpIcon=100]="TextRotateAngleUpIcon",r[r.TextRotateAngleDownIcon=101]="TextRotateAngleDownIcon",r[r.TextRotateVerticalIcon=102]="TextRotateVerticalIcon",r[r.TextRotateRotationUpIcon=103]="TextRotateRotationUpIcon",r[r.TextRotateRotationDownIcon=104]="TextRotateRotationDownIcon",r[r.BrIcon=105]="BrIcon",r[r.OverflowIcon=106]="OverflowIcon",r[r.CutIcon=107]="CutIcon",r[r.PrintIcon=108]="PrintIcon",r[r.PrintAreaIcon=109]="PrintAreaIcon",r[r.PrintTitleIcon=110]="PrintTitleIcon",r[r.BorderDashDot=111]="BorderDashDot",r[r.BorderDashDotDot=112]="BorderDashDotDot",r[r.BorderDashed=113]="BorderDashed",r[r.BorderDotted=114]="BorderDotted",r[r.BorderHair=115]="BorderHair",r[r.BorderMedium=116]="BorderMedium",r[r.BorderMediumDashDot=117]="BorderMediumDashDot",r[r.BorderMediumDashDotDot=118]="BorderMediumDashDotDot",r[r.BorderMediumDashed=119]="BorderMediumDashed",r[r.BorderThick=120]="BorderThick",r[r.BorderThin=121]="BorderThin",r))(hm||{}),dm=(r=>(r.BUTTON="Button",r.CONTAINER="Container",r.CELL_RANGE_MODAL="CellRangeModal",r.LAYOUT="Layout",r.HEADER="Header",r.FOOTER="Footer",r.CONTENT="Content",r.SIDER="Sider",r.DEMO="Demo",r.SHEET_CONTAINER="SheetContainer",r))(dm||{}),Dn=(r=>(r.INPUT="input",r.COLOR="color",r.DOUBLE="double",r.JSX="jsx",r.INPUT_NUMBER="inputNumber",r))(Dn||{}),Jr=(r=>(r.JSX="jsx",r.JSX_STRING="jsx_string",r.HTML="html",r.HTML_STRING="html_string",r.STRING="string",r.SINGLE="single",r.SELECT="select",r))(Jr||{}),ys,Ct,Oc,gm,wo=0,fm=[],Xa=[],mm=Ge.__b,pm=Ge.__r,_m=Ge.diffed,bm=Ge.__c,vm=Ge.unmount;function To(r,e){Ge.__h&&Ge.__h(Ct,r,wo||e),wo=0;var t=Ct.__H||(Ct.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({__V:Xa}),t.__[r]}function Ci(r){return wo=1,Cm(wm,r)}function Cm(r,e,t){var n=To(ys++,2);if(n.t=r,!n.__c&&(n.__=[t?t(e):wm(void 0,e),function(o){var i=n.__N?n.__N[0]:n.__[0],a=n.t(i,o);i!==a&&(n.__N=[a,n.__[1]],n.__c.setState({}))}],n.__c=Ct,!Ct.u)){Ct.u=!0;var s=Ct.shouldComponentUpdate;Ct.shouldComponentUpdate=function(o,i,a){if(!n.__c.__H)return!0;var l=n.__c.__H.__.filter(function(c){return c.__c});if(l.every(function(c){return!c.__N}))return!s||s.call(this,o,i,a);var u=!1;return l.forEach(function(c){if(c.__N){var h=c.__[0];c.__=c.__N,c.__N=void 0,h!==c.__[0]&&(u=!0)}}),!(!u&&n.__c.props===o)&&(!s||s.call(this,o,i,a))}}return n.__N||n.__}function Qr(r,e){var t=To(ys++,3);!Ge.__s&&Mc(t.__H,e)&&(t.__=r,t.i=e,Ct.__H.__h.push(t))}function Ei(r,e){var t=To(ys++,4);!Ge.__s&&Mc(t.__H,e)&&(t.__=r,t.i=e,Ct.__h.push(t))}function On(r){return wo=5,Ya(function(){return{current:r}},[])}function OC(r,e,t){wo=6,Ei(function(){return typeof r=="function"?(r(e()),function(){return r(null)}):r?(r.current=e(),function(){return r.current=null}):void 0},t==null?t:t.concat(r))}function Ya(r,e){var t=To(ys++,7);return Mc(t.__H,e)?(t.__V=r(),t.i=e,t.__h=r,t.__V):t.__}function So(r,e){return wo=8,Ya(function(){return r},e)}function FC(r){var e=Ct.context[r.__c],t=To(ys++,9);return t.c=r,e?(t.__==null&&(t.__=!0,e.sub(Ct)),e.props.value):r.__}function MC(r,e){Ge.useDebugValue&&Ge.useDebugValue(e?e(r):r)}function NC(){var r=To(ys++,11);if(!r.__){for(var e=Ct.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);r.__="P"+t[0]+"-"+t[1]++}return r.__}function kC(){for(var r;r=fm.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(ja),r.__H.__h.forEach(Fc),r.__H.__h=[]}catch(e){r.__H.__h=[],Ge.__e(e,r.__v)}}Ge.__b=function(r){Ct=null,mm&&mm(r)},Ge.__r=function(r){pm&&pm(r),ys=0;var e=(Ct=r.__c).__H;e&&(Oc===Ct?(e.__h=[],Ct.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=Xa,t.__N=t.i=void 0})):(e.__h.forEach(ja),e.__h.forEach(Fc),e.__h=[])),Oc=Ct},Ge.diffed=function(r){_m&&_m(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(fm.push(e)!==1&&gm===Ge.requestAnimationFrame||((gm=Ge.requestAnimationFrame)||BC)(kC)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==Xa&&(t.__=t.__V),t.i=void 0,t.__V=Xa})),Oc=Ct=null},Ge.__c=function(r,e){e.some(function(t){try{t.__h.forEach(ja),t.__h=t.__h.filter(function(n){return!n.__||Fc(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],Ge.__e(n,t.__v)}}),bm&&bm(r,e)},Ge.unmount=function(r){vm&&vm(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{ja(n)}catch(s){e=s}}),t.__H=void 0,e&&Ge.__e(e,t.__v))};var Em=typeof requestAnimationFrame=="function";function BC(r){var e,t=function(){clearTimeout(n),Em&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,100);Em&&(e=requestAnimationFrame(t))}function ja(r){var e=Ct,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),Ct=e}function Fc(r){var e=Ct;r.__c=r.__(),Ct=e}function Mc(r,e){return!r||r.length!==e.length||e.some(function(t,n){return t!==r[n]})}function wm(r,e){return typeof e=="function"?e(r):e}function Tm(r,e){for(var t in e)r[t]=e[t];return r}function Nc(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function kc(r,e){return r===e&&(r!==0||1/r==1/e)||r!=r&&e!=e}function yo(r){this.props=r}function LC(r,e){function t(s){var o=this.props.ref,i=o==s.ref;return!i&&o&&(o.call?o(null):o.current=null),e?!e(this.props,s)||!i:Nc(this.props,s)}function n(s){return this.shouldComponentUpdate=t,_(r,s)}return n.displayName="Memo("+(r.displayName||r.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(yo.prototype=new Mt).isPureReactComponent=!0,yo.prototype.shouldComponentUpdate=function(r,e){return Nc(this.props,r)||Nc(this.state,e)};var Sm=Ge.__b;Ge.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),Sm&&Sm(r)};var PC=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Ka(r){function e(t){var n=Tm({},t);return delete n.ref,r(n,t.ref||null)}return e.$$typeof=PC,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(r.displayName||r.name)+")",e}var ym=function(r,e){return r==null?null:sr(sr(r).map(e))},HC={map:ym,forEach:ym,count:function(r){return r?sr(r).length:0},only:function(r){var e=sr(r);if(e.length!==1)throw"Children.only";return e[0]},toArray:sr},UC=Ge.__e;Ge.__e=function(r,e,t,n){if(r.then){for(var s,o=e;o=o.__;)if((s=o.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(r,e)}UC(r,e,t,n)};var Am=Ge.unmount;function Rm(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=Tm({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return Rm(n,e,t)})),r}function Im(r,e,t){return r&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return Im(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.insertBefore(r.__e,r.__d),r.__c.__e=!0,r.__c.__P=t)),r}function Za(){this.__u=0,this.t=null,this.__b=null}function xm(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function zC(r){var e,t,n;function s(o){if(e||(e=r()).then(function(i){t=i.default||i},function(i){n=i}),n)throw n;if(!t)throw e;return _(t,o)}return s.displayName="Lazy",s.__f=!0,s}function wi(){this.u=null,this.o=null}Ge.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&r.__h===!0&&(r.type=null),Am&&Am(r)},(Za.prototype=new Mt).__c=function(r,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var s=xm(n.__v),o=!1,i=function(){o||(o=!0,t.__R=null,s?s(a):a())};t.__R=i;var a=function(){if(!--n.__u){if(n.state.__a){var u=n.state.__a;n.__v.__k[0]=Im(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}},l=e.__h===!0;n.__u++||l||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(i,i)},Za.prototype.componentWillUnmount=function(){this.t=[]},Za.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Rm(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&_(Rt,null,r.fallback);return s&&(s.__h=null),[_(Rt,null,e.__a?null:r.children),s]};var Dm=function(r,e,t){if(++t[1]===t[0]&&r.o.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.o.size))for(t=r.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.u=t=t[2]}};function WC(r){return this.getChildContext=function(){return r.context},r.children}function VC(r){var e=this,t=r.i;e.componentWillUnmount=function(){Ar(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),r.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,s){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),Ar(_(WC,{context:e.context},r.__v),e.l)):e.l&&e.componentWillUnmount()}function $C(r,e){var t=_(VC,{__v:r,i:e});return t.containerInfo=e,t}(wi.prototype=new Mt).__a=function(r){var e=this,t=xm(e.__v),n=e.o.get(r);return n[0]++,function(s){var o=function(){e.props.revealOrder?(n.push(s),Dm(e,r,n)):s()};t?t(o):o()}},wi.prototype.render=function(r){this.u=null,this.o=new Map;var e=sr(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return r.children},wi.prototype.componentDidUpdate=wi.prototype.componentDidMount=function(){var r=this;this.o.forEach(function(e,t){Dm(r,t,e)})};var Om=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,GC=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,XC=typeof document!="undefined",YC=function(r){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(r)};function jC(r,e,t){return e.__k==null&&(e.textContent=""),Ar(r,e),typeof t=="function"&&t(),r?r.__c:null}function KC(r,e,t){return am(r,e),typeof t=="function"&&t(),r?r.__c:null}Mt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(Mt.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var Fm=Ge.event;function ZC(){}function qC(){return this.cancelBubble}function JC(){return this.defaultPrevented}Ge.event=function(r){return Fm&&(r=Fm(r)),r.persist=ZC,r.isPropagationStopped=qC,r.isDefaultPrevented=JC,r.nativeEvent=r};var Mm,Nm={configurable:!0,get:function(){return this.class}},km=Ge.vnode;Ge.vnode=function(r){var e=r.type,t=r.props,n=t;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var o in n={},t){var i=t[o];XC&&o==="children"&&e==="noscript"||o==="value"&&"defaultValue"in t&&i==null||(o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&i===!0?i="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!YC(t.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():s&&GC.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():i===null&&(i=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),n[o]&&(o="oninputCapture")),n[o]=i)}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=sr(t.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=sr(t.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),r.props=n,t.class!=t.className&&(Nm.enumerable="className"in t,t.className!=null&&(n.class=t.className),Object.defineProperty(n,"className",Nm))}r.$$typeof=Om,km&&km(r)};var Bm=Ge.__r;Ge.__r=function(r){Bm&&Bm(r),Mm=r.__c};var QC={ReactCurrentDispatcher:{current:{readContext:function(r){return Mm.__n[r.__c].props.value}}}};function e5(r){return _.bind(null,r)}function Lm(r){return!!r&&r.$$typeof===Om}function t5(r){return Lm(r)?qr.apply(null,arguments):r}function n5(r){return!!r.__k&&(Ar(null,r),!0)}function r5(r){return r&&(r.base||r.nodeType===1&&r)||null}var s5=function(r,e){return r(e)},o5=function(r,e){return r(e)},i5=Rt;function Pm(r){r()}function a5(r){return r}function l5(){return[!1,Pm]}var u5=Ei;function c5(r,e){var t=e(),n=Ci({h:{__:t,v:e}}),s=n[0].h,o=n[1];return Ei(function(){s.__=t,s.v=e,kc(s.__,e())||o({h:s})},[r,t,e]),Qr(function(){return kc(s.__,s.v())||o({h:s}),r(function(){kc(s.__,s.v())||o({h:s})})},[r]),t}var Et={useState:Ci,useId:NC,useReducer:Cm,useEffect:Qr,useLayoutEffect:Ei,useInsertionEffect:u5,useTransition:l5,useDeferredValue:a5,useSyncExternalStore:c5,startTransition:Pm,useRef:On,useImperativeHandle:OC,useMemo:Ya,useCallback:So,useContext:FC,useDebugValue:MC,version:"17.0.2",Children:HC,render:jC,hydrate:KC,unmountComponentAtNode:n5,createPortal:$C,createElement:_,createContext:lm,createFactory:e5,cloneElement:t5,createRef:Ae,Fragment:Rt,isValidElement:Lm,findDOMNode:r5,Component:Mt,PureComponent:yo,memo:LC,forwardRef:Ka,flushSync:o5,unstable_batchedUpdates:s5,StrictMode:i5,Suspense:Za,SuspenseList:wi,lazy:zC,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:QC};class Oe extends Mt{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}Oe.contextType=Eo;class Hm extends yo{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}Hm.contextType=Eo;function qa(r){return r instanceof Element||r instanceof HTMLDocument}const Um=typeof HTMLElement=="object"?function(r){return r instanceof HTMLElement}:function(r){return r&&typeof r=="object"&&r.nodeType===1&&typeof r.nodeName=="string"};function Rr(r,e){e=e||document;let t=e.querySelectorAll(r);return t.length===1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function h5(r,e,t){if(typeof e!="string"){e.classList.add(r);return}t=t||document,Array.prototype.slice.call(t.querySelectorAll(e)).forEach(s=>{s.classList.add(r)})}function d5(r,e,t){if(typeof e!="string"){e.classList.remove(r);return}t=t||document,Array.prototype.slice.call(t.querySelectorAll(e)).forEach(s=>{s.classList.remove(r)})}function g5(r,e){const t=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;for(;r;){if(t.call(r,e))return r;r=r.parentElement}return null}function Ja(r){return r=r?`${r}-`:"",r+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function zm(r){let e=[],t=r.getElementsByTagName("*");for(let n=0,s=t.length;n<s;++n){if(t[n].nodeType!==1)continue;let o=t[n].parentNode;o&&o.nodeType===1?o===r&&(e[e.length]=t[n]):o&&o.parentNode===r&&(e[e.length]=t[n])}return e}function $t(...r){if(!r.length)return;let e="";return r.forEach(t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=` ${t}`}),e}const Wm=r=>[...r.parentNode.children].indexOf(r);function es(r,e){let t=null;return function(...n){clearTimeout(t),t=setTimeout(()=>{r(...n)},e)}}function Vm(r){var e,t;if(window.getSelection){let n=document.createRange(),s=r.firstChild;s&&(n.setStart(s,0),n.setEnd(s,s.length),n.startContainer&&Bc(n.startContainer)&&((e=window.getSelection())==null||e.removeAllRanges(),(t=window.getSelection())==null||t.addRange(n)))}}function $m(r,e){var t,n;if(window.getSelection){let s=document.createRange(),o=r.firstChild,i=e.firstChild;o&&i&&(s.setStart(o,0),s.setEnd(i,i.length),s.startContainer&&Bc(s.startContainer)&&((t=window.getSelection())==null||t.removeAllRanges(),(n=window.getSelection())==null||n.addRange(s)))}}function Bc(r){return r===document.body?!1:document.body.contains(r)}function jt(r){return r.length===0?r:r.replace(/^\s+|\s+$/gm,"")}function ts(r){if(Um(r.current))return r.current;let e=r.current;return e?e==null?void 0:e.base:r.base}function f5(r){return r>47&&r<58||r===32||r===13||r>64&&r<91||r>95&&r<112||r>185&&r<193||r>218&&r<223}function Qa(r){return typeof r!="string"?r:r.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}function Gm(r){const e=window.getSelection();e&&e.selectAllChildren(r),e&&e.collapseToEnd()}function Lc(r){var a;let e=r.childNodes;if(e.length===0)return r.textContent;if(e[0].nodeName==="DIV"&&(e=e[0].childNodes),e.length===1&&e[0].nodeName==="#text")return e[0].textContent;const t={},n=[];let s=0;for(let l=0;l<e.length;l++){let u=e[`${l}`],c;u.nodeName==="#text"?(c=(a=u.textContent)!=null?a:"",u=u.parentElement):c=u.innerText;let h=el(u);Xm(c).forEach(g=>{s=+g.length;let m=St(6);t[m]={eId:m,st:0,ed:g.length-1,et:0,tr:{ct:g,ts:h}},n.push({elementId:m,paragraphElementType:0})})}const o=St(6);return{id:St(6),body:{blockElements:{[o]:{blockId:o,st:0,ed:s,blockType:0,paragraph:{elements:t,elementOrder:n}},b:{blockId:"b",st:0,ed:0,blockType:Fe.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}},blockElementOrder:[o,"b"]},documentStyle:{}}}function Pc(r){var t;let e="";if((t=r.body)!=null&&t.blockElements)for(let n in r.body.blockElements){const s=r.body.blockElements[n];if(!(s.blockType!==Fe.PARAGRAPH&&s.blockType!==Fe.SECTION_BREAK)&&s.blockType===Fe.PARAGRAPH)for(let o in s.paragraph){const i=s.paragraph[o];for(let a in i){const l=i[a];if(l.et===K.TEXT_RUN){let u=`display:inline-block;${tl(l.tr.ts)}`;e+=`<span id='${l.eId}' ${u.length?`style="${u}"`:""} >${l.tr.ct}</span>`}}}}return e}function el(r){const e=r.style.cssText;if(e==null||e.length===0)return{};let t=e.split(";"),n={};return t.forEach(s=>{s=s.toLowerCase();let o=jt(s.substr(0,s.indexOf(":"))),i=jt(s.substr(s.indexOf(":")+1));if(o==="font-weight")i==="bold"?n.bl=1:n.bl=0;else if(o==="font-style")i==="italic"?n.it=1:n.it=0;else if(o==="font-family")n.ff=i;else if(o==="font-size"){let a=parseInt(i);e.indexOf("vertical-align")>-1&&(e.indexOf("sub")>-1||e.indexOf("sup")>-1)&&(a*=2),i.indexOf("px")!==-1&&(a=D0(parseInt(i))),n.fs=a}else o==="color"?n.cl={rgb:i}:o==="background"||o==="background-color"?n.bg={rgb:i}:o==="text-decoration-line"?i==="underline"?(n.ul||(n.ul={s:1}),n.ul.s=1):i==="line-through"?(n.st||(n.st={s:1}),n.st.s=1):i==="overline"&&(n.ol||(n.ol={s:1}),n.ol.s=1):o==="text-decoration-color"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,cl:{rgb:i}}),n.ul.cl={rgb:i}),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,cl:{rgb:i}}),n.st.cl={rgb:i}),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,cl:{rgb:i}}),n.ol.cl={rgb:i})):o==="text-decoration-style"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,t:Number(i)}),n.ul.t=Number(i)),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,t:Number(i)}),n.st.t=Number(i)),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,t:Number(i)}),n.ol.t=Number(i))):(o==="text-decoration"||o==="univer-strike")&&(n.st={s:1});if(o==="univer-underline"&&(n.ul={s:1}),o==="vertical-align"&&(i==="sub"?n.va=1:i==="super"?n.va=2:i==="top"?n.vt=1:i==="middle"?n.vt=2:i==="bottom"?n.vt=3:n.va=0),o==="transform"){const a=i.split(")"),l=a.findIndex(u=>u.includes("rotate"));if(l>-1){const u=a[l].match(/\d+/g);let c=0,h=0;u!=null&&u.length&&(c=+u[0]),r.dataset.vertical&&(h=+r.dataset.vertical),n.tr={a:c,v:h}}}o==="text-align"&&(i==="left"?n.ht=1:i==="center"?n.ht=2:i==="right"?n.ht=3:i==="justify"?n.ht=4:n.ht=0),(o==="overflow-wrap"||o==="overflowWrap")&&i==="break-word"&&(n.tb=3)}),n}function Xm(r){if(r==="")return[r];const e=/(?:(\n+.+)|(.+))/g;return r.match(e).map(s=>s.replace(/\n/g,`\r
`))}function tl(r,e=!1){var o;let t="";const n=new Map([["ff",()=>{r.ff&&(t+=`font-family: ${r.ff}; `)}],["fs",()=>{if(r.fs){let i=r.fs;r.va&&(i/=2),t+=`font-size: ${i}pt; `}}],["it",()=>{r.it?t+="font-style: italic; ":t+="font-style: normal; "}],["bl",()=>{r.bl?t+="font-weight: bold; ":t+="font-weight: normal; "}],["ul",()=>{var i;(i=r.ul)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):t+="text-decoration-line: underline; ",r.ul.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${Ft(r.ul.cl)}; `),r.ul.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.ul.t} `))}],["st",()=>{var i;(i=r.st)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):t+="text-decoration-line: line-through; ",r.st.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${Ft(r.st.cl)}; `),r.st.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.st.t} `))}],["ol",()=>{var i;(i=r.ol)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):t+="text-decoration-line: overline; ",r.ol.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${Ft(r.ol.cl)}; `),r.ol.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.ol.t} `))}],["bg",()=>{t+=`background: ${Ft(r.bg)}; `}],["bd",()=>{var i,a,l,u,c,h,d,g,m,f,p,b;(i=r.bd)!=null&&i.b&&(t+=`border-bottom: ${nl((a=r.bd)==null?void 0:a.b.s)} ${(l=Ft(r.bd.b.cl))!=null?l:""}; `),(u=r.bd)!=null&&u.t&&(t+=`border-top: ${nl((c=r.bd)==null?void 0:c.t.s)} ${(h=Ft(r.bd.t.cl))!=null?h:""}; `),(d=r.bd)!=null&&d.r&&(t+=`border-right: ${nl((g=r.bd)==null?void 0:g.r.s)} ${(m=Ft(r.bd.r.cl))!=null?m:""}; `),(f=r.bd)!=null&&f.l&&(t+=`border-left: ${nl((p=r.bd)==null?void 0:p.l.s)} ${(b=Ft(r.bd.l.cl))!=null?b:""}; `)}],["cl",()=>{t+=`color: ${Ft(r.cl)}; `}],["va",()=>{r.va===cn.NORMAL?t+="vertical-align: baseline; ":r.va===cn.SUBSCRIPT?t+="vertical-align: sub; ":t+="vertical-align: super; "}],["td",()=>{r.td===Ys.UNSPECIFIED?t+="direction: inherit; ":r.td===Ys.LEFT_TO_RIGHT?t+="direction: ltr; ":t+="direction: rtl; "}],["tr",()=>{var i,a,l;t+=`data-rotate: (${(i=r.tr)==null?void 0:i.a}deg${(a=r.tr)!=null&&a.v?` ,${(l=r.tr)==null?void 0:l.v}`:""});`}],["ht",()=>{r.ht===ut.UNSPECIFIED?t+="text-align: inherit; ":r.ht===ut.LEFT?t+="text-align: left; ":r.ht===ut.RIGHT?t+="text-align: right; ":r.ht===ut.CENTER?t+="text-align: center; ":t+="text-align: justify; "}],["vt",()=>{r.vt===tn.UNSPECIFIED?t+="vertical-align: inherit; ":r.vt===tn.BOTTOM?t+="vertical-align: bottom; ":r.vt===tn.TOP?t+="vertical-align: top; ":t+="vertical-align: middle; "}],["tb",()=>{r.tb===kt.CLIP?t+="text-overflow: clip; ":r.tb===kt.OVERFLOW?t+="text-break: overflow; ":r.tb===kt.WRAP&&(t+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var c,h,d,g,m,f,p,b;let i=`${(c=r.pd)==null?void 0:c.b}pt`,a=`${(h=r.pd)==null?void 0:h.t}pt`,l=`${(d=r.pd)==null?void 0:d.l}pt`,u=`${(g=r.pd)==null?void 0:g.r}pt`;(m=r.pd)!=null&&m.b&&(t+=`padding-bottom: ${i}; `),(f=r.pd)!=null&&f.t&&(t+=`padding-top: ${a}; `),(p=r.pd)!=null&&p.l&&(t+=`padding-left: ${l}; `),(b=r.pd)!=null&&b.r&&(t+=`padding-right: ${u}; `)}]]),s=["bd","tr","tb"];for(let i in r)e&&s.includes(i)||(o=n.get(i))==null||o();return t}function nl(r){let e="";return r===C.NONE?e="none":r===C.THIN?e="0.5pt solid":r===C.HAIR?e="0.5pt double":r===C.DOTTED?e="0.5pt dotted":r===C.DASHED||r===C.DASH_DOT?e="0.5pt dashed":r===C.DASH_DOT_DOT?e="0.5pt dotted":r===C.DOUBLE?e="0.5pt double":r===C.MEDIUM?e="1pt solid":r===C.MEDIUM_DASHED||r===C.MEDIUM_DASH_DOT?e="1pt dashed":r===C.MEDIUM_DASH_DOT_DOT?e="1pt dotted":r===C.SLANT_DASH_DOT?e="0.5pt dashed":r===C.THICK&&(e="1.5pt solid"),e}function Ym(r){let e=[];const t=document.createElement("DIV");if(t.innerHTML=r,e=new Array(t.querySelectorAll("table tr").length),!e.length)return[];let n=0;const s=t.querySelectorAll("table tr");s[0].querySelectorAll("td").forEach(a=>{let l=0;const u=a.getAttribute("colSpan");u!==null?l=+u:l=1,n+=l});for(let a=0;a<e.length;a++)e[a]=new Array(n);let i=0;return s.forEach(a=>{let l=0;a.querySelectorAll("td").forEach(u=>{let c={};if(u.querySelectorAll("span").length||u.querySelectorAll("font").length){const g=Lc(u);typeof g!="string"&&(c.p=g)}let h=u.innerText;h.trim().length===0?(c.v="",c.m=""):(c.v=h,c.m=h);const d=el(u);for(W.isPlainObject(d)&&(c.s=d);l<n&&e[i][l]!=null;)l++;if(l!==n){if(e[i][l]==null){e[i][l]=c;let g=Number(u.getAttribute("rowSpan")),m=Number(u.getAttribute("colSpan"));if(Number.isNaN(g)&&(g=1),Number.isNaN(m)&&(m=1),g>1||m>1){let f={rs:g-1,cs:m-1,r:i,c:l};e[i][l].mc=f;for(let p=0;p<g;p++)for(let b=0;b<m;b++)p===0&&b===0||(e[i+p][l+b]={mc:null})}}l++}}),i++}),e}function jm(r){let e=[];const t=document.createElement("DIV");t.innerHTML=r;let s=r.replace(/\r/g,"").split(`
`),o=s[0].split("	").length;for(let i=0;i<s.length;i++)s[i].split("	").length<o||e.push(s[i].split("	"));for(let i=0;i<e.length;i++)for(let a=0;a<e[i].length;a++)e[i][a].length?e[i][a]={v:e[i][a]||"",m:e[i][a]||""}:e[i][a]=null;return e}function Km(r,e){r.length,r[0].length;let t=0,n=0;e&&(t=e.startRow,n=e.startColumn);const s=[];for(let o=0;o<r.length;o++)for(let i=0;i<r[o].length;i++)if(r[o][i]&&typeof r[o][i]=="object"&&"mc"in r[o][i])if(r[o][i].mc){const a=r[o][i].mc,l=a.r+t,u=l+a.rs,c=a.c+n,h=c+a.cs;s.push({startRow:l,endRow:u,startColumn:c,endColumn:h}),delete r[o][i].mc}else r[o][i]=null;return{data:r,mergeData:s}}class m5{constructor(e){this._plugin=e,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new W6;const e=this._plugin.getContext().getObserverManager().getObserver("onKeyPasteObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._clipboardExtensionManager.pasteResolver(t).then(n=>{this._clipboardExtensionManager.handle(n)})})}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new G6;const e=this._plugin.getContext().getObserverManager().getObserver("onDropObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._dragAndDropExtensionManager.dragResolver(t).then(n=>{n.length!==0&&this._dragAndDropExtensionManager.handle(n)})})}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}class rl extends sn{constructor(){super(Pe.BASE_COMPONENT)}static create(){return new rl}installTo(e){e.installPlugin(this)}initialize(){this.getContext(),this.setRegisterManager()}setRegisterManager(){this._registerManager=new m5(this)}getRegisterManager(){return this._registerManager}onMounted(){this.initialize()}onDestroy(){}}var p5=Object.freeze(Object.defineProperty({__proto__:null,BaseClipboardExtension:Wa,BaseClipboardExtensionFactory:Ac,ClipboardExtensionManager:W6,ClipboardExtensionRegister:z6,BaseDragAndDropExtension:Ic,BaseDragAndDropExtensionFactory:V6,DragAndDropExtensionManager:G6,DragAndDropExtensionRegister:$6,Clipboard:Rc,AppContext:Eo,KeyboardManager:um,DragManager:cm,DescriptionEnum:hm,ComponentType:dm,ISelectButton:Dn,ISlotElement:Jr,render:Ar,Component:Oe,forwardRef:Ka,createRef:Ae,PureComponent:Hm,cloneElement:qr,isElement:qa,isDOM:Um,$$:Rr,addClass:h5,removeClass:d5,closest:g5,randomId:Ja,getFirstChildren:zm,joinClassNames:$t,getNodeindex:Wm,debounce:es,selectTextContent:Vm,selectTextContentCross:$m,isInPage:Bc,textTrim:jt,getRefElement:ts,printableCharacter:f5,xssDeal:Qa,setLastCaretPosition:Gm,handleDomToJson:Lc,handleJsonToDom:Pc,handleStringToStyle:el,splitSpanText:Xm,handleStyleToString:tl,handelTableToJson:Ym,handlePlainToJson:jm,handleTableMergeData:Km,BaseComponentPlugin:rl},Symbol.toStringTag,{value:"Module"})),_5={avatar:"univer-avatar",avatarImage:"univer-avatar-image",avatarSquare:"univer-avatar-square",avatarLg:"univer-avatar-lg",avatarSm:"univer-avatar-sm"};const b5=r=>{const{alt:e,shape:t="circle",size:n,src:s,onError:o,style:i,fit:a="fill",children:l,onLoad:u,title:c}=r,h=typeof n=="number"?{width:n,height:n,lineHeight:`${n}px`}:{},d=_5.avatar,g=$t(d,{[`${d}-${t}`]:t,[`${d}-image`]:s,[`${d}-lg`]:n==="large",[`${d}-sm`]:n==="small"}),m=a?{objectFit:a}:{};return s?_("span",{className:g,style:{...h,...i,...m}},_("img",{src:s,title:c,alt:e,onError:o,onLoad:u}),l):_("span",{className:g,style:{...h,...i}},l)};var Hc={icon:"univer-icon",iconIcon:"univer-icon-icon",iconSpin:"univer-icon-spin",loadingCircle:"univer-loadingCircle"};const Re=r=>{const{spin:e,rotate:t,children:n,name:s,style:o,className:i}=r;let a;o?(a=o,a.transform=t?`rotate(${t}deg)`:""):a=t?{transform:`rotate(${t}deg)`}:{};const l=$t(Hc.icon,{[`${Hc.icon}-${s}`]:s,[`${Hc.icon}-spin`]:e||s==="loading"},i);return _("span",{role:"img",className:l,style:{...a}},n)},Uc=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"loading",style:r.style},_("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));class v5{render(){return Uc}}const zc=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},_("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},_("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),_("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),_("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),_("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),_("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"})));class C5{render(){return zc}}const Zm=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),_("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),_("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),_("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),_("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),qm=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),_("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),_("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),_("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),Jm=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),Qm=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),e3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),t3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),_("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),n3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})));var Wc={AddNumIcon:Zm,ReduceNumIcon:qm,PercentIcon:Jm,MoneyIcon:Qm,FxIcon:e3,AddIcon:t3,ReduceIcon:n3};class E5{render(){return Zm}}class w5{render(){return qm}}class T5{render(){return Jm}}class S5{render(){return Qm}}class y5{render(){return e3}}class A5{render(){return t3}}class R5{render(){return n3}}const r3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),s3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),_("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),_("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),o3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),_("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),_("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),i3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),_("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),_("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),_("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),a3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));var I5={BoldIcon:r3,ItalicIcon:s3,DeleteLineIcon:o3,UnderLineIcon:i3,TextColorIcon:a3};class x5{render(){return r3}}class D5{render(){return s3}}class O5{render(){return o3}}class F5{render(){return i3}}class M5{render(){return a3}}const l3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),_("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),u3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),_("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),c3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),_("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),_("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),h3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),_("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),_("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),_("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),_("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),_("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),_("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),d3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),_("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),_("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),_("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),_("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),_("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),g3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),_("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),_("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),_("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),_("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),_("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),_("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),f3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),_("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),_("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),m3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),_("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),_("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),_("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),p3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),_("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),_("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),_3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),_("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),b3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),_("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),v3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),_("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));var N5={FillColorIcon:l3,FullBorderIcon:u3,TopBorderIcon:c3,BottomBorderIcon:h3,LeftBorderIcon:d3,RightBorderIcon:g3,NoneBorderIcon:f3,OuterBorderIcon:m3,InnerBorderIcon:p3,StripingBorderIcon:_3,VerticalBorderIcon:b3,MergeIcon:v3};class k5{render(){return l3}}class B5{render(){return u3}}class L5{render(){return c3}}class P5{render(){return h3}}class H5{render(){return d3}}class U5{render(){return g3}}class z5{render(){return f3}}class W5{render(){return m3}}class V5{render(){return p3}}class $5{render(){return _3}}class G5{render(){return b3}}class X5{render(){return v3}}const C3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),E3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),w3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),T3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),S3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),y3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),A3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),R3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),Y5=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),j5=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),K5=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),Z5=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),I3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),_("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),_("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),x3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),_("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),D3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),_("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));class q5{render(){return C3}}class J5{render(){return E3}}class Q5{render(){return w3}}class eE{render(){return T3}}class tE{render(){return S3}}class nE{render(){return y3}}class rE{render(){return A3}}class sE{render(){return R3}}class oE{render(){return Y5}}class iE{render(){return j5}}class aE{render(){return K5}}class lE{render(){return Z5}}class uE{render(){return I3}}class cE{render(){return x3}}class hE{render(){return D3}}var dE={LeftAlignIcon:C3,CenterAlignIcon:E3,RightAlignIcon:w3,TopVerticalIcon:T3,CenterVerticalIcon:S3,BottomVerticalIcon:y3,TextRotateIcon:A3,TextRotateAngleUpIcon:R3,BrIcon:I3,OverflowIcon:x3,CutIcon:D3};const O3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),F3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),_("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),M3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),_("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),_("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})));var gE={PhotoIcon:O3,LinkIcon:F3,ChartIcon:M3};class fE{render(){return O3}}class mE{render(){return F3}}class pE{render(){return M3}}const N3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),k3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),B3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),L3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"nextIcon",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),P3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"rightIcon",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),H3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),_("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),U3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},_("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),_("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),Vc=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),_("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),z3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),W3=r=>_(Re,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),_("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),_("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var Ao={BackIcon:N3,ForwardIcon:k3,FormatIcon:B3,NextIcon:L3,RightIcon:P3,CorrectIcon:H3,LtIcon:U3,CloseIcon:Vc,MenuIcon:z3,HideIcon:W3};class _E{render(){return N3}}class bE{render(){return k3}}class vE{render(){return B3}}class CE{render(){return L3}}class EE{render(){return P3}}class wE{render(){return H3}}class TE{render(){return U3}}class SE{render(){return Vc}}class yE{render(){return Vc}}class AE{render(){return z3}}class RE{render(){return W3}}const V3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),$3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),G3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),X3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),Y3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),j3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),K3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),_("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),Z3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),q3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})));var IE={PivotableIcon:V3,SumIcon:$3,OrderIcon:G3,OrderDESCIcon:X3,OrderASCIcon:Y3,FilterIcon:j3,FilterRankIcon:K3,CleanIcon:Z3,CheckIcon:q3};class xE{render(){return V3}}class DE{render(){return $3}}class OE{render(){return G3}}class FE{render(){return X3}}class ME{render(){return Y3}}class NE{render(){return j3}}class kE{render(){return K3}}class BE{render(){return Z3}}class LE{render(){return q3}}const J3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),_("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"})));class PE{render(){return J3}}const Q3=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},_("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),_("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),_("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),_("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),_("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"})));class HE{render(){return Q3}}const e1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"})));class UE{render(){return e1}}const t1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"})));class zE{render(){return t1}}const n1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"})));class WE{render(){return n1}}const r1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"})));class VE{render(){return r1}}const s1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"})));class $E{render(){return s1}}const o1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"})));class GE{render(){return o1}}const i1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),_("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),_("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"})));class XE{render(){return i1}}const a1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),_("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),_("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"})));class YE{render(){return a1}}const l1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"})));class jE{render(){return l1}}const u1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));class KE{render(){return u1}}var Ti={CommentIcon:J3,FreezeIcon:Q3,conditionalFormatIcon:e1,DivideIcon:t1,ReplaceIcon:n1,SearchIcon:r1,LockIcon:s1,LocationIcon:o1,PageIcon:i1,RegularIcon:a1,LayoutIcon:l1,TableIcon:u1};const c1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),_("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),_("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),h1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),d1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),g1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),_("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),f1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})));class ZE{render(){return c1}}class qE{render(){return h1}}class JE{render(){return d1}}class QE{render(){return g1}}class e4{render(){return f1}}var t4={PrintIcon:c1,ScreenshotIcon:h1,PrintAreaIcon:d1,PrintTitleIcon:g1,ImageIcon:f1};const m1=r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},_("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),_("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"})));class n4{render(){return m1}}var sl={Close:r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},_("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),_("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),DropDownIcon:r=>_(Re,{spin:r.spin,rotate:r.rotate,name:"dropdown",style:r.style},_("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},_("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),_("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})))};const p1={RightIcon:_(Ao.RightIcon,null)};var r4=Object.freeze(Object.defineProperty({__proto__:null,LoadingIcon:Uc,LogoIcon:zc,DeleteIcon:m1,Math:Wc,Font:I5,Cell:N5,Text:dE,Insert:gE,Format:Ao,Data:IE,Sheet:Ti,View:t4,Other:sl,IconMap:p1},Symbol.toStringTag,{value:"Module"})),As={btn:"univer-btn",btnLg:"univer-btn-lg",btnSm:"univer-btn-sm",btnPrimary:"univer-btn-primary",btnDanger:"univer-btn-danger",btnText:"univer-btn-text",btnRound:"univer-btn-round",btnCircle:"univer-btn-circle",btnBlock:"univer-btn-block",btnLoading:"univer-btn-loading"};const Pt=r=>{const{type:e,shape:t,size:n,htmlType:s="button",danger:o=!1,disabled:i,block:a=!1,loading:l=!1,active:u=!1,onClick:c,children:h,className:d="",style:g}=r,m=w=>{if(i){w.preventDefault();return}c&&c(w)};let f="";switch(n){case"large":f="lg";break;case"small":f="sm";break}const p=$t(As.btn,{[`${As.btn}-${e}`]:e,[`${As.btn}-${t}`]:t,[`${As.btn}-${f}`]:n,[`${As.btn}-danger`]:!!o,[`${As.btn}-block`]:a,[`${As.btn}-loading`]:l},d);let b=g;return u&&(b=Object.assign(g||{},{background:"#eee"})),_("button",{type:s,onClick:m,className:p,disabled:i,style:{...b}},l?_(Uc,null):"",h)};class s4{render(){return Pt}}var o4={};class $n extends Oe{constructor(){super(...arguments),this.canvasRef=Ae()}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,n,s,o,i,a){try{t==="Hair"?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(l){console.log(l)}e.beginPath(),t.indexOf("Medium")>-1?(n==="h"?(e.moveTo(s,o-.5),e.lineTo(i,a-.5)):(e.moveTo(s-.5,o),e.lineTo(i-.5,a)),e.lineWidth=2):t==="Thick"?(e.moveTo(s,o),e.lineTo(i,a),e.lineWidth=3):(e.moveTo(s,o),e.lineTo(i,a),e.lineWidth=1)}render(){return _("canvas",{ref:this.canvasRef,className:o4.canvas,width:this.props.width,height:this.props.height})}}class _1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thin","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class i4{render(){return _1}}class b1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Hair","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class a4{render(){return b1}}class v1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dotted","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class l4{render(){return v1}}class C1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class u4{render(){return C1}}class E1 extends Oe{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class c4{render(){return E1}}class w1 extends Oe{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class h4{render(){return w1}}class T1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Medium","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class d4{render(){return T1}}class S1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class g4{render(){return S1}}class y1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class f4{render(){return y1}}class A1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class m4{render(){return A1}}class R1 extends Mt{constructor(){super(...arguments),this.ref=Ae()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thick","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return _($n,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class p4{render(){return R1}}var _4=Object.freeze(Object.defineProperty({__proto__:null,BorderThin:_1,BorderHair:b1,BorderDotted:v1,BorderDashed:C1,BorderDashDot:E1,BorderDashDotDot:w1,BorderMedium:T1,BorderMediumDashed:S1,BorderMediumDashDot:y1,BorderMediumDashDotDot:A1,BorderThick:R1},Symbol.toStringTag,{value:"Module"})),I1={cellRangeModal:"univer-cell-range-modal",input:"univer-input",cellModalIcon:"univer-cell-modal-icon"};class x1 extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.state={modalData:[{name:"dataValidation.selectCellRange2",show:!1,group:[{name:"button.confirm",type:"primary",onClick:()=>this.handleOk()},{name:"button.cancel"}]}],placeholderState:{name:"dataValidation.selectCellRange2"},value:""},this.showModal=(e,t)=>{let{modalData:n}=this.state;const s=n.findIndex(o=>o.name===e);s>-1&&(n[s].show=t),this.setValue({modalData:n})},this.handleOk=()=>{const e=this.ref.current.getValue();this.showModal("dataValidation.selectCellRange2",!1),this.setValue({value:e})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.changeRange=e=>{const t=e.target;this.setValue({value:t.value})},this.showRange=()=>{var e;this.showModal("dataValidation.selectCellRange2",!0),(e=this._context.getWorkBook().getActiveSheet())==null||e.getSelection().setSelection({selection:this.state.value})}}setLocale(){const e=this.context.locale;this.setState(t=>{let{modalData:n,placeholderState:s}=t;return n.forEach(o=>{o.title=e.get(o.locale),o.group&&o.group.length&&o.group.forEach(i=>{i.label=e.get(i.locale)})}),s.label=e.get(s.name),{modalData:n,placeholderState:s}})}componentWillReceiveProps(e){this.setValue({value:e.valueProps})}componentDidMount(){var e,t;this.setValue({value:this.props.valueProps}),this.setLocale(),this._context,this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()}),this._localeObserver1=(t=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable","worksheet"))==null?void 0:t.add(n=>{console.dir(n)})}componentWillUnmount(){}render(e,t){const{modalData:n,placeholderState:s,value:o}=t,{placeholderProps:i}=e;return _("div",{className:I1.cellRangeModal},_(Rs,{placeholder:i,value:o,onChange:a=>this.changeRange(a)}),_("span",{className:I1.cellModalIcon,onClick:this.showRange},_(Ti.TableIcon,null)),n.map(a=>{if(!!a.show)return _(hl,{title:a.title,visible:a.show,group:a.group,onCancel:a.onCancel},_(Rs,{readonly:!0,placeholder:s.label,value:o,ref:this.ref}))}))}}class b4{render(){return x1}}var Ir={checkboxWrapper:"univer-checkbox-wrapper",checkBox:"univer-check-box",checkboxInput:"univer-checkbox-input",checkboxInner:"univer-checkbox-inner",checkBoxChecked:"univer-check-box-checked",checkBoxDisabled:"univer-check-box-disabled",checkboxGroup:"univer-checkbox-group"};class $c extends Oe{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${Ir.checkBox}`:Ir.checkBox,check:!0},this.handleStyle=(e,t)=>{let n=$t(Ir.checkBox,{[`${Ir.checkBox}-checked`]:e,[`${Ir.checkBox}-disabled`]:t});this.setState(s=>({classes:n,check:e}))},this.handleChange=e=>{var n,s;const t=e.target;this.handleStyle(t.checked,this.props.disabled),(s=(n=this.props).onChange)==null||s.call(n,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:n,check:s}=t,{value:o,name:i,disabled:a,children:l}=e;return _("label",{className:Ir.checkboxWrapper},_("span",{className:n},_("span",{className:Ir.checkboxInner}),_("input",{type:"checkbox",name:i,checked:s,disabled:a,className:Ir.checkboxInput,value:o,onChange:this.handleChange})),l&&_("span",null,l))}}class v4{render(){return $c}}const D1=r=>{let{options:e,onChange:t,disabled:n,name:s}=r,o=On(null);n&&e.forEach(a=>{a.disabled=!0}),s&&e.forEach(a=>{a.name=s});const i=()=>{var u;if(!t)return;let a=(u=o.current)==null?void 0:u.querySelectorAll("label input"),l=[];a==null||a.forEach(c=>{let h=c;h.checked&&l.push(h.value)}),t(l)};return _("div",{className:Ir.checkboxGroup,ref:o},e.map(a=>_($c,{name:a.name,disabled:a.disabled,checked:a.checked,onChange:i,value:a.value},a.label)))};class C4{render(){return D1}}var xr={panelWrapper:"univer-panel-wrapper",panelHeader:"univer-panel-header",panelHeaderIcon:"univer-panel-header-icon",panelHeaderIconRotate:"univer-panel-header-icon-rotate",panelBody:"univer-panel-body",active:"univer-active"};const O1=r=>{const{header:e,children:t}=r;let[n,s]=Ci($t(xr.panelBody));const o=()=>{n.includes("active")?s($t(xr.panelBody)):s($t(xr.panelBody,xr.active))};return _("div",{className:xr.panelWrapper},_("div",{className:xr.panelHeader,onClick:()=>o()},e,_("span",{className:`${xr.panelHeaderIcon} ${n.includes("active")?xr.panelHeaderIconRotate:""}`},_(Ao.NextIcon,null))),_("div",{className:n},t))},F1=r=>{const{children:e}=r;return _("div",{className:xr.collapseWrapper},e)};class E4{render(){return F1}}class w4{render(){return O1}}function Ro(){return(Ro=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}function ol(r,e){if(r==null)return{};var t,n,s={},o=Object.keys(r);for(n=0;n<o.length;n++)e.indexOf(t=o[n])>=0||(s[t]=r[t]);return s}function Si(r){var e=On(r),t=On(function(n){e.current&&e.current(n)});return e.current=r,t.current}var Io=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r<e?e:r},yi=function(r){return"touches"in r},Gc=function(r){return r&&r.ownerDocument.defaultView||self},M1=function(r,e,t){var n=r.getBoundingClientRect(),s=yi(e)?function(o,i){for(var a=0;a<o.length;a++)if(o[a].identifier===i)return o[a];return o[0]}(e.touches,t):e;return{left:Io((s.pageX-(n.left+Gc(r).pageXOffset))/n.width),top:Io((s.pageY-(n.top+Gc(r).pageYOffset))/n.height)}},N1=function(r){!yi(r)&&r.preventDefault()},Xc=Et.memo(function(r){var e=r.onMove,t=r.onKey,n=ol(r,["onMove","onKey"]),s=On(null),o=Si(e),i=Si(t),a=On(null),l=On(!1),u=Ya(function(){var g=function(p){N1(p),(yi(p)?p.touches.length>0:p.buttons>0)&&s.current?o(M1(s.current,p,a.current)):f(!1)},m=function(){return f(!1)};function f(p){var b=l.current,v=Gc(s.current),w=p?v.addEventListener:v.removeEventListener;w(b?"touchmove":"mousemove",g),w(b?"touchend":"mouseup",m)}return[function(p){var b=p.nativeEvent,v=s.current;if(v&&(N1(b),!function(S,T){return T&&!yi(S)}(b,l.current)&&v)){if(yi(b)){l.current=!0;var w=b.changedTouches||[];w.length&&(a.current=w[0].identifier)}v.focus(),o(M1(v,b,a.current)),f(!0)}},function(p){var b=p.which||p.keyCode;b<37||b>40||(p.preventDefault(),i({left:b===39?.05:b===37?-.05:0,top:b===40?.05:b===38?-.05:0}))},f]},[i,o]),c=u[0],h=u[1],d=u[2];return Qr(function(){return d},[d]),Et.createElement("div",Ro({},n,{onTouchStart:c,onMouseDown:c,className:"react-colorful__interactive",ref:s,onKeyDown:h,tabIndex:0,role:"slider"}))}),il=function(r){return r.filter(Boolean).join(" ")},Yc=function(r){var e=r.color,t=r.left,n=r.top,s=n===void 0?.5:n,o=il(["react-colorful__pointer",r.className]);return Et.createElement("div",{className:o,style:{top:100*s+"%",left:100*t+"%"}},Et.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},an=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t},k1=function(r){var e=r.s,t=r.v,n=r.a,s=(200-e)*t/100;return{h:an(r.h),s:an(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:an(s/2),a:an(n,2)}},jc=function(r){var e=k1(r);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Kc=function(r){var e=k1(r);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},T4=function(r){var e=r.h,t=r.s,n=r.v,s=r.a;e=e/360*6,t/=100,n/=100;var o=Math.floor(e),i=n*(1-t),a=n*(1-(e-o)*t),l=n*(1-(1-e+o)*t),u=o%6;return{r:an(255*[n,a,i,i,l,n][u]),g:an(255*[l,n,n,a,i,i][u]),b:an(255*[i,i,l,n,n,a][u]),a:an(s,2)}},S4=function(r){var e=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(r);return e?y4({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}},y4=function(r){var e=r.r,t=r.g,n=r.b,s=r.a,o=Math.max(e,t,n),i=o-Math.min(e,t,n),a=i?o===e?(t-n)/i:o===t?2+(n-e)/i:4+(e-t)/i:0;return{h:an(60*(a<0?a+6:a)),s:an(o?i/o*100:0),v:an(o/255*100),a:s}},A4=Et.memo(function(r){var e=r.hue,t=r.onChange,n=il(["react-colorful__hue",r.className]);return Et.createElement("div",{className:n},Et.createElement(Xc,{onMove:function(s){t({h:360*s.left})},onKey:function(s){t({h:Io(e+360*s.left,0,360)})},"aria-label":"Hue","aria-valuenow":an(e),"aria-valuemax":"360","aria-valuemin":"0"},Et.createElement(Yc,{className:"react-colorful__hue-pointer",left:e/360,color:jc({h:e,s:100,v:100,a:1})})))}),R4=Et.memo(function(r){var e=r.hsva,t=r.onChange,n={backgroundColor:jc({h:e.h,s:100,v:100,a:1})};return Et.createElement("div",{className:"react-colorful__saturation",style:n},Et.createElement(Xc,{onMove:function(s){t({s:100*s.left,v:100-100*s.top})},onKey:function(s){t({s:Io(e.s+100*s.left,0,100),v:Io(e.v-100*s.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+an(e.s)+"%, Brightness "+an(e.v)+"%"},Et.createElement(Yc,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:jc(e)})))}),I4=function(r,e){if(r===e)return!0;for(var t in r)if(r[t]!==e[t])return!1;return!0},x4=function(r,e){return r.replace(/\s/g,"")===e.replace(/\s/g,"")};function D4(r,e,t){var n=Si(t),s=Ci(function(){return r.toHsva(e)}),o=s[0],i=s[1],a=On({color:e,hsva:o});Qr(function(){if(!r.equal(e,a.current.color)){var u=r.toHsva(e);a.current={hsva:u,color:e},i(u)}},[e,r]),Qr(function(){var u;I4(o,a.current.hsva)||r.equal(u=r.fromHsva(o),a.current.color)||(a.current={hsva:o,color:u},n(u))},[o,r,n]);var l=So(function(u){i(function(c){return Object.assign({},c,u)})},[]);return[o,l]}var O4=typeof window!="undefined"?Ei:Qr,F4=function(){return typeof __webpack_nonce__!="undefined"?__webpack_nonce__:void 0},B1=new Map,M4=function(r){O4(function(){var e=r.current?r.current.ownerDocument:document;if(e!==void 0&&!B1.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,B1.set(e,t);var n=F4();n&&t.setAttribute("nonce",n),e.head.appendChild(t)}},[])},N4=function(r){var e=r.className,t=r.hsva,n=r.onChange,s={backgroundImage:"linear-gradient(90deg, "+Kc(Object.assign({},t,{a:0}))+", "+Kc(Object.assign({},t,{a:1}))+")"},o=il(["react-colorful__alpha",e]),i=an(100*t.a);return Et.createElement("div",{className:o},Et.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),Et.createElement(Xc,{onMove:function(a){n({a:a.left})},onKey:function(a){n({a:Io(t.a+a.left)})},"aria-label":"Alpha","aria-valuetext":i+"%","aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"},Et.createElement(Yc,{className:"react-colorful__alpha-pointer",left:t.a,color:Kc(t)})))},k4=function(r){var e=r.className,t=r.colorModel,n=r.color,s=n===void 0?t.defaultColor:n,o=r.onChange,i=ol(r,["className","colorModel","color","onChange"]),a=On(null);M4(a);var l=D4(t,s,o),u=l[0],c=l[1],h=il(["react-colorful",e]);return Et.createElement("div",Ro({},i,{ref:a,className:h}),Et.createElement(R4,{hsva:u,onChange:c}),Et.createElement(A4,{hue:u.h,onChange:c}),Et.createElement(N4,{hsva:u,onChange:c,className:"react-colorful__last-control"}))},B4={defaultColor:"rgba(0, 0, 0, 1)",toHsva:S4,fromHsva:function(r){var e=T4(r);return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},equal:x4},L4=function(r){return Et.createElement(k4,Ro({},r,{colorModel:B4}))},P4=/^#?([0-9A-F]{3,8})$/i,H4=function(r){var e=r.color,t=e===void 0?"":e,n=r.onChange,s=r.onBlur,o=r.escape,i=r.validate,a=r.format,l=r.process,u=ol(r,["color","onChange","onBlur","escape","validate","format","process"]),c=Ci(function(){return o(t)}),h=c[0],d=c[1],g=Si(n),m=Si(s),f=So(function(b){var v=o(b.target.value);d(v),i(v)&&g(l?l(v):v)},[o,l,i,g]),p=So(function(b){i(b.target.value)||d(o(t)),m(b)},[t,o,i,m]);return Qr(function(){d(o(t))},[t,o]),Et.createElement("input",Ro({},u,{value:a?a(h):h,spellCheck:"false",onChange:f,onBlur:p}))},L1=function(r){return"#"+r},U4=function(r){var e=r.prefixed,t=r.alpha,n=ol(r,["prefixed","alpha"]),s=So(function(i){return i.replace(/([^0-9A-F]+)/gi,"").substring(0,t?8:6)},[t]),o=So(function(i){return function(a,l){var u=P4.exec(a),c=u?u[1].length:0;return c===3||c===6||!!l&&c===4||!!l&&c===8}(i,t)},[t]);return Et.createElement(H4,Ro({},n,{escape:s,format:e?L1:void 0,process:L1,validate:o}))},Zc={input:"univer-input",inputFocused:"univer-input-focused",inputDisabled:"univer-input-disabled",inputBorderless:"univer-input-borderless",inputBorderlessFocused:"univer-input-borderless-focused"};class Rs extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.setValue=(e,t)=>{this.setState(n=>({value:e}),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const n=e.target;this.setValue(n.value),t(e)},this.handleKeyUp=e=>{const{onKeyUp:t}=this.props;t==null||t(e)},this.onFocus=e=>{const{onFocus:t}=this.props;t==null||t(e)},this.onClick=e=>{const{onClick:t}=this.props;t==null||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;t==null||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:n,disabled:s,type:o,placeholder:i,bordered:a=!0,className:l="",readonly:u}=e,{value:c}=t,h=$t(Zc.input,{[`${Zc.input}-disable`]:s,[`${Zc.input}-borderless`]:!a},l);return _("input",{type:o,onBlur:this.onBlur,onFocus:this.onFocus,className:h,placeholder:i,disabled:s,ref:this.ref,onChange:this.handleChange,value:c,onClick:this.onClick,readonly:u,id:n,onKeyUp:this.handleKeyUp})}}class z4{render(){return Rs}}const W4=r=>{let{color:e}=r;if(!e)return null;let t;if(e.indexOf("#")>-1){if(e=nr.hexToRgbString(e),!e)return null;t=e.replace("rgba(","").replace(")","").split(",")}else e.indexOf("rgba")>-1?t=e.replace("rgba(","").replace(")","").split(","):(t=e.replace("rgb(","").replace(")","").split(","),t.push("1"));let n=On(null);const s=()=>{r.onChange(n.current.base.value)};return _(Rs,{ref:n,type:"text",value:`rgba(${t})`,onChange:s})};var Ai={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class V4 extends Oe{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return _("div",{className:Ai.colorPickerPanel,onClick:e=>e.stopPropagation()},_(L4,{className:Ai.colorPicker,color:this.state.color,onChange:es(this.setColor.bind(this),500)}),_("div",{className:Ai.colorPickerPanelSetting},_("div",{className:Ai.panelInput},this.props.rgb?_(W4,{color:this.state.color,onChange:es(this.setColor.bind(this),500)}):_(U4,{color:this.state.color,onChange:es(this.setColor.bind(this),500)})),_("div",{className:Ai.panelColor},_("div",{style:{background:this.state.color}}),_("div",{style:{background:this.props.color}}))))}}var ns={colorPickerOuter:"univer-color-picker-outer",colorPicker:"univer-color-picker",picker:"univer-picker",pickerSwatches:"univer-picker-swatches",pickerSwatchesItem:"univer-picker-swatches-item",pickerSwatch:"univer-picker-swatch",pickerSwatchBtn:"univer-picker-swatch-btn",colorfulWarp:"univer-colorful-warp",colorBtn:"univer-color-btn",colorPickerSlot:"univer-color-picker-slot"};let $4=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class wn extends Oe{constructor(){super(...arguments),this.ulRef=Ae(),this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState(t=>({styles:{display:"none"}})),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState(t=>({styles:{display:"block"}})),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const n=e.getBoundingClientRect(),s=this.ulRef.current.getBoundingClientRect(),o=document.documentElement.clientWidth||document.body.clientWidth,i=document.documentElement.clientHeight||document.body.clientHeight;let a=0,l=0;return l=n.top+s.height>i?n.top-s.height:n.top+n.height,a=n.left+s.width>o?o-s.width:n.left,{left:a,top:l}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise((t,n)=>{this.setState({setting:!this.state.setting}),t("end")}).then(()=>{if(this.state.root){const{top:t,left:n}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${n}px`,this.ulRef.current.style.top=`${t}px`}})}}initialize(e){this.state={presetColors:$4,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}render(){var t;const e=Object.assign(this.state.styles||{},this.props.style);return this.props.lang=(t=this.props.lang)!=null?t:{collapse:"",customColor:"",confirmColor:"",cancelColor:"",change:""},_("div",{className:`${ns.colorPickerOuter} ${this.props.className}`,ref:this.ulRef,style:{...e}},_("div",{className:ns.colorPicker,onClick:n=>{}},_("div",{className:ns.picker},_("div",{className:ns.pickerSwatches},this.state.presetColors.map(n=>_("div",{className:ns.pickerSwatchesItem},n.map(s=>_("span",{className:ns.pickerSwatch,style:{background:s}},_(or,{title:s,placement:"top"},_("button",{key:s,className:ns.pickerSwatchBtn,style:{background:s},onClick:o=>{this.props.onClick&&this.props.onClick(s,o)}}))))))),_("div",null,_(Pt,{onClick:this.onSwitch},this.state.setting?this.props.lang.collapse:this.props.lang.customColor))),this.state.setting?_("div",{className:ns.colorfulWarp},_(V4,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),_("div",null,_(Pt,{type:"primary",onClick:n=>{var s;(s=this.onClick)==null||s.call(this,this.state.afterColor,n)}},this.props.lang.confirmColor),_(Pt,{danger:!0,onClick:n=>{this.onCancel()}},this.props.lang.cancelColor),_(Pt,{onClick:n=>{n.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.props.lang.change))):null))}}class G4{render(){return wn}}var al={colorPickerCircleButton:"univer-color-picker-circle-button",colorSelectCircle:"univer-color-select-circle",verticalMiddle:"univer-vertical-middle"};class P1 extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.colorRef=Ae(),this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:n,onCancel:s,style:o,colorPickerStyle:i}=e,a=this.getComponentRender().renderFunction("NextIcon");return _("div",{style:o,className:al.colorPickerCircleButton,ref:this.ref,onClick:this.handleColorSelectButtonClick},_("span",{className:`${al.colorSelectCircle} ${al.verticalMiddle}`,style:{backgroundColor:t}}),_(a,{className:al.verticalMiddle}),_(wn,{color:t,onClick:n,onCancel:s,style:i,ref:this.colorRef}))}}class X4{render(){return P1}}const Fn=Ka((r,e)=>{const{children:t,style:n,className:s,onClick:o}=r;return _("div",{ref:e,style:n,className:s,onClick:o},t)});class Y4{render(){return Fn}}var ll={countBar:"univer-count-bar",btn:"univer-btn",countZoom:"univer-count-zoom",countSlider:"univer-count-slider",countStatistic:"univer-count-statistic"};class j4 extends Oe{constructor(){super(...arguments),this.max=400,this.min=0,this.ref=Ae(),this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.onChange=e=>{let t=e.target;this.setValue({zoom:t.value})},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let t=(Math.floor(this.state.zoom/10)+1)*10;t>=this.max&&(t=this.max),this.setValue({zoom:t}),this.ref.current.changeInputValue(0,t)},this.reduceZoom=()=>{let t=(Math.ceil(this.state.zoom/10)-1)*10;t<=this.min&&(t=this.min),this.setValue({zoom:t}),this.ref.current.changeInputValue(0,t)}}initialize(e){this.state={zoom:100,content:"\u8BA1\u65700"}}render(e,t){const{zoom:n,content:s}=t;return _("div",{className:ll.countBar},_(Pt,{type:"text",className:ll.countZoom},n),_(Pt,{type:"text",onClick:this.addZoom},_(Wc.AddIcon,null)),_("div",{className:ll.countSlider},_(eh,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),_(Pt,{type:"text",onClick:this.reduceZoom},_(Wc.ReduceIcon,null)),_(Pt,{type:"text"},_(Ti.PageIcon,null)),_(Pt,{type:"text"},_(Ti.LayoutIcon,null)),_(Pt,{type:"text"},_(Ti.RegularIcon,null)),_("span",{className:ll.countStatistic},s))}}var K4={formatModal:"univer-format-modal",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",colsMenuitemContent:"univer-cols-menuitem-content"};class H1 extends Oe{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.showModal=(e,t)=>{let n=this.state.data,s=n.findIndex(o=>o.name===e);s>-1&&(n[s].show=t,this.setValue({data:n},()=>({data:n})))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach(n=>{var s;n.title=e.get(n.name),n.name==="format.titleCurrency"?n.children=e.get("currencyDetail").map(o=>({label:o.name,icon:o.value})):n.name==="format.titleDateTime"?n.children=e.get("dateFmtList").map(o=>({label:o.name,icon:o.value})):n.name==="format.titleNumber"&&(n.children=e.get("numFmtList").map(o=>({label:o.name,icon:o.value}))),(s=n.group)!=null&&s.length&&n.group.forEach(o=>{o.label=e.get(o.locale)})}),this.setState(n=>({data:t}))}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}render(e,t){const{data:n}=t;return _(Rt,null,n.map((s,o)=>s.show?_(hl,{title:s.title,className:K4.formatModal,group:s.group,visible:s.show,onCancel:s.onCancel},s.label,_(ss,{show:!0,children:s.children,ref:i=>this.refs[o]=i})):_(Rt,null)))}}class Z4{render(){return H1}}var Ri={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class q4 extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const e=this._render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:o}=this.props;return _("div",{className:$t(Ri.selectItem,o?Ri.selectDisabledItem:"")},t?_("span",{className:Ri.selectItemSelected},_(e,null)):"",_("span",{className:Ri.selectItemContent},n),s?_("span",{className:Ri.selectItemSuffix},s):"")}}var Dr={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"},qc=(r=>(r[r.SINGLE=0]="SINGLE",r[r.INPUT=1]="INPUT",r[r.COLOR=2]="COLOR",r[r.DOUBLE=3]="DOUBLE",r[r.FIX=4]="FIX",r[r.DOUBLEFIX=5]="DOUBLEFIX",r))(qc||{});class ul extends Oe{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(o=>{o.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,o=this._render.renderFunction("Button");return _("div",{className:`${Dr.selectSingle} ${n}`},_(o,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,o=this._render.renderFunction("Input"),i=this._render.renderFunction("Button");return _("div",{className:`${Dr.selectInput} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_(o,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,o=this._render.renderFunction("NextIcon"),i=this._render.renderFunction("Button");return _("div",{className:`${Dr.selectDouble} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:_(o,null)},_("div",{className:Dr.selectLabel},e))))},this.getFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this._render.renderFunction("Button");return _("div",{className:`${Dr.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},_("div",{className:Dr.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this._render.renderFunction("Button"),i=this._render.renderFunction("NextIcon");return _("div",{className:`${Dr.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:_(i,null)},_("div",{className:Dr.selectLabel},e))))}}initialize(){var o;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(o=this.props.defaultColor)!=null?o:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=this.handleSelected(o),a=n[o];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const u=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),u.unSelectable)return;const c=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:c}):this.setState({content:n[l[2]].label,menu:c})}}else if(e===1){if(!n.length)return;const o=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(u=>i===u.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(c=>c.selected);a<0&&(a=0);let l=this.handleSelected(a);const u=n[a];this.setState({content:u.label,menu:l})}};o(s),this.onClick=(...i)=>{var l,u;(u=(l=this.props).onClick)==null||u.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,u;const a=i.currentTarget.value;(u=(l=this.props).onKeyUp)==null||u.call(l,a),o(a)}}else if(e===2){const o=this.handleSelected(null);this.setState({menu:o}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=n[o],a=this.handleSelected(o);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var u,c,h,d;if(l.length){(c=(u=this.props).onClick)==null||c.call(u,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(e){this.props=Object.assign(this.props,e),this.initData()}resetMenu(e,t){var s;const n=[];for(let o=0;o<e.length;o++){let i=!1;t||(i=(s=e[o].selected)!=null?s:!1),n[o]={label:""},n[o].label=_(q4,{disabled:e[o].disabled,border:e[o].border,selected:i,label:e[o].label,suffix:e[o].suffix}),n[o].disabled=e[o].disabled,n[o].style=e[o].style,n[o].value=e[o].value,n[o].className=e[o].className,n[o].onClick=e[o].onClick,n[o].border=e[o].border,e[o].children&&(n[o].children=this.resetMenu(e[o].children))}return n}render(){const{type:e=0}=this.props;return _("div",{className:Dr.selectComponent},this.getType(e))}}var Is={formulaBox:"univer-formula-box",selectButton:"univer-select-button",tooltipGroup:"univer-tooltip-Group",tooltipBody:"univer-tooltip-body",formulaBar:"univer-formula-bar",formulaIcon:"univer-formula-icon",formulaGrey:"univer-formula-grey",formulaBlack:"univer-formula-black",formulaInput:"univer-formula-input",formulaContent:"univer-formula-content"};class U1 extends Oe{constructor(){super(...arguments),this.onkeyUp=e=>{},this.printChange=e=>{this.onkeyUp(e.target)}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this._render.renderFunction("NextIcon"),this.state={namedRanges:[{value:"1",label:"1"}],spanClass:Is.formulaGrey,formulaContent:""},this.onkeyUp=es(this.onkeyUp,300)}setFormulaContent(e){this.setState({formulaContent:e})}setNamedRanges(e){this.setState({namedRanges:e})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onFormulaBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{namedRanges:n}=t,s=this._render.renderFunction("CloseIcon"),o=this._render.renderFunction("CorrectIcon"),i=this._render.renderFunction("FxIcon");return _("div",{className:Is.formulaBox},_(ul,{children:n,type:0}),_("div",{className:Is.formulaBar},_("div",{className:Is.formulaIcon},_("span",{className:t.spanClass},_(s,null)),_("span",{className:t.spanClass},_(o,null)),_("span",{className:Is.formulaBlack},_(i,null))),_("div",{className:Is.formulaInput},_("div",{autoFocus:!0,contentEditable:!0,className:Is.formulaContent,onKeyUp:a=>this.printChange(a)},t.formulaContent))))}}var Ix="";const J4=r=>_(Fn,{className:"universheet-info-detail"},_("div",{style:{marginRight:"18px"}},_(or,{title:"\u8FD4\u56DE",placement:"bottom"},_(Pt,{className:"universheet-info-return",type:"text"},_(sl.DropDownIcon,{rotate:90})))),_(zc,{style:{width:"152px",height:"32px"}}),_("div",{className:"sheet-name"},_(Rs,{bordered:!1,value:"Universheet Demo"})),_("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},"\u65B0\u6253\u5F00"),_("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58"));var xs={layoutWrapper:"univer-layout-wrapper",layoutWrapperHasSider:"univer-layout-wrapper-has-sider",headerWrapper:"univer-header-wrapper",footerWrapper:"univer-footer-wrapper",contentWrapper:"univer-content-wrapper",siderWrapper:"univer-sider-wrapper"};class Gn extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=zm(this.ref.current);const t=e instanceof Array?e:[e];for(const n of t)n.tagName==="ASIDE"&&this.setState({isAside:!0})}}render(e,t){const{children:n,style:s,className:o=""}=e,{isAside:i}=t;return _("section",{style:s,ref:this.ref,className:i?`${xs.layoutWrapper} ${xs.layoutWrapperHasSider} ${o}`:`${xs.layoutWrapper} ${o}`},n)}}const Ii=r=>{const{children:e,style:t,className:n=""}=r;return _("header",{style:t,className:`${xs.headerWrapper} ${n}`},e)},xi=r=>{const{children:e,style:t,className:n=""}=r;return _("footer",{style:t,className:`${xs.footerWrapper} ${n}`},e)},Di=Ka((r,e)=>{const{children:t,style:n,className:s=""}=r;return _("main",{ref:e,style:n,className:`${xs.contentWrapper} ${s}`},t)}),mn=r=>{const{children:e,style:t,className:n=""}=r;return _("aside",{style:t,className:`${xs.siderWrapper} ${n}`},e)};class Q4{render(){return Gn}}class ew{render(){return Ii}}class tw{render(){return xi}}class nw{render(){return Di}}class rw{render(){return mn}}var cl={colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",colsMenuitemLine:"univer-cols-menuitem-line",colsMenuitemDisabled:"univer-cols-menuitem-disabled"};class Oi extends Oe{constructor(){super(...arguments),this._MenuRef=Ae(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,n)=>{var o,i;const{deep:s=0}=this.props;(o=t.onClick)==null||o.call(null,e,t.value,n,s),(i=this.props.onClick)==null||i.call(null,e,t.value,n,s),this.showMenu(!1)},this.showMenu=e=>{this.setState(t=>({show:e}),()=>{this.getStyle()})},this.mouseEnter=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var a;const e=this._MenuRef.current;if(!e)return;let t={};const n=e.getBoundingClientRect();let s;const{dom:o,parent:i}=this.props;if(s={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},i){e.style.position="fixed";let l=(a=e.parentElement)==null?void 0:a.getBoundingClientRect();if(!l)return;l.right+n.width>s.right?(t.left=`${l.left-n.width}px`,t.top=`${l.top}px`):(t.left=`${l.right}px`,t.top=`${l.top}px`),this.setState({posStyle:t})}}}initialize(){this.state={show:!1,posStyle:{}}}render(){const{className:e="",style:t="",menu:n,deep:s=0}=this.props,{show:o,posStyle:i}=this.state;return _("ul",{className:$t(cl.colsMenu,e),style:{...t,...i,display:o?"block":"none"},ref:this._MenuRef},n==null?void 0:n.map((a,l)=>{var u,c;if(!a.hide)return _(Rt,null,_("li",{className:$t(cl.colsMenuitem,(u=a.className)!=null?u:"",a.disabled?cl.colsMenuitemDisabled:""),style:(c=a.style)!=null?c:"",onClick:h=>this.handleClick(h,a,l),onMouseEnter:h=>{this.mouseEnter(h,l)},onMouseLeave:h=>{this.mouseLeave(h,l)}},a.label,a.children?_(Oi,{ref:h=>this._refs[l]=h,menu:a.children,onClick:a.onClick,className:a.className,style:a.style,parent:this,deep:s+1}):_(Rt,null)),a.border?_("div",{className:cl.colsMenuitemLine}):"")}))}}class sw{render(){return Oi}}var ow={drag:"univer-drag",dragTop:"univer-drag-top",dragBottom:"univer-drag-bottom",dragLeft:"univer-drag-left",dragRight:"univer-drag-right"};class iw extends Oe{constructor(){super(...arguments),this.root=Ae(),this.onMouseMove=e=>{let t=this.state.offsetX,n=this.state.offsetY,s=e.x,o=e.y,i=`${s-t}px`,a=`${o-n}px`;this.setState({top:a,left:i})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(e){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(e){window.addEventListener("mousemove",this.onMouseMove);let t=e.offsetX,n=e.offsetY;this.setState({offsetX:t,offsetY:n})}getWindowRect(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth,s=this.root.current.offsetHeight,o=this.root.current.offsetLeft,i=this.root.current.offsetTop,a=`${(t-s)/2}px`,l=`${(e-n)/2}px`;this.setState({width:e,height:t,rootW:n,rootH:s,rootL:o,rootT:i,top:a,left:l})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:e}=this.props;return _(Rt,null,e?_("div",{ref:this.root,className:ow.drag,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}var Ds={modalMask:"univer-modal-mask",modalWrapper:"univer-modal-wrapper",modalDargWrapper:"univer-modal-darg-wrapper",modalHeader:"univer-modal-header",modalClose:"univer-modal-close",modalBody:"univer-modal-body",modalFooter:"univer-modal-footer"};class hl extends Oe{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState(t=>({visible:e}))},this.handleClick=e=>{this.showModal(!1),e&&e()}}initialize(){var e;this.state={visible:(e=this.props.visible)!=null?e:!1}}componentWillReceiveProps(e){e.visible!==this.state.visible&&this.setState({visible:e.visible})}render(){const{title:e,width:t=500,top:n=0,style:s,children:o,className:i="",group:a=[],isDrag:l=!1,mask:u=!0,footer:c=!0}=this.props,{visible:h}=this.state;return _(Rt,null,h?_("div",{className:i},u?_("div",{className:Ds.modalMask,onClick:d=>{var g,m;(m=(g=this.props).onCancel)==null||m.call(g,d),this.showModal(!1)}}):null,_(iw,{isDrag:l},_("div",{className:`${l?Ds.modalDargWrapper:Ds.modalWrapper}`,style:{width:`${t}px`,...s}},_("div",{className:Ds.modalHeader},_("span",null,e),_("span",{className:Ds.modalClose,onClick:d=>{var g,m;(m=(g=this.props).onCancel)==null||m.call(g,d),this.showModal(!1)}},_(sl.Close,null))),_("div",{className:Ds.modalBody},o),c?_("div",{className:Ds.modalFooter},a.map(d=>_(Pt,{type:d.type,onClick:()=>this.handleClick(d.onClick)},d.label))):null))):null)}}class aw{render(){return hl}}var Os={radioGroup:"univer-radio-group",radioWrap:"univer-radio-wrap",radioLeft:"univer-radio-left",circle:"univer-circle",active:"univer-active",fork:"univer-fork",label:"univer-label"};class lw extends Oe{handleActiveChange(e){this.props.onChange(e)}render(){const{vertical:e,className:t=""}=this.props;return _("div",{className:`${e?Os.radioGroup:""} ${t||""}`},this.props.children.map(n=>{let s=this.props.active===n.props.value;return qr(n,{label:n.props.label,children:n.props.children,value:n.props.value,active:s,onClick:this.handleActiveChange.bind(this)})}))}}class Jc extends Oe{render(){return _("div",{className:Os.radioWrap},_("div",{className:Os.radioLeft},_("div",{onClick:this.props.onClick.bind(this,this.props.value)},_("div",{className:`${Os.circle} ${this.props.active&&Os.active}`},_("div",{className:Os.fork})),_("div",{className:Os.label},this.props.label)),this.props.children))}}class uw{render(){return Jc}}class cw{render(){return Jc}}var rt={resizeDialog:"univer-resize-dialog",dialogMove:"univer-dialog-move",moveItem:"univer-move-item",moveTop:"univer-move-top",moveRight:"univer-move-right",moveBottom:"univer-move-bottom",moveLeft:"univer-move-left",dialogResize:"univer-dialog-resize",dialogResizeActive:"univer-dialog-resize-active",resizeItem:"univer-resize-item",resizeLt:"univer-resize-lt",resizeMt:"univer-resize-mt",resizeLm:"univer-resize-lm",resizeRm:"univer-resize-rm",resizeRt:"univer-resize-rt",resizeLb:"univer-resize-lb",resizeMb:"univer-resize-mb",resizeRb:"univer-resize-rb"};const hw=r=>{let{left:e=0,top:t=0,width:n=100,height:s=50,children:o,ratio:i=1}=r;const a=On(null),l=On(null);Qr(()=>{const T=a.current;!T||(T.style.width=`${n*i}px`,T.style.height=`${s*i}px`,T.style.left=`${e*i}px`,T.style.top=`${t*i}px`)},[]);let u=[0,0],c=[0,0],h=!1,d=!1,g=null;const m=()=>{if(!a.current)return;const T=a.current.parentElement;if(!T)return;T.querySelectorAll(`.${rt.dialogResize}`).forEach(R=>{R.classList.remove(rt.dialogResizeActive)})},f=T=>{if(!a.current||!l.current)return;const D=l.current.classList;a.current.contains(T.target)?D.add(rt.dialogResizeActive):D.contains(rt.dialogResizeActive)&&D.remove(rt.dialogResizeActive)},p=T=>{T.stopPropagation(),m(),f(T)},b=T=>{window.addEventListener("mousemove",w),window.addEventListener("mouseup",S),window.addEventListener("click",p),T.stopPropagation(),m(),f(T),u=[T.pageX,T.pageY],h=!0},v=T=>{T.stopPropagation();const D=T.target;!D.className.includes(`${rt.resizeItem}`)||(g=D,u=[T.pageX,T.pageY],d=!0)},w=T=>{if(T.stopPropagation(),!a.current)return;const D=a.current.parentElement;if(!D||!D.contains(T.target)||!h&&!d)return;const R=a.current;if(!!R){if(c=[T.pageX,T.pageY],e=parseFloat(R.style.left)+c[0]-u[0],e=e<0?0:e,e+a.current.offsetWidth>D.offsetWidth&&(e=D.offsetWidth-a.current.offsetWidth),t=parseFloat(R.style.top)+c[1]-u[1],t=t<0?0:t,t+a.current.offsetHeight>D.offsetHeight&&(t=D.offsetHeight-a.current.offsetHeight),d){let I,y;const O=g.dataset.type;(O==="rm"||O==="rb"||O==="rt")&&(I=parseFloat(R.style.width)+c[0]-u[0],I<10&&(I=10),e+I>D.offsetWidth&&(I=D.offsetWidth-e),R.style.width=`${I}px`),(O==="lm"||O==="lb"||O==="lt")&&(I=parseFloat(R.style.width)-(c[0]-u[0]),I<10&&(I=10),e+I>D.offsetWidth&&(I=D.offsetWidth-e),R.style.width=`${I}px`,R.style.left=`${e}px`),(O==="lb"||O==="mb"||O==="rb")&&(y=parseFloat(R.style.height)+c[1]-u[1],y<10&&(y=10),y+t>D.offsetHeight&&(y=D.offsetHeight-t),R.style.height=`${y}px`),(O==="lt"||O==="mt"||O==="rt")&&(y=parseFloat(R.style.height)-(c[1]-u[1]),y<10&&(y=10),y+t>D.offsetHeight&&(y=D.offsetHeight-t),R.style.height=`${y}px`,R.style.top=`${t}px`)}h&&(R.style.left=`${e}px`,R.style.top=`${t}px`),u=c}},S=T=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",S),window.removeEventListener("click",p),T.stopPropagation(),!(!h&&!d||!a.current)&&(h=!1,d=!1)};return _("div",{className:rt.resizeDialog,ref:a},_("div",{className:rt.dialogMove,onMouseDown:b},_("div",{className:`${rt.moveItem} ${rt.moveTop}`}),_("div",{className:`${rt.moveItem} ${rt.moveRight}`}),_("div",{className:`${rt.moveItem} ${rt.moveBottom}`}),_("div",{className:`${rt.moveItem} ${rt.moveLeft}`})),_("div",{className:rt.dialogResize,onMouseDown:v,ref:l},_("div",{"data-type":"lt",className:`${rt.resizeItem} ${rt.resizeLt}`}),_("div",{"data-type":"mt",className:`${rt.resizeItem} ${rt.resizeMt}`}),_("div",{"data-type":"lm",className:`${rt.resizeItem} ${rt.resizeLm}`}),_("div",{"data-type":"rm",className:`${rt.resizeItem} ${rt.resizeRm}`}),_("div",{"data-type":"rt",className:`${rt.resizeItem} ${rt.resizeRt}`}),_("div",{"data-type":"lb",className:`${rt.resizeItem} ${rt.resizeLb}`}),_("div",{"data-type":"mb",className:`${rt.resizeItem} ${rt.resizeMb}`}),_("div",{"data-type":"rb",className:`${rt.resizeItem} ${rt.resizeRb}`})),_("div",{className:rt.dialogContent},o))};var Fi={richTextEditorContainer:"univer-rich-text-editor-container",richTextEditor:"univer-rich-text-editor",formulaTextColor:"univer-formula-text-color",formulaTextString:"univer-formula-text-string"};class dw{constructor(e){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=e}updateFormat(e,t){e in this.inlineStyleAffectAttribute&&this.editor.textContent.substr(0,1)!=="="&&this.updateInlineStringFormat(e,t)}updateInlineStringFormat(e,t){var c;let n=window.getSelection(),s;if((n==null?void 0:n.type)==="None"||(s=n==null?void 0:n.getRangeAt(0)),!s)return;let o=this.editor,i=s.endContainer,a=s.startContainer,l=s.endOffset,u=s.startOffset;if(o){if(a===i){let h=a.parentNode,d,g=!1,m=h.innerHTML;o.innerHTML.substr(0,5)!=="<span"&&(g=!0);let p="",b="",v="",w=0,S=u,T=l,D=m.length;p=m.substring(w,S),b=m.substring(S,T),v=m.substring(T,D);let R="";if(p!==""){let y=h.style.cssText;if(g){let O=h.closest(`.${Fi.richTextEditorContainer}`);O!=null&&(y=this.extendCssText(O.style.cssText,y))}R+=`<span style='${y}'>${p}</span>`}if(b!==""){let y=this.getCssText(h.style.cssText,e,t);if(g){let O=h.closest(`.${Fi.richTextEditorContainer}`);O!=null&&(y=this.extendCssText(O.style.cssText,y))}R+=`<span style='${y}'>${b}</span>`}if(v!==""){let y=h.style.cssText;if(g){let O=h.closest(`.${Fi.richTextEditorContainer}`);O!=null&&(y=this.extendCssText(O.style.cssText,y))}R+=`<span style='${y}'>${v}</span>`}if(a.parentNode.tagName==="SPAN"){d=Rr("span",o).indexOf(h);let y=(c=h.parentElement)==null?void 0:c.innerHTML,O=h.outerHTML.replace("\\","");const M=y==null?void 0:y.replace(O,R);h.parentElement.innerHTML=M}else d=0,h.innerHTML=R;let I=0;w===S?I=d:I=d+1,Vm(o.querySelectorAll("span")[I])}else if(a.parentNode.tagName==="SPAN"&&i.parentNode.tagName==="SPAN"){let h=a.parentNode,d,g=i.parentNode,m;d=Rr("span",o).indexOf(h),m=Rr("span",o).indexOf(g);let f=h.innerHTML,p=g.innerHTML,b="",v="",w="",S="",T=0,D=u,R=l,I=p.length;b=f.substring(T,D),v=f.substring(D,f.length),w=p.substring(0,R),S=p.substring(R,I);let y=Array.prototype.slice.call(o.querySelectorAll("span"));y.slice(d,m+1);let O="";for(let x=0;x<d;x++){let E=y[`${x}`],N=E.innerHTML;O+=`<span style='${E.style.cssText}'>${N}</span>`}if(b!==""&&(O+=`<span style='${h.style.cssText}'>${b}</span>`),v!==""&&(O+=`<span style='${this.getCssText(h.style.cssText,e,t)}'>${v}</span>`),d<m)for(let x=d+1;x<m;x++){let E=y[`${x}`],N=E.innerHTML;O+=`<span style='${this.getCssText(E.style.cssText,e,t)}'>${N}</span>`}w!==""&&(O+=`<span style='${this.getCssText(g.style.cssText,e,t)}'>${w}</span>`),S!==""&&(O+=`<span style='${g.style.cssText}'>${S}</span>`);for(let x=m+1;x<y.length;x++){let E=y[`${x}`],N=E.innerHTML;O+=`<span style='${E.style.cssText}'>${N}</span>`}o.innerHTML=O;let M,F;T===D?(M=d,F=m):(M=d+1,F=m+1),y=o.querySelectorAll("span"),$m(y[`${M}`],y[`${F}`])}}}extendCssText(e,t,n=!0){let s=e.split(";"),o=t.split(";"),i="",a={};for(let l=0;l<s.length;l++){let u=s[l],c=!0;u=u.toLowerCase();let h=jt(u.substr(0,u.indexOf(":")));if(h==="font-size")continue;let d=jt(u.substr(u.indexOf(":")+1));if(!(n&&!(h in this.inlineStyleAffectCssName))){for(let g=0;g<o.length;g++){let m=o[g];m=m.toLowerCase();let f=jt(m.substr(0,m.indexOf(":"))),p=jt(m.substr(m.indexOf(":")+1));if(h===f){i+=`${f}:${p};`,c=!1;continue}}c&&(i+=`${h}:${d};`),a[h]=1}}for(let l=0;l<o.length;l++){let u=o[l];u=u.toLowerCase();let c=jt(u.substr(0,u.indexOf(":"))),h=jt(u.substr(u.indexOf(":")+1));n&&!(c in this.inlineStyleAffectCssName)||c in a||(i+=`${c}:${h};`)}return i}getCssText(e,t,n){let s={};if(s[t]=n,t==="un"){let l=this.getClassWithcss(e,"color");l===""&&(l="#000000");let u=this.getClassWithcss(e,"font-size"),c=parseInt(u);u===""&&(c=11),s._fontSize=c,s._color=l}let o=this.getFontStyleByCell(s,void 0,void 0,!1),i=jt(o&&o.substr(0,o.indexOf(":"))),a=jt(o&&o.substr(o.indexOf(":")+1));return a=a.substr(0,a.length-1),e=this.removeClassWidthCss(e,t),e=this.upsetClassWithCss(e,i,a),e}getClassWithcss(e,t){let n=e.split(";");if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let s=0;s<n.length;s++){let o=n[s];o=o.toLowerCase();let i=jt(o.substr(0,o.indexOf(":"))),a=jt(o.substr(o.indexOf(":")+1));if(i===t)return a}return""}removeClassWidthCss(e,t){let n=e.split(";"),s="",o=t;if(t==null||t.length===0)return e;if(t in this.univerToCssName&&(t=this.univerToCssName[t]),e.indexOf(t)>-1)for(let i=0;i<n.length;i++){let a=n[i];a=a.toLowerCase();let l=jt(a.substr(0,a.indexOf(":"))),u=jt(a.substr(a.indexOf(":")+1));l===t||o==="cl"&&l==="lucky-strike"||o==="un"&&l==="lucky-underline"||l.length>0&&(s+=`${l}:${u};`)}else s=e;return s}upsetClassWithCss(e,t,n){let s=e.split(";"),o="";if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let i=0;i<s.length;i++){let a=s[i];a=a.toLowerCase();let l=jt(a.substr(0,a.indexOf(":"))),u=jt(a.substr(a.indexOf(":")+1));l===t?o+=`${l}:${n};`:l.length>0&&(o+=`${l}:${u};`)}else t.length>0&&(e+=`${t}:${n};`,o=e);return o}getFontStyleByCell(e,t,n,s=!0){if(e==null)return"";let o="";for(let i in e){let a=e[i];if(s&&(a=this.checkstatusByCell(e,i)),i==="bl"&&a!=="0"&&(o+="font-weight: bold;"),i==="it"&&a!=="0"&&(o+="font-style:italic;"),i==="ff"&&(o+=`font-family: ${a};`),i==="fs"&&a!=="10"&&(o+=`font-size: ${a}pt;`),(i==="fc"&&a!=="#000000"||t!=null||n!=null&&n.textColor!=null)&&(n!=null&&n.textColor!=null?o+=`color: ${n.textColor};`:t!=null?o+=`color: ${t[0]};`:o+=`color: ${a};`),i==="bg"&&a!=="#ffffff"&&a!=="#fff"&&(o+=`background: ${a};`),i==="cl"&&a!=="0"&&(o+="text-decoration: line-through;"),i==="un"&&(a==="1"||a==="3")){let l=e._color;l==null&&(l=e.fc);let u=e._fontSize||11;u==null&&(u=e.fs||11),o+=`border-bottom: ${Math.floor(u/9)}px solid ${l};`}}return o}checkstatusByCell(e,t){let n;return t in{bl:1,it:1,ff:1,cl:1,un:1}?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="fc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000"),n.indexOf("rgba")>-1&&(n=nr.rgbColorToHexValue(n))):t==="bg"?n==null?n=null:(n=n[t],n==null?n=null:n.toString().indexOf("rgba")>-1&&(n=nr.rgbColorToHexValue(n))):t.substr(0,2)==="bs"?n==null?n="none":(n=n[t],n==null&&(n="none")):t.substr(0,2)==="bc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000")):t==="ht"?(n==null?n="1":(n=n[t],n==null&&(n="1")),["0","1","2"].indexOf(n.toString())===-1&&(n="1")):t==="vt"?(n==null?n="0":(n=n[t],n==null&&(n="0")),["0","1","2"].indexOf(n.toString())===-1&&(n="0")):t==="ct"?n==null?n=null:(n=n[t],n==null&&(n=null)):t==="fs"?n==null?n="10":(n=n[t],n==null&&(n="10")):t==="tb"||t==="tr"?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="rt"&&(n==null?n=null:(n=n[t],n==null&&(n=null))),n}}class xo extends Oe{constructor(){super(...arguments),this.container=Ae(),this.ref=Ae(),this.hooks=new Map}initialize(e){}setValue(e){this.ref.current&&(this.ref.current.innerHTML=Qa(e))}getValue(){var e;return((e=this.ref.current)==null?void 0:e.innerHTML)||""}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(e){const t=this.hooks.get("onKeyDown");t&&t(e),e.key==="Enter"&&e.preventDefault()}onKeyUp(e){const t=this.hooks.get("onKeyUp");t&&t(e),e.key==="Enter"&&e.preventDefault()}componentWillMount(){}componentDidMount(){var e;this.cellTextStyle=new dw(this.ref.current),(e=this._context.getObserverManager().getObserver("onRichTextDidMountObservable"))==null||e.notifyObservers(this)}componentWillUnmount(){}render(e,t){const{style:n,className:s="",onClick:o,text:i}=e;return _("div",{className:`${Fi.richTextEditorContainer} ${s}`,style:n,ref:this.container},_("div",{ref:this.ref,className:Fi.richTextEditor,onClick:o,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:i||""},contentEditable:!0}))}}var mt={selectButton:"univer-select-button",selectButtonInner:"univer-select-button-inner",selectColor:"univer-select-color",selectButtonInnerLabelIcon:"univer-select-button-inner-label-icon",selectButtonInnerLabelString:"univer-select-button-inner-label-string",selectInput:"univer-select-input",selectLine:"univer-select-line",btn:"univer-btn",colorPicker:"univer-color-picker",selectDoubleButton:"univer-select-double-button",doubleButtons:"univer-double-buttons"};class z1 extends yo{constructor(e){super(e),this.ref=Ae(),this.inputRef=Ae(),this.colorBtn=Ae(),this.showSelect=n=>{n.stopImmediatePropagation();const s=this.ref.current;s&&this.props.selectType===Dn.COLOR?s.showSelect(this.colorBtn.current):s&&s.showSelect(),window.addEventListener("click",this.hide,!0)},this.hide=n=>{!this.ref.current||!this.ref.current.ulRef&&!this.ref.current.ulRef.current||this.ref.current.ulRef.current.contains(n.target)||this.hideSelect(n)},this.hideSelect=n=>{this.ref.current.hideSelect(n),window.removeEventListener("click",this.hide,!0)},this.changeValue=n=>{this.setState(s=>({...n}))},this.update=n=>{const s=typeof this.props.label,o=this.state.children;let i;o==null||o.forEach((a,l)=>{a.value===n?(a.selected=!0,this.props.needChange&&(this.setState({label:s==="string"?a.label:a.icon}),i=a.label)):a.selected=!1}),this.setState({children:o}),this.props.selectType===Dn.INPUT_NUMBER&&this.inputRef.current.setValue(i)},this.handleClick=(...n)=>{var u,c;const s=typeof this.props.label;this.hideSelect(n[0]);const{item:o,index:i}=n[1],a=this.state.children;a==null||a.forEach(h=>h.selected=!1),a[i].selected=!0;let l=a[i].label;if(this.setState({children:a}),this.props.needChange){this.setState({label:s==="string"?l:o.icon}),[Dn.INPUT,Dn.INPUT_NUMBER].includes(this.props.selectType)&&this.inputRef.current.setValue(l);const h=this.props.children;if(h[10]&&h[10].locale==="borderLine.borderColor"){let m=h[10].children[0].value,f=h[11].value;(u=this.props.onClick)==null||u.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label,m,f);return}}(c=this.props.onClick)==null||c.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label)},this.handleButtonClick=()=>{var i,a,l,u;const n=this.state.children,s=n==null?void 0:n.find(c=>c.selected===!0),o=this.props.children;if(this.props.selectType==="color")(i=this.props.onClick)==null||i.call(this,this.state.selectColor);else if(o&&o[10]&&o[10].locale==="borderLine.borderColor"){let d=o[10].children[0].value,g=o[11].value;s&&((a=this.props.onClick)==null||a.call(this,s.hasOwnProperty("value")?s.value:s.label,d,g));return}else if(o&&o[0]&&o[0].locale&&o[0].locale.indexOf("merge")>-1){(l=this.props.onClick)==null||l.call(this,"all");return}s&&((u=this.props.onClick)==null||u.call(this,s.hasOwnProperty("value")?s.value:s.label))},this.handleKeyUp=n=>{var s;if(n.key==="Enter"){this.props.selectType===Dn.INPUT_NUMBER&&this.inputRef.current.base.blur();const o=n.currentTarget.value;this.update(o),this.hideSelect(n),(s=this.props.onKeyUp)==null||s.call(this,o)}},this.state={label:"",children:[],selectColor:"#000"};const{triggerUpdate:t}=e;t&&t(this.update.bind(this))}componentWillMount(){this.changeValue({label:this.props.label,children:this.props.children})}render(e){const{icon:t,tooltip:n,selectType:s,border:o,slot:i,style:a,onClick:l}=e;return this.state.label,s===Dn.INPUT||s===Dn.INPUT_NUMBER?_("div",{className:mt.selectButton},_("div",{className:mt.selectInput},_(Rs,{type:s===Dn.INPUT_NUMBER?"number":"text",value:this.state.label,onClick:this.showSelect,ref:this.inputRef,bordered:!1,onKeyUp:this.handleKeyUp}),_("span",{onClick:this.showSelect},t)),o?_("div",{className:mt.selectLine}):"",_(ss,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Dn.DOUBLE?_("div",{className:`${mt.selectButton} ${mt.selectDoubleButton}`},_("div",{style:{display:"flex",alignItems:"center"}},_(or,{title:n,placement:"bottom"},_(Pt,{type:"text",onClick:this.handleButtonClick},_("div",{className:mt.selectButtonInner},_("div",{className:typeof this.state.label=="string"?mt.selectButtonInnerLabelString:mt.selectButtonInnerLabelIcon},this.state.label)))),_(or,{title:this.props.tooltipRight,placement:"bottom"},_(Pt,{type:"text",onClick:this.showSelect,className:mt.doubleButtons},_("div",{className:mt.selectButtonInner},t)))),o?_("div",{className:mt.selectLine}):"",_(ss,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Dn.COLOR?_("div",{className:`${mt.selectButton} ${mt.selectDoubleButton}`,ref:this.colorBtn},_("div",{style:{display:"flex",alignItems:"center"}},_(or,{title:n,placement:"bottom"},_(Pt,{type:"text",onClick:this.handleButtonClick},_("div",{className:mt.selectButtonInner},_("div",{className:typeof this.state.label=="string"?mt.selectButtonInnerLabelString:mt.selectButtonInnerLabelIcon},this.state.label),_("div",{className:mt.selectColor,style:{backgroundColor:this.state.selectColor}})))),_(or,{title:this.props.tooltipRight,placement:"bottom"},_(Pt,{type:"text",onClick:this.showSelect,className:mt.doubleButtons},_("div",{className:mt.selectButtonInner},t)))),o?_("div",{className:mt.selectLine}):"",_(wn,{color:"#000",onClick:u=>{this.setState({selectColor:u},()=>{l&&l(this.state.selectColor)})},slot:i,ref:this.ref})):_("div",{className:mt.selectButton},_(or,{title:n,placement:"bottom"},_(Pt,{type:"text",onClick:this.showSelect},_("div",{className:mt.selectButtonInner},_("div",{className:typeof this.state.label=="string"?mt.selectButtonInnerLabelString:mt.selectButtonInnerLabelIcon},this.state.label),t))),o?_("div",{className:mt.selectLine}):"",_(ss,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a}))}}class gw{render(){return z1}}var Qc={dropdown:"univer-dropdown",dropContent:"univer-drop-content",dropIcon:"univer-drop-icon"};class Ht extends Oe{constructor(){super(...arguments),this.MenuRef=Ae(),this.DropRef=Ae(),this.IconRef=Ae(),this.handleClick=e=>{var n,s,o;(s=(n=this.props).onClick)==null||s.call(n);const{icon:t}=this.props;t||(o=this.MenuRef.current)==null||o.showMenu(!0)},this.handleSubClick=()=>{var e;(e=this.MenuRef.current)==null||e.showMenu(!0)},this.hideMenu=e=>{var t,n;(!this.DropRef.current||!((t=this.DropRef.current)!=null&&t.contains(e.target)))&&((n=this.MenuRef.current)==null||n.showMenu(!1))}}initialize(){this.state={menuStyle:{}}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};!e||e==="Bottom"?(t.left=0,t.top="100%"):e==="Top"?(t.left=0,t.top="-100%"):e==="Left"?(t.left="-100%",t.top=0):(t.left="100%",t.top=0),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenu)}componentWillUnmount(){window.removeEventListener("click",this.hideMenu)}render(){const{children:e,menu:t,showArrow:n,icon:s,tooltip:o}=this.props,{menuStyle:i}=this.state;return _("div",{className:Qc.dropdown,ref:this.DropRef},_(or,{title:o,placement:"bottom"},_("div",{className:Qc.dropContent,onClick:this.handleClick},e,n?_(Ao.NextIcon,null):"")),s?_("div",{ref:this.IconRef,className:Qc.dropIcon,onClick:this.handleSubClick},s):"",_(Oi,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:{...t.style,...i}}))}}class fw{render(){return Ht}}var W1={line:"univer-line",vertical:"univer-vertical"};const mw=r=>{const{mode:e}=r;return _("div",{className:`${W1.line} ${e?W1.vertical:""}`})};var Fs={siderModal:"univer-sider-modal",siderModalHeader:"univer-sider-modal-header",siderModalTitle:"univer-sider-modal-title",siderModalClose:"univer-sider-modal-close",siderModalBody:"univer-sider-modal-body",siderModalBodyInner:"univer-sider-modal-body-inner",siderModalFooter:"univer-sider-modal-footer"};class V1 extends Oe{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t="",style:n}=e;return _("div",{className:`${Fs.siderModal} ${t}`,style:{...n}},_("div",{className:Fs.siderModalHeader},_("h3",{className:Fs.siderModalTitle},this.props.title),_("span",{className:Fs.siderModalClose,onClick:()=>this.close()},_(sl.Close,null))),_("div",{className:Fs.siderModalBody},_("div",{className:Fs.siderModalBodyInner},this.props.children)),_("div",{className:Fs.siderModalFooter},this.props.footer))}}class pw{render(){return V1}}var Do={slider:"univer-slider",srOnly:"univer-sr-only"};class eh extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.onInput=(e,t)=>{var o;const s=t.target.value;this.changeInputValue(e,s),(o=this.props.onChange)==null||o.call(this,t)},this.onClick=(e,t)=>{var c;const{min:n=0,max:s=100,step:o=1}=this.props,i=t.currentTarget;let a=t.offsetX;const l=i.offsetWidth;if(a<0||a>l)return;let u=a/this.width*(s-n);u%o&&(u+=o-u%o),this.changeInputValue(e,u),(c=this.props.onClick)==null||c.call(this,t,u)},this.changeInputValue=(e,t)=>{let n=this.ref.current,o=n.getElementsByTagName("input")[e].id;n.style.setProperty(`--${o}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=Ja("slider"),this.idNext=Ja("slider")}componentDidMount(){const{min:e=0,max:t=100,range:n}=this.props;let s=t-e,o=this.ref.current;if(this.width=o.offsetWidth,o.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${Do.slider}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${Do.slider}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);}`,0),document.styleSheets[0].addRule(`.${Do.slider}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${Do.slider}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);}`,0),n){let{value:i}=this.props;i=i||[0,0],this.setValue({valuePrev:i[0],valueNext:i[1]})}else{let{value:i}=this.props;i=i||0,this.changeInputValue(0,i)}}render(e,t){const{valuePrev:n,valueNext:s}=t,{step:o=1,min:i=0,max:a=100,range:l=!1}=e;return l?_("div",{className:Do.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref},_("label",{class:"sr-only",for:this.idPrev}),_("input",{id:this.idPrev,type:"range",min:i,value:n,max:a,step:o,onInput:u=>this.onInput(0,u)}),_("label",{class:"sr-only",for:this.idNext}),_("input",{id:this.idNext,type:"range",min:i,value:s,max:a,step:o,onInput:u=>this.onInput(1,u)})):_("div",{className:Do.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref,onClick:u=>this.onClick(0,u)},_("label",{class:"sr-only",for:this.idPrev}),_("input",{id:this.idPrev,type:"range",min:i,value:n,max:a,step:o,onInput:u=>this.onInput(0,u)}))}}class _w{render(){return eh}}var Xn={tabs:"univer-tabs",tabsNav:"univer-tabs-nav",tabsNavWrap:"univer-tabs-nav-wrap",tabsNavList:"univer-tabs-nav-list",tabsTab:"univer-tabs-tab",tabsTabActive:"univer-tabs-tab-active",tabsContent:"univer-tabs-content",tabsPanel:"univer-tabs-panel",tabsPanelActive:"univer-tabs-panel-active",tabsCard:"univer-tabs-card"};class $1 extends yo{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.parseNavList=()=>{const{active:e}=this.state;return sr(this.props.children).map(t=>{const{tab:n,keys:s}=t.props,o=`${Ja("tab")}-${s}`;return e===s?_("div",{id:o,onClick:this.handleClick,className:$t(Xn.tabsTab,Xn.tabsTabActive)},n):_("div",{id:o,onClick:this.handleClick,className:Xn.tabsTab},n)})},this.handleClick=e=>{var o,i;const t=e.target.id,n=t.lastIndexOf("-"),s=t.slice(n+1);this.setValue({active:s}),(i=(o=this.props).onTabClick)==null||i.call(o,s,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:n,type:s="line",className:o=""}=e,i=$t(Xn.tabs,{[`${Xn.tabs}-card`]:s==="card"},o);return _("div",{className:i},_("div",{className:Xn.tabsNav},_("div",{className:Xn.tabsNavWrap},_("div",{className:Xn.tabsNavList},this.parseNavList()))),_("div",{className:Xn.tabsContent},n.map(a=>_(th,{keys:a.props.keys,active:a.props.keys===this.state.active},a.props.children))))}}const th=r=>{const{id:e,keys:t,style:n,children:s,active:o}=r;return _("div",{id:e&&`${e}-panel-${t}`,role:"tabpanel",style:{...n},className:$t(Xn.tabsPanel,o&&Xn.tabsPanelActive)},o&&s)};class bw{render(){return $1}}class vw{render(){return th}}var rs={tooltipGroup:"univer-tooltip-Group",tooltipTitle:"univer-tooltip-title",tooltipBody:"univer-tooltip-body",tooltipSs:"univer-tooltip-ss",top:"univer-top",tooltipTriangle:"univer-tooltip-triangle",right:"univer-right",bottom:"univer-bottom",left:"univer-left"};const Cw={top:rs.top,bottom:rs.bottom,left:rs.left,right:rs.right};class or extends Oe{constructor(){super(...arguments),this.tooltip=Ae()}initialize(e){this.state={placement:e.placement||"top",placementClassName:$t(rs.tooltipTitle,Cw[e.placement||"top"]),top:"",left:""}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,n=e.width;this.state.placement==="bottom"?this.setState({top:t+10,left:n/2}):this.state.placement==="left"?this.setState({top:t/2,left:n+5}):this.state.placement==="right"?this.setState({top:t/2,left:-n-10}):this.setState({top:-t-20,left:n/2})}}render(){return _("div",{ref:this.tooltip,className:rs.tooltipGroup,style:this.props.styles},_("div",{className:rs.tooltipBody,onMouseEnter:this.handleMouseOver.bind(this)},this.props.children),this.props.title?_("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`}},this.props.title,_("span",{className:rs.tooltipTriangle})):null)}}class Ew{render(){return or}}var ir={colsMenu:"univer-cols-menu",colsMenuJsx:"univer-cols-menu-jsx",colsMenuitem:"univer-cols-menuitem",line:"univer-line",colsMenuitemContent:"univer-cols-menuitem-content",ulIcon:"univer-ul-icon",submenuArrow:"univer-submenu-arrow",iconRightIcon:"univer-icon-rightIcon"};class ss extends Oe{constructor(){super(...arguments),this.refs=[],this.ulRef=Ae(),this.filterChildren=e=>{let t;return Array.from(e.children).forEach(n=>{n.nodeName==="UL"&&(t=!0)}),t},this.mouseOver=(e,t)=>{this.refs.forEach(s=>{s.hideSelect()});const n=e.currentTarget;!this.filterChildren(n)||this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{(this.refs[t]?this.refs[t].props.children[0].selectType:"")!=="jsx"&&this.refs.forEach(s=>{s.hideSelect()})},this.handleClick=(e,{item:t,index:n,ref:s},o)=>{e.stopImmediatePropagation(),o==null||o.call(this,e,{item:t,index:n,ref:s})},this.handleKeyUp=(e,{item:t,index:n,ref:s},o)=>{e.stopImmediatePropagation(),o==null||o.call(this,e,{item:t,index:n,ref:s})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),((e=this.state.style)==null?void 0:e.display)!=="none"&&(this.refs.forEach(t=>{t.hideSelect()}),this.setState(t=>({style:{display:"none"}})))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState(e=>({style:{display:"inline-block"}}),()=>{this.getStyle()})},this.getStyle=()=>{var c;const e=(c=this.ulRef.current)==null?void 0:c.parentElement,t=this.ulRef.current;let n={},s;if(!t||!e)return;const o=t.getBoundingClientRect();let i=e==null?void 0:e.getBoundingClientRect();s=this.getContext().getPluginManager().getPluginByName("spreadsheet").getSheetContainerControl().getContentRef().current.getBoundingClientRect(),!(!s||!i)&&((e==null?void 0:e.nodeName)==="LI"?(t.style.position="fixed",i=e==null?void 0:e.getBoundingClientRect(),i.right+o.width>s.right?(n.left=`${i.left-o.width}px`,n.top=`${i.top}px`):(n.left=`${i.right}px`,n.top=`${i.top}px`)):(e==null?void 0:e.nodeName)==="DIV"&&(i.right+o.width>s.right||i.right+o.width>document.documentElement.clientWidth?(n.right="0",n.left="auto"):(n.left="0",n.right="auto"),o.top>=s.bottom&&(n.top="auto",n.bottom="100%")),this.setState(h=>({posStyle:n})))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?_("span",{className:ir.ulIcon},_(Ao.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?_("span",{className:ir.ulIcon},_(Ao.HideIcon,{style:{fontSize:"13px"}})):_("span",{className:ir.ulIcon}):"",this.getIcon=e=>{let t=e;return typeof t=="string"&&/Icon$/.test(t)&&(t=p1[t]),_("span",{className:ir.submenuArrow},t)},this.getParent=()=>{var e;return(e=this.props.getParent())!=null?e:null}}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=es(this.getStyle,200)}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState(t=>({style:{display:"inline-block"}}))}render(e,t){var u;const{children:n,onClick:s,style:o,onKeyUp:i}=e,{posStyle:a}=t,l=Object.assign((u=this.state.style)!=null?u:{},a,o||{});return n!=null&&n.length?(n.some((c,h)=>c.selected?(n.forEach((d,g)=>{h!==g&&(d.selected=!1)}),!0):!1),_("ul",{className:n[0].selectType==="jsx"?ir.colsMenuJsx:ir.colsMenu,style:{...l},ref:this.ulRef},n==null?void 0:n.map((c,h)=>{var g;let d=c.className?`${ir.colsMenuitem} ${c.className}`:ir.colsMenuitem;if(!c.hideLi)return _("li",{className:d,style:{...c.style},onClick:m=>{m.stopPropagation(),this.handleClick(m,{item:c,index:h,ref:this},c.onClick?c.onClick:s)},onMouseEnter:m=>{this.mouseOver(m,h)},onMouseLeave:m=>{this.mouseLeave(m,h)},onKeyUp:m=>{this.handleKeyUp(m,{item:c,index:h,ref:this},c.onKeyUp?c.onKeyUp:i)}},_("div",{className:c.selectType==="jsx"?"":ir.colsMenuitemContent},this.showIcon(c),_("div",null,c.selectType==="jsx"?_("span",null,qr(c.label,{onChange:this.getStyle})):_("span",null,c.label),c.icon?this.getIcon(c.icon):"")),(g=c.children)!=null&&g.length?_(ss,{children:c.children,onClick:c.onClick,ref:m=>this.refs[h]=m,getParent:this.sendParent}):_(Rt,null),c.border?_("div",{className:ir.line}):"")}))):_(Rt,null)}}class ww{render(){return ss}}const Tw="styleUniverSheet";class dl extends sn{constructor(){super("ComponentSheet")}getComponentRender(){return new G1(this.getComponentFactory())}getComponentFactory(){return new X1}}class G1{constructor(e){this._componentFactory=e}renderForwardFn(e){return this._componentFactory.createComponent(e).render()}renderClass(e){return this._componentFactory.createComponent(e).render()}renderFunction(e){return this._componentFactory.createComponent(e).render()}}class X1{createComponent(e){switch(e){case"Button":return new s4;case"Select":return new gw;case"Container":return new Y4;case"CellRangeModal":return new b4;case"Modal":return new aw;case"SiderModal":return new pw;case"Layout":return new Q4;case"Header":return new ew;case"Footer":return new tw;case"Content":return new nw;case"Sider":return new rw;case"Checkbox":return new v4;case"CheckboxGroup":return new C4;case"ColorPicker":return new G4;case"ColorPickerCircleButton":return new X4;case"Input":return new z4;case"Radio":return new uw;case"RadioGroup":return new cw;case"Tab":return new bw;case"TabPane":return new vw;case"Tooltip":return new Ew;case"Ul":return new ww;case"Collapse":return new E4;case"Panel":return new w4;case"FormatModal":return new Z4;case"Menu":return new sw;case"Dropdown":return new fw;case"NextIcon":return new CE;case"RightIcon":return new EE;case"OrderIcon":return new OE;case"CommentIcon":return new PE;case"ConditionalFormatIcon":return new UE;case"ScreenshotIcon":return new qE;case"CheckIcon":return new LE;case"SearchIcon":return new VE;case"ReplaceIcon":return new WE;case"FreezeIcon":return new HE;case"PivotableIcon":return new xE;case"FillColorIcon":return new k5;case"BoldIcon":return new x5;case"FullBorderIcon":return new B5;case"TopBorderIcon":return new L5;case"BottomBorderIcon":return new P5;case"LeftBorderIcon":return new H5;case"RightBorderIcon":return new U5;case"NoneBorderIcon":return new z5;case"OuterBorderIcon":return new W5;case"InnerBorderIcon":return new V5;case"StripingBorderIcon":return new $5;case"VerticalBorderIcon":return new G5;case"MergeIcon":return new X5;case"SumIcon":return new DE;case"OrderDESCIcon":return new FE;case"OrderASCIcon":return new ME;case"FilterIcon":return new NE;case"FilterRankIcon":return new kE;case"CleanIcon":return new BE;case"DeleteIcon":return new n4;case"DeleteLineIcon":return new O5;case"UnderLineIcon":return new F5;case"ItalicIcon":return new D5;case"TextColorIcon":return new M5;case"BackIcon":return new _E;case"ForwardIcon":return new bE;case"FormatIcon":return new vE;case"CorrectIcon":return new wE;case"LtIcon":return new TE;case"CloseIcon":return new SE;case"DropDownIcon":return new yE;case"MenuIcon":return new AE;case"HideIcon":return new RE;case"PhotoIcon":return new fE;case"LinkIcon":return new mE;case"ChartIcon":return new pE;case"LoadingIcon":return new v5;case"LogoIcon":return new C5;case"AddNumIcon":return new E5;case"ReduceNumIcon":return new w5;case"PercentIcon":return new T5;case"MoneyIcon":return new S5;case"FxIcon":return new y5;case"AddIcon":return new A5;case"ReduceIcon":return new R5;case"DivideIcon":return new zE;case"LockIcon":return new $E;case"LocationIcon":return new GE;case"PageIcon":return new XE;case"RegularIcon":return new YE;case"LayoutIcon":return new jE;case"TableIcon":return new KE;case"ImageIcon":return new e4;case"LeftAlignIcon":return new q5;case"CenterAlignIcon":return new J5;case"RightAlignIcon":return new Q5;case"TopVerticalIcon":return new eE;case"CenterVerticalIcon":return new tE;case"BottomVerticalIcon":return new nE;case"TextRotateIcon":return new rE;case"TextRotateAngleUpIcon":return new sE;case"TextRotateAngleDownIcon":return new oE;case"TextRotateVerticalIcon":return new iE;case"TextRotateRotationUpIcon":return new aE;case"TextRotateRotationDownIcon":return new lE;case"BrIcon":return new uE;case"OverflowIcon":return new cE;case"CutIcon":return new hE;case"PrintIcon":return new ZE;case"PrintAreaIcon":return new JE;case"PrintTitleIcon":return new QE;case"BorderDashDot":return new c4;case"BorderDashDotDot":return new h4;case"BorderDashed":return new u4;case"BorderDotted":return new l4;case"BorderHair":return new a4;case"BorderMedium":return new d4;case"BorderMediumDashDot":return new f4;case"BorderMediumDashDotDot":return new m4;case"BorderMediumDashed":return new g4;case"BorderThick":return new p4;case"BorderThin":return new i4;case"Slider":return new _w}throw new Error("Not Found Component")}}var Sw=Object.freeze(Object.defineProperty({__proto__:null,Avatar:b5,Button:Pt,Collapse:F1,Panel:O1,Menu:Oi,Container:Fn,Layout:Gn,Header:Ii,Footer:xi,Content:Di,Sider:mn,Tooltip:or,Icon:r4,Input:Rs,Separator:mw,ColorPicker:wn,InfoBar:J4,Select:z1,Ul:ss,FormulaBar:U1,CountBar:j4,Modal:hl,Slider:eh,Radio:Jc,RadioGroup:lw,FormatModal:H1,Checkbox:$c,CheckboxGroup:D1,CellRangeModal:x1,Tab:$1,TabPane:th,ColorPickerCircleButton:P1,BorderLine:_4,SiderModal:V1,ResizeDialog:hw,RichText:xo,Dropdown:Ht,STYLE_LUCKYSHEET_PLUGIN_NAME:Tw,UniverComponentSheet:dl,UniverComponentRender:G1,UniverComponentFactory:X1},Symbol.toStringTag,{value:"Module"}));function Y1(r){r.deleteObserve("onAfterChangeFontFamilyObservable"),r.deleteObserve("onAfterChangeFontSizeObservable"),r.deleteObserve("onAfterChangeFontWeightObservable"),r.deleteObserve("onAfterChangeFontItalicObservable"),r.deleteObserve("onAfterChangeFontStrikethroughObservable"),r.deleteObserve("onAfterChangeFontUnderlineObservable"),r.deleteObserve("onAfterChangeFontBackgroundObservable"),r.deleteObserve("onAfterChangeFontColorObservable"),r.deleteObserve("onDragAndDropStartObserver"),r.deleteObserve("onDragAndDroppingObserver"),r.deleteObserve("onDragAndDropEndEndObserver"),r.deleteObserve("onFillStartObserver"),r.deleteObserve("onFillingObserver"),r.deleteObserve("onFillEndObserver"),r.deleteObserve("onChangeSelectionObserver"),r.deleteObserve("onToolBarDidMountObservable"),r.deleteObserve("onModalGroupDidMountObservable"),r.deleteObserve("onRichTextDidMountObservable"),r.deleteObserve("onRichTextKeyDownObservable"),r.deleteObserve("onRichTextKeyUpObservable"),r.deleteObserve("onFormulaBarDidMountObservable"),r.deleteObserve("onChangeCurrentSheetObserver"),r.deleteObserve("onSheetContainerDidMountObservable"),r.deleteObserve("onCellRangeModalDidMountObservable")}function j1(r){r.pushToObserve("onAfterChangeFontFamilyObservable"),r.pushToObserve("onAfterChangeFontSizeObservable"),r.pushToObserve("onAfterChangeFontWeightObservable"),r.pushToObserve("onAfterChangeFontItalicObservable"),r.pushToObserve("onAfterChangeFontStrikethroughObservable"),r.pushToObserve("onAfterChangeFontUnderlineObservable"),r.pushToObserve("onAfterChangeFontBackgroundObservable"),r.pushToObserve("onAfterChangeFontColorObservable"),r.pushToObserve("onDragAndDropStartObserver"),r.pushToObserve("onDragAndDroppingObserver"),r.pushToObserve("onDragAndDropEndEndObserver"),r.pushToObserve("onFillStartObserver"),r.pushToObserve("onFillingObserver"),r.pushToObserve("onFillEndObserver"),r.pushToObserve("onChangeSelectionObserver"),r.pushToObserve("onChangeCurrentSheetObserver"),r.pushToObserve("onToolBarDidMountObservable"),r.pushToObserve("onCellRangeModalDidMountObservable"),r.pushToObserve("onModalGroupDidMountObservable"),r.pushToObserve("onRichTextDidMountObservable"),r.pushToObserve("onRichTextKeyDownObservable"),r.pushToObserve("onRichTextKeyUpObservable"),r.pushToObserve("onFormulaBarDidMountObservable"),r.pushToObserve("onLineColorDidMountObservable"),r.pushToObserve("onLineBoldDidMountObservable"),r.pushToObserve("onColorSelectDidMountObservable"),r.pushToObserve("onSheetBarDidMountObservable"),r.pushToObserve("onCountBarDidMountObservable"),r.pushToObserve("onInfoBarDidMountObservable"),r.pushToObserve("onRightMenuDidMountObservable"),r.pushToObserve("onSheetContainerDidMountObservable")}var yw={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",cut:"\u526A\u5207",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},Aw={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};class Rw{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(e){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var ln=(r=>(r.MAIN_SCENE="mainScene",r.VIEW_MAIN="viewMain",r.VIEW_TOP="viewTop",r.VIEW_LEFT="viewLeft",r.VIEW_LEFT_TOP="viewLeftTop",r.SHEET_VIEW="sheetView",r.DRAG_LINE_VIEW="dragLineView",r))(ln||{});const K1=Un.create(),nh={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,formulaBar:!0,toolBar:!0,countBar:!0,sheetBar:!0,contentSplit:!1,rightMenu:!0},rh={undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},gl={hideInsertRow:!1,hideInsertColumn:!1,hideAddRowTop:!0,hideAddRowBottom:!0,hideAddColumnLeft:!0,hideAddColumnRight:!0,hideDeleteRow:!1,hideDeleteColumn:!1,hideHideRow:!0,hideShowRow:!0,hideRowHeight:!1,hideHideColumn:!0,hideShowColumn:!0,hideColumnWidth:!1,hideDeleteCell:!1,hideClearContent:!1,hideMatrix:!0},Z1={container:"universheet",layout:{sheetContainerConfig:nh,toolBarConfig:rh,rightMenuConfig:gl},selections:{"sheet-01":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}],"sheet-02":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}]}};var Ms=(r=>(r.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction",r))(Ms||{});class sh{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}setValue(e){}execute(){}}class q1{constructor(e){this._plugin=e}get zIndex(){return 0}create(e,t){return new sh(e,t)}check(e){return!1}}class oh{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new oh}}const Iw=oh.create();class J1{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellEditExtensionFactoryList.push(...e),this._cellEditExtensionFactoryList.sort(yt)}delete(e){const t=this._cellEditExtensionFactoryList.indexOf(e);this._cellEditExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...Iw.getData().sort(yt))}}class Ns{handle(e){var s;const t=(s=Ns==null?void 0:Ns.register)==null?void 0:s.cellEditExtensionFactoryList;if(!t)return;this._cellEditExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length&&(t=this._cellEditExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new J1,this.register.initialize()),this.register}}class ih{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}setValue(e){}execute(){}}class Q1{constructor(e){this._plugin=e}get zIndex(){return 0}create(e,t){return new ih(e,t)}check(e){return!1}}class ah{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new ah}}const xw=ah.create();class ep{constructor(){this._cellInputExtensionFactoryList=[]}get cellInputExtensionFactoryList(){return this._cellInputExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellInputExtensionFactoryList.push(...e),this._cellInputExtensionFactoryList.sort(yt)}delete(e){const t=this._cellInputExtensionFactoryList.indexOf(e);this._cellInputExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellInputExtensionFactoryList.push(...xw.getData().sort(yt))}}class ks{handle(e){var s;const t=(s=ks==null?void 0:ks.register)==null?void 0:s.cellInputExtensionFactoryList;if(!t)return;this._cellInputExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellInputExtensionFactoryList)return!1;for(let n=0;n<this._cellInputExtensionFactoryList.length&&(t=this._cellInputExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new ep,this.register.initialize()),this.register}}function tp(r,e){var s;const t=(s=r.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET))==null?void 0:s.getSelectionManager();if(!t)return[];const n=t==null?void 0:t.getCurrentModelsValue();return t.setModels(e),n}class Dw extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const s=this.do();this._oldActionData={...e,selections:s},this.validate()}do(){const{selections:e}=this._doActionData,t=this.getWorkSheet(),n=tp(t,e);return this._observers.notifyObservers({type:Ee.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e}=this._doActionData,t=this.do();this._oldActionData={actionName:Ms.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:t}}undo(){const{selections:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ms.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:tp(n,e)},this._observers.notifyObservers({type:Ee.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}He.register(Ms.SET_SELECTION_VALUE_ACTION,Dw);class np{constructor(e){this._range=e}getRange(){return this._range}getRect(){return this._rect}setRect(e){this._rect=e}setRange(e){this._range=e}}class rp{constructor(e){this._sheetId=e,this._antLineList=[]}deleteAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);t>-1&&this._antLineList.splice(t,1)}addAntLine(e){this._antLineList.push(e)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);if(t>-1)return this._antLineList[t]}}class sp{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class op{get copy(){return this._copy}get copyAs(){return this._copyAs}get paste(){return this._paste}get menuList(){return this._menuList}setValue(e){const{copy:t,copyAs:n,paste:s}=e;this._copy=t,this._copyAs=n,this._paste=s}setRightMenu(e){this._menuList=e}}class Ow{get sheetList(){return this._sheetList}setSheetName(e){this._sheetList=e}}class ip{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class fl{constructor(e){this._control=e,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=e.zIndex+1,this._model=e.model,this._initialize()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:t,rightControl:n,topControl:s,bottomControl:o,fillControl:i}=this._control;t.onPointerEnterObserver.add(u=>{t.cursor=ht.MOVE}),t.onPointerLeaveObserver.add(u=>{t.resetCursor()}),n.onPointerEnterObserver.add(u=>{n.cursor=ht.MOVE}),n.onPointerLeaveObserver.add(u=>{n.resetCursor()}),s.onPointerEnterObserver.add(u=>{s.cursor=ht.MOVE}),s.onPointerLeaveObserver.add(u=>{s.resetCursor()}),o.onPointerEnterObserver.add(u=>{o.cursor=ht.MOVE}),o.onPointerLeaveObserver.add(u=>{o.resetCursor()}),o.onPointerDownObserver.add(u=>{this.dragDown(u,ee.BOTTOM)}),o.onPointerUpObserver.add(u=>{o.resetCursor()});const a=this._zIndex;this._leftDragControl=new tt("__LeftDragControl__"+a,{top:0,left:-Ke.strokeWidth/2,width:Ke.strokeWidth*2,fill:Ke.strokeColor,zIndex:a}),this._rightDragControl=new tt("__RightDragControl__"+a,{width:Ke.strokeWidth*2,fill:Ke.strokeColor,zIndex:a}),this._topDragControl=new tt("__TopDragControl__"+a,{top:-Ke.strokeWidth/2,left:-Ke.strokeWidth/2,height:Ke.strokeWidth*2,fill:Ke.strokeColor,zIndex:a}),this._bottomDragControl=new tt("__BottomDragControl__"+a,{height:Ke.strokeWidth*2,fill:Ke.strokeColor,left:-Ke.strokeWidth/2,zIndex:a}),this._selectionDragShape=new hi("__SelectionDragShape__"+a,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=a,this._control.getScene().addObject(this._selectionDragShape)}dragEventInitial(){}dragDown(e,t){const n=this._control.getPlugin().getMainComponent(),s=this._model.getValue().selection;this._model=new Mi(Or.NORMAL,this._control.getPlugin()),this._model.setValue(s),this._updateControl();const{offsetX:o,offsetY:i}=e;this._startOffsetX=o,this._startOffsetY=i;const a=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let l=null;switch(t){case ee.LEFT:l=n.calculateCellIndexByPosition(o+Ke.strokeWidth,i,a);break;case ee.TOP:l=n.calculateCellIndexByPosition(o,i+Ke.strokeWidth,a);break;case ee.RIGHT:l=n.calculateCellIndexByPosition(o-Ke.strokeWidth,i,a);break;case ee.BOTTOM:l=n.calculateCellIndexByPosition(o,i-Ke.strokeWidth,a);break}const u=Qs(l);if(!u)return!1;const{startRow:c,startColumn:h,endColumn:d,endRow:g,startY:m,endY:f,startX:p,endX:b}=u,v={startColumn:h,startRow:c,endColumn:d,endRow:g,startY:m,endY:f,startX:p,endX:b};this._oldSelectionRange=v,this._cellPositionOffset={top:v.startRow-this._model.startRow,bottom:this._model.endRow-v.endRow,left:v.startColumn-this._model.startColumn,right:this._model.endColumn-v.endColumn};const w=this._control.getScene();w.disableEvent();const S=Kr.create(w);S.startScroll(o,i),this._moveObserver=w.onPointerMoveObserver.add(T=>{this.dragMoving(T);const{offsetX:D,offsetY:R}=T;S.scrolling(D,R,()=>{this.dragMoving(T)})}),this._upObserver=w.onPointerUpObserver.add(T=>{this.dragUp(),w.onPointerMoveObserver.remove(this._moveObserver),w.onPointerUpObserver.remove(this._upObserver),w.enableEvent(),S.stopScroll()})}dragMoving(e){const t=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:s,clientX:o,clientY:i}=e,a=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=t.calculateCellIndexByPosition(n,s,a),u=Qs(l);if(!u)return!1;const{startRow:c,startColumn:h,endColumn:d,endRow:g,startX:m,startY:f,endX:p,endY:b}=u,v={startColumn:h,startRow:c,endColumn:d,endRow:g,startY:f||0,endY:b||0,startX:m||0,endX:p||0},{startRow:w,endRow:S,startColumn:T,endColumn:D}=this._oldSelectionRange;if(T!==h||w!==c||D!==d||S!==g){this._oldSelectionRange=v;const{left:R,right:I,top:y,bottom:O}=this._cellPositionOffset,M=c-y,F=g+O,x=h-R,E=d+I;if(M<0||F<0||x<0||E<0)return;const N={startRow:M,endRow:F,startColumn:x,endColumn:E},X=t.getNoMergeCellPositionByIndex(N.startRow,N.startColumn),L=t.getNoMergeCellPositionByIndex(N.endRow,N.endColumn),ne=Object.assign(N,{startY:(X==null?void 0:X.startY)||0,endY:(L==null?void 0:L.endY)||0,startX:(X==null?void 0:X.startX)||0,endX:(L==null?void 0:L.endX)||0});this._model.setValue(ne),this._updateControl()}}dragUp(){const e=this._control.getPlugin().getMainComponent();this.hide();const{selection:t}=this._model.getValue(),n=e.getCellByIndex(t.startRow,t.startColumn);this._control.update(t,n)}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._model;this._leftDragControl.resize(void 0,s-t),this._rightDragControl.transformByState({height:s-t,left:n-e-Ke.strokeWidth/2}),this._topDragControl.resize(n-e+Ke.strokeWidth),this._bottomDragControl.transformByState({width:n-e+Ke.strokeWidth,top:s-t-Ke.strokeWidth/2}),this._selectionDragShape.show(),this._selectionDragShape.translate(e,t),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.hide(),this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:e,rightControl:t,topControl:n,bottomControl:s}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),s.onPointerEnterObserver.clear(),s.onPointerLeaveObserver.clear()}static create(e){return new fl(e)}}class ml{constructor(e){this._control=e,this._initialize()}_initialize(){const{fillControl:e}=this._control;this._control.getPlugin(),e.onPointerEnterObserver.add(t=>{e.cursor=ht.CROSSHAIR}),e.onPointerLeaveObserver.add(t=>{e.resetCursor()})}remove(){const{fillControl:e}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear()}static create(e){return new ml(e)}}const Ke={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var Or=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ROW=1]="ROW",r[r.COLUMN=2]="COLUMN",r))(Or||{});class Bs{constructor(e,t){this._manager=e,this._zIndex=t,this._initialize()}_initialize(){this._selectionModel=new Mi(0,this._manager.getPlugin());const e=this._zIndex;this._leftControl=new tt("__SpreadsheetSelectionShapeLeftControl__"+e,{top:0,left:-Ke.strokeWidth/2,width:Ke.strokeWidth,fill:Ke.strokeColor,zIndex:e}),this._rightControl=new tt("__SpreadsheetSelectionShapeRightControl__"+e,{width:Ke.strokeWidth,fill:Ke.strokeColor,zIndex:e}),this._topControl=new tt("__SpreadsheetSelectionTopControl__"+e,{top:-Ke.strokeWidth/2,left:-Ke.strokeWidth/2,height:Ke.strokeWidth,fill:Ke.strokeColor,zIndex:e}),this._bottomControl=new tt("__SpreadsheetSelectionBottomControl__"+e,{height:Ke.strokeWidth,fill:Ke.strokeColor,left:-Ke.strokeWidth/2,zIndex:e}),this._backgroundControlTop=new tt("__SpreadsheetSelectionBackgroundControlTop__"+e,{fill:Ke.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new tt("__SpreadsheetSelectionBackgroundControlBottom__"+e,{fill:Ke.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new tt("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{fill:Ke.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new tt("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{fill:Ke.backgroundColor,zIndex:e-1,evented:!1});const t=Ke.fillSideLength-Ke.fillStrokeLength;this._fillControl=new tt("__SpreadsheetSelectionFillControl__"+e,{width:t,height:t,fill:Ke.strokeColor,strokeWidth:Ke.fillStrokeLength,stroke:Ke.fillStrokeColor,zIndex:e+1}),this._selectionShape=new hi("__SpreadsheetSelectionShape__"+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this._selectionDragAndDrop=fl.create(this),this._selectionControlFill=ml.create(this),this.getScene().addObject(this._selectionShape)}get zIndex(){return this._zIndex}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._selectionModel;this.leftControl.resize(void 0,s-t),this.rightControl.transformByState({height:s-t,left:n-e-Ke.strokeWidth/2}),this.topControl.resize(n-e+Ke.strokeWidth),this.bottomControl.transformByState({width:n-e+Ke.strokeWidth,top:s-t-Ke.strokeWidth/2}),this.fillControl.translate(n-e-Ke.fillSideLength/2,s-t-Ke.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.show(),this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:s,startX:o,startY:i,endX:a,endY:l}=this._selectionModel,u=this._selectionModel.highlightToSelection();if(!u){this._backgroundControlTop.resize(a-o,l-i),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}const{startX:c,startY:h,endX:d,endY:g}=u,m=Ke.strokeWidth/2,f={left:-m,top:-m,width:a-o+m*2,height:h-i+m};f.height<0&&(f.width=0,f.height=0),this._backgroundControlTop.transformByState(f);const p={left:-m,top:h-i,width:c-o+m,height:g-h};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleLeft.transformByState(p);const b={left:d-o-m,top:h-i,width:a-d+m*2,height:g-h};b.width<0&&(b.width=0,b.height=0),this._backgroundControlMiddleRight.transformByState(b);const v={left:-m,top:g-i,width:a-o+m*2,height:l-g+m};v.height<0&&(v.width=0,v.height=0),this._backgroundControlBottom.transformByState(v)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var e,t,n,s,o,i,a,l,u,c;(e=this._leftControl)==null||e.dispose(),(t=this._rightControl)==null||t.dispose(),(n=this._topControl)==null||n.dispose(),(s=this._bottomControl)==null||s.dispose(),(o=this._backgroundControlTop)==null||o.dispose(),(i=this._backgroundControlMiddleLeft)==null||i.dispose(),(a=this._backgroundControlMiddleRight)==null||a.dispose(),(l=this._backgroundControlBottom)==null||l.dispose(),(u=this._fillControl)==null||u.dispose(),(c=this._selectionShape)==null||c.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:s,startX:o,endX:i,startY:a,endY:l}=e;t={startRow:n,endRow:n,startColumn:s,endColumn:s,startX:o,endX:i,startY:a,endY:l}}return t}}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const s=Bs.create(e,t);return s.update(n),s}}class Mi{constructor(e=Or.NORMAL,t){this._type=e,this._plugin=t}isEqual(e){const{startColumn:t,startRow:n,endColumn:s,endRow:o,type:i}=this,{startColumn:a,startRow:l,endColumn:u,endRow:c}=e;return t===a&&n===l&&s===u&&o===c}isInclude(e){const{startColumn:t,startRow:n,endColumn:s,endRow:o,type:i}=this,{startColumn:a,startRow:l,endColumn:u,endRow:c}=e;return!(u<t||a>s||l>o||c<n)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}highlightToSelection(){return Qs(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:s,endColumn:o,endRow:i,startX:a,startY:l,endX:u,endY:c}=e;this._startColumn=n,this._startRow=s,this._endColumn=o,this._endRow=i,this._startX=a,this._startY=l,this._endX=u,this._endY=c,this.setTypeByData(),this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}setTypeByData(){const e=this._plugin.getWorkbook().getActiveSheet().getConfig().rowCount,t=this._plugin.getWorkbook().getActiveSheet().getConfig().columnCount;return this._startRow===0&&this._endRow===e-1?this._type=Or.COLUMN:this._startColumn===0&&this._endColumn===t-1?this._type=Or.ROW:this._type=Or.NORMAL}}const Oo={strokeColor:"rgb(1,136,251)",strokeWidth:1,fillStrokeWidth:5};var lh=(r=>(r[r.VERTICAL=0]="VERTICAL",r[r.HORIZONTAL=1]="HORIZONTAL",r))(lh||{});class Fw{constructor(e){this._manager=e}create(e){const{direction:t,end:n,dragUp:s,start:o}=e;this._direction=t,this._end=n,this._start=o,this._dragUp=s;const i=this._manager.getSheetView().getSpreadsheetColumnTitle().getSkeleton();if(t){const l=i==null?void 0:i.rowTitleWidth,u=i==null?void 0:i.columnTotalWidth;this._dragLineControlMain=new tt("__SpreadsheetDragLineMain__",{width:l,height:5,top:this._end-5,fill:Oo.strokeColor}),this._dragLineControlContent=new tt("__SpreadsheetDragLineContent__",{width:u,height:1,top:this._end-1,left:l,fill:Oo.strokeColor})}else{const l=i==null?void 0:i.columnTitleHeight,u=i==null?void 0:i.rowTotalHeight;this._dragLineControlMain=new tt("__SpreadsheetDragLineMain__",{width:Oo.fillStrokeWidth,height:l,left:this._end-5,fill:Oo.strokeColor}),this._dragLineControlContent=new tt("__SpreadsheetDragLineContent__",{width:Oo.strokeWidth,height:u,top:l,left:this._end-1,fill:Oo.strokeColor})}this._dragLine=new hi("__SpreadsheetDragLine__",this._dragLineControlMain,this._dragLineControlContent),this._dragLine.hide(),this._dragLine.evented=!1,this._manager.getScene().addObject(this._dragLine,3)}dragDown(e){const t=this._manager.getScene();t.disableEvent(),this._state={distance:this._direction?e.clientY:e.clientX},this._dragLine.show(),this._moveObserver=t.onPointerMoveObserver.add(n=>{this.dragMoving(n)}),this._upObserver=t.onPointerUpObserver.add(n=>{this.dragUp(n),t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent()})}dragMoving(e){if(this._direction){if(e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5)return;this._dragLine.transformByState({top:e.clientY-this._state.distance})}else{if(e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5)return;this._dragLine.transformByState({left:e.clientX-this._state.distance})}}dragUp(e){let t;this._direction?(t=e.clientY-this._state.distance,e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5&&(t=null)):(t=e.clientX-this._state.distance,e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5&&(t=null)),this._dragUp(t),this._dragLine.dispose()}}class Mw{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentWidth=0,this._manager=e,this._leftTopWidth=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().width,this._highlightItem=new tt("HighLightColumnTitle",{width:0,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem.hide(),this._highlightItem.evented=!1,this._manager.getScene().addObject(this._highlightItem,3)}pointerDown(e){var u,c;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX-o.x-this._leftTopWidth-i.current.getBoundingClientRect().left,l=(c=(u=t.getSkeleton())==null?void 0:u.columnWidthAccumulation)!=null?c:[];for(let h=0;h<(l==null?void 0:l.length);h++)if(l[h]>=a){this._index=h;break}if(this._currentWidth=l[0],this._index&&(this._currentWidth=l[this._index]-l[this._index-1]),l[this._index]-a<=5){const h=l[this._index]+this._leftTopWidth,d=(this._index?l[this._index-1]:0)+this._leftTopWidth;this._manager.getDragLineControl().create({direction:lh.VERTICAL,end:h,start:d,dragUp:this.setColumnWidth.bind(this)}),this._manager.getDragLineControl().dragDown(e)}this.highlightColumn()}setColumnWidth(e){const n=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();e===null?n.setColumnWidth(this._index,1,5):n.setColumnWidth(this._index,1,e+this._currentWidth),this.highlightColumn()}highlightColumn(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:0,startColumn:this._index,endColumn:this._index,endRow:e.getRowCount()-1},{row:0,column:this._index})}highlightColumnTitle(e){var c,h;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX-o.x-this._leftTopWidth-i.current.getBoundingClientRect().left,l=(h=(c=t.getSkeleton())==null?void 0:c.columnWidthAccumulation)!=null?h:[];for(let d=0;d<(l==null?void 0:l.length);d++)if(l[d]>=a){this._index=d;break}this._currentWidth=l[0];let u=this._leftTopWidth;this._index&&(this._currentWidth=l[this._index]-l[this._index-1],u=this._leftTopWidth+l[this._index-1]),this._highlightItem.transformByState({width:this._currentWidth,left:u}),this._highlightItem.show()}unHighlightColumnTitle(){this._highlightItem.hide()}}class Nw{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentHeight=0,this._manager=e,this._leftTopHeight=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().height,this._highlightItem=new tt("HighLightRowTitle",{width:this._manager.getSheetView().getSpreadsheetSkeleton().rowTitleWidth,height:0,top:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem.hide(),this._highlightItem.evented=!1,this._manager.getScene().addObject(this._highlightItem,3)}pointerDown(e){var u,c;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+o.y-this._leftTopHeight-i.current.getBoundingClientRect().top,l=(c=(u=t.getSkeleton())==null?void 0:u.rowHeightAccumulation)!=null?c:[];for(let h=0;h<(l==null?void 0:l.length);h++)if(l[h]>=a){this._index=h;break}if(this._currentHeight=l[0],this._index&&(this._currentHeight=l[this._index]-l[this._index-1]),l[this._index]-a<=5){const h=l[this._index]+this._leftTopHeight,d=(this._index?l[this._index-1]:0)+this._leftTopHeight;this._manager.getDragLineControl().create({direction:lh.HORIZONTAL,end:h,start:d,dragUp:this.setRowHeight.bind(this)}),this._manager.getDragLineControl().dragDown(e)}this.highlightRow()}setRowHeight(e){const n=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();e===null?n.setRowHeights(this._index,1,5):n.setRowHeights(this._index,1,e+this._currentHeight),this.highlightRow()}highlightRow(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:this._index,startColumn:0,endColumn:e.getColumnCount()-1,endRow:this._index},{row:this._index,column:0})}highlightRowTitle(e){var c,h;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+o.y-this._leftTopHeight-i.current.getBoundingClientRect().top,l=(h=(c=t.getSkeleton())==null?void 0:c.rowHeightAccumulation)!=null?h:[];for(let d=0;d<(l==null?void 0:l.length);d++)if(l[d]>=a){this._index=d;break}this._currentHeight=l[0];let u=this._leftTopHeight;this._index&&(this._currentHeight=l[this._index]-l[this._index-1],u=this._leftTopHeight+l[this._index-1]),this._highlightItem.transformByState({height:this._currentHeight,top:u}),this._highlightItem.show()}unHighlightRowTitle(){this._highlightItem.hide()}}class ap{constructor(e){this._sheetView=e,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this.hasSelection=!1,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getSheetView(){return this._sheetView}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(e){this._worksheet=e;const t=this.getWorksheetId();t&&(this._selectionModels.get(t)||this._selectionModels.set(t,[]))}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0){for(const t of e)if(t.model.currentCell)return t}}getCurrentModels(){const e=this.getWorksheetId();return e?(this._selectionModels.get(e)||this._selectionModels.set(e,[]),this._selectionModels.get(e)):void 0}getCurrentCellModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return n}}getCurrentModel(){const e=this.getCurrentModels();if(e&&e.length>0){for(const t of e)if(t.currentCell)return t}}getCurrentModelsValue(){const e=this.getCurrentModels();if(!e)return[];const t=[];for(let n of e)t.push(n.getValue());return t}renderCurrentControls(e){const t=this.getWorksheetId();if(t){if(this._selectionControls)for(let s of this._selectionControls)s.dispose();const n=e||this._selectionModels.get(t);this._selectionControls=[],n==null||n.forEach(s=>{const o=s.currentCell,i=this._mainComponent,a=Bs.create(this,this._selectionControls.length);let l=null;o&&(l=i.getCellByIndex(o.row,o.column));const{startRow:u,startColumn:c,endRow:h,endColumn:d}=s,g=i.getNoMergeCellPositionByIndex(u,c),m=i.getNoMergeCellPositionByIndex(h,d);a.update({startColumn:c,startRow:u,endColumn:d,endRow:h,startY:(g==null?void 0:g.startY)||0,endY:(m==null?void 0:m.endY)||0,startX:(g==null?void 0:g.startX)||0,endX:(m==null?void 0:m.endX)||0},l),this._selectionControls.push(a)}),this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var e;return(e=this._worksheet)==null?void 0:e.getSheetId()}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const s=this._mainComponent,o=Bs.create(this,n.length);let i=null;t&&(i=s.getCellByIndex(t.row,t.column));const{startRow:a,startColumn:l,endRow:u,endColumn:c}=e,h=s.getNoMergeCellPositionByIndex(a,l),d=s.getNoMergeCellPositionByIndex(u,c);o.update({startColumn:l,startRow:a,endColumn:c,endRow:u,startY:(h==null?void 0:h.startY)||0,endY:(d==null?void 0:d.endY)||0,startX:(h==null?void 0:h.startX)||0,endX:(d==null?void 0:d.endX)||0},i),n.push(o),this.setSelectionModel()}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}setSelectionModel(e){if(!this._worksheet)return;e||(e=this._selectionControls.map(i=>i.model.getValue()));const t=this._worksheet.getContext().getWorkBook(),n=t.getCommandManager(),s={sheetId:this._worksheet.getSheetId(),actionName:Ms.SET_SELECTION_VALUE_ACTION,selections:e},o=new ge({WorkBookUnit:t},s);n.invoke(o)}updateSelectionModel(e,t,n){const s=this.getWorksheetId();if(!this._worksheet||!s)return;const o=this._selectionModels.get(s),i=[];o==null||o.forEach((h,d)=>{d===n?i.push({selection:e,cell:t}):i.push(h.getValue())});const a=this._worksheet.getContext().getWorkBook(),l=a.getCommandManager(),u={sheetId:this._worksheet.getSheetId(),actionName:Ms.SET_SELECTION_VALUE_ACTION,selections:i},c=new ge({WorkBookUnit:a},u);l.invoke(c)}setModels(e){const t=this.getWorksheetId();if(!t)return;const n=e.map(({selection:s,cell:o})=>{const i=new Mi(Or.NORMAL,this._plugin);return i.setValue(s,o),i});this._selectionModels.set(t,n)}move(e){var u,c;const t=this.getCurrentCellModel();if(!t)return;let{row:n,column:s}=t;const o=((u=this._worksheet)==null?void 0:u.getRowCount())||1e3,i=((c=this._worksheet)==null?void 0:c.getColumnCount())||50;switch(e){case ee.TOP:n--,n<0&&(n=0);break;case ee.BOTTOM:n++,n>o&&(n=o);break;case ee.LEFT:s--,s<0&&(s=0);break;case ee.RIGHT:s++,s>i&&(s=i);break}let a={startRow:n,endRow:n,startColumn:s,endColumn:s},l={row:n,column:s};this.clearSelectionControls(),this.addControlToCurrentByRangeData(a,l)}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels(),this._dragLineControl=new Fw(this),this._columnTitleControl=new Mw(this),this._rowTitleControl=new Nw(this)}_mainEventInitial(){const e=this._mainComponent;e.onPointerDownObserver.add(t=>{var D;const{offsetX:n,offsetY:s}=t;this._startOffsetX=n,this._startOffsetY=s;const o=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=e.calculateCellIndexByPosition(n,s,o),a=Qs(i);if(!a||!this._worksheet)return!1;const{startRow:l,startColumn:u,endColumn:c,endRow:h,startY:d,endY:g,startX:m,endX:f}=a,p={startColumn:u,startRow:l,endColumn:c,endRow:h,startY:d,endY:g,startX:m,endX:f};this._startSelectionRange=p;let b=this.getCurrentControl(),v=this.getCurrentControls();if(!v)return!1;for(let R of v){if(t.button===2&&R.model.isInclude(p)){b=R;return}if(R.model.isEqual(p)){b=R;break}t.shiftKey||R.clearHighlight()}if(v.length>0&&!t.ctrlKey&&!t.shiftKey){for(let R of v)R.dispose();v.length=0}const w=b&&b.model.currentCell;if(b&&t.shiftKey&&w){const{row:R,column:I}=w,y=e.getNoMergeCellPositionByIndex(R,I),O=e.getNoMergeCellPositionByIndex(h,c),M={startColumn:I,startRow:R,endColumn:p.startColumn,endRow:p.startRow,startY:(y==null?void 0:y.startY)||0,endY:(O==null?void 0:O.endY)||0,startX:(y==null?void 0:y.startX)||0,endX:(O==null?void 0:O.endX)||0};b.update(M,w)}else b=Bs.create(this,v.length),b.update(p,i),v.push(b);this.hasSelection=!0;const S=this.getScene();S.disableEvent();const T=Kr.create(this.getScene());T.startScroll(n,s),this.setSelectionModel(),(D=this._plugin.getObserver("onChangeSelectionObserver"))==null||D.notifyObservers(b),this._moveObserver=S.onPointerMoveObserver.add(R=>{this.moving(R,b);const{offsetX:I,offsetY:y}=R;T.scrolling(I,y,()=>{this.moving(R,b)})}),this._upObserver=S.onPointerUpObserver.add(R=>{this.up(),S.onPointerMoveObserver.remove(this._moveObserver),S.onPointerUpObserver.remove(this._upObserver),S.enableEvent(),T.stopScroll()})})}moving(e,t){var G;const n=this._mainComponent,{offsetX:s,offsetY:o,clientX:i,clientY:a}=e,{startRow:l,startColumn:u,endRow:c,endColumn:h}=this._startSelectionRange,d=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),g=n.calculateCellIndexByPosition(s,o,d),m=Qs(g);if(!m)return!1;const{startRow:f,startColumn:p,endColumn:b,endRow:v}=m,w=Math.min(f,l),S=Math.min(p,u),T=Math.max(v,c),D=Math.max(b,h),R=n.getSelectionBounding(w,S,T,D);if(!R)return!1;const{startRow:I,startColumn:y,endRow:O,endColumn:M}=R,F=n.getNoMergeCellPositionByIndex(I,y),x=n.getNoMergeCellPositionByIndex(O,M),E={startColumn:y,startRow:I,endColumn:M,endRow:O,startY:(F==null?void 0:F.startY)||0,endY:(x==null?void 0:x.endY)||0,startX:(F==null?void 0:F.startX)||0,endX:(x==null?void 0:x.endX)||0},{startRow:N,endRow:X,startColumn:L,endColumn:ne}=(t==null?void 0:t.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};(L!==y||N!==I||ne!==M||X!==O)&&(t&&t.update(E),this.setSelectionModel(),t&&((G=this._plugin.getObserver("onChangeSelectionObserver"))==null||G.notifyObservers(t)))}up(){this.setSelectionModel()}_rowEventInitial(){const e=this._rowComponent;e.onPointerDownObserver.add(t=>{this._rowTitleControl.pointerDown(t)}),e.onPointerEnterObserver.add(t=>{this._rowTitleControl.highlightRowTitle(t)}),e.onPointerMoveObserver.add(t=>{this._rowTitleControl.highlightRowTitle(t)}),e.onPointerLeaveObserver.add(()=>{this._rowTitleControl.unHighlightRowTitle()})}_columnEventInitial(){const e=this._columnComponent;e.onPointerDownObserver.add(t=>{this._columnTitleControl.pointerDown(t)}),e.onPointerEnterObserver.add(t=>{this._columnTitleControl.highlightColumnTitle(t)}),e.onPointerMoveObserver.add(t=>{this._columnTitleControl.highlightColumnTitle(t)}),e.onPointerLeaveObserver.add(()=>{this._columnTitleControl.unHighlightColumnTitle()})}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add(t=>{console.log("leftTop_moveObserver",t)})}_initModels(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(o=>{const{startColumn:i,startRow:a,endColumn:l,endRow:u}=o.selection,c=o.cell,h=new Mi(Or.NORMAL,this._plugin),d=c?{row:c.row,column:c.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:i,startRow:a,endColumn:l,endRow:u,startY:0,endY:0,startX:0,endX:0}}:null;h.setValue({startColumn:i,startRow:a,endColumn:l,endRow:u,startY:0,endY:0,startX:0,endX:0},d),s.push(h)}),this._selectionModels.set(t,s)})}_initControls(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(o=>{const i=o.selection,a=o.cell,l=this._mainComponent,u=Bs.create(this,s.length);let c=null;a&&(c=l.getCellByIndex(a.row,a.column));const{startRow:h,startColumn:d,endRow:g,endColumn:m}=i,f=l.getNoMergeCellPositionByIndex(h,d),p=l.getNoMergeCellPositionByIndex(g,m);u.model.setValue({startColumn:d,startRow:h,endColumn:m,endRow:g,startY:(f==null?void 0:f.startY)||0,endY:(p==null?void 0:p.endY)||0,startX:(f==null?void 0:f.startX)||0,endX:(p==null?void 0:p.endX)||0},c),s.push(u)})})}_initializeObserver(){var t;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this.renderCurrentControls()}),(t=this._worksheet)==null||t.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this.renderCurrentControls()})}getActiveRangeListData(){const e=this.getCurrentModels();if(e&&e.length>0)return e==null?void 0:e.map(n=>({startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}))}getActiveRangeList(){var t;const e=this.getActiveRangeListData();return e&&((t=this._worksheet)==null?void 0:t.getRangeList(e))}getActiveRangeData(){const e=this.getCurrentModels();if(e&&e.length>0){for(const t of e)if(t.currentCell)return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}}getActiveRange(){var t;const e=this.getActiveRangeData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}getCurrentCellData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return{startRow:n.row,startColumn:n.column,endRow:n.row,endColumn:n.column}}}getCurrentCell(){var t;const e=this.getCurrentCellData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}getDragLineControl(){return this._dragLineControl}}class kw extends Rw{constructor(){super(...arguments),this.viewKey=ln.SHEET_VIEW}_initialize(){const e=this.getScene(),n=this.getContext().getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const o=this._buildSkeleton(s),{rowTotalHeight:i,columnTotalWidth:a,rowTitleWidth:l,columnTitleHeight:u}=o,c=new wc("__SpreadsheetRender__",o),h=new Tc("__SpreadsheetRowTitle__",o),d=new Sc("__SpreadsheetColumnTitle__",o),g=new tt("__SpreadsheetLeftTopPlaceholder__",{zIndex:2,left:-1,top:-1,width:l,height:u,fill:pt([248,249,250]),stroke:pt([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=o,this._spreadsheet=c,this._spreadsheetRowTitle=h,this._spreadsheetColumnTitle=d,this._spreadsheetLeftTopPlaceholder=g,e.addObjects([c],0),e.addObjects([h,d,g],2),e.transformByState({width:this._columnWidthByTitle(s),height:this._rowHeightByTitle(s)+i}),this._updateViewport(l,u),this._selectionManager=new ap(this)}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(e){const t=this.getScene(),n=this._buildSkeleton(e),{rowTotalHeight:s,columnTotalWidth:o,rowTitleWidth:i,columnTitleHeight:a}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:i,height:a}),t.transformByState({width:this._columnWidthByTitle(e),height:this._rowHeightByTitle(e)+s}),this._updateViewport(i,a),this._selectionManager.updateToSheet(e)}_updateViewport(e,t){const n=this.getScene(),s=e*n.scaleX,o=t*n.scaleY,i=n.getViewport(ln.VIEW_MAIN),a=n.getViewport(ln.VIEW_TOP),l=n.getViewport(ln.VIEW_LEFT),u=n.getViewport(ln.VIEW_LEFT_TOP);i==null||i.resize({left:s,top:o}),a==null||a.resize({left:s,height:o}),l==null||l.resize({top:o,width:s}),u==null||u.resize({width:s,height:o})}_buildSkeleton(e){const t=this.getContext(),n=t.getWorkBook(),s=e.getConfig();return mi.create(s,e.getCellMatrix(),n.getStyles(),t)}_rowHeightByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.columnTitle.height)||0}_columnWidthByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.rowTitle.width)||0}}class Bw{create(e,t){return new kw().initialize(e,t)}}K1.add(new Bw),lt.COLUMN,ct.PARAGRAPH,rn.WRAP_SQUARE,te.FALSE,Hn.BOTH_SIDES,vt.START,vt.START,vt.START,vt.START,Wt.ROMAN,vt.START,Wt.ROMAN,vt.START,Wt.ROMAN,Fe.PARAGRAPH,K.TEXT_RUN,K.TEXT_RUN,cn.SUPERSCRIPT,K.TEXT_RUN,K.TEXT_RUN,K.DRAWING,K.TEXT_RUN,K.TEXT_RUN,Fe.PARAGRAPH,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,Fe.PARAGRAPH,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,Fe.PARAGRAPH,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,Fe.PARAGRAPH,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN,K.TEXT_RUN;class Lw{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine,t=this._plugin.getContext(),n=t.getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const o=s.getConfig(),i=o.rowTitle,a=o.columnTitle,l=new Ss(ln.MAIN_SCENE,e,{width:1200,height:1e3});l.openTransformer(),this._scene=l;const u=new En(ln.VIEW_MAIN,l,{left:i.width,top:a.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),c=new En(ln.VIEW_TOP,l,{left:i.width,top:0,height:a.height,right:0,isWheelPreventDefaultX:!0}),h=new En(ln.VIEW_LEFT,l,{left:0,top:a.height,bottom:0,width:i.width,isWheelPreventDefaultX:!0}),d=new En(ln.VIEW_LEFT_TOP,l,{left:0,top:0,width:i.width,height:a.height,isWheelPreventDefaultX:!0});u.onScrollAfterObserver.add(g=>{const{scrollX:m,scrollY:f,actualScrollX:p,actualScrollY:b}=g;c.updateScroll({scrollX:m,actualScrollX:p}).makeDirty(!0),h.updateScroll({scrollY:f,actualScrollY:b}).makeDirty(!0)}),t.getContextObserver("onZoomRatioSheetObservable").add(g=>{this._plugin,this._scene.scale(g.zoomRatio,g.zoomRatio)}),l.addViewport(u,h,c,d).attachControl(),l.on(Bt.wheel,(g,m)=>{const f=g;if(f.ctrlKey){const p=Math.abs(f.deltaX);let b=p<40?.2:p<80?.4:.2;if(b*=f.deltaY>0?-1:1,l.scaleX<1&&(b/=2),l.scaleX+b>4)l.scale(4,4);else if(l.scaleX+b<.1)l.scale(.1,.1);else{const v=t.getWorkBook().getActiveSheet(),w=f.deltaY>0?.1:-.1;v.setZoomRatio(v.getZoomRatio()+w),f.preventDefault()}}else u.onMouseWheel(f,m)}),new Zr(u),l.addLayer(lo.create(l,[],0),lo.create(l,[],2)),this._viewLoader(l,this._plugin),e.runRenderLoop(()=>{l.render();const g=document.getElementById("app");g&&(g.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getSheetView(){return this.getView(ln.SHEET_VIEW)}updateToSheet(e){for(let t of this._views)t.updateToSheet(e)}_viewLoader(e,t){K1.getData().forEach(n=>{this._views.push(n.create(e,t))})}}var uh={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"},ch={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#0d1117",fontSize:"14px",headingColor:"rgba(255, 255, 255, 0.85)",textColor:"#8b949e",textColorSecondary:"rgba(255, 255, 255, 0.45)",disabledColor:"rgba(255, 255, 255, 0.25)",disabledBg:"rgba(255, 255, 255, 0.04)",borderColorBase:"rgba(255, 255, 255, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(255, 255, 255, 0.12), 0 6px 16px 0 rgba(255, 255, 255, 0.08), 0 9px 28px 8px rgba(255, 255, 255, 0.05)",borderColorBaseHover:"#bfbfbf"},hh={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#004b1c",primaryColorHover:"#0e5c2f",linkColor:"#217346",bg:"#fff",fontSize:"14px",headingColor:"rgba(0, 0, 0, 0.85)",textColor:"rgba(0, 0, 0, 0.65)",textColorSecondary:"rgba(0, 0, 0, 0.45)",disabledColor:"rgba(0, 0, 0, 0.25)",disabledBg:"rgba(0, 0, 0, 0.04)",borderColorBase:"rgba(0, 0, 0, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};/*!
 * css-vars-ponyfill
 * v2.4.8
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function pn(){return pn=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},pn.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function lp(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={mimeType:e.mimeType||null,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},n=Array.isArray(r)?r:[r],s=Array.apply(null,Array(n.length)).map(function(u){return null});function o(u){var c=typeof u=="string",h=c&&u.trim().charAt(0)==="<";return c&&!h}function i(u,c){t.onError(u,n[c],c)}function a(u,c){var h=t.onSuccess(u,n[c],c);u=h===!1?"":h||u,s[c]=u,s.indexOf(null)===-1&&t.onComplete(s)}var l=document.createElement("a");n.forEach(function(u,c){l.setAttribute("href",u),l.href=String(l.href);var h=Boolean(document.all&&!window.atob),d=h&&l.host.split(":")[0]!==location.host.split(":")[0];if(d){var g=l.protocol===location.protocol;if(g){var m=new XDomainRequest;m.open("GET",u),m.timeout=0,m.onprogress=Function.prototype,m.ontimeout=Function.prototype,m.onload=function(){var p=m.responseText;o(p)?a(p,c):i(m,c)},m.onerror=function(p){i(m,c)},setTimeout(function(){m.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(u,")")),i(null,c)}else{var f=new XMLHttpRequest;f.open("GET",u),t.mimeType&&f.overrideMimeType&&f.overrideMimeType(t.mimeType),t.onBeforeSend(f,u,c),f.onreadystatechange=function(){if(f.readyState===4){var p=f.responseText;f.status<400&&o(p)||f.status===0&&o(p)?a(p,c):i(f,c)}},f.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function up(r){var e={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},t={rootElement:r.rootElement||document,include:r.include||'style,link[rel="stylesheet"]',exclude:r.exclude||null,filter:r.filter||null,skipDisabled:r.skipDisabled!==!1,useCSSOM:r.useCSSOM||!1,onBeforeSend:r.onBeforeSend||Function.prototype,onSuccess:r.onSuccess||Function.prototype,onError:r.onError||Function.prototype,onComplete:r.onComplete||Function.prototype},n=Array.apply(null,t.rootElement.querySelectorAll(t.include)).filter(function(u){return!Pw(u,t.exclude)}),s=Array.apply(null,Array(n.length)).map(function(u){return null});function o(){var u=s.indexOf(null)===-1;if(u){s.reduce(function(h,d,g){return d===""&&h.push(g),h},[]).reverse().forEach(function(h){return[n,s].forEach(function(d){return d.splice(h,1)})});var c=s.join("");t.onComplete(c,s,n)}}function i(u,c,h,d){var g=t.onSuccess(u,h,d);u=g!==void 0&&Boolean(g)===!1?"":g||u,l(u,h,d,function(m,f){s[c]===null&&(f.forEach(function(p){return t.onError(p.xhr,h,p.url)}),!t.filter||t.filter.test(m)?s[c]=m:s[c]="",o())})}function a(u,c){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],d={};return d.rules=(u.replace(e.cssComments,"").match(e.cssImports)||[]).filter(function(g){return h.indexOf(g)===-1}),d.urls=d.rules.map(function(g){return g.replace(e.cssImports,"$1")}),d.absoluteUrls=d.urls.map(function(g){return dh(g,c)}),d.absoluteRules=d.rules.map(function(g,m){var f=d.urls[m],p=dh(d.absoluteUrls[m],c);return g.replace(f,p)}),d}function l(u,c,h,d){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],f=a(u,h,m);f.rules.length?lp(f.absoluteUrls,{onBeforeSend:function(b,v,w){t.onBeforeSend(b,c,v)},onSuccess:function(b,v,w){var S=t.onSuccess(b,c,v);b=S===!1?"":S||b;var T=a(b,v,m);return T.rules.forEach(function(D,R){b=b.replace(D,T.absoluteRules[R])}),b},onError:function(b,v,w){g.push({xhr:b,url:v}),m.push(f.rules[w]),l(u,c,h,d,g,m)},onComplete:function(b){b.forEach(function(v,w){u=u.replace(f.rules[w],v)}),l(u,c,h,d,g,m)}}):d(u,g)}n.length?n.forEach(function(u,c){var h=u.getAttribute("href"),d=u.getAttribute("rel"),g=u.nodeName.toLowerCase()==="link"&&h&&d&&d.toLowerCase().indexOf("stylesheet")!==-1,m=t.skipDisabled===!1?!1:u.disabled,f=u.nodeName.toLowerCase()==="style";if(g&&!m){var p=h.indexOf("data:text/css")!==-1;if(p){var b=decodeURIComponent(h.substring(h.indexOf(",")+1));t.useCSSOM&&(b=Array.apply(null,u.sheet.cssRules).map(function(w){return w.cssText}).join("")),i(b,c,u,location.href)}else lp(h,{mimeType:"text/css",onBeforeSend:function(S,T,D){t.onBeforeSend(S,u,T)},onSuccess:function(S,T,D){var R=dh(h);i(S,c,u,R)},onError:function(S,T,D){s[c]="",t.onError(S,u,T),o()}})}else if(f&&!m){var v=u.textContent;t.useCSSOM&&(v=Array.apply(null,u.sheet.cssRules).map(function(w){return w.cssText}).join("")),i(v,c,u,location.href)}else s[c]="",o()}):t.onComplete("",[])}function dh(r,e){var t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e||document.baseURI||(document.querySelector("base")||{}).href||location.href,s.href=r,s.href}function Pw(r,e){var t=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;return t.call(r,e)}var cp=hp;function hp(r,e,t){r instanceof RegExp&&(r=dp(r,t)),e instanceof RegExp&&(e=dp(e,t));var n=gp(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}function dp(r,e){var t=e.match(r);return t?t[0]:null}hp.range=gp;function gp(r,e,t){var n,s,o,i,a,l=t.indexOf(r),u=t.indexOf(e,l+1),c=l;if(l>=0&&u>0){if(r===e)return[l,u];for(n=[],o=t.length;c>=0&&!a;)c==l?(n.push(c),l=t.indexOf(r,c+1)):n.length==1?a=[n.pop(),u]:(s=n.pop(),s<o&&(o=s,i=u),u=t.indexOf(e,c+1)),c=l<u&&l>=0?l:u;n.length&&(a=[o,i])}return a}function gh(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,removeComments:!1},n=pn({},t,e),s=[];function o(x){throw new Error("CSS parse error: ".concat(x))}function i(x){var E=x.exec(r);if(E)return r=r.slice(E[0].length),E}function a(){return i(/^{\s*/)}function l(){return i(/^}/)}function u(){i(/^\s*/)}function c(){if(u(),!(r[0]!=="/"||r[1]!=="*")){for(var x=2;r[x]&&(r[x]!=="*"||r[x+1]!=="/");)x++;if(!r[x])return o("end of comment is missing");var E=r.slice(2,x);return r=r.slice(x+2),{type:"comment",comment:E}}}function h(){for(var x=[],E;E=c();)x.push(E);return n.removeComments?[]:x}function d(){for(u();r[0]==="}";)o("extra closing bracket");var x=i(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(x){var E=x[0].trim(),N,X=/\/\*/.test(E);X&&(E=E.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var L=/["']\w*,\w*["']/.test(E);L&&(E=E.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(G){return G.replace(/,/g,"\u200C")}));var ne=/,/.test(E);return ne?N=E.split(/\s*(?![^(]*\)),\s*/):N=[E],L&&(N=N.map(function(G){return G.replace(/\u200C/g,",")})),N}}function g(){if(r[0]==="@")return O();i(/^([;\s]*)+/);var x=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,E=i(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(!!E){if(E=E[0].trim(),!i(/^:\s*/))return o("property missing ':'");var N=i(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),X={type:"declaration",property:E.replace(x,""),value:N?N[0].replace(x,"").trim():""};return i(/^[;\s]*/),X}}function m(){if(!a())return o("missing '{'");for(var x,E=h();x=g();)E.push(x),E=E.concat(h());return l()?E:o("missing '}'")}function f(){u();for(var x=[],E;E=i(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)x.push(E[1]),i(/^,\s*/);if(x.length)return{type:"keyframe",values:x,declarations:m()}}function p(){var x=i(/^@([-\w]+)?keyframes\s*/);if(!!x){var E=x[1];if(x=i(/^([-\w]+)\s*/),!x)return o("@keyframes missing name");var N=x[1];if(!a())return o("@keyframes missing '{'");for(var X,L=h();X=f();)L.push(X),L=L.concat(h());return l()?{type:"keyframes",name:N,vendor:E,keyframes:L}:o("@keyframes missing '}'")}}function b(){var x=i(/^@page */);if(x){var E=d()||[];return{type:"page",selectors:E,declarations:m()}}}function v(){var x=i(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(x){var E="".concat(x[1],"-").concat(x[2])+(x[3]?"-".concat(x[3]):"");return{type:"page-margin-box",name:E,declarations:m()}}}function w(){var x=i(/^@font-face\s*/);if(x)return{type:"font-face",declarations:m()}}function S(){var x=i(/^@supports *([^{]+)/);if(x)return{type:"supports",supports:x[1].trim(),rules:F()}}function T(){var x=i(/^@host\s*/);if(x)return{type:"host",rules:F()}}function D(){var x=i(/^@media([^{]+)*/);if(x)return{type:"media",media:(x[1]||"").trim(),rules:F()}}function R(){var x=i(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(x)return{type:"custom-media",name:x[1].trim(),media:x[2].trim()}}function I(){var x=i(/^@([-\w]+)?document *([^{]+)/);if(x)return{type:"document",document:x[2].trim(),vendor:x[1]?x[1].trim():null,rules:F()}}function y(){var x=i(/^@(import|charset|namespace)\s*([^;]+);/);if(x)return{type:x[1],name:x[2].trim()}}function O(){if(u(),r[0]==="@"){var x=y()||w()||D()||p()||S()||I()||R()||T()||b()||v();if(x&&!n.preserveStatic){var E=!1;if(x.declarations)E=x.declarations.some(function(X){return/var\(/.test(X.value)});else{var N=x.keyframes||x.rules||[];E=N.some(function(X){return(X.declarations||[]).some(function(L){return/var\(/.test(L.value)})})}return E?x:{}}return x}}function M(){if(!n.preserveStatic){var x=cp("{","}",r);if(x){var E=/:(?:root|host)(?![.:#(])/.test(x.pre)&&/--\S*\s*:/.test(x.body),N=/var\(/.test(x.body);if(!E&&!N)return r=r.slice(x.end+1),{}}}var X=d()||[],L=n.preserveStatic?m():m().filter(function(ne){var G=X.some(function(P){return/:(?:root|host)(?![.:#(])/.test(P)})&&/^--\S/.test(ne.property),Q=/var\(/.test(ne.value);return G||Q});return X.length||o("selector missing"),{type:"rule",selectors:X,declarations:L}}function F(x){if(!x&&!a())return o("missing '{'");for(var E,N=h();r.length&&(x||r[0]!=="}")&&(E=O()||M());)E.type&&N.push(E),N=N.concat(h());return!x&&!l()?o("missing '}'"):N}return{type:"stylesheet",stylesheet:{rules:F(!0),errors:s}}}function fp(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={parseHost:!1,store:{},onWarning:function(){}},n=pn({},t,e),s=new RegExp(":".concat(n.parseHost?"host":"root","$"));return typeof r=="string"&&(r=gh(r,n)),r.stylesheet.rules.forEach(function(o){o.type!=="rule"||!o.selectors.some(function(i){return s.test(i)})||o.declarations.forEach(function(i,a){var l=i.property,u=i.value;l&&l.indexOf("--")===0&&(n.store[l]=u)})}),n.store}function mp(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,n={charset:function(i){return"@charset "+i.name+";"},comment:function(i){return i.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+i.comment+"*/":""},"custom-media":function(i){return"@custom-media "+i.name+" "+i.media+";"},declaration:function(i){return i.property+":"+i.value+";"},document:function(i){return"@"+(i.vendor||"")+"document "+i.document+"{"+s(i.rules)+"}"},"font-face":function(i){return"@font-face{"+s(i.declarations)+"}"},host:function(i){return"@host{"+s(i.rules)+"}"},import:function(i){return"@import "+i.name+";"},keyframe:function(i){return i.values.join(",")+"{"+s(i.declarations)+"}"},keyframes:function(i){return"@"+(i.vendor||"")+"keyframes "+i.name+"{"+s(i.keyframes)+"}"},media:function(i){return"@media "+i.media+"{"+s(i.rules)+"}"},namespace:function(i){return"@namespace "+i.name+";"},page:function(i){return"@page "+(i.selectors.length?i.selectors.join(", "):"")+"{"+s(i.declarations)+"}"},"page-margin-box":function(i){return"@"+i.name+"{"+s(i.declarations)+"}"},rule:function(i){var a=i.declarations;if(a.length)return i.selectors.join(",")+"{"+s(a)+"}"},supports:function(i){return"@supports "+i.supports+"{"+s(i.rules)+"}"}};function s(o){for(var i="",a=0;a<o.length;a++){var l=o[a];t&&t(l);var u=n[l.type](l);u&&(i+=u,u.length&&l.selectors&&(i+=e))}return i}return s(r.stylesheet.rules)}function pp(r,e){r.rules.forEach(function(t){if(t.rules){pp(t,e);return}if(t.keyframes){t.keyframes.forEach(function(n){n.type==="keyframe"&&e(n.declarations,t)});return}!t.declarations||e(t.declarations,r)})}var Hw="--",Uw="var";function zw(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},n=pn({},t,e);return typeof r=="string"&&(r=gh(r,n)),pp(r.stylesheet,function(s,o){for(var i=0;i<s.length;i++){var a=s[i],l=a.type,u=a.property,c=a.value;if(l==="declaration"){if(!n.preserveVars&&u&&u.indexOf(Hw)===0){s.splice(i,1),i--;continue}if(c.indexOf(Uw+"(")!==-1){var h=Ni(c,n);h!==a.value&&(h=Ww(h),n.preserveVars?(s.splice(i,0,{type:l,property:u,value:h}),i++):a.value=h)}}}}),mp(r)}function Ww(r){var e=/calc\(([^)]+)\)/g;return(r.match(e)||[]).forEach(function(t){var n="calc".concat(t.split("calc").join(""));r=r.replace(t,n)}),r}function Ni(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;if(r.indexOf("var(")===-1)return r;var n=cp("(",")",r);function s(i){var a=i.split(",")[0].replace(/[\s\n\t]/g,""),l=(i.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],u=Object.prototype.hasOwnProperty.call(e.variables,a)?String(e.variables[a]):void 0,c=u||(l?String(l):void 0),h=t||i;return u||e.onWarning('variable "'.concat(a,'" is undefined')),c&&c!=="undefined"&&c.length>0?Ni(c,e,h):"var(".concat(h,")")}if(n)if(n.pre.slice(-3)==="var"){var o=n.body.trim().length===0;return o?(e.onWarning("var() must contain a non-whitespace string"),r):n.pre.slice(0,-3)+s(n.body)+Ni(n.post,e)}else return n.pre+"(".concat(Ni(n.body,e),")")+Ni(n.post,e);else return r.indexOf("var(")!==-1&&e.onWarning('missing closing ")" in the value "'.concat(r,'"')),r}var pl=typeof window!="undefined",_p=pl&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),Ls={group:0,job:0},_l={rootElement:pl?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},ar={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},It={dom:{},job:{},user:{}},bl=!1,Tn=null,ki=0,fh=null,mh=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function Yn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e="cssVars(): ",t=pn({},_l,r);function n(c,h,d,g){!t.silent&&window.console&&console.error("".concat(e).concat(c,`
`),h),t.onError(c,h,d,g)}function s(c){!t.silent&&window.console&&console.warn("".concat(e).concat(c)),t.onWarning(c)}function o(c){t.onFinally(Boolean(c),_p,ph()-t.__benchmark)}if(!!pl){if(t.watch){t.watch=_l.watch,Vw(t),Yn(t);return}else t.watch===!1&&Tn&&(Tn.disconnect(),Tn=null);if(!t.__benchmark){if(bl===t.rootElement){$w(r);return}var i=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(t.__benchmark=ph(),t.exclude=[Tn?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",t.exclude].filter(function(c){return c}).join(","),t.variables=Yw(t.variables),i.forEach(function(c){var h=c.nodeName.toLowerCase()==="style"&&c.__cssVars.text,d=h&&c.textContent!==c.__cssVars.text;h&&d&&(c.sheet&&(c.sheet.disabled=!1),c.setAttribute("data-cssvars",""))}),!Tn){var a=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars="out"]'));a.forEach(function(c){var h=c.getAttribute("data-cssvars-group"),d=h?t.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(h,'"]')):null;d||c.parentNode.removeChild(c)}),ki&&i.length<ki&&(ki=i.length,It.dom={})}}if(document.readyState!=="loading")if(_p&&t.onlyLegacy){var l=!1;if(t.updateDOM){var u=t.rootElement.host||(t.rootElement===document?document.documentElement:t.rootElement);Object.keys(t.variables).forEach(function(c){var h=t.variables[c];l=l||h!==getComputedStyle(u).getPropertyValue(c),u.style.setProperty(c,h)})}o(l)}else!mh&&(t.shadowDOM||t.rootElement.shadowRoot||t.rootElement.host)?up({rootElement:_l.rootElement,include:_l.include,exclude:t.exclude,skipDisabled:!1,onSuccess:function(h,d,g){var m=(d.sheet||{}).disabled&&!d.__cssVars;return m?!1:(h=h.replace(ar.cssComments,"").replace(ar.cssMediaQueries,""),h=(h.match(ar.cssVarDeclRules)||[]).join(""),h||!1)},onComplete:function(h,d,g){fp(h,{store:It.dom,onWarning:s}),mh=!0,Yn(t)}}):(bl=t.rootElement,up({rootElement:t.rootElement,include:t.include,exclude:t.exclude,skipDisabled:!1,onBeforeSend:t.onBeforeSend,onError:function(h,d,g){var m=h.responseURL||bp(g,location.href),f=h.statusText?"(".concat(h.statusText,")"):"Unspecified Error"+(h.status===0?" (possibly CORS related)":""),p="CSS XHR Error: ".concat(m," ").concat(h.status," ").concat(f);n(p,d,h,m)},onSuccess:function(h,d,g){var m=(d.sheet||{}).disabled&&!d.__cssVars;if(m)return!1;var f=d.nodeName.toLowerCase()==="link",p=d.nodeName.toLowerCase()==="style"&&h!==d.textContent,b=t.onSuccess(h,d,g);return h=b!==void 0&&Boolean(b)===!1?"":b||h,t.updateURLs&&(f||p)&&(h=Xw(h,g)),h},onComplete:function(h,d){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],m=pn({},It.dom,It.user),f=!1;if(It.job={},g.forEach(function(R,I){var y=d[I];if(R.__cssVars=R.__cssVars||{},R.__cssVars.text=y,ar.cssVars.test(y))try{var O=gh(y,{preserveStatic:t.preserveStatic,removeComments:!0});fp(O,{parseHost:Boolean(t.rootElement.host),store:It.dom,onWarning:s}),R.__cssVars.tree=O}catch(M){n(M.message,R)}}),pn(It.job,It.dom),t.updateDOM?(pn(It.user,t.variables),pn(It.job,It.user)):(pn(It.job,It.user,t.variables),pn(m,t.variables)),f=Ls.job>0&&Boolean(Object.keys(It.job).length>Object.keys(m).length||Boolean(Object.keys(m).length&&Object.keys(It.job).some(function(R){return It.job[R]!==m[R]}))),f)_h(t.rootElement),Yn(t);else{var p=[],b=[],v=!1;if(t.updateDOM&&Ls.job++,g.forEach(function(R,I){var y=!R.__cssVars.tree;if(R.__cssVars.tree)try{zw(R.__cssVars.tree,pn({},t,{variables:It.job,onWarning:s}));var O=mp(R.__cssVars.tree);if(t.updateDOM){var M=d[I],F=ar.cssVarFunc.test(M);if(R.getAttribute("data-cssvars")||R.setAttribute("data-cssvars","src"),O.length&&F){var x=R.getAttribute("data-cssvars-group")||++Ls.group,E=O.replace(/\s/g,""),N=t.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(x,'"]'))||document.createElement("style");v=v||ar.cssKeyframes.test(O),t.preserveStatic&&R.sheet&&(R.sheet.disabled=!0),N.hasAttribute("data-cssvars")||N.setAttribute("data-cssvars","out"),E===R.textContent.replace(/\s/g,"")?(y=!0,N&&N.parentNode&&(R.removeAttribute("data-cssvars-group"),N.parentNode.removeChild(N))):E!==N.textContent.replace(/\s/g,"")&&([R,N].forEach(function(X){X.setAttribute("data-cssvars-job",Ls.job),X.setAttribute("data-cssvars-group",x)}),N.textContent=O,p.push(O),b.push(N),N.parentNode||R.parentNode.insertBefore(N,R.nextSibling))}}else R.textContent.replace(/\s/g,"")!==O&&p.push(O)}catch(X){n(X.message,R)}y&&R.setAttribute("data-cssvars","skip"),R.hasAttribute("data-cssvars-job")||R.setAttribute("data-cssvars-job",Ls.job)}),ki=t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,t.shadowDOM){for(var w=[].concat(t.rootElement).concat([].slice.call(t.rootElement.querySelectorAll("*"))),S=0,T;T=w[S];++S)if(T.shadowRoot&&T.shadowRoot.querySelector("style")){var D=pn({},t,{rootElement:T.shadowRoot});Yn(D)}}t.updateDOM&&v&&Gw(t.rootElement),bl=!1,t.onComplete(p.join(""),b,JSON.parse(JSON.stringify(It.job)),ph()-t.__benchmark),o(b.length)}}}));else document.addEventListener("DOMContentLoaded",function c(h){Yn(r),document.removeEventListener("DOMContentLoaded",c)})}}Yn.reset=function(){Ls.job=0,Ls.group=0,bl=!1,Tn&&(Tn.disconnect(),Tn=null),ki=0,fh=null,mh=!1;for(var r in It)It[r]={}};function Vw(r){function e(l){var u=t(l)&&l.hasAttribute("disabled"),c=(l.sheet||{}).disabled;return u||c}function t(l){var u=l.nodeName.toLowerCase()==="link"&&(l.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return u}function n(l){return l.nodeName.toLowerCase()==="style"}function s(l){var u=!1;if(l.type==="attributes"&&t(l.target)&&!e(l.target)){var c=l.attributeName==="disabled",h=l.attributeName==="href",d=l.target.getAttribute("data-cssvars")==="skip",g=l.target.getAttribute("data-cssvars")==="src";c?u=!d&&!g:h&&(d?l.target.setAttribute("data-cssvars",""):g&&_h(r.rootElement,!0),u=!0)}return u}function o(l){var u=!1;if(l.type==="childList"){var c=n(l.target),h=l.target.getAttribute("data-cssvars")==="out";u=c&&!h}return u}function i(l){var u=!1;return l.type==="childList"&&(u=[].slice.call(l.addedNodes).some(function(c){var h=c.nodeType===1,d=h&&c.hasAttribute("data-cssvars"),g=n(c)&&ar.cssVars.test(c.textContent),m=!d&&(t(c)||g);return m&&!e(c)})),u}function a(l){var u=!1;return l.type==="childList"&&(u=[].slice.call(l.removedNodes).some(function(c){var h=c.nodeType===1,d=h&&c.getAttribute("data-cssvars")==="out",g=h&&c.getAttribute("data-cssvars")==="src",m=g;if(g||d){var f=c.getAttribute("data-cssvars-group"),p=r.rootElement.querySelector('[data-cssvars-group="'.concat(f,'"]'));g&&_h(r.rootElement,!0),p&&p.parentNode.removeChild(p)}return m})),u}!window.MutationObserver||(Tn&&(Tn.disconnect(),Tn=null),Tn=new MutationObserver(function(l){var u=l.some(function(c){return s(c)||o(c)||i(c)||a(c)});u&&Yn(r)}),Tn.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function $w(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(fh),fh=setTimeout(function(){r.__benchmark=null,Yn(r)},e)}function Gw(r){var e=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(d){return getComputedStyle(document.body)[d]})[0];if(e){for(var t=[].slice.call(r.querySelectorAll("*")),n=[],s="__CSSVARSPONYFILL-KEYFRAMES__",o=0,i=t.length;o<i;o++){var a=t[o],l=getComputedStyle(a)[e];l!=="none"&&(a.style[e]+=s,n.push(a))}document.body.offsetHeight;for(var u=0,c=n.length;u<c;u++){var h=n[u].style;h[e]=h[e].replace(s,"")}}}function Xw(r,e){var t=r.replace(ar.cssComments,"").match(ar.cssUrls)||[];return t.forEach(function(n){var s=n.replace(ar.cssUrls,"$1"),o=bp(s,e);r=r.replace(n,n.replace(s,o))}),r}function Yw(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=/^-{2}/;return Object.keys(r).reduce(function(t,n){var s=e.test(n)?n:"--".concat(n.replace(/^-+/,""));return t[s]=r[n],t},{})}function bp(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e,s.href=r,s.href}function ph(){return pl&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function _h(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=[].slice.call(r.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));t.forEach(function(n){return n.setAttribute("data-cssvars","")}),e&&(It.dom={})}var vl={contextMenu:"univer-context-menu",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",btn:"univer-btn",rightMenuCenter:"univer-right-menu-center",rightMenuItem:"univer-right-menu-item"};class vp extends Oe{constructor(){super(...arguments),this.ulRef=Ae(),this.root=Ae(),this.handleContextMenu=async(e,t,n)=>{e.preventDefault(),this.setState({visible:!0,srcElement:e.target,eventType:e.type},()=>{new Promise((s,o)=>{this.ulRef.current.showMenu(!0),s()}).then(()=>{const s=n?t.x:e.clientX,o=n?t.y:e.clientY,i=window.innerWidth,a=window.innerHeight,l=this.ulRef.current.base.offsetWidth,u=this.ulRef.current.base.offsetHeight,c=i-s>l,h=!c,d=a-o>u,g=!d;c&&(this.root.current.style.left=`${s}px`),h&&(this.root.current.style.left=`${s-l}px`),d&&(this.root.current.style.top=`${o}px`),g&&(this.root.current.style.top=`${o-u}px`)})})},this.handleClick=e=>{const{visible:t,eventType:n,srcElement:s}=this.state;!this.root.current||n==="click"&&s&&s.contains(e.target)||this.root.current.contains(e.target)||t&&this.setState({visible:!1})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={visible:!1,srcElement:null,eventType:null,children:[]}}resetMenuList(e){var n;const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);for(let s=0;s<e.length;s++){const o=e[s];if(o.customLabel){const i=t.getRegisterComponent(o.customLabel.name),a=(n=o.customLabel.props)!=null?n:{};i&&(o.label=_(i,{...a}))}o.children&&(o.children=this.resetMenuList(o.children))}return e}setMenuList(e){this.setState({children:this.resetMenuList(e)})}componentDidMount(){var e;document.addEventListener("click",this.handleClick),(e=this._context.getObserverManager().getObserver("onRightMenuDidMountObservable",Pe.SPREADSHEET))==null||e.notifyObservers(this)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}showRightMenu(e){this.ulRef.current.showMenu(e)}render(){if(!this.state.children.length)return;const e={...this.props.style},{visible:t}=this.state,n=this._render.renderFunction("Menu");return t&&_("div",{ref:this.root,className:vl.contextMenu,style:e,onContextMenu:s=>{s.preventDefault()}},_(n,{ref:this.ulRef,menu:this.state.children,onClick:this.handleClick}))}}class Ps extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,children:t}=this.props,n=this._render.renderFunction("Button");return _("div",null,e,t.map(s=>_(n,{type:"primary"},s.label)))}}class Fr extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}handleClick(e){e.stopPropagation()}handleKeyUp(e){const{onKeyUp:t}=this.props;t==null||t(e)}render(){const{prefix:e,suffix:t}=this.props,n=this._render.renderFunction("Input");return _("div",null,e,_(n,{onKeyUp:this.handleKeyUp.bind(this),type:"number",placeholder:"1",onClick:this.handleClick}),t)}}class Fo extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e}=this.props,t=this._render.renderFunction("RightIcon");return _("div",{className:vl.rightMenuItem},e,_(t,null))}}class Cl extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,options:t}=this.props,n=this._render.renderFunction("Input");return _("div",null,_("div",null,e),_("select",null,t.map(s=>_("option",null,s.label))),_(n,{type:"number",placeholder:"2"}))}}var El={infoDetail:"univer-info-detail",infoReturn:"univer-info-return",univericon:"univer-univericon",univericonLogo:"univer-univericon-logo",sheetName:"univer-sheet-name",infoDetailUpdate:"univer-info-detail-update",infoDetailSave:"univer-info-detail-save"};class jw extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Pe.SPREADSHEET))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;this._render.renderFunction("Button");const e=this._render.renderFunction("Container"),t=this._render.renderFunction("Input"),n=this._render.renderFunction("Tooltip");this._render.renderFunction("DropDownIcon"),this._render.renderFunction("LogoIcon");const{back:s,sheet:o,update:i,save:a,rename:l}=this.state.infoList;return _(e,{className:El.infoDetail},_("div",{className:El.sheetName},_(n,{title:l.label,placement:"bottom"},_(t,{bordered:!1,value:o.label,onBlur:o.onBlur}))),_("div",{className:El.infoDetailUpdate},i.label),_("div",{className:El.infoDetailSave},a.label))}}var os={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},Kw={textButton:"univer-text-button"};class Zw extends Oe{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={active:this.props.active}}componentWillReceiveProps(e,t){e.active!==this.props.active&&this.setState({active:e.active})}render(){const{label:e}=this.props,{active:t}=this.state,n=this._render.renderFunction("Button");return _("div",{className:Kw.textButton},_(n,{type:"text",active:t,onClick:this.handleClick},e))}}var Nt={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectDoubleString:"univer-select-double-string",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",selectLineBoldParent:"univer-select-line-bold-parent",univericonNextIcon:"univer-univericon-nextIcon",moreButton:"univer-more-button",moreTool:"univer-more-tool"};class qw extends Oe{constructor(){super(...arguments),this.toolbarRef=Ae(),this.moreBtnRef=Ae(),this.moreToolRef=Ae(),this.SelectRef=Ae(),this.clientWidth=0,this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.debounceSetToolbarListWidth=es(()=>{this.setToolbarListWidth()},50),this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${Nt.toolbarWarp} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,s=null;const o=document.documentElement.clientWidth;if(o<=this.clientWidth){this.clientWidth=o;for(let i=0;i<e.length;i++)if(n+=e[i].clientWidth+6,n>o){s=i;break}s!==null&&this.setState({defaultToolList:this.state.toolList.slice(0,s),moreToolList:s?this.state.toolList.slice(s):[]},()=>{this.resetUl(),this.forceUpdate()})}else if(this.clientWidth=o,this.state.moreToolList.length){let i=30+t;for(let c=0;c<e.length;c++)i+=e[c].clientWidth+6;const a=this.moreToolRef.current.querySelectorAll(`.${Nt.moreTool} > div`);let l=null,u=!1;for(let c=0;c<a.length;c++)if(i+=a[c].clientWidth+6,i>o){l=c;break}else c===a.length-1&&(l=c,u=!0);l!==null&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,u?l+1:l)),moreToolList:u?[]:this.state.moreToolList.slice(l)},()=>{this.resetUl(),this.forceUpdate()})}},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);for(let o=0;o<e.length;o++){const i=e[o];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=_(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=_(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=(e,t)=>{e=this.resetLabel(e),this.setState({toolList:e,defaultToolList:e,moreText:t},()=>{this.setToolbarListWidth()})},this.resetUl=()=>{var s;const t=`${((s=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET))==null?void 0:s.getSheetContainerControl().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let o=0;o<n.length;o++)n[o].style.maxHeight=t}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[],moreText:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolBarList(e){const t=this._render.renderFunction("Tooltip");return e.map(n=>{if(n.toolbarType){if(n.show)return _(t,{title:n.tooltip,placement:"bottom"},_(Zw,{active:n.active,label:n.label,onClick:n.onClick}))}else if(n.show)return _(ul,{tooltip:n.tooltip,type:n.type,display:n.display,children:n.children,customLabel:n.customLabel,customSuffix:n.customSuffix,label:n.label,onClick:n.onClick,onKeyUp:n.onKeyUp,defaultColor:n.defaultColor,hideSelectedIcon:n.hideSelectedIcon,className:n.className});return null})}render(){const{defaultToolList:e,moreToolList:t,moreText:n,showMore:s}=this.state,o=this._render.renderFunction("Button"),i=this._render.renderFunction("Container"),a=this._render.renderFunction("Tooltip");return _(i,{style:{position:"relative"}},_("div",{className:`${Nt.toolbarWarp} ${Nt.toolbar}`,ref:this.toolbarRef},this.getToolBarList(e),_("div",{ref:this.moreBtnRef,className:Nt.moreButton,style:{visibility:t.length?"visible":"hidden"}},_(a,{title:n.tip,placement:"bottom"},_(o,{type:"text",onClick:this.showMore},_("div",{style:{fontSize:"14px"}},n.more))))),t.length?_("div",{style:{visibility:s?"visible":"hidden"},className:`${Nt.moreTool} ${Nt.toolbar}`,ref:this.moreToolRef},this.getToolBarList(t)):"")}}var wl={countBar:"univer-count-bar",btn:"univer-btn",countZoom:"univer-count-zoom",countSlider:"univer-count-slider",countStatistic:"univer-count-statistic"};class Jw extends Oe{constructor(){super(...arguments),this.max=400,this.min=0,this.ref=Ae(),this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.onChange=e=>{let t=e.target;this.state.onChange&&this.state.onChange(t.value),this.setValue({zoom:t.value}),console.log(t.value),this.ref.current.changeInputValue(0,t.value)},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let t=(Math.floor(this.state.zoom/10)+1)*10;t>=this.max&&(t=this.max),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t))},this.reduceZoom=()=>{let t=(Math.ceil(this.state.zoom/10)-1)*10;t<=this.min&&(t=this.min),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t)),this.ref.current.changeInputValue(0,t)}}initialize(e){this.state={zoom:100,content:""}}setZoom(e){e!==this.state.zoom&&(this.setValue({zoom:e}),this.ref.current.changeInputValue(0,e))}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCountBarDidMountObservable",Pe.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{zoom:n,content:s}=t,o=this.getComponentRender().renderFunction("ReduceIcon"),i=this.getComponentRender().renderFunction("RegularIcon"),a=this.getComponentRender().renderFunction("Slider"),l=this.getComponentRender().renderFunction("Button"),u=this.getComponentRender().renderFunction("AddIcon");return _("div",{className:wl.countBar},_(l,{type:"text",className:wl.countZoom},n),_(l,{type:"text",onClick:this.addZoom},_(u,null)),_("div",{className:wl.countSlider},_(a,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),_(l,{type:"text",onClick:this.reduceZoom},_(o,null)),_(l,{type:"text"},_(i,null)),_("span",{className:wl.countStatistic},s))}}class Qw extends Oe{constructor(){super(...arguments),this.refs=[]}initialize(){this.state={modalGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onModalGroupDidMountObservable"))==null||e.notifyObservers(this)}setModalGroup(e){const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET),n=e.map((s,o)=>{const i=t==null?void 0:t.getRegisterComponent(s);return i?_(i,{ref:a=>this.refs[o]=a}):null});this.setState({modalGroup:n})}getModalGroup(){return this.refs}render(){const{modalGroup:e}=this.state;return _(Rt,null,e.map(t=>t))}}class eT extends Oe{initialize(){this.state={sideGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSideGroupDidMountObservable"))==null||e.notifyObservers(this)}setSideGroup(e){const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET),n=e.map(s=>{const o=t==null?void 0:t.getRegisterComponent(s.name);return o&&(s.side=_(o,null)),s});this.setState({sideGroup:n})}render(){const{sideGroup:e}=this.state;return _("div",null,e.map(t=>t.show?_("div",{onClick:()=>t.onClick(t.name),style:{zIndex:t.zIndex}},t.side):_(Rt,null)))}}class tT{constructor(e){const t=e.primeval();this._scrollX=t.scrollLeft,this._slideTabBar=e}scrollX(e){const t=this._slideTabBar.primeval();t.scrollLeft=e,this._scrollX=t.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const nT={easeOutStrong(r,e,t,n){return-t*((r=r/n-1)*r*r*r-1)+e},backOut(r,e,t,n,s){return typeof s=="undefined"&&(s=.7),t*((r=r/n-1)*r*((s+1)*r+s)+1)+e}},rT={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(r){},success(r){},cancel(r){},complete(r){}};class sT{static success(...e){let t=0;return new Promise(n=>{for(let s=0;s<e.length;s++){let o=e[s],i=o._config,a=i.success;i.loop||(i.success=u=>{t++,a&&a.call(o,u),t===e.length&&n()})}})}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;let n=nT[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(n),this._status===1){this._config.cancel(n),this._config.complete(n);return}if(e===this._config.duration){this._config.success(n),this._config.complete(n);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}constructor(e){this._config={...rT,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}}class Mr{static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static make(e,t){let n=[];return e.forEach(s=>n.push(new Mr(s,t))),n}constructor(e,t){this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=t,this._placeholder=null,this._scrollbar=t.getScrollbar(),this.update()}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}primeval(){return this._slideTabItem}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}editor(e){if(this._editMode===!1){let t=this.primeval().querySelector("span"),n=o=>{this._editMode=!1,t&&(t.removeAttribute("contentEditable"),t.removeEventListener("blur",n),t.removeEventListener("input",s)),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName&&this._slideTabBar.getConfig().onChangeName(o),e&&e(o)},s=()=>{if(t){const o=t.querySelectorAll("br");o.length>0&&(o.forEach(i=>{t&&t.removeChild(i)}),t.blur())}};t&&(t.setAttribute("contentEditable","true"),t.addEventListener("blur",n),t.addEventListener("input",s),this._editMode=!0,Tl.keepLastIndex(t))}}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new sT({begin:this._translateX,end:e,receive:t=>{this._slideTabItem.style.transform=`translateX(${t}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=Mr.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("box-shadow"),this._slideTabItem.style.removeProperty("background"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),t=this.getBoundingRect();this._placeholder=e,this._placeholder.style.width=`${t.width}px`,this._placeholder.style.height=`${t.height}px`,this._placeholder.style.flexShrink="0",this._slideTabItem.style.left=`${t.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${t.y}px`,this._slideTabItem.style.width=`${t.width}px`,this._slideTabItem.style.height=`${t.height}px`,this._slideTabItem.style.background=getComputedStyle(this._slideTabItem).background,this._slideTabItem.style.boxShadow="0px 0px 1px 1px rgba(82,82,82,0.1)",this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,t,n){this._slideTabItem.addEventListener(e,t,n)}removeEventListener(e,t,n){this._slideTabItem.removeEventListener(e,t,n)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=Mr.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}}class Tl{static checkedSkipSlide(e){let t=e.target;for(;t!=null&&t!==document.body;){if(t.getAttribute("data-slide-skip"))return!0;t=t.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{const t=window.getSelection();t&&(t.selectAllChildren(e),t.collapseToEnd())})}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s<n&&(this._scrollIncremental=-Math.min(Math.abs(s-n)*.1,50))}_scrollRight(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s>t.width-n&&(this._scrollIncremental=Math.min(Math.abs(s-(t.width-n))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){let t=this._slideTabItems[e],n=this._slideTabItems[e+1];n&&t.after(n)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let o=0;o<e&&!(o>=e);o++)n.push(this._slideTabItems[o]);for(let o=e+1;o<t;o++)this._slideTabItems[o].animate().translateX(0);let s=!0;for(let o=n.length-1;o>=0;o--){let i=n[o];Mr.midline(this._activeTabItem)<i.getMidLine()?(i.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=o,s=!1):(i.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let o=e+1;o<t;o++)n.push(this._slideTabItems[o]);for(let o=0;o<e;o++)this._slideTabItems[o].animate().translateX(0);let s=!0;for(let o=0;o<n.length;o++){let i=n[o];Mr.midline(this._activeTabItem)>i.getMidLine()?(i.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+o+1,s=!1):(i.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_initialize(){document.addEventListener("mousemove",this._moveAction),document.addEventListener("mouseup",this._upAction),this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("mousedown",this._downAction)})}constructor(e){var a,l;if(e.slideTabRoot==null)throw new Error("not found slide-tab-bar root element");const t=e.slideTabRoot.querySelector(`.${(a=e.slideTabBarClassName)!=null?a:"slide-tab-bar"}`),n=e.slideTabRoot.querySelectorAll(`.${(l=e.slideTabBarItemClassName)!=null?l:"slide-tab-item"}`);if(t==null)throw new Error("not found slide-tab-bar");this._config=e,this._activeTabItem=null,this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._activeTabItemIndex=0,this._slideTabBar=t,this._slideScrollbar=new tT(this),this._slideTabItems=Mr.make(n,this);let s=0,o=0,i=0;this._downAction=u=>{var p;if(u.button===2){s=0,i=0,o=0;return}const{pageX:c,pageY:h}=u,d=Date.now();if(d-i<=800&&c===s&&h===o){const b=this._slideTabItems.find(v=>v.equals(new Mr(u.currentTarget,this)));b&&b.editor(),i=0,s=0,o=0}else{if(!this._hasEditItem()){if(Tl.checkedSkipSlide(u)){s=0,i=0,o=0;return}const b=this._slideTabItems.findIndex(v=>v.equals(new Mr(u.currentTarget,this)));b>-1?(this._compareIndex=b,this._downActionX=u.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[b],this._activeTabItemIndex=b,this._config.activeClassNameAutoController&&(this._slideTabItems.forEach(v=>{var w;v.classList().remove((w=this._config.slideTabBarItemActiveClassName)!=null?w:"slide-tab-active")}),this._activeTabItem.classList().add((p=this._config.slideTabBarItemActiveClassName)!=null?p:"slide-tab-active")),this._activeTabItem.enableFixed(),this._startAutoScroll()):(this.updateItems(),this._activeTabItemIndex=0,this._downActionX=0,this._scrollIncremental=0,this._compareIndex=0,this._activeTabItem=null)}s=c,o=h,i=d}},this._upAction=u=>{if(this._activeTabItem){this._closeAutoScroll(),this._activeTabItem.disableFixed(),this._sortedItems(),this.updateItems(),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&this._config.onSlideEnd(u);let c=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this._activeTabItem.primeval().dispatchEvent(c),this._scrollIncremental=0,this._activeTabItemIndex=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null}},this._moveAction=u=>{this._activeTabItem&&(this._moveActionX=u.pageX-this._downActionX,this._scrollIncremental=0,this._scrollLeft(u),this._scrollRight(u))},this._wheelAction=u=>{u.deltaY>0?this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+u.deltaY):this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+u.deltaY)},this._initialize()}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}destroy(){document.removeEventListener("mousemove",this._moveAction),document.removeEventListener("mouseup",this._upAction),document.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("mousedown",this._downAction)})}}var Gt={sheetBar:"univer-sheet-bar",sheetBarOptions:"univer-sheet-bar-options",sheetBarOptionsButton:"univer-sheet-bar-options-button",sheetBarScrollButton:"univer-sheet_bar_scroll_button",slideTabBar:"univer-slide-tab-bar",slideTabActive:"univer-slide-tab-active",slideTabItem:"univer-slide-tab-item",slideTabDivider:"univer-slide-tab-divider",slideTabContent:"univer-slide-tab-content",slideTabTitle:"univer-slide-tab-title",slideTabIcon:"univer-slide-tab-icon",slideTabFooter:"univer-slide-tab-footer",slideTabActiveBar:"univer-slide-tab-active-bar"};class oT extends Oe{constructor(){super(...arguments),this.ref=Ae(),this.ulRef=Ae(),this.sheetContainerRef=Ae(),this.slideTabRoot=Ae(),this.sheetContentRef=Ae(),this.sheetBarContentRef=Ae(),this._renderKey=1,this.setValue=(e,t)=>{const{sheetList:n,menuList:s,sheetUl:o}=e;n&&this.jointJsx(n),s&&this.jointJsx(s),o&&this.jointJsx(o),this.setState(i=>({...e}),t)},this.scrollLeft=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()-50)},this.scrollRight=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()+50)},this.overGrid=()=>{},this.contextMenu=e=>{e.preventDefault(),this.showUlList(e)},this.showSelect=(e,t)=>{e.stopImmediatePropagation();const n=t.current;n&&n.showSelect(),window.addEventListener("click",this.hideSelect)},this.hideSelect=e=>{const t=this.ref.current,n=this.ulRef.current;t&&t.hideSelect(),n&&n.hideSelect(),window.removeEventListener("click",this.hideSelect)},this.showUlList=e=>{new Promise(t=>{e.currentTarget.dataset.id,this.showSelect(e,this.ulRef),t()}).then(()=>{const t=e.currentTarget.closest(`.${Gt.slideTabItem}`);if(t){const n=t.getBoundingClientRect(),s=`${n.left}px`,o=`${n.height}px`,i=this.ulRef.current.ulRef.current;i.style.left=s,i.style.bottom=o,i.style.top="auto",i.style.right="auto"}})},this.reNameSheet=e=>{const t=this.slideTabBar.getSlideTabItems().find(n=>n.primeval().dataset.id===e);t&&t.editor()},this.changeEditable=e=>{const t=e.target;let n;t.contentEditable="true",t.focus(),t.addEventListener("blur",n=s=>{this.state.changeSheetName&&this.state.changeSheetName(e),t.contentEditable="false",t.removeEventListener("blur",n)})},this.time=0,this.target=null,this.cloneTarget=null}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={sheetList:[],sheetUl:[],menuList:[],addSheet:null,contextMenu:null,selectSheet:null,changeSheetName:null,dragEnd:null}}jointJsx(e){e.forEach(t=>{if(t.icon&&typeof t.icon=="string"&&/Icon$/.test(t.icon)){const n=this._render.renderFunction(t.icon);t.icon=_(n,null)}if(t.selectType&&t.selectType==="jsx"){const n=this._render.renderFunction(t.label);t.label=_(n,{style:{visibility:"visible",marginTop:"-60px",marginLeft:"-50px"},onClick:s=>{t.onClick(s)}})}t.children&&t.children.length>0&&this.jointJsx(t.children)})}componentWillUnmount(){}componentDidUpdate(){this.slideTabBar&&this.slideTabBar.destroy(),this.slideTabBar=new Tl({slideTabBarClassName:"univer-slide-tab-bar",slideTabBarItemActiveClassName:"univer-slide-tab-active",slideTabBarItemClassName:"univer-slide-tab-item",slideTabBarItemAutoSort:!0,slideTabRoot:this.slideTabRoot.current,onChangeName:e=>{this.state.changeSheetName&&this.state.changeSheetName(e)},onSlideEnd:e=>{this.state.dragEnd&&this.state.dragEnd(this.slideTabBar.getSlideTabItems().map(t=>t.primeval()))}})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSheetBarDidMountObservable",Pe.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{sheetList:n,menuList:s,sheetUl:o,addSheet:i,contextMenu:a,selectSheet:l}=t;if(!i||!l||!a)return;const u=this._render.renderFunction("Button"),c=this._render.renderFunction("Ul"),h=this._render.renderFunction("AddIcon"),d=this._render.renderFunction("MenuIcon"),g=this._render.renderFunction("NextIcon");return _("div",{className:Gt.sheetBar,ref:this.slideTabRoot},_("div",{className:Gt.sheetBarOptions},_(u,{className:Gt.sheetBarOptionsButton,onClick:i,type:"text"},_(h,{style:{fontSize:"20px"}})),_(u,{className:Gt.sheetBarOptionsButton,onClick:m=>this.showSelect(m,this.ref),type:"text"},_(d,{style:{fontSize:"20px"}}),_(c,{onClick:l,children:s,ref:this.ref,style:{bottom:"2.2rem",left:"0"}}))),_("div",{className:Gt.slideTabBar,ref:this.sheetContainerRef},n.map(m=>_("div",{onMouseDown:m.onDown,onClick:m.onClick,onContextMenu:a,"data-id":m.sheetId,key:this._renderKey++,className:`${Gt.slideTabItem} ${m.selected?Gt.slideTabActive:""}`},_("div",{className:`${Gt.slideTabContent}`},_("div",{className:`${Gt.slideTabDivider}`}),_("div",{className:`${Gt.slideTabTitle}`},_("span",{style:{padding:"2px 5px 2px 5px"}},m.label)),_("div",{className:`${Gt.slideTabIcon}`,"data-slide-skip":"true",style:{lineHeight:1},"data-id":m.sheetId,onClick:a},m.icon)),_("div",{className:`${Gt.slideTabFooter}`},_("div",{className:`${Gt.slideTabActiveBar}`,style:m.color?{background:m.color}:{}}))))),_(c,{children:o,ref:this.ulRef}),_("div",{className:`${Gt.sheetBarOptions} ${Gt.sheetBarScrollButton}`},_(u,{type:"text",className:Gt.sheetBarOptionsButton,onClick:this.scrollLeft},_(g,{rotate:90,style:{padding:"5px"}})),_(u,{type:"text",className:Gt.sheetBarOptionsButton,onClick:this.scrollRight},_(g,{rotate:-90,style:{padding:"5px"}}))))}}class iT extends Oe{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=Ae(),this.contentRef=Ae(),this.layoutContainerRef=Ae(),this.handleSplitBarMouseDown=n=>{var o,i,a,l,u;this.leftContentLeft=(o=this.splitLeftRef.current)==null?void 0:o.getBoundingClientRect().left,this.leftContentTop=(i=this.splitLeftRef.current)==null?void 0:i.getBoundingClientRect().top;const s=(a=this.splitLeftRef.current)==null?void 0:a.parentElement;this.rightBorderX=(l=s==null?void 0:s.getBoundingClientRect())==null?void 0:l.width,this.rightBorderY=(u=s==null?void 0:s.getBoundingClientRect())==null?void 0:u.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=n=>{n=n||window.event;let s=n.clientX-this.leftContentLeft,o=n.clientY-this.leftContentTop;s=s>=this.rightBorderX?this.rightBorderX:s,o=o>=this.rightBorderY?this.rightBorderY:o,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${o}px`:this.splitLeftRef.current.style.width=`${s}px`},this.handleSplitBarMouseUp=n=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)};const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={layout:{},currentLocale:"",currentSkin:e.config.skin},this.changeSkin(e.config.container,e.config.skin)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}getLayoutContainerRef(){return this.layoutContainerRef}handleChangeSkin(e){const{changeSkin:t}=this.props,s=e.target.value;this.setState({currentSkin:s},()=>{this.changeSkin(this.props.config.container,s)}),t()}changeSkin(e,t){let n=document.documentElement,o={default:uh,dark:ch,green:hh}[t];o=Object.fromEntries(Object.keys(o).map(l=>[`--${l.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,o[l]])),W.isIEBrowser()?Yn({rootElement:n,variables:o}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(o).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const u="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===u)return a(document.styleSheets[d],l),document.styleSheets[d];const c=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=u,c.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,u){let c=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${u}`){c=h,l.deleteRule(c);break}}}}setLocale(e){const{changeLocale:t}=this.props,s=e.target.value;this.setState({currentLocale:s},()=>{t(s)})}componentDidMount(){var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Pe.SPREADSHEET).getObserver("onSheetContainerDidMountObservable"))==null||e.notifyObservers(this)}render(){const{context:e}=this.props.config,{layout:t,currentLocale:n,currentSkin:s}=this.state;return _(Eo.Provider,{value:{coreContext:e}},_(Fn,{ref:this.layoutContainerRef,className:os.layoutContainer},_(Gn,null,_(mn,{style:{display:t.outerLeft?"block":"none"}}),_(Gn,{className:os.mainContent,style:{position:"relative"}},_(Ii,{style:{display:t.header?"block":"none"}},t.infoBar&&_(jw,null),t.toolBar&&_(qw,{toolList:[]}),t.formulaBar&&_(U1,null)),_(Gn,null,_(mn,{style:{display:t.innerLeft?"block":"none"}}),_(Di,{className:t.contentSplit==="vertical"?os.contentContainerVertical:os.contentContainerHorizontal},_(Qw,null),!!t.contentSplit&&_(Fn,{ref:this.splitLeftRef,className:os.contentInnerLeftContainer},_("div",{className:os.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),_(Fn,{ref:this.contentRef,className:os.contentInnerRightContainer},_(vp,null),_("div",{style:{position:"fixed",right:"200px",top:"10px",fontSize:"14px"}},_("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u76AE\u80A4"),_("select",{value:s,onChange:this.handleChangeSkin.bind(this),style:{width:55}},_("option",{value:"default"},"\u9ED8\u8BA4"),_("option",{value:"dark"},"\u6697\u9ED1"),_("option",{value:"green"},"\u7EFF\u8272")),_("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u8BED\u8A00"),_("select",{value:n,onChange:this.setLocale.bind(this),style:{width:55}},_("option",{value:"en"},"English"),_("option",{value:"zh"},"\u4E2D\u6587"))))),_(mn,{style:{display:t.innerRight?"block":"none"}},_(eT,null))),_(xi,{style:{display:t.footer?"block":"none"}},t.sheetBar&&_(oT,null),t.countBar&&_(Jw,null))),_(mn,{style:{display:t.outerRight?"block":"none"},className:os.outerRightContainer}))))}}class Cp{_removeAntLineModelBySheetId(e){const t=this._antLineModelList.findIndex(n=>n.getSheetId()!==e);t>-1&&this._antLineModelList.splice(t,1)}_findAntLineModelBySheetId(e,t){var n;return(n=this._antLineModelList.find(s=>s.getSheetId()===e))!=null?n:t}_saveOrUpdateAntLineModel(e){for(let t=0;t<this._antLineModelList.length;t++)if(this._antLineModelList[t].getSheetId()===e.getSheetId()){this._antLineModelList[t]=e;return}this._antLineModelList.push(e)}_createAntLineRectBySheetIdAndRange(e,t){let s=this.getWorkBook().getSheetBySheetId(e);if(s==null)throw new Error(`not found sheet from id: ${e}`);let o=s.getConfig().rowTitle.width,i=s.getConfig().columnTitle.height,a=s.getRowManager(),l=s.getColumnManager(),u=0,c=0;for(let g=t.startRow;g<t.endRow;g++)u+=a.getRowHeight(g);for(let g=t.startColumn;g<t.endColumn;g++)c+=l.getColumnWidth(g);let h=0,d=0;for(let g=0;g<=t.startRow-1;g++)d+=a.getRowHeight(g);for(let g=0;g<=t.startColumn-1;g++)h+=l.getColumnWidth(g);return new tt("__AntLineShape__",{stroke:"red",strokeWidth:2,left:h+o,top:d+i,height:u,width:c,strokeDashArray:[5]})}_deleteSceneAllAntLineRect(){for(let e=0;e<this._antLineModelList.length;e++){let n=this._antLineModelList[e].getAntLineList();for(let s=0;s<n.length;s++){let i=n[s].getRect();i&&this.getSheetViewScene().removeObject(i)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e],n=t.getAntLineList();if(t.getSheetId()===this._activeSheetId)for(let s=0;s<n.length;s++){let o=n[s],i=this._createAntLineRectBySheetIdAndRange(t.getSheetId(),o.getRange());o.setRect(i),console.log(i),this.getSheetViewScene().addObject(i)}}}constructor(e){this._plugin=e,this._antLineModelList=[],e.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}),e.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})}removeSheetAntLine(e=this._activeSheetId){this._removeAntLineModelBySheetId(e),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(e,t=this._activeSheetId){const n=this._findAntLineModelBySheetId(t,new rp(t));n.addAntLine(new np(e)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}}class Ep{constructor(e){this._plugin=e,this._initialize()}_initialize(){var e,t;(e=this._plugin.getObserver("onSheetContainerDidMountObservable"))==null||e.add(n=>{var s;this._initRegisterComponent(),this._sheetContainer=n,this._initRegisterComponent(),(s=this._plugin.getObserver("onRichTextDidMountObservable"))==null||s.add(o=>{this.richTextEle=ts(o.container),this.richTextEditEle=Rr("div",this.richTextEle),this.richText=o,this.hideEditContainer(),this._keyboardManager.handleKeyboardAction(this.richTextEditEle),this._handleKeyboardObserver(),this.richText.hooks.set("onKeyDown",i=>{var a;(a=this._plugin.getObserver("onRichTextKeyDownObservable"))==null||a.notifyObservers(i)}),this.richText.hooks.set("onKeyUp",i=>{var a;(a=this._plugin.getObserver("onRichTextKeyUpObservable"))==null||a.notifyObservers(i)})})}),(t=this._plugin.context.getObserverManager().getObserver("onSheetRenderDidMountObservable","core"))==null||t.add(n=>{const s=this._plugin.getMainComponent();s.onDblclickObserver.add(o=>{o.button!==2&&this.enterEditMode()}),s.onPointerDownObserver.add(o=>{this.exitEditMode(),o.preventDefault()})}),this._cellEditExtensionManager=new Ns,this._keyboardManager=new um(this._plugin)}_initRegisterComponent(){this._plugin.registerModal(`${Pe.SPREADSHEET+xo.name}cell`,xo),this._plugin.registerModal(`${Pe.SPREADSHEET+xo.name}formula`,xo)}_handleKeyboardObserver(){const e=this._plugin.getContext().getObserverManager().getObserver("onKeyDownObservable","core"),t=this._plugin.getContext().getObserverManager().getObserver("onKeyCompositionStartObservable","core");e&&!e.hasObservers()&&e.add(n=>{if(!n.ctrlKey&&ff(n.key))this.enterEditMode(!0);else switch(n.key){case"Enter":if(this.isEditMode){this.exitEditMode();const s=this._plugin.getSelectionManager().getCurrentCellModel();s!=null&&s.isMerged||this._plugin.getSelectionManager().move(ee.BOTTOM)}else this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode(!0);break;case"ArrowUp":this.isEditMode||this._plugin.getSelectionManager().move(ee.TOP);break;case"ArrowDown":this.isEditMode||this._plugin.getSelectionManager().move(ee.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._plugin.getSelectionManager().move(ee.LEFT);break;case"ArrowRight":this.isEditMode||this._plugin.getSelectionManager().move(ee.RIGHT);break;case"Tab":this.isEditMode||this._plugin.getSelectionManager().move(ee.RIGHT),n.preventDefault();break}}),t&&!t.hasObservers()&&t.add(n=>{this.isEditMode||this.enterEditMode(!0)})}hideEditContainer(){this.richTextEle.style.maxHeight="1px",this.richTextEle.style.maxWidth="1px",this.richTextEle.style.minWidth="1px",this.richTextEle.style.minHeight="1px",this.richTextEle.style.borderWidth="0px",this.richTextEle.style.transform="scale(0)"}enterEditMode(e=!1){var g,m,f,p;if(this.focusEditEle(),this.isEditMode)return;setTimeout(()=>{Gm(this.richTextEditEle)},1),this.isEditMode=!0;const t=this._plugin.getSelectionManager().getCurrentCellModel();if(!t)return!1;let n,s,o,i;if(t.isMerged){const b=t.mergeInfo;n=b.startX,s=b.endX,o=b.startY,i=b.endY}else n=t.startX,s=t.endX,o=t.startY,i=t.endY;const a=((m=(g=this._plugin.getMainScene())==null?void 0:g.getViewport(ln.VIEW_TOP))==null?void 0:m.actualScrollX)||0,l=((p=(f=this._plugin.getMainScene())==null?void 0:f.getViewport(ln.VIEW_LEFT))==null?void 0:p.actualScrollY)||0;this.richTextEle.style.left=`${n-a}px`,this.richTextEle.style.top=`${o-l}px`,this.richTextEle.style.minWidth=`${s-n}px`,this.richTextEle.style.minHeight=`${i-o}px`,this.richTextEle.style.borderWidth="2px";const u=ts(this._sheetContainer.contentRef).getBoundingClientRect();this.richTextEle.style.maxWidth=`${u.width-n+a}px`,this.richTextEle.style.maxHeight=`${u.height-o+l}px`,this.richTextEle.style.transform="";let c=this.getSelectionValue();const h=this._cellEditExtensionManager.handle({row:t.row,column:t.column,value:c});h&&(c=h.value),e&&(c=""),this.richText.setValue(c);const d=this.getSelectionStyle();this.richTextEditEle.style.cssText="",d&&(this.richTextEditEle.style.cssText=tl(d,!0)),this.setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const e=Lc(this.richTextEditEle),t=this.richTextEditEle.innerText;let n={};typeof e=="string"?(n.v=e,n.m=e):typeof e=="object"&&(n.p=e,n.v=t,n.m=t);const s=el(this.richTextEditEle);W.isPlainObject(s)&&(n.s=s),this.setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout(()=>{this.richTextEditEle.focus()},100)}setCurrentEditRangeData(){const e=this._plugin.getSelectionManager().getCurrentCellModel();if(!e)return;let t,n;if(e.isMerged){const s=e.mergeInfo;t=s.startRow,n=s.startColumn}else t=e.row,n=e.column;this.currentEditRangeData={startRow:t,startColumn:n,endRow:t,endColumn:n}}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(e){const{startRow:t,startColumn:n,endRow:s,endColumn:o}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t,n,s,o).setRangeData(e)}getSelectionValue(){const e=this._plugin.getSelectionManager().getActiveRange();if(!e)return"";const t=e&&e.getDisplayValue();return typeof t=="string"?t:typeof t=="object"&&t!==null?Pc(t):""}getSelectionStyle(){var e;return(e=this._plugin.getSelectionManager().getActiveRange())==null?void 0:e.getTextStyle()}setSelectionValue(e){const t=this._plugin.getSelectionManager().getActiveRange();!t||(typeof e=="string"&&t.setValue(e),typeof e=="object"&&t.setRangeData({p:e}))}handleBackSpace(){}handleDirection(e){}}class aT{constructor(e){this._master=e}}class lT{_initialize(){const n=this._master.getPlugin().getContext().getWorkBook();this._countBar.setState({onChange:s=>{n.getActiveSheet().setZoomRatio(W.numberFixed(s/100,2))}})}_totalRangeList(e){let t=e.getRangeList(),n=[],l=this._master.getPlugin().getContext().getWorkBook().getActiveSheet().getCellMatrix(),u=0,c=0,h=0;for(let d=0;d<t.length;d++){let g=t[d];for(let m=g.startRow;m<=g.endRow;m++)for(let f=g.startColumn;f<=g.endColumn;f++){if(n.includes(`${m}${f}`))continue;const p=l.getValue(m,f);if(p){let b=parseFloat(p.v);isNaN(b)||(h+=1,c+=b)}n.push(`${m}${f}`)}}h>0&&(u=c/h),this._countBar.setState({content:`\u5E73\u5747\u6570\uFF1A${W.numberFixed(u,2)} \u8BA1\u6570\uFF1A${W.numberFixed(c,2)} \u6570\u91CF\uFF1A${h}`})}_initializeSelectedObserver(){var n;const e=this._master.getPlugin(),t=e.getSelectionManager();(n=e.getObserver("onChangeSelectionObserver"))==null||n.add(()=>{const s=t.getActiveRangeList();s&&this._countBar&&this._totalRangeList(s)})}constructor(e){this._master=e;const t=e.getPlugin().getContext();t.getObserverManager().requiredObserver("onCountBarDidMountObservable").add(s=>{this._countBar=s,this._initialize()}),t.getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{const s=t.getWorkBook().getActiveSheet().getZoomRatio();this._countBar.setZoom(Math.trunc(s*100))}),t.getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._initializeSelectedObserver()}),t.getContextObserver("onZoomRatioSheetObservable").add(s=>{this._countBar.setZoom(Math.trunc(s.zoomRatio*100))})}}class wp{constructor(e){this._plugin=e,this._uiController=new lT(this),this._apiController=new aT(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}}class Tp{constructor(e){this._plugin=e;const t=e.getContext().getWorkBook().getConfig().name;this._infoBarModel=new sp(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setSheetName(n)}}},this._initialize()}_initialize(){const e=this._plugin.context;e.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Pe.SPREADSHEET).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class Sp{constructor(e,t){this.insertRow=(...s)=>{const o=this._getSelections();if((o==null?void 0:o.length)===1){const i=this._plugin.getContext().getWorkBook().getActiveSheet();i==null||i.insertRowBefore(o[0].startRow,o[0].endRow-o[0].startRow+1)}},this.deleteRow=(...s)=>{const o=this._getSelections();if((o==null?void 0:o.length)===1){const i=this._plugin.getContext().getWorkBook().getActiveSheet();i==null||i.deleteRows(o[0].startRow,o[0].endRow-o[0].startRow+1)}},this.insertColumn=(...s)=>{const o=this._getSelections();(o==null?void 0:o.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(o[0].startColumn,o[0].endColumn-o[0].startColumn+1)},this.deleteColumn=(...s)=>{const o=this._getSelections();(o==null?void 0:o.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(o[0].startColumn,o[0].endColumn-o[0].startColumn+1)},this.clear=(...s)=>{const o=this._getSelections();(o==null?void 0:o.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(o[0]).clear()},this.deleteCellLeft=(...s)=>{const o=this._getSelections();(o==null?void 0:o.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(o[0]).deleteCells(0)},this.deleteCellTop=(...s)=>{const o=this._getSelections();(o==null?void 0:o.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(o[0]).deleteCells(1)},this.addItem=s=>{s instanceof Array?this._menuList.push(...s):this._menuList.push(s),this.resetMenuList(this.resetMenuLabel(this._menuList))},this._plugin=e,this._initRegisterComponent();const n=t?W.deepClone(gl):W.deepMerge(gl,t);this._menuList=[{locale:["rightClick.insert","rightClick.row"],onClick:this.insertRow,hide:n.hideInsertRow},{locale:["rightClick.insert","rightClick.column"],onClick:this.insertColumn,hide:n.hideInsertColumn},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.to","rightClick.top","rightClick.add"],suffixLocale:"rightClick.row"}},hide:n.hideAddRowTop},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.to","rightClick.bottom","rightClick.add"],suffixLocale:"rightClick.row"}},hide:n.hideAddRowBottom},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.to","rightClick.left","rightClick.add"],suffixLocale:"rightClick.column"}},hide:n.hideAddColumnLeft},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.to","rightClick.right","rightClick.add"],suffixLocale:"rightClick.column"}},hide:n.hideAddColumnRight},{locale:["rightClick.deleteSelected","rightClick.row"],onClick:this.deleteRow,hide:n.hideDeleteRow},{locale:["rightClick.deleteSelected","rightClick.column"],onClick:this.deleteColumn,hide:n.hideDeleteColumn},{locale:["rightClick.hideSelected","rightClick.row"],hide:n.hideHideRow},{locale:["rightClick.showHide","rightClick.row"],hide:n.hideShowRow},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.row","rightClick.height"],suffix:"px",onKeyUp:this.setRowHeight.bind(this)}},onClick:(...s)=>console.dir(s),hide:n.hideRowHeight},{locale:["rightClick.hideSelected","rightClick.column"],hide:n.hideHideColumn},{locale:["rightClick.showHide","rightClick.column"],hide:n.hideShowColumn},{customLabel:{name:Fr.name,props:{prefixLocale:["rightClick.column","rightClick.width"],suffix:"px",onKeyUp:this.setColumnWidth.bind(this)}},hide:n.hideColumnWidth},{hide:n.hideDeleteCell,customLabel:{name:Fo.name,props:{locale:"rightClick.deleteCell"}},border:!0,children:[{locale:["rightClick.moveLeft"],className:vl.rightMenuCenter,onClick:(...s)=>this.deleteCellLeft(...s)},{locale:["rightClick.moveUp"],className:vl.rightMenuCenter,onClick:(...s)=>this.deleteCellTop(...s)}]},{locale:["rightClick.clearContent"],onClick:(...s)=>this.clear(...s),border:!0,hide:n.hideClearContent},{hide:n.hideMatrix,customLabel:{name:Fo.name,props:{locale:"rightClick.matrix"}},children:[{customLabel:{name:Ps.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.upAndDown"},{locale:"rightClick.leftAndRight"}]}}},{customLabel:{name:Ps.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.clockwise"},{locale:"rightClick.counterclockwise"}]}}},{locale:["rightClick.transpose"]},{customLabel:{name:Cl.name,props:{locale:"rightClick.matrixCalculation",options:[{locale:"rightClick.plus"},{locale:"rightClick.minus"},{locale:"rightClick.multiply"},{locale:"rightClick.divided"},{locale:"rightClick.power"},{locale:"rightClick.root"},{locale:"rightClick.log"}]}}},{customLabel:{name:Ps.name,props:{locale:"rightClick.delete0",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}},{customLabel:{name:Ps.name,props:{locale:"rightClick.removeDuplicate",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}}]}],this._rightMenuModel=new op,this._initialize()}_initialize(){const e=this._plugin.getContext();e.getObserverManager().requiredObserver("onRightMenuDidMountObservable",Pe.SPREADSHEET).add(n=>{this._RightMenu=n,this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onSheetRenderDidMountObservable").add(()=>{const n=this._plugin.getSheetContainerControl().getContentRef().current;!n||this._plugin.getMainComponent().onPointerDownObserver.add(s=>{if(s.button===2){n.oncontextmenu=()=>!1;const o=this._plugin.getSelectionManager().getCurrentModel();console.log("selecionModel",o==null?void 0:o.type),this._RightMenu.handleContextMenu(s)}})})}_initRegisterComponent(){this._plugin.registerComponent(Fr.name,Fr),this._plugin.registerComponent(Ps.name,Ps),this._plugin.registerComponent(Cl.name,Cl),this._plugin.registerComponent(Fo.name,Fo)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if(t==="locale")e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this.findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this.resetMenuLabel(e[t]));return e}resetMenuLabel(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetMenuLabel(n.children))}return e}resetMenuList(e){var t;(t=this._RightMenu)==null||t.setMenuList(e)}_getSelections(){var n;const e=(n=this._plugin)==null?void 0:n.getSelectionManager().getCurrentControls();return e==null?void 0:e.map(s=>{const o=s.model;return{startRow:o.startRow,startColumn:o.startColumn,endRow:o.endRow,endColumn:o.endColumn}})}setColumnWidth(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setColumnWidth(n[0].startColumn,n[0].endColumn-n[0].startColumn+1,Number(t)),this._RightMenu.showRightMenu(!1)}setRowHeight(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setRowHeights(n[0].startRow,n[0].endRow-n[0].startRow+1,Number(t)),this._RightMenu.showRightMenu(!1)}}class uT{constructor(e){this._barControl=e,this._sheetUl=[{locale:"sheetConfig.delete",onClick:(...t)=>{t[1].ref.hideSelect(),e.deleteSheet()}},{locale:"sheetConfig.copy",onClick:(...t)=>{t[1].ref.hideSelect(),e.copySheet()}},{locale:"sheetConfig.rename",onClick:(...t)=>{t[1].ref.hideSelect(),e.reNameSheet()}},{locale:"sheetConfig.changeColor",icon:"RightIcon",children:[{selectType:"jsx",label:"ColorPicker",onClick:t=>{e.setSheetColor(t)}}]},{locale:"sheetConfig.hide",border:!0,onClick:(...t)=>{t[1].ref.hideSelect(),e.hideSheet()}},{locale:"sheetConfig.unhide",onClick:(...t)=>{t[1].ref.hideSelect(),e.unHideSheet()}},{locale:"sheetConfig.moveLeft",border:!0,onClick:(...t)=>{t[1].ref.hideSelect(),e.moveSheet("left")}},{locale:"sheetConfig.moveRight",onClick:(...t)=>{t[1].ref.hideSelect(),e.moveSheet("right")}}],this._initializeData(),this._initializeObserver()}getMenuList(){return this._menuList}getSheetList(){return this._sheetList}getSheetBar(){return this._sheetBar}getDataId(){return this._dataId}_initializeObserver(){const e=this._barControl.getPlugin(),t=e.getContext(),n=t.getObserverManager(),o=t.getWorkBook().getUnitId();n.requiredObserver("onSheetBarDidMountObservable",Pe.SPREADSHEET).add(i=>{this._sheetBar=i,this.resetSheetUl(),this._sheetBar.setValue({sheetList:this._sheetList,sheetUl:this._sheetUl,menuList:this._menuList,addSheet:()=>{this._barControl.addSheet()},selectSheet:(a,l)=>{this._dataId=l.item.sheetId;const u=e.getContext().getWorkBook().getSheetBySheetId(this._dataId);u&&u.activate()},contextMenu:a=>{const l=a.currentTarget;this._dataId=l.dataset.id,this._barControl.contextMenu(a)},changeSheetName:a=>{this._barControl.changeSheetName(a)},dragEnd:a=>{this._barControl.dragEnd(a)}})}),t.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetSheetUl(),this._sheetBar.setValue({sheetUl:this._sheetUl})}),He.getActionObservers().add(i=>{const u=i.action.getWorkBook().getUnitId();if(o!==u)return;const{data:c}=i;switch(c.actionName){case $.SET_SHEET_ORDER_ACTION:case $.INSERT_SHEET_ACTION:case $.SET_TAB_COLOR_ACTION:case $.REMOVE_SHEET_ACTION:case $.SET_WORKSHEET_NAME_ACTION:case $.SET_WORKSHEET_ACTIVATE_ACTION:case $.SET_WORKSHEET_STATUS_ACTION:{this._initializeData(),this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList});break}}})}_initializeData(){const n=this._barControl.getPlugin().getWorkbook().getSheets();this._menuList=n.map((s,o)=>({label:s.getName(),index:String(o),sheetId:s.getSheetId(),hidden:s.isSheetHidden(),selected:s.getStatus()===1,onClick:i=>{console.log("000000000");const a=i.currentTarget;this._dataId=a.dataset.id,s.showSheet(),s.activate()}})),this._sheetList=n.filter(s=>!s.isSheetHidden()).map((s,o)=>({sheetId:s.getSheetId(),label:s.getName(),icon:"NextIcon",index:String(o),selected:s.getStatus()===1,color:s.getTabColor(),onDown:i=>{const a=i.currentTarget;this._dataId=a.dataset.id},onClick:i=>{const a=i.currentTarget;this._dataId=a.dataset.id,s.activate()}})),this._sheetIndex=n.findIndex(s=>s.getStatus()===1),this._dataId=n[this._sheetIndex].getSheetId()}resetSheetUl(){const e=this._barControl.getPlugin().context.getLocale();this._sheetUl.forEach(t=>{t.label=e.get(t.locale)})}selectSheet(...e){}deleteSheet(){}sortMenu(e,t,n){}copySheet(){}addSheet(e,t){this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList},()=>{this._sheetBar.overGrid()})}reNameSheet(){this._sheetBar.reNameSheet(this._dataId)}hideSheet(){}unHideSheet(){this._sheetBar.ref.current.showSelect()}moveSheet(e){}changeSheetName(e){}contextMenu(e){this._sheetBar.contextMenu(e)}dragEnd(e){let t=[];Array.from(e).forEach(n=>{const s=this._sheetList.find(o=>o.sheetId===n.dataset.id);s&&t.push(s)}),this._sheetList=t,this._sheetBar.setValue({sheetList:t})}}class cT{constructor(e){this._barControl=e}deleteSheet(){const t=this._barControl.getPlugin().getWorkbook();t&&t.removeSheetBySheetId(this._barControl.getUIController().getDataId())}copySheet(){const e=this._barControl.getPlugin().getWorkbook(),n=e.getActiveSheet().copy(mr.getSheetName());e&&e.insertSheet(e.getActiveSheetIndex()+1,n.getConfig())}setSheetColor(e){const s=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());s&&s.setTabColor(e)}changeSheetName(e){const n=this._barControl.getUIController().getMenuList().find(a=>a.sheetId===this._barControl.getUIController().getDataId()),i=this._barControl.getPlugin().getContext().getWorkBook();if(n){const a=i.getSheetBySheetId(n.sheetId),l=e.target.innerText;a&&l!==a.getName()&&a.setName(l)}}addSheet(){this._barControl.getPlugin().getContext().getWorkBook().insertSheet()}moveSheet(e){const s=this._barControl.getPlugin().getContext().getWorkBook();switch(e){case"left":{const o=s.getActiveSheetIndex(),i=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(i.getSheetId(),Math.max(o-1,0));break}case"right":{const o=s.getActiveSheetIndex(),i=s.getSheetSize(),a=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(a.getSheetId(),Math.min(o+1,i));break}}}dragEnd(e){let t=[],n=this._barControl.getUIController().getDataId();Array.from(e).forEach(s=>{const o=this._barControl.getUIController().getSheetList().find(i=>i.sheetId===s.dataset.id);o&&t.push(o)}),console.log(n),t.forEach((s,o)=>{s.sheetId===n&&this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(s.sheetId,o)}),console.log(e)}hideSheet(){const n=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());n&&n.hideSheet()}}class yp{constructor(e){this._plugin=e,this._apiController=new cT(this),this._uiController=new uT(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}selectSheet(...e){}hideSheet(){this._apiController.hideSheet()}unHideSheet(){this._uiController.unHideSheet()}addSheet(e,t){this._apiController.addSheet(),this._uiController.addSheet(e,t),this._uiController.getSheetBar().slideTabBar.getScrollbar().scrollRight()}deleteSheet(){this._apiController.deleteSheet(),this._uiController.deleteSheet()}moveSheet(e){this._apiController.moveSheet(e)}copySheet(){this._apiController.copySheet()}reNameSheet(){this._uiController.reNameSheet()}changeSheetName(e){this._apiController.changeSheetName(e),this._uiController.changeSheetName(e)}setSheetColor(e){this._apiController.setSheetColor(e)}contextMenu(e){this._uiController.contextMenu(e)}dragEnd(e){this._apiController.dragEnd(e),this._uiController.dragEnd(e)}}class Sl extends Oe{constructor(){super(...arguments),this.inputRef=Ae(),this.modalRef=Ae()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={modalData:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCellRangeModalDidMountObservable",Pe.SPREADSHEET))==null||e.notifyObservers(this)}confirmRange(){var e;(e=this.inputRef.current)==null||e.value}setModal(e){this.setState({modalData:e})}render(){const{value:e,title:t,children:n,group:s,show:o}=this.state.modalData,i=this._render.renderFunction("Input"),a=this._render.renderFunction("Modal");if(!!o)return _(a,{isDrag:!0,visible:o,title:t,group:s,mask:!1},_(i,{ref:this.inputRef,readonly:!0,placeholder:n==null?void 0:n.placeholder,value:e}))}}class Ap{constructor(e,t){var n;this.changeSkin=()=>{var s;(s=this._plugin.getContext().getObserverManager().getObserver("onAfterChangeUISkinObservable"))==null||s.notifyObservers(this._plugin.getContext().getWorkBook())},this.changeLocale=s=>{var o;this._plugin.getContext().getLocale().change(s),(o=this._plugin.getContext().getContextObserver("onAfterChangeUILocaleObservable"))==null||o.notifyObservers()},this._plugin=e,this._config=t,this._initRegisterComponent(),this._initialize(),this._defaultLayout=((n=this._config.layout)==null?void 0:n.sheetContainerConfig)||nh}_initialize(){He.getCommandObservers().add(({actions:e})=>{const t=this._plugin;if(!t||!e||e.length===0)return;const n=e[0],s=t.context.getWorkBook().getUnitId(),o=n.getWorkBook().getUnitId();if(s!==o)return;const i=n.getWorkBook().getActiveSheet();if(i)try{const a=t.getCanvasView();a&&(a.updateToSheet(i),t.getMainComponent().makeDirty(!0))}catch(a){console.info(a)}}),this._plugin.getContext().getObserverManager().requiredObserver("onSheetContainerDidMountObservable",Pe.SPREADSHEET).add(e=>{this._sheetContainer=e,this._sheetContainer.setState({layout:this._defaultLayout,currentLocale:this._plugin.getContext().getLocale().options.currentLocale}),this._dragManager.handleDragAction(ts(e))}),this._dragManager=new cm(this._plugin)}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const t={ForwardIcon:this._render.renderFunction("ForwardIcon"),BackIcon:this._render.renderFunction("BackIcon"),BoldIcon:this._render.renderFunction("BoldIcon"),RightIcon:this._render.renderFunction("RightIcon"),ItalicIcon:this._render.renderFunction("ItalicIcon"),DeleteLineIcon:this._render.renderFunction("DeleteLineIcon"),UnderLineIcon:this._render.renderFunction("UnderLineIcon"),TextColorIcon:this._render.renderFunction("TextColorIcon"),FillColorIcon:this._render.renderFunction("FillColorIcon"),MergeIcon:this._render.renderFunction("MergeIcon"),TopBorderIcon:this._render.renderFunction("TopBorderIcon"),BottomBorderIcon:this._render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this._render.renderFunction("LeftBorderIcon"),RightBorderIcon:this._render.renderFunction("RightBorderIcon"),NoneBorderIcon:this._render.renderFunction("NoneBorderIcon"),FullBorderIcon:this._render.renderFunction("FullBorderIcon"),OuterBorderIcon:this._render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this._render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this._render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this._render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this._render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this._render.renderFunction("CenterAlignIcon"),RightAlignIcon:this._render.renderFunction("RightAlignIcon"),TopVerticalIcon:this._render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this._render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this._render.renderFunction("BottomVerticalIcon"),OverflowIcon:this._render.renderFunction("OverflowIcon"),BrIcon:this._render.renderFunction("BrIcon"),CutIcon:this._render.renderFunction("CutIcon"),TextRotateIcon:this._render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this._render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this._render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this._render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this._render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this._render.renderFunction("TextRotateRotationDownIcon"),SearchIcon:this._render.renderFunction("SearchIcon"),ReplaceIcon:this._render.renderFunction("ReplaceIcon"),LocationIcon:this._render.renderFunction("LocationIcon"),BorderDashDot:this._render.renderFunction("BorderDashDot"),BorderDashDotDot:this._render.renderFunction("BorderDashDotDot"),BorderDashed:this._render.renderFunction("BorderDashed"),BorderDotted:this._render.renderFunction("BorderDotted"),BorderHair:this._render.renderFunction("BorderHair"),BorderMedium:this._render.renderFunction("BorderMedium"),BorderMediumDashDot:this._render.renderFunction("BorderMediumDashDot"),BorderMediumDashDotDot:this._render.renderFunction("BorderMediumDashDotDot"),BorderMediumDashed:this._render.renderFunction("BorderMediumDashed"),BorderThick:this._render.renderFunction("BorderThick"),BorderThin:this._render.renderFunction("BorderThin")};for(let n in t)this._plugin.registerComponent(n,t[n]);this._plugin.registerModal(Sl.name,Sl)}getContentRef(){return this._sheetContainer.getContentRef()}getSplitLeftRef(){return this._sheetContainer.getSplitLeftRef()}getLayoutContainerRef(){return this._sheetContainer.getLayoutContainerRef()}}class hT{}class bh extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={color:"rgb(217,217,217)"}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setColor(e){this.setState({color:e})}render(){const e=this._render.renderFunction("RightIcon"),{color:t}=this.state,{label:n}=this.props;return _("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},_("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},n),_(e,null))}}const dT=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],gT=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],fT=[{locale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{locale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{locale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{locale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{locale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{locale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{locale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{locale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{locale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{locale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],mT=[{locale:"borderLine.borderNone",value:""},{customLabel:{name:"BorderThin"},value:"BorderThin"},{customLabel:{name:"BorderHair"},value:"BorderHair"},{customLabel:{name:"BorderDotted"},value:"BorderDotted"},{customLabel:{name:"BorderDashed"},value:"BorderDashed"},{customLabel:{name:"BorderDashDot"},value:"BorderDashDot"},{customLabel:{name:"BorderDashDotDot"},value:"BorderDashDotDot"},{customLabel:{name:"BorderMedium"},value:"BorderMedium"},{customLabel:{name:"BorderMediumDashed"},value:"BorderMediumDashed"},{customLabel:{name:"BorderMediumDashDot"},value:"BorderMediumDashDot"},{customLabel:{name:"BorderMediumDashDotDot"},value:"BorderMediumDashDotDot"},{customLabel:{name:"BorderThick"},value:"BorderThick"}],pT=[{locale:"merge.all",value:"all"},{locale:"merge.vertical",value:"vertical"},{locale:"merge.horizontal",value:"horizontal"},{locale:"merge.cancel",value:"cancel"}],_T=[{locale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{locale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{locale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],bT=[{locale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{locale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{locale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],vT=[{locale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{locale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{locale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],CT=[{locale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{locale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{locale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{locale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{locale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{locale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];class vh extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={img:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineBoldDidMountObservable"))==null||e.notifyObservers(this)}setLineType(e){this.setState({img:e})}getImg(e){const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},s=this._render.renderFunction(e);return _(s,{...n})}render(){const e=this._render.renderFunction("RightIcon"),{img:t}=this.state,{label:n}=this.props;return _("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},_("span",{className:"base-sheets-line-bold",style:{position:"relative"}},n,_("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"10px"}},t.length?this.getImg(t):"")),_(e,null))}}var Rp={colorSelect:"univer-color-select",colorSelectLine:"univer-color-select-line"};class yl extends Oe{componentDidMount(){var n;(n=this._context.getObserverManager().getObserver("onColorSelectDidMountObservable"))==null||n.notifyObservers(this);const e=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);let t=this.props.label;if(this.props.customLabel){const s=e==null?void 0:e.getRegisterComponent(this.props.customLabel.name);t=_(s,{...this.props.customLabel.props})}this.setState({label:t,color:"#000"})}setColor(e){this.setState({color:e})}getId(){return this.props.id}render(){return _("div",{className:Rp.colorSelect},_("div",null,this.state.label),_("div",{className:Rp.colorSelectLine,style:{background:this.state.color}}))}}class Ip{constructor(e,t){this._colorSelect=[],this._plugin=e;const n=this._plugin.getPluginName();this._initRegisterComponent();const s=t||rh;this._borderInfo={color:"rgb(217, 217, 217)",type:1},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:s.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:s.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",className:Nt.selectLabelString,name:"font",show:s.font,border:!0,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||i.notifyObservers(o)},children:gT},{type:1,tooltipLocale:"toolbar.fontSize",label:String(us.fs),name:"fontSize",show:s.fontSize,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||i.notifyObservers(o)},onKeyUp:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||i.notifyObservers(o)},children:dT},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,name:"bold",show:s.bold,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||i.notifyObservers(o)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},name:"italic",show:s.italic,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||i.notifyObservers(o)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},name:"strikethrough",show:s.strikethrough,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||i.notifyObservers(o)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},name:"underline",show:s.underline,onClick:o=>{var i;(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.notifyObservers(o)}},{type:5,tooltipLocale:"toolbar.textColor.main",customLabel:{name:n+yl.name,props:{customLabel:{name:"TextColorIcon"},id:"textColor"}},hideSelectedIcon:!0,className:Nt.selectColorPickerParent,children:[{customLabel:{name:n+wn.name,props:{onClick:(o,i)=>{var l;const a=this._colorSelect.find(u=>u.getId()==="textColor");a==null||a.setColor(o),(l=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||l.notifyObservers(o)},lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:Nt.selectColorPicker}],name:"textColor",show:s.textColor},{type:5,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:n+yl.name,props:{customLabel:{name:"FillColorIcon"},id:"fillColor"}},hideSelectedIcon:!0,className:Nt.selectColorPickerParent,children:[{customLabel:{name:n+wn.name,props:{onClick:(o,i)=>{var l;const a=this._colorSelect.find(u=>u.getId()==="fillColor");a==null||a.setColor(o),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.notifyObservers(o)},lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:Nt.selectColorPicker}],name:"fillColor",show:s.fillColor},{type:3,display:1,show:s.border,tooltipLocale:"toolbar.border.main",className:Nt.selectDoubleString,onClick:o=>{o&&this.setBorder(o)},name:"border",children:[...fT,{customLabel:{name:n+bh.name,props:{locale:"borderLine.borderColor"}},unSelectable:!0,className:Nt.selectColorPickerParent,children:[{customLabel:{name:n+wn.name,props:{onClick:(o,i)=>this.handleLineColor(o,i),lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:Nt.selectColorPicker,onClick:this.handleLineColor}]},{customLabel:{name:n+vh.name,props:{locale:"borderLine.borderSize"}},onClick:(...o)=>this.handleLineBold(o[1],o[2],o[0]),className:Nt.selectLineBoldParent,unSelectable:!0,children:mT}]},{type:5,tooltipLocale:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:s.mergeCell,onClick:o=>{this.setMerge(o)},name:"mergeCell",children:pT},{type:3,tooltipLocale:"toolbar.horizontalAlignMode.main",className:Nt.selectDoubleString,display:1,name:"horizontalAlignMode",show:s.horizontalAlignMode,onClick:o=>{this.setHorizontalAlignment(o)},children:_T},{type:3,tooltipLocale:"toolbar.verticalAlignMode.main",className:Nt.selectDoubleString,display:1,name:"verticalAlignMode",show:s.verticalAlignMode,onClick:o=>{this.setVerticalAlignment(o)},children:bT},{type:3,className:Nt.selectDoubleString,tooltipLocale:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:s.textWrapMode,onClick:o=>{this.setWrapStrategy(o)},children:vT},{type:3,className:Nt.selectDoubleString,name:"textRotateMode",tooltipLocale:"toolbar.textRotateMode.main",display:1,show:s.textRotateMode,onClick:o=>{this.setTextRotation(o)},children:CT}],this._moreText={more:"toolbar.toolMore",tip:"toolbar.toolMoreTip"},this._toolBarModel=new ip,this._toolBarModel.config=s,this._toolBarModel.toolList=this._toolList,this.init()}_changeToolBarState(e){var s,o,i,a,l;const n=this._plugin.getContext().getWorkBook().getActiveSheet();if(n){n.getCellMatrix();const u=e.getStrikeThrough(),c=e.getFontSize(),h=e.getFontWeight(),d=e.getFontFamily(),g=e.getFontStyle(),m=e.getUnderline(),f=e.getHorizontalAlignment(),p=e.getVerticalAlignment(),b=e.getTextRotation(),v=this._toolList.find(M=>M.name==="textRotateMode"),w=this._toolList.find(M=>M.name==="fontSize"),S=this._toolList.find(M=>M.name==="font"),T=this._toolList.find(M=>M.name==="bold"),D=this._toolList.find(M=>M.name==="italic"),R=this._toolList.find(M=>M.name==="strikethrough"),I=this._toolList.find(M=>M.name==="underline"),y=this._toolList.find(M=>M.name==="horizontalAlignMode"),O=this._toolList.find(M=>M.name==="verticalAlignMode");R&&(R.active=!!(u&&u.s)),S&&((s=S.children)==null||s.forEach(M=>{M.selected=d===M.value})),w&&((o=w.children)==null||o.forEach(M=>{M.selected=c===M.value})),T&&(T.active=!!h),D&&(D.active=!!g),I&&(I.active=!!(m&&m.s)),y&&((i=y.children)==null||i.forEach(M=>{M.selected=f===M.value})),v&&((a=v.children)==null||a.forEach(M=>{M.selected=b===M.value})),O&&((l=O.children)==null||l.forEach(M=>{M.selected=p===M.value})),this.resetToolBarList()}}init(){var e,t,n,s,o,i,a,l,u,c,h,d,g,m;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("ff",f):this.setFontFamily(f)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fs",f):this.setFontSize(f)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bl",f?"1":"0"):this.setFontWeight(f)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("it",f?"1":"0"):this.setFontStyle(f)}),(o=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||o.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("cl",f?"1":"0"):this.setStrikeThrough(f)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("un",f?"1":"0"):this.setUnderline(f)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fc",f):this.setFontColor(f)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(f=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bg",f):this.setBackground(f)}),(u=this._plugin.getObserver("onToolBarDidMountObservable"))==null||u.add(f=>{this._toolBarComponent=f,this.resetToolBarList()}),(c=this._plugin.getObserver("onLineColorDidMountObservable"))==null||c.add(f=>{this._lineColor=f}),(h=this._plugin.getObserver("onLineBoldDidMountObservable"))==null||h.add(f=>{this._lineBold=f}),(d=this._plugin.getObserver("onColorSelectDidMountObservable"))==null||d.add(f=>{this._colorSelect.push(f)}),(g=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","core"))==null||g.add(()=>{this.resetToolBarList()}),(m=this._plugin.getObserver("onChangeSelectionObserver"))==null||m.add(f=>{const p=this._plugin.getSelectionManager(),b=p==null?void 0:p.getCurrentCell();b&&this._changeToolBarState(b)})}_initRegisterComponent(){const e=this._plugin.getPluginName();this._plugin.registerComponent(e+bh.name,bh),this._plugin.registerComponent(e+vh.name,vh),this._plugin.registerComponent(e+yl.name,yl),this._plugin.registerComponent(e+wn.name,wn)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if(t==="locale")e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this.findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this.resetToolListLabel(e[t]));return e}resetToolListLabel(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetToolListLabel(n.children))}return e}resetToolBarList(){const e=this._plugin.context.getLocale(),t=this.resetToolListLabel(this._toolList);this._toolBarComponent.setToolBar(t,{more:e.get(this._moreText.more),tip:e.get(this._moreText.tip)})}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontColor(e)}setBackground(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setBackground(e)}setFontSize(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontSize(e)}setFontFamily(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontFamily(e)}setFontWeight(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontWeight(e)}setFontStyle(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontStyle(e)}setStrikeThrough(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setStrikeThrough(e)}setUnderline(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setUnderline(e)}setMerge(e){const t=this._plugin.getSelectionManager().getActiveRange();switch(e){case"all":t==null||t.merge();break;case"vertical":t==null||t.mergeVertically();break;case"horizontal":t==null||t.mergeAcross();break;case"cancel":t==null||t.breakApart();break}}setHorizontalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setHorizontalAlignment(e)}setVerticalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalAlignment(e)}setWrapStrategy(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setWrapStrategy(e)}setTextRotation(e){var t,n;e==="v"?(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalText(1):(n=this._plugin.getSelectionManager().getActiveRangeList())==null||n.setTextRotation(e)}setBorder(e){const t=this._plugin.getSelectionManager().getCurrentControls();t&&t.length>0&&(t==null||t.forEach(n=>{const s=n.model,o={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(o).setBorderByType(e,this._borderInfo.color,this._borderInfo.type)}))}handleLineColor(e,t){t.stopPropagation(),this._lineColor.setColor(e),this._borderInfo.color=e}handleLineBold(e,t,n){console.log("handleLineBold===",e,t,n),t===7?t=8:t===8?t=9:t===9?t=10:t===10?t=11:t===11&&(t=13),n.stopPropagation(),e&&(this._lineBold.setLineType(e),this._borderInfo.type=t)}addToolButton(e){this._toolList.findIndex(n=>n.name===e.name)>-1||(this._toolList.push(e),this._toolBarComponent&&this.resetToolBarList())}}class ET{constructor(e){this._plugin=e,this._ModalGroup=[],this.init()}init(){var e;(e=this._plugin.getObserver("onModalGroupDidMountObservable"))==null||e.add(t=>{this._ModalGroupComponent=t})}addModal(e,t){var s;this._ModalGroup.findIndex(o=>o===e)<0&&(this._plugin.registerComponent(e,t),this._ModalGroup.push(e),(s=this._ModalGroupComponent)==null||s.setModalGroup(this._ModalGroup))}getModal(e){return this._ModalGroupComponent.getModalGroup().find(n=>n.constructor.name===e)}}class wT{constructor(e){this._plugin=e,this._initialize()}_initialize(){var n;this._plugin.context.getObserverManager().requiredObserver("onFormulaBarDidMountObservable",Pe.SPREADSHEET).add(s=>{this._formulaBar=s,this._namedRanges=this._plugin.getContext().getWorkBook().getConfig().namedRanges;const o=this._namedRanges.map(i=>({value:i.name,label:i.name}));this._formulaBar.setNamedRanges(o)}),(n=this._plugin.getObserver("onChangeSelectionObserver"))==null||n.add(s=>{const o=s.model.currentCell;if(o){let i;if(o.isMerged){const l=o.mergeInfo;i={startRow:l.startRow,endRow:l.endRow,startColumn:l.startColumn,endColumn:l.endColumn}}else{const{row:l,column:u}=o;i={startRow:l,endRow:l,startColumn:u,endColumn:u}}const a=this._plugin.getWorkbook().getActiveSheet().getRange(i).getObjectValue({isIncludeStyle:!0});if(a){let l=String(a.m||a.v||"");const u=this._cellInputExtensionManager.handle({row:i.startRow,column:i.startColumn,value:l});u&&(l=u.value),this._formulaBar.setFormulaContent(l)}}}),this._cellInputExtensionManager=new ks}}class TT extends si{execute(){this.actionDataList.forEach(t=>{if(t.operation!=null&&!pr.hasExtension(t))return!1;if(t.actionName===$.INSERT_ROW_ACTION){const{sheetId:n,rowCount:s,rowIndex:o}=t,i=W.deepClone(this._plugin.getWorkbook().getConfig().namedRanges);for(let a=0;a<i.length;a++){const l=i[a].range.rangeData;if(o>l.endRow)continue;o>=l.startRow&&o<=l.endRow||(l.startRow+=s),l.endRow+=s;const u={actionName:$.SET_NAMED_RANGE_ACTION,namedRange:i[a],sheetId:n};this.push(u)}}})}}class ST extends fa{get zIndex(){return 3}create(e){return new TT(e,this._plugin)}}class xp extends sn{constructor(e={}){super(Pe.SPREADSHEET),this._config=W.deepMerge(Z1,e)}register(e){let t=ts(this._sheetContainerController.getContentRef());this._canvasEngine=e,e.setContainer(t),window.addEventListener("resize",()=>{e.resize()})}initialize(e){var l,u,c,h;this.context=e,e.getLocale().load({en:Aw,zh:yw});const t=e.getWorkBook().getConfig(),n=this._initContainer(this._config.container),s={skin:t.skin||"default",layout:this._config.layout,container:n,onDidMount:()=>{},context:e};this._componentList=new Map;const o=(l=this._config.layout)==null?void 0:l.sheetContainerConfig,i=(u=this._config.layout)==null?void 0:u.rightMenuConfig,a=(c=this._config.layout)==null?void 0:c.toolBarConfig;this._modalGroupController=new ET(this),this._sheetContainerController=new Ap(this,s),o!=null&&o.rightMenu&&(this._rightMenuControl=new Sp(this,i)),o!=null&&o.toolBar&&(this._toolBarControl=new Ip(this,a)),o!=null&&o.infoBar&&(this._infoBarControl=new Tp(this)),o!=null&&o.sheetBar&&(this._sheetBarControl=new yp(this)),this._cellEditorController=new Ep(this),this._antLineController=new Cp(this),o!=null&&o.countBar&&(this._countBarController=new wp(this)),o!=null&&o.formulaBar&&(this._formulaBarController=new wT(this)),(h=this.getObserver("onSheetContainerDidMountObservable"))==null||h.add(()=>{this._initializeRender(e)}),Ar(_(iT,{changeLocale:this._sheetContainerController.changeLocale,changeSkin:this._sheetContainerController.changeSkin,config:s}),n),this.registerExtension()}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else qa(e)?t=e:(t=document.createElement("div"),t.id="universheet");return t}onMounted(e){j1(this),this.initialize(e),He.getActionObservers().add(t=>{const n=this.getContext().getWorkBook().getUnitId(),s=t.action,o=s.getDoActionData(),i=s.getWorkBook().getUnitId();n===i&&o.actionName===$.SET_NAMED_RANGE_ACTION&&o.namedRange})}get config(){return this._config}_initializeRender(e){var n,s;const t=(n=this.getPluginByName(Pe.BASE_RENDER))==null?void 0:n.getEngine();this.register(t),this._canvasView==null&&(this._canvasView=new Lw(t,this)),(s=this.context.getContextObserver("onSheetRenderDidMountObservable"))==null||s.notifyObservers()}onDestroy(){super.onDestroy(),Y1(this),this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._namedRangeActionExtensionFactory)}registerExtension(){const e=this.context.getCommandManager().getActionExtensionManager().getRegister();this._namedRangeActionExtensionFactory=new ST(this),e.add(this._namedRangeActionExtensionFactory)}addButton(e){this._addButtonFunc(e)}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(ln.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var e;return(e=this.getSheetView())==null?void 0:e.getSelectionManager()}getCurrentControls(){var e;return(e=this.getSelectionManager())==null?void 0:e.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorController(){return this._cellEditorController}getModalGroupControl(){return this._modalGroupController}getSheetContainerControl(){return this._sheetContainerController}addRightMenu(e){this._rightMenuControl&&this._rightMenuControl.addItem(e)}addToolButton(e){this._toolBarControl&&this._toolBarControl.addToolButton(e)}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}registerModal(e,t){this._modalGroupController.addModal(e,t)}}var Dp={cellRange:"univer-cell-range",cellModalIcon:"univer-cell-modal-icon"};class Op extends Oe{constructor(){super(...arguments),this.inputRef=Ae()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this._group=[{label:this.props.confirmText,type:"primary",onClick:this.confirmRange}],this.state={show:!1,value:this.props.value}}changeInput(e){const t=e.target.value;this.setState({value:t})}confirmRange(){var t;const e=(t=this.inputRef.current)==null?void 0:t.value;this.setState({value:e})}handleClick(){const{onClick:e}=this.props;e==null||e()}render(){const{placeholder:e,value:t,onTableClick:n}=this.props,s=this._render.renderFunction("Input"),o=this._render.renderFunction("TableIcon");return _("div",{className:Dp.cellRange},_(s,{onClick:this.handleClick.bind(this),placeholder:e,value:t,onChange:this.changeInput}),_("span",{className:Dp.cellModalIcon,onClick:n},_(o,null)))}}var yT=Object.freeze(Object.defineProperty({__proto__:null,SheetPlugin:xp,AntLine:np,AntLineModel:rp,InfoBarModel:sp,RightMenuModel:op,SelectionModel:Mi,SheetBarModel:Ow,ToolBarModel:ip,AntLineControl:Cp,CellEditorController:Ep,CountBarController:wp,InfoBarController:Tp,RightMenuController:Sp,SelectionControlDragAndDrop:fl,SelectionControlFill:ml,DEFAULT_SELECTION_CONFIG:Ke,SELECTION_TYPE:Or,SelectionControl:Bs,SelectionManager:ap,SheetBarControl:yp,SheetContainerController:Ap,SpreadsheetAction:hT,ToolBarController:Ip,DefaultSheetContainerConfig:nh,DefaultToolbarConfig:rh,DefaultRightMenuConfig:gl,DEFAULT_SPREADSHEET_PLUGIN_DATA:Z1,ACTION_NAMES:Ms,uninstall:Y1,install:j1,BaseCellEditExtension:sh,BaseCellEditExtensionFactory:q1,CellEditExtensionManager:Ns,CellEditExtensionRegister:J1,BaseCellInputExtension:ih,BaseCellInputExtensionFactory:Q1,CellInputExtensionManager:ks,CellInputExtensionRegister:ep,RightMenu:vp,RightMenuButton:Ps,RightMenuInput:Fr,RightMenuItem:Fo,RightMenuSelect:Cl,RichText:xo,CellRange:Op,CellRangeModal:Sl,SelectTypes:qc,Select:ul},Symbol.toStringTag,{value:"Module"})),AT={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},RT={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};function IT(r){r.pushToObserve("onAfterChangeFontFamilyObservable"),r.pushToObserve("onAfterChangeFontSizeObservable"),r.pushToObserve("onAfterChangeFontWeightObservable"),r.pushToObserve("onAfterChangeFontItalicObservable"),r.pushToObserve("onAfterChangeFontStrikethroughObservable"),r.pushToObserve("onAfterChangeFontUnderlineObservable"),r.pushToObserve("onAfterChangeFontBackgroundObservable"),r.pushToObserve("onAfterChangeFontColorObservable"),r.pushToObserve("onDragAndDropStartObserver"),r.pushToObserve("onDragAndDroppingObserver"),r.pushToObserve("onDragAndDropEndEndObserver"),r.pushToObserve("onFillStartObserver"),r.pushToObserve("onFillingObserver"),r.pushToObserve("onFillEndObserver"),r.pushToObserve("onChangeCurrentSheetObserver"),r.pushToObserve("onToolBarDidMountObservable"),r.pushToObserve("onSheetBarDidMountObservable"),r.pushToObserve("onCountBarDidMountObservable"),r.pushToObserve("onInfoBarDidMountObservable"),r.pushToObserve("onRightMenuDidMountObservable"),r.pushToObserve("onDocContainerDidMountObservable"),r.pushToObserve("onSpreadsheetKeyDownObservable"),r.pushToObserve("onSpreadsheetKeyUpObservable"),r.pushToObserve("onSpreadsheetKeyCopyObservable"),r.pushToObserve("onSpreadsheetKeyPasteObservable"),r.pushToObserve("onSpreadsheetKeyCutObservable"),r.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),r.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),r.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}var is={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},Bi={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class Ch extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:o}=this.props;return _("div",{className:$t(Bi.selectItem,o?Bi.selectDisabledItem:"")},t?_("span",{className:Bi.selectItemSelected},_(e,null)):"",_("span",{className:Bi.selectItemContent},n),s?_("span",{className:Bi.selectItemSuffix},s):"")}}var Sn={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"};class xT extends Oe{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(o=>{o.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("Button");return _("div",{className:`${Sn.selectSingle} ${n}`},_(o,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return _("div",{className:`${Sn.selectInput} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_(o,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{color:s,menu:o}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return _("div",{className:`${Sn.selectColor} ${Sn.selectDouble} ${t}`},_(i,{type:"text"},_(Ht,{tooltip:n,onClick:this.onClick,menu:{menu:o,onClick:this.onClick},icon:_(a,null)},_("div",{className:Sn.selectLabel},e),_("div",{className:Sn.selectLine,style:{background:s}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return _("div",{className:`${Sn.selectDouble} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:_(o,null)},_("div",{className:Sn.selectLabel},e))))},this.getFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this.Render.renderFunction("Button");return _("div",{className:`${Sn.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},_("div",{className:Sn.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return _("div",{className:`${Sn.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:_(i,null)},_("div",{className:Sn.selectLabel},e))))}}initialize(){var o;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(o=this.props.defaultColor)!=null?o:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}componentDidMount(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=this.handleSelected(o),a=n[o];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const u=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),u.unSelectable)return;const c=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:c}):this.setState({content:n[l[2]].label,menu:c})}}else if(e===1){if(!n.length)return;const o=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(u=>i===u.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(c=>c.selected);a<0&&(a=0);let l=this.handleSelected(a);const u=n[a];this.setState({content:u.label,menu:l})}};o(s),this.onClick=(...i)=>{var l,u;(u=(l=this.props).onClick)==null||u.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,u;const a=i.currentTarget.value;(u=(l=this.props).onKeyUp)==null||u.call(l,a),o(a)}}else if(e===2){const o=this.handleSelected(null);this.setState({menu:o}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=n[o],a=this.handleSelected(o);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var u,c,h,d;if(l.length){(c=(u=this.props).onClick)==null||c.call(u,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}resetMenu(e,t){var s;const n=[];for(let o=0;o<e.length;o++){let i=!1;t||(i=(s=e[o].selected)!=null?s:!1),n[o]={label:""},n[o].label=_(Ch,{disabled:e[o].disabled,border:e[o].border,selected:i,label:e[o].label,suffix:e[o].suffix}),n[o].disabled=e[o].disabled,n[o].style=e[o].style,n[o].value=e[o].value,n[o].className=e[o].className,n[o].onClick=e[o].onClick,e[o].children&&(n[o].children=this.getChildren(e[o].children))}return this.props.type===2&&(n[0]={label:_(Ch,{label:_(wn,{style:{display:"block"},ref:o=>this.ColorRef=o,color:"#000",onClick:o=>{this.ColorRef.hideSelect(),this.setState({color:o},()=>{this.onClick()})}})})}),n}getChildren(e){return e.map(n=>{const s=this.props.hideSelectedIcon?!1:n.selected;return n.label=_(Ch,{disabled:n.disabled,border:n.border,selected:s,label:n.label,suffix:n.suffix}),n.children&&(n.children=this.getChildren(n.children)),n})}render(){const{type:e=0}=this.props;return _("div",{className:Sn.selectComponent},this.getType(e))}}var DT={textButton:"univer-text-button"};class OT extends Oe{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return _("div",{className:DT.textButton},_(n,{type:"text",active:t,onClick:this.handleClick},e))}}var Mo={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",doubleButton:"univer-double-button",colorBottom:"univer-color-bottom",doubleButtonRight:"univer-double-button-right",doubleButtonRightPopup:"univer-double-button-right-popup",doubleButtonMenuItem:"univer-double-button-menu-item",doubleButtonMenuItemIcon:"univer-double-button-menu-item-icon",doubleButtonMenuItemContent:"univer-double-button-menu-item-content",moreButton:"univer-more-button",moreTool:"univer-more-tool",univericonNextIcon:"univer-univericon-nextIcon"};class FT extends Oe{constructor(){super(...arguments),this.toolbarWarp=Ae(),this.toolbarRef=Ae(),this.moreBtn=Ae(),this.moreToolRef=Ae(),this.SelectRef=Ae(),this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Pe.DOCUMENT);for(let o=0;o<e.length;o++){const i=e[o];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=_(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=_(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e})}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{toolList:n}=t,s=this.Render.renderFunction("Button"),o=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return _(o,{style:{position:"relative"}},_("div",{className:Mo.toolbarWarp,ref:this.toolbarWarp},_("div",{className:Mo.toolbar,ref:this.toolbarRef},n.map(a=>a.toolbarType?_(i,{title:a.tooltip,placement:"bottom"},_(OT,{label:a.label,onClick:a.onClick})):_(xT,{tooltip:a.tooltip,type:a.type,display:a.display,children:a.children,customLabel:a.customLabel,customSuffix:a.customSuffix,label:a.label,onClick:a.onClick,onKeyUp:a.onKeyUp,defaultColor:a.defaultColor,hideSelectedIcon:a.hideSelectedIcon,selectClassName:a.selectClassName}))),this.state.moreToolList.length===0?null:_("div",{ref:this.moreBtn,className:Mo.singleButton},_(i,{title:this.state.moreText,placement:"bottom"},_(s,{type:"text",onClick:this.moreTool},_("div",{style:{fontSize:"14px"}},this.state.moreText))))),_("div",{className:`${Mo.moreTool} ${this.state.more?Mo.moreShow:null}`,ref:this.moreToolRef}))}}var ZN="";class MT extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Pe.DOCUMENT))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),s=this.Render.renderFunction("Tooltip"),o=this.Render.renderFunction("DropDownIcon");this.Render.renderFunction("LogoIcon");const{back:i,sheet:a,update:l,save:u,rename:c}=this.state.infoList;return _(t,{className:"universheet-info-detail"},_("div",{style:{marginRight:"18px"}},_(s,{title:i.label,placement:"bottom"},_(e,{className:"universheet-info-return",type:"text"},_(o,{rotate:90})))),_("div",{className:"sheet-name"},_(s,{title:c.label,placement:"bottom"},_(n,{bordered:!1,value:a.label,onBlur:a.onBlur}))),_("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},l.label),_("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},u.label))}}const Li={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,toolBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class NT extends Oe{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=Ae(),this.rightRef=Ae(),this.menuRef=Ae(),this.cellRightRef=Ae(),this.btnRef=Ae(),this.contentRef=Ae(),this.layoutContainerRef=Ae(),this.containerRef=Ae(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var g,m,f,p,b;this.leftContentLeft=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().left,this.leftContentTop=(m=this.splitLeftRef.current)==null?void 0:m.getBoundingClientRect().top;const d=(f=this.splitLeftRef.current)==null?void 0:f.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(b=d==null?void 0:d.getBoundingClientRect())==null?void 0:b.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,g=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,g=g>=this.rightBorderY?this.rightBorderY:g,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${g}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:n,layout:s,context:o,addSider:i,addMain:a,showSiderByName:l,showMainByName:u}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),l(this.showSiderByName.bind(this)),u(this.showMainByName.bind(this));const c=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=c.getComponentRender(),this.setSkin(t,n),this.state={layout:s==="auto"?W.deepClone(Li):W.deepMerge(Li,s),currentLocale:o.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}setSkin(e,t){let n=document.documentElement,o={default:uh,dark:ch,green:hh}[t];o=Object.fromEntries(Object.keys(o).map(l=>[`--${l.replace(/([A-Z])/g,"-$1").toLowerCase()}`,o[l]])),W.isIEBrowser()?Yn({rootElement:n,variables:o}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(o).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const u="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===u)return a(document.styleSheets[d],l),document.styleSheets[d];const c=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=u,c.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,u){let c=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${u}`){c=h,l.deleteRule(c);break}}}}addSider(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.siderPanelList.length+1});return{siderPanelList:[...n.siderPanelList,s]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.mainList.length+1});return{mainList:[...n.mainList,s]}},()=>{t()})})}showSiderByName(e,t){return new Promise(n=>{this.setState(s=>{let o=!1,i=0,a=s.siderPanelList.map(u=>(u.name===e&&(i=u.zIndex),u.zIndex));return{siderPanelList:s.siderPanelList.map(u=>(u.name===e?(u.show=t,u.zIndex=Math.max(...a)):u.zIndex>i&&u.zIndex--,u.show&&(o=!0),u)),showSider:o}},()=>{n()})})}showMainByName(e,t){return new Promise(n=>{this.setState(s=>({mainList:s.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{n()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Pe.DOCUMENT).getObserver("onDocContainerDidMountObservable"))==null||e.notifyObservers(this)})}render(){const{addButton:e,context:t}=this.props.config,{layout:n,currentLocale:s,currentSkin:o,siderPanelList:i,mainList:a,showSider:l,renderState:u}=this.state;return _(Eo.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},_(Fn,{ref:this.layoutContainerRef,className:is.layoutContainer},_(Gn,null,_(mn,{style:{display:n.outerLeft?"block":"none"}}),_(Gn,{className:is.mainContent,style:{position:"relative"}},_(Ii,{style:{display:n.header?"block":"none"}},n.infoBar&&_(MT,null),n.toolBar&&_(FT,{toolList:[]})),_(Gn,null,_(mn,{style:{display:n.innerLeft?"block":"none"}}),_(Di,{className:n.contentSplit==="vertical"?is.contentContainerVertical:is.contentContainerHorizontal},a.map((c,h)=>{if(c.type===Jr.JSX)return qr(c.content,{style:{display:c.show?"":"none"}});if(c.type===Jr.JSX_STRING){const d=this.Render.renderFunction(c.content);return this.refMap[c.name]=Ae(),_(d,{ref:this.refMap[c.name],style:{display:c.show?"":"none"}})}return c}),!!n.contentSplit&&_(Fn,{ref:this.splitLeftRef,className:is.contentInnerLeftContainer},_("div",{className:is.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),_(Fn,{ref:this.contentRef,className:is.contentInnerRightContainer,onClick:this.handleContentClick})),_(mn,{style:{display:n.innerRight?"block":"none"}})),_(xi,{style:{display:n.footer?"block":"none"}})),_(mn,{style:{display:n.outerRight&&l?"block":"none"},className:is.outerRightContainer},i.map((c,h)=>c.type===Jr.JSX?qr(c.label,{style:{display:c.show?"":"none",zIndex:c.zIndex}}):c)))))}}const kT=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],BT=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];class LT{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class Fp{constructor(e){this._plugin=e,this._plugin.getPluginName(),this._initRegisterComponent();const t=this._plugin.config.layout==="auto"?W.deepClone(Li.toolBarConfig):W.deepMerge(Li.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:t.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:t.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",selectClassName:Mo.selectLabelString,show:t.font,border:!0,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||s.notifyObservers(n)},children:BT},{type:1,tooltipLocale:"toolbar.fontSize",label:String(us.fs),show:t.fontSize,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},onKeyUp:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},children:kT},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:t.bold,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:t.italic,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:t.strikethrough,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:t.underline,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:t.textColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:t.fillColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||s.notifyObservers(n)}}],this._toolBarModel=new LT,this._toolBarModel.config=t,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,s,o,i,a,l,u,c;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(h=>{this.setFontFamily(h)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(h=>{this.setFontSize(h)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(h=>{this.setFontWeight(h)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(h=>{this.setFontStyle(h)}),(o=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||o.add(h=>{this.setStrikeThrough(h)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(h=>{this.setUnderline(h)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(h=>{this.setFontColor(h)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(h=>{this.setBackground(h)}),(u=this._plugin.getObserver("onToolBarDidMountObservable"))==null||u.add(h=>{this._toolBarComponent=h,this.resetToolBarList()}),(c=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null||c.add(()=>{})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet");this._plugin.getPluginName(),this.Render=e.getComponentRender();const t={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};for(let n in t)this._plugin.registerComponent(n,t[n])}resetLocale(e){const t=this._plugin.context.getLocale();for(let n=0;n<e.length;n++){const s=e[n];s.tooltipLocale&&(s.tooltip=t.get(s.tooltipLocale)),s.locale&&(s.label=t.get(s.locale)),s.suffixLocale&&(s.suffix=t.get(s.suffixLocale)),s.children&&(s.children=this.resetLocale(s.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){}setBackground(e){}setFontSize(e){}setFontFamily(e){}setFontWeight(e){}setFontStyle(e){}setStrikeThrough(e){}setUnderline(e){}}class PT{constructor(e){var t;this._plugin=e,this._previousIMEContent="",(t=this._plugin.getObserver("onDocContainerDidMountObservable"))==null||t.add(()=>{this._initialize()})}_initialize(){const e=this._plugin.getInputEvent();if(!e)return;const{onInputObservable:t,onCompositionstartObservable:n,onCompositionupdateObservable:s,onCompositionendObservable:o,onKeydownObservable:i}=e,a=this._plugin.context.getDocument();i.add(l=>{var f;const{event:u,document:c,selection:h}=l;let d=u;const g=(h==null?void 0:h.getCursor())||0,m=c.getSkeleton();if(!!m&&d.key===lu.backspace){const p=c.remainActiveSelection(),b=((f=c.findNodeByCharIndex(g-1))==null?void 0:f.content)||"";a.deleteText(b,g),m.calculate();const v=c.findNodeByCharIndex(g-2);this._adjustSelection(c,p,v),this._resetIME()}}),t.add(l=>{const{event:u,content:c="",document:h,selection:d}=l,g=(d==null?void 0:d.getCursor())||0;console.log("cursor",g,d);const m=h.getSkeleton();if(!m)return;const f=h.remainActiveSelection();a.insertText(c,g),m.calculate();const p=h.findNodeByCharIndex(g+c.length-1);this._adjustSelection(h,f,p)}),n.add(l=>{const{selection:u}=l,c=(u==null?void 0:u.getCursor())||0;this._previousIMEStart=c}),s.add(l=>{const{event:u,content:c="",document:h}=l,d=this._previousIMEStart,g=h.getSkeleton();if(!g)return;const m=u;if(c===this._previousIMEContent)return;const f=h.remainActiveSelection();a.updateText(c,this._previousIMEContent,d),g.calculate();const p=h.findNodeByCharIndex(d+c.length-1);console.log("Compositionupdate",c,this._previousIMEContent,m.data,d,p,g.getSkeletonData(),g),this._adjustSelection(h,f,p),this._previousIMEContent=c}),o.add(l=>{this._resetIME()})}_resetIME(){this._previousIMEContent="",this._previousIMEStart=-1}_getIncreaseText(e,t){const n=t.length;return e.slice(n)}_adjustSelection(e,t,n){if(n==null)return;const s=e.findPositionBySpan(n);if(s==null||t==null)return;this._hasListSpan(n)&&(s.span+=1);const o={...s,isBack:!1};e.addSelection(t),t.startNodePosition=o,t.endNodePosition=void 0,t.refresh(e),e.syncSelection()}_hasListSpan(e){var s;const t=e==null?void 0:e.parent;return t==null?!1:((s=t.spanGroup[0])==null?void 0:s.spanType)===on.LIST}}class HT{constructor(e,t={}){this._plugin=e,this._config=t,this._initialize()}_initialize(){this._inputController=new PT(this._plugin)}}class UT{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class Mp{constructor(e){this._plugin=e;const t="UniverDoc Demo";this._infoBarModel=new UT(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setDocName(n)}}},this._initialize()}_initialize(){this._plugin.context.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Pe.DOCUMENT).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setDocName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class Eh{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var No=(r=>(r.MAIN_SCENE="mainScene",r.DOCS_VIEW="docsView",r))(No||{});const Al=Un.create();var wh=(r=>(r.MAIN="__DocsRender__",r))(wh||{});class zT extends Eh{constructor(){super(...arguments),this.zIndex=1,this.viewKey=No.DOCS_VIEW}_initialize(){const e=this.getScene(),n=this.getContext().getDocument(),s=this._buildSkeleton(n.getSnapshot()),o=new ws("__DocsRender__",s);o.zIndex=1e3,this._documentSkeleton=s,this._documents=o,s.calculate(),e.addObjects([o],0),o.calculatePagePosition(),o.enableEditor()}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_buildSkeleton(e){const t=this.getContext();return Es.create(e,t)}}Al.add(new zT);const WT="page_view_background";class VT extends Eh{constructor(){super(...arguments),this.zIndex=2,this.viewKey=WT}_initialize(){var s;const e=this.getScene();this.getContext();const t=e.getObject(wh.MAIN),n=(s=t.getSkeleton())==null?void 0:s.getPageSize();t.onPageRenderObservable.add(o=>{const{page:i,pageLeft:a,pageTop:l,ctx:u}=o,{width:c,height:h,marginBottom:d,marginLeft:g,marginRight:m,marginTop:f}=i;u.save(),u.translate(a-.5,l-.5),tt.drawWith(u,{width:(n==null?void 0:n.width)||c,height:(n==null?void 0:n.height)||h,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),u.restore()})}}Al.add(new VT);const $T="drawings_view_background";class GT extends Eh{constructor(){super(...arguments),this.zIndex=3,this.viewKey=$T,this._liquid=new bo}_initialize(){var c;const e=this.getScene();this.getContext();const t=e.getObject(wh.MAIN),n=t.getSkeleton(),s=n==null?void 0:n.getSkeletonData();if(!s)return;const{left:o,top:i}=t,{pages:a}=s,l=[],u=new Map;for(let h=0,d=a.length;h<d;h++){const g=a[h],{skeDrawings:m,marginLeft:f,marginTop:p,pageWidth:b,pageHeight:v}=g;this._liquid.translatePagePadding(g),m.forEach(w=>{var M;const{aLeft:S,aTop:T,height:D,width:R,drawingOrigin:I}=w,{objectProperties:y}=I,O=new vs(w.objectId,{url:((M=y.imageProperties)==null?void 0:M.contentUrl)||"",left:S+o+this._liquid.x,top:T+i+this._liquid.y,width:R,height:D,zIndex:11,isTransformer:!0});u.set(w.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),l.push(O)}),this._liquid.translatePage(g,t.pageLayoutType,t.pageMarginLeft,t.pageMarginTop)}e.openTransformer(),e.addObjects(l),(c=e.getTransformer())==null||c.onChangingObservable.add(h=>{const{objects:d}=h;d.forEach(g=>{const{oKey:m,left:f,top:p,height:b,width:v}=g,w=u.get(m),S=(w==null?void 0:w.marginLeft)||0,T=(w==null?void 0:w.marginTop)||0;n==null||n.updateDrawing(m,{left:f-o-S,top:p-i-T,height:b,width:v})}),n==null||n.calculate()}),e.closeTransformer()}}Al.add(new GT);class XT{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine;this._plugin.getContext();const t=new Ss(No.MAIN_SCENE,e,{width:1200,height:2e3});this._scene=t;const n=new En(No.DOCS_VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(Bt.wheel,(s,o)=>{const i=s;if(i.ctrlKey){const a=Math.abs(i.deltaX);let l=a<40?.2:a<80?.4:.2;l*=i.deltaY>0?-1:1,t.scaleX<1&&(l/=2),t.scaleX+l>4?t.scale(4,4):t.scaleX+l<.1?t.scale(.1,.1):(i.deltaY>0,i.preventDefault())}else n.onMouseWheel(i,o)}),new Zr(n),t.addLayer(lo.create(t,[],0),lo.create(t,[],2)),this._viewLoader(t,this._plugin),e.runRenderLoop(()=>{t.render();const s=document.getElementById("app");s&&(s.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getDocsView(){return this.getView(No.DOCS_VIEW)}_viewLoader(e,t){Al.getData().sort(yt).forEach(n=>{this._views.push(n.initialize(e,t))})}}const YT={container:"univerdoc",layout:Li};class Rl extends sn{constructor(e={}){super(Pe.DOCUMENT),this._config=W.commonExtend(YT,e)}static create(e){return new Rl(e)}installTo(e){e.installPlugin(this)}initialize(){var o;const e=this.getContext();(o=this.getObserver("onDocContainerDidMountObservable"))==null||o.add(()=>{this._initializeRender()}),e.getLocale().load({en:RT,zh:AT}),this._componentList=new Map;const t=this._config.layout;t.toolBar&&(this._toolBarControl=new Fp(this)),t.infoBar&&(this._infoBarControl=new Mp(this)),this._toolBarControl=new Fp(this),this._infoBarControl=new Mp(this),this._documentController=new HT(this,this.config);const n=this._initContainer(this._config.container),s={skin:"default",layout:this._config.layout,container:n,context:e,getSplitLeftRef:i=>{this._splitLeftRef=i},getContentRef:i=>{this._contentRef=i},addButton:i=>{this._addButtonFunc=i},addSider:i=>{this._addSiderFunc=i},addMain:i=>{this._addMainFunc=i},showSiderByName:i=>{this._showSiderByNameFunc=i},showMainByName:i=>{this._showMainByNameFunc=i},onDidMount:()=>{}};Ar(_(NT,{config:s}),n)}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else qa(e)?t=e:(t=document.createElement("div"),t.id="univerdoc");return t}_initializeRender(){var t;const e=(t=this.getPluginByName(Pe.BASE_RENDER))==null?void 0:t.getEngine();this.register(e)}register(e){let t=ts(this.getContentRef());this._canvasEngine=e,e.setContainer(t),this._canvasView=new XT(e,this),window.addEventListener("resize",()=>{e.resize()})}get config(){return this._config}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(No.MAIN_SCENE)}getDocsView(){return this.getCanvasView().getDocsView()}getMainComponent(){return this.getDocsView().getDocs()}getInputEvent(){return this.getMainComponent().getEditorInputEvent()}getContentRef(){return this._contentRef}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}onMounted(e){IT(this),this.initialize()}onDestroy(){}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}}var jT=Object.freeze(Object.defineProperty({__proto__:null,DocPlugin:Rl},Symbol.toStringTag,{value:"Module"})),KT={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},ZT={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};function qT(r){r.pushToObserve("onAfterChangeFontFamilyObservable"),r.pushToObserve("onAfterChangeFontSizeObservable"),r.pushToObserve("onAfterChangeFontWeightObservable"),r.pushToObserve("onAfterChangeFontItalicObservable"),r.pushToObserve("onAfterChangeFontStrikethroughObservable"),r.pushToObserve("onAfterChangeFontUnderlineObservable"),r.pushToObserve("onAfterChangeFontBackgroundObservable"),r.pushToObserve("onAfterChangeFontColorObservable"),r.pushToObserve("onDragAndDropStartObserver"),r.pushToObserve("onDragAndDroppingObserver"),r.pushToObserve("onDragAndDropEndEndObserver"),r.pushToObserve("onFillStartObserver"),r.pushToObserve("onFillingObserver"),r.pushToObserve("onFillEndObserver"),r.pushToObserve("onChangeCurrentSheetObserver"),r.pushToObserve("onToolBarDidMountObservable"),r.pushToObserve("onSlideBarMousedownObservable"),r.pushToObserve("onSheetBarDidMountObservable"),r.pushToObserve("onCountBarDidMountObservable"),r.pushToObserve("onInfoBarDidMountObservable"),r.pushToObserve("onSlideBarDidMountObservable"),r.pushToObserve("onRightMenuDidMountObservable"),r.pushToObserve("onSlideContainerDidMountObservable"),r.pushToObserve("onSpreadsheetKeyDownObservable"),r.pushToObserve("onSpreadsheetKeyUpObservable"),r.pushToObserve("onSpreadsheetKeyCopyObservable"),r.pushToObserve("onSpreadsheetKeyPasteObservable"),r.pushToObserve("onSpreadsheetKeyCutObservable"),r.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),r.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),r.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}var as={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},JT={textButton:"univer-text-button"};class QT extends Oe{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return _("div",{className:JT.textButton},_(n,{type:"text",active:t,onClick:this.handleClick},e))}}var ko={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",doubleButton:"univer-double-button",colorBottom:"univer-color-bottom",doubleButtonRight:"univer-double-button-right",doubleButtonRightPopup:"univer-double-button-right-popup",doubleButtonMenuItem:"univer-double-button-menu-item",doubleButtonMenuItemIcon:"univer-double-button-menu-item-icon",doubleButtonMenuItemContent:"univer-double-button-menu-item-content",moreButton:"univer-more-button",moreTool:"univer-more-tool",univericonNextIcon:"univer-univericon-nextIcon"},Pi={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class Th extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:o}=this.props;return _("div",{className:$t(Pi.selectItem,o?Pi.selectDisabledItem:"")},t?_("span",{className:Pi.selectItemSelected},_(e,null)):"",_("span",{className:Pi.selectItemContent},n),s?_("span",{className:Pi.selectItemSuffix},s):"")}}var yn={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"};class eS extends Oe{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(o=>{o.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("Button");return _("div",{className:`${yn.selectSingle} ${n}`},_(o,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return _("div",{className:`${yn.selectInput} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},_(o,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{color:s,menu:o}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return _("div",{className:`${yn.selectColor} ${yn.selectDouble} ${t}`},_(i,{type:"text"},_(Ht,{tooltip:n,onClick:this.onClick,menu:{menu:o,onClick:this.onClick},icon:_(a,null)},_("div",{className:yn.selectLabel},e),_("div",{className:yn.selectLine,style:{background:s}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,o=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return _("div",{className:`${yn.selectDouble} ${n}`},_(i,{type:"text"},_(Ht,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:_(o,null)},_("div",{className:yn.selectLabel},e))))},this.getFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this.Render.renderFunction("Button");return _("div",{className:`${yn.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},_("div",{className:yn.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,o=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return _("div",{className:`${yn.selectDouble} ${t}`},_(o,{type:"text"},_(Ht,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:_(i,null)},_("div",{className:yn.selectLabel},e))))}}initialize(){var o;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(o=this.props.defaultColor)!=null?o:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}componentDidMount(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=this.handleSelected(o),a=n[o];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const u=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),u.unSelectable)return;const c=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:c}):this.setState({content:n[l[2]].label,menu:c})}}else if(e===1){if(!n.length)return;const o=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(u=>i===u.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(c=>c.selected);a<0&&(a=0);let l=this.handleSelected(a);const u=n[a];this.setState({content:u.label,menu:l})}};o(s),this.onClick=(...i)=>{var l,u;(u=(l=this.props).onClick)==null||u.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,u;const a=i.currentTarget.value;(u=(l=this.props).onKeyUp)==null||u.call(l,a),o(a)}}else if(e===2){const o=this.handleSelected(null);this.setState({menu:o}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let o=n.findIndex(l=>l.selected);o<0&&(o=0);const i=n[o],a=this.handleSelected(o);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var u,c,h,d;if(l.length){(c=(u=this.props).onClick)==null||c.call(u,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}resetMenu(e,t){var s;const n=[];for(let o=0;o<e.length;o++){let i=!1;t||(i=(s=e[o].selected)!=null?s:!1),n[o]={label:""},n[o].label=_(Th,{disabled:e[o].disabled,border:e[o].border,selected:i,label:e[o].label,suffix:e[o].suffix}),n[o].disabled=e[o].disabled,n[o].style=e[o].style,n[o].value=e[o].value,n[o].className=e[o].className,n[o].onClick=e[o].onClick,e[o].children&&(n[o].children=this.getChildren(e[o].children))}return this.props.type===2&&(n[0]={label:_(Th,{label:_(wn,{style:{display:"block"},ref:o=>this.ColorRef=o,color:"#000",onClick:o=>{this.ColorRef.hideSelect(),this.setState({color:o},()=>{this.onClick()})}})})}),n}getChildren(e){return e.map(n=>{const s=this.props.hideSelectedIcon?!1:n.selected;return n.label=_(Th,{disabled:n.disabled,border:n.border,selected:s,label:n.label,suffix:n.suffix}),n.children&&(n.children=this.getChildren(n.children)),n})}render(){const{type:e=0}=this.props;return _("div",{className:yn.selectComponent},this.getType(e))}}class tS extends Oe{constructor(){super(...arguments),this.toolbarWarp=Ae(),this.toolbarRef=Ae(),this.moreBtn=Ae(),this.moreToolRef=Ae(),this.SelectRef=Ae(),this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Pe.SLIDE);for(let o=0;o<e.length;o++){const i=e[o];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=_(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=_(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e})}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{toolList:n}=t,s=this.Render.renderFunction("Button"),o=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return _(o,{style:{position:"relative"}},_("div",{className:ko.toolbarWarp,ref:this.toolbarWarp},_("div",{className:ko.toolbar,ref:this.toolbarRef},n.map(a=>a.toolbarType?_(i,{title:a.tooltip,placement:"bottom"},_(QT,{label:a.label,onClick:a.onClick})):_(eS,{tooltip:a.tooltip,type:a.type,display:a.display,children:a.children,customLabel:a.customLabel,customSuffix:a.customSuffix,label:a.label,onClick:a.onClick,onKeyUp:a.onKeyUp,defaultColor:a.defaultColor,hideSelectedIcon:a.hideSelectedIcon,selectClassName:a.selectClassName}))),this.state.moreToolList.length===0?null:_("div",{ref:this.moreBtn,className:ko.singleButton},_(i,{title:this.state.moreText,placement:"bottom"},_(s,{type:"text",onClick:this.moreTool},_("div",{style:{fontSize:"14px"}},this.state.moreText))))),_("div",{className:`${ko.moreTool} ${this.state.more?ko.moreShow:null}`,ref:this.moreToolRef}))}}var jk="";class nS extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Pe.SLIDE))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),s=this.Render.renderFunction("Tooltip"),o=this.Render.renderFunction("DropDownIcon");this.Render.renderFunction("LogoIcon");const{back:i,sheet:a,update:l,save:u,rename:c}=this.state.infoList;return _(t,{className:"universheet-info-detail"},_("div",{style:{marginRight:"18px"}},_(s,{title:i.label,placement:"bottom"},_(e,{className:"universheet-info-return",type:"text"},_(o,{rotate:90})))),_("div",{className:"sheet-name"},_(s,{title:c.label,placement:"bottom"},_(n,{bordered:!1,value:a.label,onBlur:a.onBlur}))),_("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},l.label),_("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},u.label))}}var Hs={slideBar:"univer-slide-bar",slideBarContent:"univer-slide-bar-content",slideBarItem:"univer-slide-bar-item",slideBarBox:"univer-slide-bar-box",slideBarItemActive:"univer-slide-bar-item-active",slideAddButton:"univer-slide-add-button"};class rS extends Oe{constructor(){super(...arguments),this.slideBarRef=Ae()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={slideList:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSlideBarDidMountObservable",Pe.SLIDE))==null||e.notifyObservers(this)}isActive(e,t=0){return this.state.activePageId==null&&t==0||this.state.activePageId===e?Hs.slideBarItemActive:""}setSlide(e){this.setState({slideList:e})}handleClick(e,t){var n;this.state.activePageId!==e&&(this.setState({activePageId:e}),(n=this._context.getObserverManager().getObserver("onSlideBarMousedownObservable",Pe.SLIDE))==null||n.notifyObservers(e))}render(){const e=this._render.renderFunction("Button"),{addSlide:t}=this.props,{slideList:n}=this.state;return _("div",{className:Hs.slideBar,ref:this.slideBarRef},_("div",{className:Hs.slideBarContent},n.map((s,o)=>_("div",{className:`${Hs.slideBarItem} ${this.isActive(s.id,o)}`,onClick:()=>this.handleClick(s.id,o)},_("span",null,o+1),_("div",{className:Hs.slideBarBox})))),_("div",{className:Hs.slideAddButton},_(e,{type:"text",onClick:t},"+")))}}const Hi={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,toolBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class sS extends Oe{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=Ae(),this.rightRef=Ae(),this.menuRef=Ae(),this.cellRightRef=Ae(),this.btnRef=Ae(),this.contentRef=Ae(),this.layoutContainerRef=Ae(),this.containerRef=Ae(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var g,m,f,p,b;this.leftContentLeft=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().left,this.leftContentTop=(m=this.splitLeftRef.current)==null?void 0:m.getBoundingClientRect().top;const d=(f=this.splitLeftRef.current)==null?void 0:f.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(b=d==null?void 0:d.getBoundingClientRect())==null?void 0:b.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,g=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,g=g>=this.rightBorderY?this.rightBorderY:g,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${g}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:n,layout:s,context:o,addSider:i,addMain:a,showSiderByName:l,showMainByName:u}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),l(this.showSiderByName.bind(this)),u(this.showMainByName.bind(this));const c=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=c.getComponentRender(),this.setSkin(t,n),this.state={layout:s==="auto"?W.deepClone(Hi):W.deepMerge(Hi,s),currentLocale:o.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}setSkin(e,t){let n=document.documentElement,o={default:uh,dark:ch,green:hh}[t];o=Object.fromEntries(Object.keys(o).map(l=>[`--${l.replace(/([A-Z])/g,"-$1").toLowerCase()}`,o[l]])),W.isIEBrowser()?Yn({rootElement:n,variables:o}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(o).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const u="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===u)return a(document.styleSheets[d],l),document.styleSheets[d];const c=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=u,c.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,u){let c=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${u}`){c=h,l.deleteRule(c);break}}}}addSider(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.siderPanelList.length+1});return{siderPanelList:[...n.siderPanelList,s]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.mainList.length+1});return{mainList:[...n.mainList,s]}},()=>{t()})})}showSiderByName(e,t){return new Promise(n=>{this.setState(s=>{let o=!1,i=0,a=s.siderPanelList.map(u=>(u.name===e&&(i=u.zIndex),u.zIndex));return{siderPanelList:s.siderPanelList.map(u=>(u.name===e?(u.show=t,u.zIndex=Math.max(...a)):u.zIndex>i&&u.zIndex--,u.show&&(o=!0),u)),showSider:o}},()=>{n()})})}showMainByName(e,t){return new Promise(n=>{this.setState(s=>({mainList:s.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{n()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Pe.SLIDE).getObserver("onSlideContainerDidMountObservable"))==null||e.notifyObservers(this)})}addSlide(){this.getContext().getPluginManager().getRequirePluginByName(Pe.SLIDE).getSlideBarControl().addSlide()}render(){const{addButton:e,context:t}=this.props.config,{layout:n,currentLocale:s,currentSkin:o,siderPanelList:i,mainList:a,showSider:l,renderState:u}=this.state;return _(Eo.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},_(Fn,{ref:this.layoutContainerRef,className:as.layoutContainer},_(Gn,null,_(mn,{style:{display:n.outerLeft?"block":"none"}}),_(Gn,{className:as.mainContent,style:{position:"relative"}},_(Ii,{style:{display:n.header?"block":"none"}},n.infoBar&&_(nS,null),n.toolBar&&_(tS,{toolList:[]})),_(Gn,null,_(mn,{style:{width:"300px",display:n.innerLeft?"block":"none"}},_(rS,{addSlide:this.addSlide.bind(this)})),_(Di,{className:n.contentSplit==="vertical"?as.contentContainerVertical:as.contentContainerHorizontal},a.map((c,h)=>{if(c.type===Jr.JSX)return qr(c.content,{style:{display:c.show?"":"none"}});if(c.type===Jr.JSX_STRING){const d=this.Render.renderFunction(c.content);return this.refMap[c.name]=Ae(),_(d,{ref:this.refMap[c.name],style:{display:c.show?"":"none"}})}return c}),!!n.contentSplit&&_(Fn,{ref:this.splitLeftRef,className:as.contentInnerLeftContainer},_("div",{className:as.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),_(Fn,{ref:this.contentRef,className:as.contentInnerRightContainer,onClick:this.handleContentClick})),_(mn,{style:{display:n.innerRight?"block":"none"}})),_(xi,{style:{display:n.footer?"block":"none"}})),_(mn,{style:{display:n.outerRight&&l?"block":"none"},className:as.outerRightContainer},i.map((c,h)=>c.type===Jr.JSX?qr(c.label,{style:{display:c.show?"":"none",zIndex:c.zIndex}}):c)))))}}const oS=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],iS=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];class Np extends Oe{initialize(){var t;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={locale:"",color:(t=this.props.color)!=null?t:"#000"}}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setLocale(){const e=this.context.locale;this.setState({locale:e.get("borderLine.borderColor")})}setColor(e){this.setState({color:e})}render(){const e=this.Render.renderFunction("RightIcon"),{locale:t,color:n}=this.state;return _("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},_("span",{style:{display:"inline-block",borderBottom:`3px solid ${n}`}},t),_(e,null))}}class aS{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class lS{constructor(e){this._plugin=e,this._plugin.getPluginName(),this._initRegisterComponent();const t=this._plugin.config.layout==="auto"?W.deepClone(Hi.toolBarConfig):W.deepMerge(Hi.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:t.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:t.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",selectClassName:ko.selectLabelString,show:t.font,border:!0,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||s.notifyObservers(n)},children:iS},{type:1,tooltipLocale:"toolbar.fontSize",label:String(us.fs),show:t.fontSize,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},onKeyUp:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},children:oS},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:t.bold,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:t.italic,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:t.strikethrough,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:t.underline,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:t.textColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:t.fillColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||s.notifyObservers(n)}}],this._toolBarModel=new aS,this._toolBarModel.config=t,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,s,o,i,a,l,u,c;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(h=>{this.setFontFamily(h)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(h=>{this.setFontSize(h)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(h=>{this.setFontWeight(h)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(h=>{this.setFontStyle(h)}),(o=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||o.add(h=>{this.setStrikeThrough(h)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(h=>{this.setUnderline(h)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(h=>{this.setFontColor(h)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(h=>{this.setBackground(h)}),(u=this._plugin.getObserver("onToolBarDidMountObservable"))==null||u.add(h=>{this._toolBarComponent=h,this.resetToolBarList()}),(c=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null||c.add(()=>{})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet"),t=this._plugin.getPluginName();this.Render=e.getComponentRender();const n={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};this._plugin.registerComponent(t+Np.name,Np),this._plugin.registerComponent(t+wn.name,wn);for(let s in n)this._plugin.registerComponent(s,n[s])}resetLocale(e){const t=this._plugin.context.getLocale();for(let n=0;n<e.length;n++){const s=e[n];s.tooltipLocale&&(s.tooltip=t.get(s.tooltipLocale)),s.locale&&(s.label=t.get(s.locale)),s.suffixLocale&&(s.suffix=t.get(s.suffixLocale)),s.children&&(s.children=this.resetLocale(s.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){}setBackground(e){}setFontSize(e){}setFontFamily(e){}setFontWeight(e){}setFontStyle(e){}setStrikeThrough(e){}setUnderline(e){}}class uS{constructor(e){this._plugin=e,this._initialize()}_initialize(){}}class cS{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class hS{constructor(e){this._plugin=e;const t="UniverSlide Demo";this._infoBarModel=new cS(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setSlideName(n)}}},this._initialize()}_initialize(){this._plugin.context.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Pe.SLIDE).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSlideName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class dS{constructor(e){this._pages=[],this._plugin=e,this._init()}_init(){const t=this._plugin.context.getObserverManager();this._generateModel(),t.requiredObserver("onSlideBarDidMountObservable",Pe.SLIDE).add(n=>{var s,o;this._slideBar=n,this._slideBar.setSlide(this._pages),(s=this._plugin.getObserver("onSlideContainerDidMountObservable"))==null||s.add(()=>{const i=this._getCanvasView();i.createSlidePages(this._slideBar,this._pages),i.getSlide().onSlideChangePageByNavigationObservable.add(a=>{this._slideBar.state.activePageId===a||a==null||(this._slideBar.setState({activePageId:a}),i.activePage(a))})}),(o=this._plugin.getObserver("onSlideBarMousedownObservable"))==null||o.add(i=>{this._getCanvasView().activePage(i)})})}_getCanvasView(){return this._plugin.getCanvasView()}_generateModel(){const e=this._plugin.context.getSlide(),t=e.getPages(),n=e.getPageOrder();!t||!n||n.forEach(s=>{this._pages.push(t[s])})}addSlide(){const e=this._plugin.context.getSlide(),t=this._getCanvasView(),n=e.addPage();this._pages.push(n),this._slideBar.setSlide(this._pages),t.createSlidePages(this._slideBar,this._pages)}}class Ui{constructor(){this.zIndex=0}check(e){if(e===this.viewKey)return this}convert(e,t,n){}}const Bo=Un.create();class gS extends Ui{constructor(){super(...arguments),this.zIndex=1,this.viewKey=Ie.IMAGE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:n,left:s=0,top:o=0,width:i,height:a,angle:l,scaleX:u,scaleY:c,skewX:h,skewY:d,flipX:g,flipY:m,title:f,description:p,image:b={}}=e,{imageProperties:v,placeholder:w,link:S}=b,T=(v==null?void 0:v.contentUrl)||"";return new vs(t,{url:T,top:o,left:s,width:i,height:a,zIndex:n,angle:l,scaleX:u,scaleY:c,skewX:h,skewY:d,flipX:g,flipY:m,isTransformer:!0,forceRender:!0})}}Bo.add(new gS);class fS extends Ui{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Ie.TEXT}check(e){if(e===this.viewKey)return this}convert(e,t,n){if(n==null)return;const{id:s,zIndex:o,left:i=0,top:a=0,width:l,height:u,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,title:b,description:v,richText:w={}}=e,{text:S,ff:T,fs:D,it:R,bl:I,ul:y,st:O,ol:M,bg:F,bd:x,cl:E,rich:N}=w;let X={top:a,left:i,width:l,height:u,zIndex:o,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,isTransformer:!0,forceRender:!0},L=!1;if(S!=null?(X={...X,text:S,ff:T,fs:D,it:R,bl:I,ul:y,st:O,ol:M,bg:F,bd:x,cl:E},L=!0):N!=null&&(X={...X,richText:N},L=!0),L!==!1)return new U6(n,s,X)}}Bo.add(new fS);class mS extends Ui{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Ie.SHAPE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:n,left:s=0,top:o=0,width:i,height:a,angle:l,scaleX:u,scaleY:c,skewX:h,skewY:d,flipX:g,flipY:m,title:f,description:p}=e,{shapeType:b,text:v,shapeProperties:w,placeholder:S,link:T}=e.shape||{},D=w==null?"":Ft(w.shapeBackgroundFill)||"rgba(255,255,255,1)",R=w==null?void 0:w.outline,I={};if(R){const{outlineFill:y,weight:O}=R;I.strokeWidth=O,I.stroke=Ft(y)||"rgba(0,0,0,1)"}if(b===Ot.RECTANGLE)return new tt(t,{fill:D,top:o,left:s,width:i,height:a,zIndex:n,angle:l,scaleX:u,scaleY:c,skewX:h,skewY:d,flipX:g,flipY:m,isTransformer:!0,forceRender:!0,...I});if(b===Ot.ROUND_RECTANGLE){const y=(w==null?void 0:w.radius)||0;return new tt(t,{fill:D,top:o,left:s,width:i,height:a,zIndex:n,angle:l,scaleX:u,scaleY:c,skewX:h,skewY:d,flipX:g,flipY:m,isTransformer:!0,forceRender:!0,radius:y,...I})}else Ot.ELLIPSE}}Bo.add(new mS);class pS extends Ui{constructor(){super(...arguments),this.zIndex=4,this.viewKey=Ie.SPREADSHEET}check(e){if(e===this.viewKey)return this}convert(e,t,n){const{id:s,zIndex:o,left:i=0,top:a=0,width:l,height:u,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,title:b,description:v,spreadsheet:w}=e;if(w==null||n==null)return;const{worksheet:S,styles:T}=w,{columnData:D,rowData:R,cellData:I}=S,y=new _e(I),O=mi.create(S,y,new Cu(T),n),{rowTotalHeight:M,columnTotalWidth:F,rowTitleWidth:x,columnTitleHeight:E}=O,N=F+S.rowTitle.width||0,X=M+S.columnTitle.height||0,L=new za("spreadInSlideSceneViewer"+s,{top:a,left:i,width:l,height:u,zIndex:o,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,isTransformer:!0,forceRender:!0}),ne=new Ss("spreadInSlideScene"+s,L,{width:N,height:X});this._updateViewport(s,x,E,ne,t);const G=new wc("testSheetViewer",O,!1),Q=new Tc("spreadInSlideRow",O),P=new Sc("spreadInSlideColumn",O),V=new tt("spreadInSlideLeftTop",{zIndex:2,left:-1,top:-1,width:x,height:E,fill:pt([248,249,250]),stroke:pt([217,217,217]),strokeWidth:1});return G.zIndex=10,ne.addObjects([G],1),ne.addObjects([Q,P,V],2),L}_updateViewport(e,t,n,s,o){if(o==null)return;const i=t*s.scaleX,a=n*s.scaleY,l=new En("spreadInSlideViewMain"+e,s,{left:i,top:a,bottom:0,right:0,isWheelPreventDefaultX:!0}),u=new En("spreadInSlideViewTop"+e,s,{left:i,height:a,top:0,right:0,isWheelPreventDefaultX:!0}),c=new En("spreadInSlideViewLeft"+e,s,{left:0,bottom:0,top:a,width:i,isWheelPreventDefaultX:!0}),h=new En("spreadInSlideViewLeftTop"+e,s,{left:0,top:0,width:i,height:a,isWheelPreventDefaultX:!0});l.onScrollAfterObserver.add(d=>{const{scrollX:g,scrollY:m,actualScrollX:f,actualScrollY:p}=d;u.updateScroll({scrollX:g,actualScrollX:f}).makeDirty(!0),c.updateScroll({scrollY:m,actualScrollY:p}).makeDirty(!0)}),s.addViewport(l,c,u,h).attachControl(),new Zr(l,{mainScene:o}),s.on(Bt.wheel,(d,g)=>{const m=d;if(m.ctrlKey){const f=Math.abs(m.deltaX);let p=f<40?.05:f<80?.02:.01;p*=m.deltaY>0?-1:1,s.scaleX<1&&(p/=2),s.scaleX+p>4?s.scale(4,4):s.scaleX+p<.1?s.scale(.1,.1):(s.scaleBy(p,p),m.preventDefault())}else l.onMouseWheel(m,g)})}}Bo.add(new pS);class _S extends Ui{constructor(){super(...arguments),this.zIndex=5,this.viewKey=Ie.DOCUMENT,this._liquid=new bo}check(e){if(e===this.viewKey)return this}convert(e,t,n){var N,X;const{id:s,zIndex:o,left:i=0,top:a=0,width:l,height:u,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,title:b,description:v,document:w}=e;if(w==null)return;const S=Es.create(w,n),T=new ws("__DocsRender__",S);S.calculate();const D=new za("__DocsViewer__"+s,{top:a,left:i,width:l,height:u,zIndex:o,angle:c,scaleX:h,scaleY:d,skewX:g,skewY:m,flipX:f,flipY:p,isTransformer:!0}),R=new Ss("__DocsScene__"+s,D),I=new En("__DocsViewPort_"+s,R,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});R.addViewport(I).attachControl(),R.on(Bt.wheel,(L,ne)=>{const G=L;if(G.ctrlKey){const Q=Math.abs(G.deltaX);let P=Q<40?.2:Q<80?.4:.2;P*=G.deltaY>0?-1:1,R.scaleX<1&&(P/=2),R.scaleX+P>4?R.scale(4,4):R.scaleX+P<.1?R.scale(.1,.1):(G.deltaY>0,G.preventDefault())}else I.onMouseWheel(G,ne)}),new Zr(I,{mainScene:t}),R.addObject(T),T.calculatePagePosition();const y=(N=T.getSkeleton())==null?void 0:N.getPageSize();T.onPageRenderObservable.add(L=>{const{page:ne,pageLeft:G,pageTop:Q,ctx:P}=L,{width:V,height:pe,marginBottom:oe,marginLeft:Z,marginRight:ie,marginTop:be}=ne;P.save(),P.translate(G-.5,Q-.5),tt.drawWith(P,{width:(y==null?void 0:y.width)||V,height:(y==null?void 0:y.height)||pe,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),P.restore()});const{left:O,top:M}=T,{pages:F}=S.getSkeletonData(),x=[],E=new Map;for(let L=0,ne=F.length;L<ne;L++){const G=F[L],{skeDrawings:Q,marginLeft:P,marginTop:V,pageWidth:pe,pageHeight:oe}=G;this._liquid.translatePagePadding(G),Q.forEach(Z=>{var Ne;const{aLeft:ie,aTop:be,height:Ce,width:fe,drawingOrigin:Te}=Z,{objectProperties:Le}=Te,Ze=new vs(Z.objectId,{url:((Ne=Le.imageProperties)==null?void 0:Ne.contentUrl)||"",left:ie+O+this._liquid.x,top:be+M+this._liquid.y,width:fe,height:Ce,zIndex:11,isTransformer:!0});E.set(Z.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),x.push(Ze)}),this._liquid.translatePage(G,T.pageLayoutType,T.pageMarginLeft,T.pageMarginTop)}return R.openTransformer(),R.addObjects(x),(X=R.getTransformer())==null||X.onChangingObservable.add(L=>{const{objects:ne}=L;ne.forEach(G=>{const{oKey:Q,left:P,top:V,height:pe,width:oe}=G,Z=E.get(Q),ie=(Z==null?void 0:Z.marginLeft)||0,be=(Z==null?void 0:Z.marginTop)||0;S==null||S.updateDrawing(Q,{left:P-O-ie,top:V-M-be,height:pe,width:oe})}),S==null||S.calculate()}),R.closeTransformer(),D}}Bo.add(new _S);class Sh{constructor(){this._adaptors=[],this._adaptorLoader()}convertToRenderObjects(e,t,n){const s=Object.keys(e),o=[];return s.forEach(i=>{const a=e[i],l=this._executor(a,t,n);l!=null&&o.push(l)}),o}_executor(e,t,n){var i;const{id:s,type:o}=e;for(let a of this._adaptors){const l=(i=a.check(o))==null?void 0:i.convert(e,t,n);if(l!=null)return l}}_adaptorLoader(){Bo.getData().sort(yt).forEach(e=>{this._adaptors.push(e)})}static create(){return new Sh}}class bS{constructor(e,t){this._engine=e,this._plugin=t,this._slideThumbEngine=new Map,this._ObjectProvider=new Sh,this._initialize()}getSlide(){return this._slide}createSlidePages(e,t){var a;const s=(a=e.slideBarRef.current)==null?void 0:a.childNodes[0].childNodes;if(!(s==null||s.length!==t.length)){for(var o=0,i=s.length;o<i;o++){const l=s[o].querySelector("div"),u=t[o],{id:c}=u;this._slideThumbEngine.has(c)||!l||(this._createThumb(l,c),this._createScene(c,this._slide,t[o]),this._thumbSceneRender(c))}this._activePageId=t[0].id,this._slide.activeFirstPage()}}activePage(e){const t=this._plugin.context.getSlide();let n;if(e)n=t.getPage(e);else{const o=t.getPages(),i=t.getPageOrder();if(i==null||o==null)return;n=o[i[0]],e=n.id}if(n==null)return;const{id:s}=n;if(this._activePageId=e,this._slide.hasPage(s)){this._slide.changePage(s);return}this._createScene(s,this._slide,n)}_initialize(){const e=this._engine,t=new Ss("__mainScene__",e,{width:2400,height:1800});this._scene=t;const n=new En("__mainView__",t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(Bt.wheel,(l,u)=>{const c=l;if(c.ctrlKey){const h=Math.abs(c.deltaX);let d=h<40?.2:h<80?.4:.2;d*=c.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):(c.deltaY>0,c.preventDefault())}else n.onMouseWheel(c,u)}),Zr.attachTo(n);const{left:s,top:o}=this._getCenterPositionViewPort(),{x:i,y:a}=n.getBarScroll(s,o);n.scrollTo({x:i,y:a}),this._createSlide(),this.activePage(),e.runRenderLoop(()=>{t.render();const l=document.getElementById("app");l&&(l.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}_createSlide(){const e=this._plugin.context.getSlide(),t=this._scene,{width:n,height:s}=t,o=e.getPageSize(),{width:i=100,height:a=100}=o,l=new H6("__slideRender__",{left:(n-i)/2,top:(s-a)/2,width:i,height:a,zIndex:10});l.enableNav(),l.enableSelectedClipElement(),this._slide=l,t.addObject(l)}_addBackgroundRect(e,t){const s=this._plugin.context.getSlide().getPageSize(),{width:o=0,height:i=0}=s,a=new tt("canvas",{left:0,top:0,width:o,height:i,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:Ft(t)||"rgba(255,255,255, 1)",zIndex:0,evented:!1});e.addObject(a,0)}_getCenterPositionViewPort(){const{width:e,height:t}=this._scene,n=this._scene.getEngine(),s=(n==null?void 0:n.width)||0,o=(n==null?void 0:n.height)||0;return{left:(e-s)/2,top:(t-o)/2}}_thumbSceneRender(e){const t=this._slideThumbEngine.get(e);if(t==null)return;const{width:n,height:s}=this._slide,{width:o=n,height:i=s}=t,a=t.getCanvas().getContext();this._slide.renderToThumb(a,e,o/n,i/s)}_createThumb(e,t){const n=new Zu;n.setContainer(e),this._slideThumbEngine.set(t,n)}_createScene(e,t,n){let{width:s,height:o}=t;const i=new Ss(e,t,{width:s,height:o}),a=new En("PageViewer_"+e,i,{left:0,top:0,bottom:0,right:0});a.closeClip(),i.addViewport(a);const{pageElements:l,pageBackgroundFill:u}=n,c=this._ObjectProvider.convertToRenderObjects(l,this._scene,this._plugin.context);i.openTransformer(),this._addBackgroundRect(i,u),i.addObjects(c);const h=i.getTransformer();return h==null||h.onChangeEndObservable.add(()=>{this._thumbSceneRender(this._activePageId)}),h==null||h.onClearControlObservable.add(()=>{this._thumbSceneRender(this._activePageId)}),this._slide.addPage(i),i}}const vS={container:"universlide",layout:Hi};class Il extends sn{constructor(e={}){super(Pe.SLIDE),this._config=W.commonExtend(vS,e)}static create(e){return new Il(e)}installTo(e){e.installPlugin(this)}initialize(){var o;const e=this.getContext();(o=this.getObserver("onSlideContainerDidMountObservable"))==null||o.add(()=>{this._initializeRender()}),e.getLocale().load({en:ZT,zh:KT}),this._componentList=new Map;const t=this._config.layout;t.toolBar&&(this._toolBarControl=new lS(this)),t.infoBar&&(this._infoBarControl=new hS(this)),this._slideBarControl=new dS(this),this._SlideController=new uS(this);const n=this._initContainer(this._config.container),s={skin:"default",layout:this._config.layout,container:n,context:e,getSplitLeftRef:i=>{this._splitLeftRef=i},getContentRef:i=>{this._contentRef=i},addButton:i=>{this._addButtonFunc=i},addSider:i=>{this._addSiderFunc=i},addMain:i=>{this._addMainFunc=i},showSiderByName:i=>{this._showSiderByNameFunc=i},showMainByName:i=>{this._showMainByNameFunc=i},onDidMount:()=>{}};Ar(_(sS,{config:s}),n)}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else qa(e)?t=e:(t=document.createElement("div"),t.id="universlide");return t}_initializeRender(){var t;const e=(t=this.getPluginByName(Pe.BASE_RENDER))==null?void 0:t.getEngine();this.register(e)}register(e){let t=ts(this.getContentRef());this._canvasEngine=e,e.setContainer(t),this._canvasView=new bS(e,this),window.addEventListener("resize",()=>{e.resize()})}get config(){return this._config}getContentRef(){return this._contentRef}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSlideBarControl(){return this._slideBarControl}getCanvasView(){return this._canvasView}onMounted(){qT(this),this.initialize()}onDestroy(){}registerComponent(e,t){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}}var CS=Object.freeze(Object.defineProperty({__proto__:null,SlidePlugin:Il},Symbol.toStringTag,{value:"Module"})),ES={collaboration:{tooltip:"Collaboration",one:"\u4E00",two:"\u4E8C",three:"\u4E09"}},wS={collaboration:{tooltip:"Collaboration",one:"one",two:"two",three:"three"}};const TS="collaboration";class SS{constructor(e){this._plugin=e,this._initialize()}_initialize(){const e=this._plugin.getConfig(),{url:t}=e;if(t===""){console.warn("url must be input");return}this._initSocket(t),this._initObserver()}_initSocket(e){this.socket=new Su({url:e}),this.socket.on(dn.MESSAGE,t=>{this.onMessage(t&&t.data)}),this.socket.on(dn.ERROR,t=>{this.onError(t&&t.data)}),this.socket.on(dn.OPEN,t=>{this.onOpen(t&&t.data)}),this.socket.on(dn.CLOSE,t=>{this.onClose(t&&t.data)}),this.socket.on(dn.RETRY,t=>{this.onRetry(t&&t.data)}),this.socket.on(dn.DESTROY,t=>{this.onDestroy(t&&t.data)}),this.socket.link()}_initObserver(){let e=null;He.getCommandObservers().add(({actions:t})=>{const n=this._plugin;if(!n||!t||t.length===0)return;const s=t[0];if(s.getDoActionData().actionName!==$.SET_RANGE_DATA_ACTION)return;const i=n.context,a=i.getWorkBook().getUnitId(),l=s.getWorkBook().getUnitId();if(a!==l)return;if(s.getWorkBook().getActiveSheet())try{e&&(clearTimeout(e),e=null),e=setTimeout(()=>{const c=i.getWorkBook().getConfig(),h={type:"workbookData",config:c},d=JSON.stringify(h);this.previousMessage=d,this.socket.send(d)},100)}catch(c){console.info(c)}})}onMessage(e){const n=JSON.parse(e).content;if(!(n===Tu||this.previousMessage===n)){this.previousMessage=n;try{const s=JSON.parse(n);s&&s.type==="workbookData"&&(console.log("refresh"),this.refresh(s.config))}catch{console.error(n)}}}onError(e){console.log("onError====",e)}onOpen(e){console.log("onOpen====",e)}onClose(e){console.log("onClose====",e)}onRetry(e){console.log("onRetry====",e)}onDestroy(e){console.log("onDestroy====",e)}close(){this.socket.close()}refresh(e){const t=this._plugin.getContext();t.refreshWorkbook(e);const n=t.getWorkBook().getActiveSheet();if(n)try{const s=t.getPluginManager().getRequirePluginByName(Pe.SPREADSHEET),o=s.getCanvasView();o&&(o.updateToSheet(n),s.getMainComponent().makeDirty(!0))}catch(s){console.info(s)}}}class xl extends sn{constructor(e){super(TS),this.config=e||{url:""},console.log("colla---config---",e)}static create(e){return new xl(e)}installTo(e){e.installPlugin(this)}initialize(){this.getContext().getLocale().load({en:wS,zh:ES}),this._collaborationController=new SS(this)}onMounted(){this.initialize()}onDestroy(){}getConfig(){return this.config}getCollaborationController(){return this._collaborationController}}var yS=Object.freeze(Object.defineProperty({__proto__:null,CollaborationPlugin:xl},Symbol.toStringTag,{value:"Module"})),yh=(r=>(r.SET_FORMULA_RANGE_DATA_ACTION="SetFormulaRangeDataAction",r))(yh||{});class AS{}const RS={formulaData:{"workbook-01":{"sheet-01":{12:{3:{formula:"=SUM(F1, G8)",row:12,column:3,sheetId:"sheet-01"}},13:{3:{formula:"=SUM(A3:G4)",row:13,column:3,sheetId:"sheet-01"}},14:{3:{formula:"=SUM(D14, D13)",row:14,column:3,sheetId:"sheet-01"}}}}}},IS={formulaData:{"workbook-02":{"sheet-0001":{12:{3:{formula:"=SUM(F1, G8)",row:12,column:3,sheetId:"sheet-0001"}},13:{3:{formula:"=SUM(A3:G4)",row:13,column:3,sheetId:"sheet-0001"}},14:{3:{formula:"=SUM(D14, D13)",row:14,column:3,sheetId:"sheet-0001"}}}}}},xS={formulaData:{"workbook-01":{"sheet-0003":{11:{6:{formula:"=E12*F12",row:11,column:6,sheetId:"sheet-0003"}},12:{6:{formula:"=E13*F13",row:12,column:6,sheetId:"sheet-0003"}},13:{6:{formula:"=LAMBDA(x,x+2)(E14)",row:13,column:6,sheetId:"sheet-0003"}},19:{6:{formula:"=SUM(G12:G19)",row:19,column:6,sheetId:"sheet-0003"}}}}}},DS={formulaData:{"workbook-01":{"sheet-0003":{11:{6:{formula:"=E12*F12",row:11,column:6,sheetId:"sheet-0003"}},12:{6:{formula:"=E13*F13",row:12,column:6,sheetId:"sheet-0003"}},13:{6:{formula:"=LAMBDA(x,x+2)(E14)",row:13,column:6,sheetId:"sheet-0003"}},19:{6:{formula:"=SUM(G12:G19)",row:19,column:6,sheetId:"sheet-0003"}}}}}},kp=[{locale:"formula.formulaMore.Math"},{locale:"formula.formulaMore.Statistical"},{locale:"formula.formulaMore.Lookup"},{locale:"formula.formulaMore.universheet"},{locale:"formula.formulaMore.dataMining"},{locale:"formula.formulaMore.Database"},{locale:"formula.formulaMore.Date"},{locale:"formula.formulaMore.Filter"},{locale:"formula.formulaMore.Financial"},{locale:"formula.formulaMore.Engineering"},{locale:"formula.formulaMore.Logical"},{locale:"formula.formulaMore.Operator"},{locale:"formula.formulaMore.Text"},{locale:"formula.formulaMore.Parser"},{locale:"formula.formulaMore.Array"},{locale:"formula.formulaMore.other"}],Bp=[{n:"SUMIF",t:0,dLocale:"formula.functionList.SUMIF.d",p:[{nameLocale:"formula.functionList.SUMIF.p.range.name",detailLocale:"formula.functionList.SUMIF.p.range.detail",example:"A1:A10"},{nameLocale:"formula.functionList.SUMIF.p.rangeAll.name",detailLocale:"formula.functionList.SUMIF.p.rangeAll.detail",example:'">20"'},{nameLocale:"formula.functionList.SUMIF.p.range1.name",detailLocale:"formula.functionList.SUMIF.p.range1.detail",example:"B1:B10"}]},{n:"SUMIF1",t:1,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF2",t:2,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF3",t:3,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF4",t:4,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF5",t:5,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF6",t:6,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF7",t:7,dLocale:"formula.functionList.SUMIF.d"}],Xt="formula",Lp={show:!0};var Ah=(r=>(r.AUTOMATIC="Automatic",r.MANUAL="Manual",r.AUTOMATIC_EXCEPT_TABLE="AutomaticExceptTable",r))(Ah||{});function Pp(r,e){const t=r.getContext().getPluginManager().getRequirePluginByName(Xt).getFormulaController().getDataModel(),n=W.deepClone(t.getFormulaData());return t.setFormulaData(e),n}class OS extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,formulaData:this.do()}}do(){return this.redo()}redo(){const{_workbook:e}=this,{formulaData:t}=this._doActionData;return Pp(e,t)}undo(){const{_workbook:e}=this,{formulaData:t}=this._oldActionData;Pp(e,t)}validate(){return!1}}He.register(yh.SET_FORMULA_RANGE_DATA_ACTION,OS);var we=(r=>(r.DIV_BY_ZERO="#DIV/0!",r.NAME="#NAME!",r.VALUE="#VALUE!",r.NUM="#NUM!",r.NA="#NA!",r.CYCLE="#CYCLE!",r.REF="#REF!",r.SPILL="#SPILL!",r.CALC="#CALC!",r.ERROR="#ERROR!",r.CONNECT="#GETTING_DATA",r.NULL="#NULL!",r))(we||{});const FS=new Set(["#DIV/0!","#NAME!","#VALUE!","#NUM!","#NA!","#CYCLE!","#REF!","#SPILL!","#CALC!","#ERROR!","#GETTING_DATA","#NULL!"]),zi="P_1",Wi="R_1",Dl="L_1",Hp="LR_1";class st{constructor(){this._children=[]}getLambdaId(){return this._lambdaId}setLambdaId(e){this._lambdaId=e}getLambdaPrivacyVar(){return this._lambdaPrivacyVar}setLambdaPrivacyVar(e){this._lambdaPrivacyVar=e}getLambdaParameter(){return this._lambdaParameter}setLambdaParameter(e){this._lambdaParameter=e}getParent(){return this._parent}setParent(e){this._parent=e}getChildren(){return this._children}setChildren(e){this._children=e}addChildren(e){this._children.push(e)}getToken(){return this._token}setToken(e){this._token=e}changeToParent(e){const t=this.getParent();t&&t.removeChild(this),this.setParent(e),e.getChildren().push(this)}removeChild(e){const t=this.getChildren(),n=t.length;for(let s=0;s<n;s++)if(t[s]===e){t.splice(s,1);return}}serialize(){const e=this.getToken(),t=this.getChildren(),n=[],s=t.length;for(let o=0;o<s;o++){const i=t[o];i instanceof st?n.push(i.serialize()):n.push(i)}return{token:e,children:n}}}var Mn=(r=>(r.PLUS="+",r.MINUS="-",r.MULTIPLY="*",r.DIVIDED="/",r.CONCATENATE="&",r.POWER="^",r.EQUALS="=",r.NOT_EQUAL="<>",r.GREATER_THAN=">",r.GREATER_THAN_OR_EQUAL=">=",r.LESS_THAN="<",r.LESS_THAN_OR_EQUAL="<=",r))(Mn||{}),Ye=(r=>(r.EQUALS="=",r.NOT_EQUAL="<>",r.GREATER_THAN=">",r.GREATER_THAN_OR_EQUAL=">=",r.LESS_THAN="<",r.LESS_THAN_OR_EQUAL="<=",r))(Ye||{});const Rh=new Map([["<>",3],["<",3],[">=",3],["=",3],[">",3],["<=",3],["&",2],["+",2],["-",2],["/",1],["*",1],["^",0]]),Vi=new Set(Rh.keys()),MS=new Set(["=","<>",">",">=","<","<="]);var wt=(r=>(r.OPEN_BRACKET="(",r.CLOSE_BRACKET=")",r.COMMA=",",r.SINGLE_QUOTATION="'",r.DOUBLE_QUOTATION='"',r.OPEN_BRACES="{",r.CLOSE_BRACES="}",r.COLON=":",r))(wt||{}),Lo=(r=>(r.PERCENTAGE="%",r.POUND="#",r))(Lo||{});const NS=new Set(["%","#"]);var _n=(r=>(r.AT="@",r.MINUS="-",r))(_n||{});class Ol{constructor(e){this._formulaString=e,this._upLevel=0,this._segment="",this._bracketState=[],this._bracesState=0,this._singleQuotationState=0,this._doubleQuotationState=0,this._lambdaState=!1,this._colonState=!1}_resetCurrentLexerNode(){this._currentLexerNode=new st}_resetSegment(){this._segment=""}_pushNodeToChildren(e,t=!1){if(e!==""){const n=this._currentLexerNode.getChildren();if(!(e instanceof st)&&this.isColonOpen()){const s=new st;s.setToken(e),s.setParent(this._currentLexerNode),e=s}t?n.unshift(e):n.push(e)}this.isColonOpen()&&(this._setAncestorCurrentLexerNode(),this._closeColon())}_openBracket(e=0){this._bracketState.push(e)}_closeBracket(){this._bracketState.pop()}_getCurrentBracket(){const e=this._bracketState;return e[e.length-1]}_openBraces(){this._bracesState+=1}_closeBraces(){this._bracesState-=1}_openSingleQuotation(){this._singleQuotationState+=1}_closeSingleQuotation(){this._singleQuotationState-=1}_openDoubleQuotation(){this._doubleQuotationState+=1}_closeDoubleQuotation(){this._doubleQuotationState-=1}_openLambda(){this._lambdaState=!0}_closeLambda(){this._lambdaState=!1}_openColon(e){this._upLevel=e,this._colonState=!0}_closeColon(){this._upLevel=0,this._colonState=!1}getUpLevel(){return this._upLevel}isColonClose(){return this._colonState===!1}isColonOpen(){return this._colonState===!0}isDoubleQuotationClose(){return this._doubleQuotationState===0}isLambdaOpen(){return this._lambdaState===!0}isLambdaClose(){return this._lambdaState===!1}isSingleQuotationClose(){return this._singleQuotationState===0}isBracesClose(){return this._bracesState===0}isBracketClose(){return this._bracketState.length===0}_getLastChildCurrentLexerNode(){const e=this._currentLexerNode.getChildren();if(e&&e.length>0){const t=e[e.length-1];if(t instanceof st)return t}return!1}_getLastChildCurrent(){const e=this._currentLexerNode.getChildren();return e&&e.length>0?e[e.length-1]:!1}_setParentCurrentLexerNode(){const e=this._currentLexerNode.getParent();return e?(this._currentLexerNode=e,!0):!1}_setAncestorCurrentLexerNode(){var n,s,o,i;const e=(n=this._currentLexerNode)==null?void 0:n.getParent();let t=!1;e&&e.getToken()===Dl?(s=e==null?void 0:e.getParent())!=null&&s.getParent()&&(this._currentLexerNode=(o=this._currentLexerNode.getParent())==null?void 0:o.getParent().getParent(),t=!0):e!=null&&e.getParent()&&(this._currentLexerNode=this._currentLexerNode.getParent().getParent(),t=!0);for(let a=0;a<this._upLevel;a++)this._currentLexerNode=(i=this._currentLexerNode)==null?void 0:i.getParent(),this._currentLexerNode?t=!0:t=!1;return t}_segmentCount(){return this._segment.trim().length}_pushSegment(e){this._segment+=e}_setCurrentLexerNode(e,t=!1){this._pushNodeToChildren(e,t),e.setParent(this._currentLexerNode),this._currentLexerNode=e}_newAndPushCurrentLexerNode(e,t=!1){const n=new st;n.setToken(e),this._setCurrentLexerNode(n,t)}_getTopNode(e){let t=e;for(;t.getParent();)t=t.getParent();return t}_removeLastChild(){this._currentLexerNode.getChildren().splice(-1)}_findPreviousToken(e,t){for(;t>=0;){const n=e[t];if(n!==" ")return n;t--}}getCurrentLexerNode(){return this._currentLexerNode}treeMaker(){return this._resetCurrentLexerNode(),this._currentLexerNode.setToken(Wi),this._nodeMaker(this._formulaString),this._currentLexerNode=this._getTopNode(this._currentLexerNode),this._currentLexerNode}suffixExpressionHandler(e){var i,a;const t=e.getChildren();if(!t)return;const n=t.length,s=[],o=[];for(let l=0;l<n;l++){const u=t[l];if(u instanceof st)this.suffixExpressionHandler(u),s.push(u);else{const c=u.trim();if(c==="")continue;if(Vi.has(c)){for(;o.length>0;){const h=(i=o[o.length-1])==null?void 0:i.trim();if(!h||h===wt.OPEN_BRACKET)break;const d=Rh.get(h),g=Rh.get(c);if(!d||!g)break;if(g>d)s.push(o.pop());else break}o.push(u)}else if(c===wt.OPEN_BRACKET)o.push(u);else if(c===wt.CLOSE_BRACKET)for(;o.length>0;){const h=(a=o[o.length-1])==null?void 0:a.trim();if(!h)break;if(h===wt.OPEN_BRACKET){o.pop();break}s.push(o.pop())}else s.push(u)}}for(;o.length>0;)s.push(o.pop());e.setChildren(s)}_negativeCondition(e){return!!(Vi.has(e)||e===wt.OPEN_BRACKET||e===wt.COMMA)}_nodeMaker(e){e.substring(0,1)===Mn.EQUALS&&(e=e.substring(1));const t=e.split(""),n=t.length;let s=0;for(this._resetSegment();s<n;){const o=t[s];if(o===wt.OPEN_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())if(this._segmentCount()>0||this.isLambdaOpen()){this.isLambdaClose()&&(this._newAndPushCurrentLexerNode(this._segment),this._resetSegment()),this._openBracket(1),this._closeLambda();const i=t[s+1];if(i&&i===wt.CLOSE_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==n-1)return we.VALUE;s++}else i&&this._newAndPushCurrentLexerNode(zi)}else this._pushNodeToChildren(o),this._openBracket(0);else if(o===wt.CLOSE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment),this._resetSegment();const i=this._getCurrentBracket();if(i===0)this._pushNodeToChildren(o);else if(i===1){const a=t[s+1];if(a&&a===wt.OPEN_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==n-1)return we.VALUE;this._newAndPushCurrentLexerNode(Dl,!0),this._openLambda()}else if(!this._setAncestorCurrentLexerNode()&&s!==n-1)return we.VALUE}else return we.VALUE;this._closeBracket()}else if(o===wt.OPEN_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(o),this._openBraces();else if(o===wt.CLOSE_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(o),this._pushNodeToChildren(this._segment),this._resetSegment(),this._closeBraces();else if(o===wt.DOUBLE_QUOTATION&&this.isSingleQuotationClose()&&this.isBracesClose()){if(this.isDoubleQuotationClose())this._openDoubleQuotation();else{const i=t[s+1];i&&i===wt.DOUBLE_QUOTATION?s++:this._closeDoubleQuotation()}this._pushSegment(o)}else if(o===wt.SINGLE_QUOTATION&&this.isDoubleQuotationClose()){if(this.isSingleQuotationClose())this._openSingleQuotation();else{const i=t[s+1];i&&i===wt.SINGLE_QUOTATION?s++:this._closeSingleQuotation()}this._pushSegment(o)}else if(o===wt.COMMA&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose())if(this._getCurrentBracket()===1){if(this._pushNodeToChildren(this._segment),this._resetSegment(),!this._setParentCurrentLexerNode()&&s!==n-1)return we.VALUE;this._newAndPushCurrentLexerNode(zi)}else return we.VALUE;else if(o===wt.COLON&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()){const i=new st;i.setToken(o);const a=new st;a.setToken(zi),a.setParent(i);const l=new st;l.setToken(zi),l.setParent(i),i.getChildren().push(a,l);let u=i,c=0;if(this._segmentCount()>0){let h,d,g=0;new RegExp(_n.MINUS,"g").test(this._segment)&&(h=new st,h.setToken(_n.MINUS),g++),new RegExp(_n.AT,"g").test(this._segment)&&(d=new st,d.setToken(_n.AT),h&&(h.addChildren(d),d.setParent(h)),g++),g>0&&(this._segment=this._segment.slice(g)),c=g,d?(d.addChildren(i),i.setParent(d),d.getParent()?u=d.getParent():u=d):h&&(u=h,h.addChildren(i),i.setParent(h));const m=new st;m.setToken(this._segment),m.setParent(a),a.getChildren().push(m),this._resetSegment()}else{const h=this._getLastChildCurrentLexerNode();h&&h.changeToParent(a)}this._setCurrentLexerNode(u),this._currentLexerNode=l,this._openColon(c)}else if(NS.has(o)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment);const i=new st;i.setToken(o);const a=this._getLastChildCurrent();a instanceof st?a.changeToParent(i):a!==!1&&(i.getChildren().push(a),this._removeLastChild()),this._pushNodeToChildren(i),i.setParent(this._currentLexerNode),this._resetSegment()}else if(Vi.has(o)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){let i=this._segment.trim();if(o===Mn.MINUS&&i===""){const a=this._findPreviousToken(t,s-1)||"";if(this._negativeCondition(a)){this._pushSegment(Mn.MINUS),s++;continue}}else this._segment.length>0&&i===""?i=this._segment:(this._pushNodeToChildren(this._segment),i="");if(o===Mn.LESS_THAN||o===Mn.GREATER_THAN){const a=t[s+1];a&&Vi.has(o+a)?(this._pushNodeToChildren(i+o+a),s++):this._pushNodeToChildren(i+o)}else this._pushNodeToChildren(i+o);this._resetSegment()}else this._pushSegment(o);s++}this._pushNodeToChildren(this._segment)}}const Nn=Un.create(),qt=ba.create();var Us=(r=>(r.FALSE="FALSE",r.TRUE="TRUE",r))(Us||{}),$i=(r=>(r[r.SUCCESS=0]="SUCCESS",r[r.ERROR=1]="ERROR",r))($i||{}),zs=(r=>(r.ALL="#All",r.DATA="#Data",r.HEADERS="#Headers",r.TOTALS="#Totals",r))(zs||{}),Nr=(r=>(r[r.FRONT=0]="FRONT",r[r.BACK=1]="BACK",r))(Nr||{}),et=(r=>(r.REFERENCE="ReferenceNode",r.VALUE="ValueNode",r.OPERATOR="OperatorNode",r.FUNCTION="FunctionNode",r.LAMBDA="LambdaNode",r.LAMBDA_PARAMETER="LambdaNodeParameter",r.ERROR="ErrorNode",r.BASE="Base",r.ROOT="Root",r.UNION="UnionNode",r.PREFIX="PrefixNode",r.SUFFIX="SuffixNode",r))(et||{});const lr=new Map([["ReferenceNode",7],["ValueNode",9],["OperatorNode",8],["FunctionNode",6],["LambdaNode",1],["LambdaNodeParameter",2],["Root",10],["UnionNode",3],["PrefixNode",4],["SuffixNode",5]]);class kn{constructor(e){this._token=e,this._children=[],this._calculateState=!1,this._async=!1,this._address=!1}get nodeType(){return et.BASE}isAsync(){return this._async}isAddress(){return this._address}setAsync(){this._async=!0}setAddress(){this._address=!0}getParent(){return this._parent}setParent(e){this._parent=e,e.addChildren(this)}getChildren(){return this._children}addChildren(...e){this._children.push(...e)}getToken(){return this._token}setValue(e){this._valueObject=e}getValue(){return this._valueObject}isCalculated(){return this._calculateState}setCalculated(){this._calculateState=!0}execute(e,t){}async executeAsync(e){return Promise.resolve($i.SUCCESS)}serialize(){const e=this.getToken(),t=this.getChildren(),n=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];n.push(a.serialize())}const o={token:e,nodeType:this.nodeType};return s>0&&(o.children=n),o}}class ur{get zIndex(){return 0}create(e,t){let n;return e instanceof st?n=e.getToken():n=e,new kn(n)}checkAndCreateNodeType(e,t){return!1}}class Ih extends kn{get nodeType(){return et.ROOT}execute(){const t=this.getChildren()[0];this.setValue(t.getValue())}}class kS extends ur{get zIndex(){return lr.get(et.ROOT)||100}checkAndCreateNodeType(e){return e instanceof st&&e.getToken()===Wi?new Ih(Wi):!1}}Nn.add(new kS);class xh{isErrorObject(){return!1}isAsyncObject(){return!1}isReferenceObject(){return!1}isValueObject(){return!1}}const Up=class extends xh{constructor(r){super(),this._errorType=r}getErrorType(){return this._errorType}isErrorObject(){return!0}static create(r){if(this.errorMap.has(r))return this.errorMap.get(r);{const e=new Up(r);return this.errorMap.set(r,e),e}}};let Me=Up;Me.errorMap=new Map;class Yt extends kn{constructor(e){super(e),this._errorValueObject=Me.create(e)}get nodeType(){return et.ERROR}getValue(){return this._errorValueObject}static create(e){return new Yt(e)}}class Jt{get name(){return""}isAsync(){return!1}isAddress(){return!1}calculate(...e){return Me.create(we.VALUE)}checkArrayType(e){return e.isReferenceObject()||e.isValueObject()&&e.isArray()}static create(){return this.functionMap.has(this.name)?this.functionMap.get(this.name):new this}}Jt.functionMap=new Map;const zp="COMPARE";class BS extends Jt{get name(){return zp}setCompareType(e){this._compareType=e}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Me.create(we.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().compare(t.toArrayValueObject(),this._compareType):this.checkArrayType(e)?n=e.toArrayValueObject().compare(t,this._compareType):this.checkArrayType(t)?n=e.compare(t.toArrayValueObject(),this._compareType):n=e.compare(t,this._compareType),n}}qt.add(zp,BS.create());const Wp="DIVIDED";class LS extends Jt{get name(){return Wp}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Me.create(we.VALUE);if(t.getValue()===0)return Me.create(we.DIV_BY_ZERO);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().divided(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().divided(t):this.checkArrayType(t)?n=e.divided(t.toArrayValueObject()):n=e.divided(t),n}}qt.add(Wp,LS.create());const Vp="MINUS";class PS extends Jt{get name(){return Vp}calculate(e,t){return e.isErrorObject()||t.isErrorObject()?Me.create(we.VALUE):e.minus(t)}}qt.add(Vp,PS.create());const $p="MULTIPLY";class HS extends Jt{get name(){return $p}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Me.create(we.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().multiply(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().multiply(t):this.checkArrayType(t)?n=e.multiply(t.toArrayValueObject()):n=e.multiply(t),n}}qt.add($p,HS.create());const Gp="PLUS";class US extends Jt{get name(){return Gp}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Me.create(we.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().plus(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().plus(t):this.checkArrayType(t)?n=e.plus(t.toArrayValueObject()):n=e.plus(t),n}}qt.add(Gp,US.create());const Xp="UNION";class zS extends Jt{get name(){return Xp}setCompareType(e){this._compareType=e}calculate(e,t){return e.isErrorObject()||t.isErrorObject()||!e.isReferenceObject()||!t.isReferenceObject()?Me.create(we.REF):(e=e,t=t,e.isCell()&&t.isCell()||e.isRow()&&t.isRow()||e.isColumn()&&t.isColumn()?e.unionBy(t):Me.create(we.REF))}}qt.add(Xp,zS.create());function Yp(r){let e;switch(r){case Ye.EQUALS:e=Ye.NOT_EQUAL;break;case Ye.GREATER_THAN:e=Ye.LESS_THAN_OR_EQUAL;break;case Ye.GREATER_THAN_OR_EQUAL:e=Ye.LESS_THAN;break;case Ye.LESS_THAN:e=Ye.GREATER_THAN_OR_EQUAL;break;case Ye.LESS_THAN_OR_EQUAL:e=Ye.GREATER_THAN;break;case Ye.NOT_EQUAL:e=Ye.EQUALS;break}return e}function WS(r){return""}class Fl extends xh{constructor(e){super(),this._rawValue=e}isValueObject(){return!0}getValue(){return 0}getArrayValue(){return[]}setValue(e){}setArrayValue(e){}isArray(){return!1}isString(){return!1}isNumber(){return!1}isBoolean(){return!1}isError(){return!1}getNegative(){return Me.create(we.VALUE)}getReciprocal(){return Me.create(we.VALUE)}plus(e){return Me.create(we.VALUE)}minus(e){return Me.create(we.VALUE)}multiply(e){return Me.create(we.VALUE)}divided(e){return Me.create(we.VALUE)}compare(e,t){return Me.create(we.VALUE)}concatenateFront(e){return Me.create(we.VALUE)}concatenateBack(e){return Me.create(we.VALUE)}plusBy(e){return Me.create(we.VALUE)}minusBy(e){return Me.create(we.VALUE)}multiplyBy(e){return Me.create(we.VALUE)}dividedBy(e){return Me.create(we.VALUE)}compareBy(e,t){return Me.create(we.VALUE)}concatenate(e,t=Nr.FRONT){let n=this.getValue().toString();if(typeof e=="string")t===Nr.FRONT?n=e+n:n+=e;else if(typeof e=="number")t===Nr.FRONT?n=e.toString()+n:n+=e.toString();else if(typeof e=="boolean"){const s=e?"TRUE":"FALSE";t===Nr.FRONT?n=s+n:n+=s}return this.setValue(n),this}}class Gi extends Fl{constructor(e,t=!1){if(super(e),t){this._value=e;return}if(typeof e=="boolean")this._value=e;else if(typeof e=="string"){const n=e.toLocaleUpperCase();n===Us.TRUE?this._value=!0:n===Us.FALSE&&(this._value=!1)}else e===1?this._value=!0:this._value=!1}_convertTonNumber(){const e=this.getValue();let t=0;return e&&(t=1),new Qt(t,!0)}getValue(){return this._value}isBoolean(){return!0}getNegative(){const e=this.getValue();let t=0;return e&&(t=1),new Qt(-t,!0)}getReciprocal(){return this.getValue()?new Qt(1,!0):Me.create(we.DIV_BY_ZERO)}plus(e){return this._convertTonNumber().plus(e)}minus(e){return this._convertTonNumber().minus(e)}multiply(e){return this._convertTonNumber().multiply(e)}divided(e){return this._convertTonNumber().divided(e)}compare(e,t){return this._convertTonNumber().compare(e,t)}concatenateFront(e){return this._convertTonNumber().concatenateFront(e)}concatenateBack(e){return this._convertTonNumber().concatenateBack(e)}}class Qt extends Fl{constructor(e,t=!1){if(super(e),this._value=0,t){this._value=e;return}this._value=Number(e)}getValue(){return this._value}setValue(e){this._value=e}isNumber(){return!0}getNegative(){return new Qt(0).minus(this)}getReciprocal(){return new Qt(1).divided(this)}plus(e){return e.isArray()?e.plus(this):this.plusBy(e.getValue())}equalZero(){return this._value===0}minus(e){if(e.isArray()){const t=e.getNegative();return t.isErrorObject()?t:t.plus(this)}return this.minusBy(e.getValue())}multiply(e){return e.isArray()?e.multiply(this):this.multiplyBy(e.getValue())}divided(e){if(e.isArray()){const t=e.getReciprocal();return t.isErrorObject()?t:t.multiply(this)}return this.dividedBy(e.getValue())}concatenateFront(e){return e.isArray()?e.concatenateBack(this):this.concatenate(e.getValue(),Nr.FRONT)}concatenateBack(e){return e.isArray()?e.concatenateFront(this):this.concatenate(e.getValue(),Nr.BACK)}compare(e,t){if(e.isArray()){const n=e.getReciprocal();return n.isErrorObject()?n:n.compare(this,Yp(t))}return this.compareBy(e.getValue(),t)}plusBy(e){let t=this.getValue();return typeof e=="string"?Me.create(we.VALUE):(typeof e=="number"?this.setValue(t+e):typeof e=="boolean"&&this.setValue(t+(e?1:0)),this)}minusBy(e){let t=this.getValue();return typeof e=="string"?Me.create(we.VALUE):(typeof e=="number"?this.setValue(t-e):typeof e=="boolean"&&this.setValue(t-(e?1:0)),this)}multiplyBy(e){let t=this.getValue();return typeof e=="string"?Me.create(we.VALUE):(typeof e=="number"?this.setValue(t*e):typeof e=="boolean"&&this.setValue(t*(e?1:0)),this)}dividedBy(e){let t=this.getValue();if(typeof e=="string")return Me.create(we.VALUE);if(typeof e=="number"){if(e===0)return Me.create(we.DIV_BY_ZERO);this.setValue(t/e)}else if(typeof e=="boolean"){if(e===!1)return Me.create(we.DIV_BY_ZERO);this.setValue(t/1)}return this}compareBy(e,t){let n=this.getValue(),s=!1;if(typeof e=="string")switch(t){case Ye.EQUALS:case Ye.GREATER_THAN:case Ye.GREATER_THAN_OR_EQUAL:s=!1;break;case Ye.LESS_THAN:case Ye.LESS_THAN_OR_EQUAL:case Ye.NOT_EQUAL:s=!0;break}else if(typeof e=="number")switch(t){case Ye.EQUALS:s=n===e;break;case Ye.GREATER_THAN:s=n>e;break;case Ye.GREATER_THAN_OR_EQUAL:s=n>=e;break;case Ye.LESS_THAN:s=n<e;break;case Ye.LESS_THAN_OR_EQUAL:s=n<=e;break;case Ye.NOT_EQUAL:s=n!==e;break}else if(typeof e=="boolean")switch(t){case Ye.EQUALS:case Ye.GREATER_THAN:case Ye.GREATER_THAN_OR_EQUAL:s=!1;break;case Ye.LESS_THAN:case Ye.LESS_THAN_OR_EQUAL:case Ye.NOT_EQUAL:s=!0;break}return new Gi(s)}}const jp="COUNT";class Kp extends Jt{get name(){return jp}calculate(...e){let t=new Qt(0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((o,i,a)=>{!o.isErrorObject()&&!o.isString()&&(t=t.plusBy(1))}):s.isString()||(t=t.plusBy(1))}return t}}qt.add(jp,Kp.create());const Zp="SUM";class qp extends Jt{get name(){return Zp}calculate(...e){let t=new Qt(0);for(let n=0;n<e.length;n++){let s=e[n];if(s.isErrorObject())return Me.create(we.VALUE);if(s.isReferenceObject()||s.isValueObject()&&s.isArray()){let o=!1;if(s.iterator((i,a,l)=>{if(i.isErrorObject())return o=!0,!1;t=t.plus(i)}),o)return Me.create(we.VALUE)}else t=t.plus(s)}return t}}qt.add(Zp,qp.create());const Jp="AVERAGE";class VS extends Jt{get name(){return Jp}calculate(...e){const t=qp.create().calculate(...e),n=Kp.create().calculate(...e);return t.isErrorObject()||n.isErrorObject()?Me.create(we.VALUE):t.divided(n)}}qt.add(Jp,VS.create());const Qp="CONCATENATE";class $S extends Jt{get name(){return Qp}calculate(e,t){return Me.create(we.VALUE)}}qt.add(Qp,$S.create());const e_="MAX";class GS extends Jt{get name(){return e_}_validator(e,t){return e.compare(t,Ye.LESS_THAN).getValue()&&(e=t),e}calculate(...e){let t=new Qt(-1/0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((o,i,a)=>{!o.isErrorObject()&&!o.isString()&&(t=this._validator(t,o))}):s.isString()||(t=this._validator(t,s))}return t}}qt.add(e_,GS.create());const t_="MIN";class XS extends Jt{get name(){return t_}_validator(e,t){return e.compare(t,Ye.GREATER_THAN).getValue()&&(e=t),e}calculate(...e){let t=new Qt(1/0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((o,i,a)=>{!o.isErrorObject()&&!o.isString()&&(t=this._validator(t,o))}):s.isString()||(t=this._validator(t,s))}return t}}qt.add(t_,XS.create());const n_="POWER";class YS extends Jt{get name(){return n_}calculate(e,t){return Me.create(we.VALUE)}}qt.add(n_,YS.create());const Dh=`'?\\[((?![\\/?:"<>|*\\\\]).)*\\]`,Oh="((?![\\[\\]\\/?*\\\\]).)*!",Ml="$",jS="#",KS=`\\${Ml}?[A-Za-z]+\\${Ml}?[0-9]+`,ZS=`^(${Dh})?(${Oh})?\\s*?${KS}(${jS})?$`,qS=`^(${Dh})?(${Oh})?\\s*?\\${Ml}?[0-9]+$`,JS=`^(${Dh})?(${Oh})?\\s*?\\${Ml}?[A-Za-z]+$`,r_=/[.*?]/g,QS=/{.*?}/g;class s_ extends Fl{constructor(e,t=!1){if(super(e),t){this._value=e;return}let n=e.toString();n.charAt(0)==='"'&&n.charAt(n.length-1)==='"'&&(n=n.slice(1,-1),n=n.replace(/""/g,'"')),this._value=n}getValue(){return this._value}isString(){return!0}concatenateFront(e){return e.isArray()?e.concatenateBack(this):this.concatenate(e.getValue(),Nr.FRONT)}concatenateBack(e){return e.isArray()?e.concatenateFront(this):this.concatenate(e.getValue(),Nr.BACK)}compare(e,t){if(e.isArray()){const n=e.getReciprocal();return n.isErrorObject()?n:n.compare(this,Yp(t))}return this.compareBy(e.getValue(),t)}compareBy(e,t){let n=this.getValue(),s=!1;if(typeof e=="string")switch(t){case Ye.EQUALS:s=n===e;break;case Ye.GREATER_THAN:s=n>e;break;case Ye.GREATER_THAN_OR_EQUAL:s=n>=e;break;case Ye.LESS_THAN:s=n<e;break;case Ye.LESS_THAN_OR_EQUAL:s=n<=e;break;case Ye.NOT_EQUAL:s=n!==e;break}else if(typeof e=="number")switch(t){case Ye.EQUALS:case Ye.GREATER_THAN:case Ye.GREATER_THAN_OR_EQUAL:s=!0;break;case Ye.LESS_THAN:case Ye.LESS_THAN_OR_EQUAL:case Ye.NOT_EQUAL:s=!1;break}else if(typeof e=="boolean")switch(t){case Ye.EQUALS:case Ye.GREATER_THAN:case Ye.GREATER_THAN_OR_EQUAL:s=!1;break;case Ye.LESS_THAN:case Ye.LESS_THAN_OR_EQUAL:case Ye.NOT_EQUAL:s=!0;break}return new Gi(s)}}class o_{static create(e){if(typeof e=="boolean")return new Gi(e,!0);if(typeof e=="string"){const t=e.toLocaleUpperCase();return t===Us.TRUE||t===Us.FALSE?new Gi(t):isNaN(Number(e))?QS.test(e)?new i_(e):new s_(e):new Qt(e)}else if(typeof e=="number")return new Qt(e,!0);return Me.create(we.NA)}}class i_ extends Fl{constructor(e){var t=(...n)=>{super(...n)};if(e instanceof String)t(e);else{const n=WS();t(n)}this._value=this._formatValue(e)}_formatValue(e){if(!(e instanceof String))return e=e,this._rowCount=e.rowCount,this._columnCount=e.columnCount,e.calculateValueList;e=e.slice(1,-1);const t=e.split(";"),n=t.length,s=[];let o=0;for(let i=0;i<n;i++){const l=t[i].split(","),u=l.length;o<u&&(o=u);const c=[];for(let h=0;h<u;h++){const d=l[h];c.push(o_.create(d))}s.push(c)}return this._rowCount=n,this._columnCount=o,s}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}getArrayValue(){return this._value}setArrayValue(e){this._value=e}isArray(){return!0}getRangePosition(){let e=0,t=this.getRowCount(),n=0,s=this.getColumnCount();return{startRow:e,endRow:t-1,startColumn:n,endColumn:s-1}}iterator(e){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=this.getRangePosition(),i=this.getArrayValue();for(let a=t;a<=n;a++)for(let l=s;l<=o;l++)if(e(i[a][l],a,l)===!1)return}_batchOperator(e,t,n){var a,l,u,c,h;if(e.isArray()){let d=e.getRowCount(),g=e.getColumnCount();d<this._rowCount&&(d=this._rowCount),g<this._columnCount&&(g=this._columnCount);const m=[],f=e.getArrayValue();for(let p=0;p<d;p++){const b=[];for(let v=0;v<g;v++){const w=(l=(a=this._value)==null?void 0:a[p])==null?void 0:l[v],S=(u=f==null?void 0:f[p])==null?void 0:u[v];if(w&&S)if(w.isErrorObject()||S.isErrorObject())b[v]=Me.create(we.VALUE);else switch(t){case 1:b[v]=w.plus(S);break;case 0:b[v]=w.minus(S);break;case 2:b[v]=w.multiply(S);break;case 3:b[v]=w.divided(S);break;case 4:n?b[v]=w.compare(S,n):b[v]=Me.create(we.VALUE);break;case 5:b[v]=w.concatenateFront(S);break;case 6:b[v]=w.concatenateBack(S);break}else w?b[v]=w:S?b[v]=S:b[v]=Me.create(we.VALUE)}m.push(b)}return this.setArrayValue(m),this.setRowCount(d),this.setColumnCount(g),this}let s=this._rowCount,o=this._columnCount;const i=[];for(let d=0;d<s;d++){const g=[];for(let m=0;m<o;m++){const f=(h=(c=this._value)==null?void 0:c[d])==null?void 0:h[m];if(f&&e)if(f.isErrorObject()||e.isErrorObject())g[m]=Me.create(we.VALUE);else switch(t){case 1:g[m]=f.plus(e);break;case 0:g[m]=f.minus(e);break;case 2:g[m]=f.multiply(e);break;case 3:g[m]=f.divided(e);break;case 4:n?g[m]=f.compare(e,n):g[m]=Me.create(we.VALUE);break;case 5:g[m]=f.concatenateFront(e);break;case 6:g[m]=f.concatenateBack(e);break}else f?g[m]=f:e?g[m]=e:g[m]=Me.create(we.VALUE)}i.push(g)}return this.setArrayValue(i),this.setRowCount(s),this.setColumnCount(o),this}plus(e){return this._batchOperator(e,1)}minus(e){return this._batchOperator(e,0)}multiply(e){return this._batchOperator(e,2)}divided(e){return this._batchOperator(e,3)}compare(e,t){return this._batchOperator(e,4,t)}concatenateFront(e){return this._batchOperator(e,5)}concatenateBack(e){return this._batchOperator(e,6)}}class Xi extends xh{constructor(e){super(),this._token=e,this._rowCount=0,this._columnCount=0}getRangePosition(){let e=this._rangeData.startRow,t=this._rangeData.endRow,n=this._rangeData.startColumn,s=this._rangeData.endColumn;return e===-1&&(e=0),n===-1&&(n=0),t===-1&&(t=this._rowCount-1),s===-1&&(s=this._columnCount-1),{startRow:e,endRow:t,startColumn:n,endColumn:s}}isReferenceObject(){return!0}iterator(e){const{startRow:t,endRow:n,startColumn:s,endColumn:o}=this.getRangePosition();for(let i=t;i<=n;i++)for(let a=s;a<=o;a++){const l=this.getCellData(i,a);let u=!1;if(!l){u=e(new Qt(0,!0),i,a);continue}const c=this.getCellValueObject(l);if(u=e(c,i,a),u===!1)return}}getRangeData(){return this._rangeData}setRangeData(e){this._rangeData=e}getUnitId(){return this._forcedUnitId?this._forcedUnitId:this._defaultUnitId}getSheetId(){return this._forcedSheetId?this._forcedSheetId:this._defaultSheetId}setForcedUnitIdDirect(e){this._forcedUnitId=e}getForcedUnitId(){return this._forcedUnitId}setForcedSheetId(e){this._forcedSheetId=e[this._forcedSheetName]}setForcedSheetIdDirect(e){this._forcedSheetId=e}getForcedSheetId(){return this._forcedSheetId}setForcedSheetName(e){this._forcedSheetName=e}getForcedSheetName(){return this._forcedSheetName}setDefaultSheetId(e){this._defaultSheetId=e}getDefaultSheetId(){return this._defaultSheetId}setDefaultUnitId(e){this._defaultUnitId=e}getDefaultUnitId(){return this._defaultUnitId}getUnitData(){return this._unitData}setUnitData(e){this._unitData=e}getRuntimeData(){return this._runtimeData}setRuntimeData(e){this._runtimeData=e}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}isCell(){return!1}isColumn(){return!1}isRow(){return!1}isRange(){return!1}isTable(){return!1}unionBy(e){return Me.create(we.REF)}unionRange(e,t){return{startRow:-1,startColumn:-1,endRow:-1,endColumn:-1}}getCellValueObject(e){const t=e.v||0;return FS.has(t)?Me.create(t):e.t===xn.BOOLEAN?new Gi(t):e.t===xn.FORCE_STRING||e.t===xn.STRING?new s_(t):new Qt(t)}getCellByRow(e){return this.getCellByPosition(e)}getCellByColumn(e){return this.getCellByPosition(void 0,e)}getCurrentActiveSheetData(){return this._unitData[this.getUnitId()][this.getSheetId()]}getCurrentRuntimeSheetData(){var e,t;return(t=(e=this._runtimeData)==null?void 0:e[this.getUnitId()])==null?void 0:t[this.getSheetId()]}getCellData(e,t){const n=this.getCurrentActiveSheetData(),s=this.getCurrentRuntimeSheetData();return(s==null?void 0:s.getValue(e,t))||n.getValue(e,t)}getCellByPosition(e,t){e||(e=this._rangeData.startRow),t||(t=this._rangeData.startColumn);const n=this.getCellData(e,t);return n?this.getCellValueObject(n):Me.create(we.VALUE)}toArrayValueObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this.getRangePosition(),o=t-e+1,i=s-n+1,a=new Array(o);this.iterator((u,c,h)=>{const d=c-e,g=h-n;a[d]||(a[d]=new Array(i)),a[d][g]=u});const l={calculateValueList:a,rowCount:a.length,columnCount:a[0].length};return new i_(l)}toUnitRange(){return{rangeData:this._rangeData,sheetId:this.getSheetId(),unitId:this.getUnitId()}}}class ey extends Xi{constructor(e,t,n){super(""),this.setRangeData(e),t&&this.setForcedSheetIdDirect(t),n&&this.setForcedUnitIdDirect(n)}isRange(){return!0}}class Fh extends Xi{constructor(e){super(e);const t=da(e);this.setForcedSheetName(t.sheetName),this.setRangeData(t.rangeData)}_createRange(e){const t=new ey(e,this.getForcedSheetId(),this.getForcedUnitId());return t.setUnitData(this.getUnitData()),t.setDefaultSheetId(this.getDefaultSheetId()),t.setRowCount(this.getRowCount()),t.setColumnCount(this.getColumnCount()),t.setDefaultUnitId(this.getDefaultUnitId()),t.setRuntimeData(this.getRuntimeData()),this.getForcedUnitId()!=null&&t.setForcedSheetIdDirect(this.getForcedUnitId()),t}isCell(){return!0}unionBy(e){if(!e.isCell())return Me.create(we.REF);const t=e,n=this.unionRange(this.getRangeData(),t.getRangeData());return this._createRange(n)}unionRange(e,t){const n=e.startRow,s=e.startColumn,o=t.startRow,i=t.startColumn;let a={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};return n>o?(a.startRow=o,a.endRow=n):(a.startRow=n,a.endRow=o),s>i?(a.startColumn=i,a.endColumn=s):(a.startColumn=s,a.endColumn=i),a}}const a_="OFFSET";class ty extends Jt{get name(){return a_}calculate(e,t,n,s,o){return new Fh("A5")}}qt.add(a_,ty.create());const l_="INDIRECT";class ny extends Jt{get name(){return l_}calculate(e,t){return new Fh("A5")}}qt.add(l_,ny.create());class ry{constructor(){this._astNodeFactoryArray=[],this._functionMap=new Map,this._tableMap=new Map,this._tableOptionMap=new Map,this._definedNameMap=new Map}_initialNode(){this.registerNode(...Nn.getData().sort(yt))}_initialFunction(){this._functionMap=qt.getData()}registerNode(...e){this._astNodeFactoryArray.push(...e)}registerFunction(...e){for(let t=0;t<e.length;t++){const n=e[t];this._functionMap.set(n.name,n)}}registerTable(e,t){this._tableMap.set(e,t)}registerDefinedName(e,t){this._definedNameMap.set(e,t)}registerTableOptionMap(e,t){this._tableOptionMap.set(e,t)}getTableOptionMap(){return this._tableOptionMap}getFunctionMap(){return this._functionMap}getAstNodeFactoryArray(){return this._astNodeFactoryArray}getTableMap(){return this._tableMap}getDefinedNameMap(){return this._definedNameMap}getExecutor(e){return this._functionMap.get(e)}getLambdaRuntime(){return this._lambdaRuntime}setLambdaRuntime(e){this._lambdaRuntime=e}hasLambdaRuntime(){return this._lambdaRuntime!=null}hasExecutor(e){return this._functionMap.has(e)}initialize(){this._initialNode(),this._initialFunction()}}class Nl extends kn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.PREFIX}_handlerAT(e,t){if(!e.isReferenceObject())return Me.create(we.VALUE);const n=e;if(n.isCell())return Me.create(we.VALUE);const s=(t==null?void 0:t.currentRow)||0,o=(t==null?void 0:t.currentColumn)||0;return n.isRow()?n.getCellByColumn(o):n.isColumn()?n.getCellByRow(s):n.isRange()||n.isTable()?n.getCellByPosition():Me.create(we.VALUE)}execute(e){const n=this.getChildren()[0].getValue();let s;this._operatorString===_n.MINUS?s=this._functionExecutor.calculate(new Qt(0),n):this._operatorString===_n.AT?s=this._handlerAT(n,e):s=Me.create(we.VALUE),this.setValue(s)}}class sy extends ur{get zIndex(){return lr.get(et.PREFIX)||100}checkAndCreateNodeType(e,t){if(!(e instanceof st))return!1;const n=e.getToken(),s=n.trim();if(s.charAt(0)==='"'&&s.charAt(s.length-1)==='"')return!1;let o="";if(s===_n.MINUS)o="MINUS";else return s===_n.AT?new Nl(s):!1;const i=t.getExecutor(o);return i?new Nl(s,i):(console.error("No function "+n),Yt.create(we.NAME))}}Nn.add(new sy);class oy extends kn{constructor(e,t){super(e),this._functionExecutor=t,this._functionExecutor.isAsync()&&this.setAsync(),this._functionExecutor.isAddress()&&this.setAddress()}get nodeType(){return et.FUNCTION}async executeAsync(){const e=[],t=this.getChildren(),n=t.length;for(let o=0;o<n;o++)e.push(t[o].getValue());const s=this._functionExecutor.calculate(...e);return s.isAsyncObject()?this.setValue(await s.getValue()):this.setValue(s),Promise.resolve($i.SUCCESS)}execute(){const e=[],t=this.getChildren(),n=t.length;for(let o=0;o<n;o++)e.push(t[o].getValue());const s=this._functionExecutor.calculate(...e);this.setValue(s)}}class iy extends ur{get zIndex(){return lr.get(et.FUNCTION)||100}create(e,t){const n=t.getExecutor(e);return n?new oy(e,n):(console.error("No function "+e),Yt.create(we.NAME))}checkAndCreateNodeType(e,t){if(typeof e=="string")return!1;let s=e.getToken().trim().toUpperCase(),o,i;const a=s.slice(0,2);let l=0;if(new RegExp(_n.MINUS,"g").test(a)){const u=t.getExecutor("MINUS");o=new Nl(_n.MINUS,u),l++}if(new RegExp(_n.AT,"g").test(a)&&(i=new Nl(_n.AT),o&&i.setParent(o),l++),l>0&&(s=s.slice(l)),t!=null&&t.hasExecutor(s)){const u=this.create(s,t);return console.log("functionNode",u),i?u.setParent(i):o&&u.setParent(o),u}return!1}}Nn.add(new iy);const ay="LAMBDA";class ly extends kn{constructor(e,t){super(e),this._lambdaId=t}get nodeType(){return et.LAMBDA}getLambdaId(){return this._lambdaId}execute(){const e=this.getChildren(),t=e.length;this.setValue(e[t-1].getValue())}}class uy extends ur{get zIndex(){return lr.get(et.LAMBDA)||100}_updateLambdaStatement(e,t,n){this._updateTree(e,t,n)}_updateTree(e,t,n){const s=e.getChildren(),o=s.length;for(let i=0;i<o;i++){const a=s[i];if(a instanceof st)this._updateTree(a,t,n);else{const l=a.trim();if(n.has(l)){const u=new st;u.setToken(Hp),u.setLambdaId(t),u.setLambdaPrivacyVar(n),u.setLambdaParameter(l),s[i]=u}}}}create(e,t){const n=e.getChildren(),s=n[0],o=n.slice(1,-1),i=n[n.length-1];if(!(s instanceof st&&i instanceof st)||s.getToken()!==Dl)return Yt.create(we.NAME);const a=s.getChildren();if(o.length!==a.length)return Yt.create(we.VALUE);const l=St(8),u=t.getLambdaRuntime(),c=new Map;for(let h=0;h<o.length;h++){const d=o[h];if(d instanceof st){const g=d.getChildren()[0];c.set(g,null)}else return Yt.create(we.VALUE)}return u.registerLambdaPrivacyVar(l,c),this._updateLambdaStatement(i,l,c),new ly(e.getToken(),l)}checkAndCreateNodeType(e,t){return!(e instanceof st)||e.getToken().trim().toUpperCase()!==ay?!1:this.create(e,t)}}Nn.add(new uy);class cy extends kn{constructor(e,t,n){super(e),this._lambdaParameter=t,this._currentLambdaPrivacyVar=n}get nodeType(){return et.LAMBDA_PARAMETER}execute(){const e=this._currentLambdaPrivacyVar.get(this._lambdaParameter);e?this.setValue(e.getValue()):this.setValue(Me.create(we.SPILL))}}class hy extends ur{get zIndex(){return lr.get(et.LAMBDA_PARAMETER)||100}create(e){e.getLambdaId();const t=e.getLambdaPrivacyVar(),n=e.getLambdaParameter();return t?new cy(e.getToken(),n,t):new Yt(we.SPILL)}checkAndCreateNodeType(e){return!(e instanceof st)||e.getToken().trim()!==Hp?!1:this.create(e)}}Nn.add(new hy);const dy="PLUS",gy="MINUS",fy="MULTIPLY",my="DIVIDED",py="CONCATENATE",_y="POWER",u_="COMPARE";class by extends kn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.OPERATOR}execute(){const e=this.getChildren();this._functionExecutor.name===u_&&this._functionExecutor.setCompareType(this.getToken()),this.setValue(this._functionExecutor.calculate(e[0].getValue(),e[1].getValue()))}}class vy extends ur{get zIndex(){return lr.get(et.OPERATOR)||100}create(e,t){let n="";const s=e;s===Mn.PLUS?n=dy:s===Mn.MINUS?n=gy:s===Mn.MULTIPLY?n=fy:s===Mn.DIVIDED?n=my:s===Mn.CONCATENATE?n=py:s===Mn.POWER?n=_y:MS.has(s)&&(n=u_);const o=t.getExecutor(n);return o?new by(s,o):(console.error("No function "+e),Yt.create(we.NAME))}checkAndCreateNodeType(e,t){if(e instanceof st)return!1;const n=e.trim();return n.charAt(0)==='"'&&n.charAt(n.length-1)==='"'?!1:Vi.has(n)?this.create(n,t):!1}}Nn.add(new vy);class Cy extends Xi{constructor(e){super(e);const t=da(e);this.setForcedSheetName(t.sheetName);const n={startColumn:-1,startRow:t.rangeData.startRow,endColumn:-1,endRow:-1};this.setRangeData(n)}isRow(){return!0}unionBy(e){if(!e.isRow())return Me.create(we.REF);const t=e;if(t.getForcedSheetName()!==void 0)return Me.create(we.REF);const n=this.getRangeData();if(n.endRow!==-1)return Me.create(we.REF);const s=t.getRangeData().startRow,o=n.startRow;return s>o?n.endRow=s:(n.startRow=s,n.endRow=o),this}}class Ey extends Xi{constructor(e){super(e);const t=da(e);this.setForcedSheetName(t.sheetName);const n={startColumn:t.rangeData.startColumn,startRow:-1,endColumn:-1,endRow:-1};this.setRangeData(n)}isColumn(){return!0}unionBy(e){if(!e.isColumn())return Me.create(we.REF);const t=e;if(t.getForcedSheetName()!==void 0)return Me.create(we.REF);const n=this.getRangeData();if(n.endColumn!==-1)return Me.create(we.REF);const s=t.getRangeData().startColumn,o=n.startColumn;return s>o?n.endColumn=s:(n.startColumn=s,n.endColumn=o),this}}class wy extends Xi{constructor(e,t,n,s){super(e),this._tableData=t,this._columnDataString=n;const o=this._tableData.sheetId,i=this._tableData.rangeData,a=this._tableData.titleMap;this.setForcedSheetIdDirect(o);const l=this._stringToColumnData(this._columnDataString,a,s),u=l.startColumn,c=l.endColumn,h=l.type;let d=-1,g=-1;const m=i.startRow,f=i.startColumn;h===zs.ALL?(d=m,g=f):h===zs.DATA?(d=m+1,g=f):h===zs.HEADERS?(d=m,g=m):h===zs.TOTALS&&(d=f,g=f),this.setRangeData({startColumn:u,endColumn:c,startRow:d,endRow:g})}_stringToColumnData(e,t,n){e=e.substring(1,-1);const s=e.indexOf(wt.COMMA);let o=-1,i=-1,a=zs.ALL;if(s===-1){const l=this._columnHandler(e,t);o=l.startColumn,i=l.endColumn}else{const l=e.substring(0,s).substring(1,-1),u=e.substring(s+1),c=this._columnHandler(u,t,!0);o=c.startColumn,i=c.endColumn,a=n.get(l),a||(a=zs.ALL)}return{startColumn:o,endColumn:i,type:a}}_columnHandler(e,t,n=!1){let s=-1,o=-1;const i=e.indexOf(wt.COLON);if(r_.test(e)){const a=e.substring(0,i).substring(1,-1),l=e.substring(i+1).substring(1,-1);s=t[a],o=t[l]}else n&&(e=e.substring(1,-1)),s=t[e],o=s;return{startColumn:s,endColumn:o}}isTable(){return!0}}class kl extends kn{constructor(e,t){super(e),this._operatorString=e,this._referenceObject=t}get nodeType(){return et.REFERENCE}execute(e,t){const n=e;n&&(this._referenceObject.setUnitData(n.unitData),this._referenceObject.setDefaultSheetId(n.currentSheetId),this._referenceObject.setForcedSheetId(n.sheetNameMap),this._referenceObject.setRowCount(n.rowCount),this._referenceObject.setColumnCount(n.columnCount),this._referenceObject.setDefaultUnitId(n.currentUnitId)),t&&this._referenceObject.setRuntimeData(t),this.setValue(this._referenceObject)}}class Ty extends ur{get zIndex(){return lr.get(et.REFERENCE)||100}checkAndCreateNodeType(e,t){let n=!1,s;if(e instanceof st?(n=!0,s=e.getToken().trim()):s=e.trim(),!n&&s.charAt(0)==='"'&&s.charAt(s.length-1)==='"')return!1;if(new RegExp(ZS).test(s))return new kl(s,new Fh(s));if(n&&new RegExp(qS).test(s))return new kl(s,new Cy(s));if(n&&new RegExp(JS).test(s))return new kl(s,new Ey(s));const o=t.getDefinedNameMap();if(!n&&o.has(s)){const u=o.get(s),c=new Ol(u),h=c.treeMaker();return c.suffixExpressionHandler(h),new Yt(we.VALUE)}const i=t.getTableMap(),a=r_,l=s.replace(a,"");if(!n&&i.has(l)){const u=a.exec(s);let c="";u&&(c=u[0]);const h=i.get(l),d=t.getTableOptionMap();return new kl(s,new wy(s,h,c,d))}return!1}}Nn.add(new Ty);class c_ extends kn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.SUFFIX}_handlerPound(e,t){var h,d,g,m;if(!e.isReferenceObject()||!e.isCell())return Me.create(we.VALUE);const n=e,s=n.getRangeData(),o=n.getUnitId(),i=n.getSheetId(),a=t==null?void 0:t.formulaData,l=(m=(g=(d=(h=a==null?void 0:a[o])==null?void 0:h[i])==null?void 0:d[s.startRow])==null?void 0:g[s.startColumn])==null?void 0:m.formula;if(!l)return Me.create(we.VALUE);const u=new Ol(l),c=u.treeMaker();return u.suffixExpressionHandler(c),Me.create(we.VALUE)}execute(e){const n=this.getChildren()[0].getValue();let s;this._operatorString===Lo.PERCENTAGE?s=this._functionExecutor.calculate(n,new Qt(100)):this._operatorString===Lo.POUND?s=this._handlerPound(n,e):s=Me.create(we.VALUE),this.setValue(s)}}class Sy extends ur{get zIndex(){return lr.get(et.SUFFIX)||100}checkAndCreateNodeType(e,t){if(!(e instanceof st))return!1;const n=e.getToken().trim();if(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')return!1;let s="";if(n===Lo.PERCENTAGE)s="DIVIDED";else return n===Lo.POUND?new c_(n):!1;const o=t.getExecutor(s);return o?new c_(n,o):(console.error("No function "+e),Yt.create(we.NAME))}}Nn.add(new Sy);const yy="UNION";class Ay extends kn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.UNION}execute(){const e=this.getChildren(),t=e[0].getValue(),n=e[1].getValue();let s;this._operatorString===wt.COLON?s=this._functionExecutor.calculate(t,n):s=Me.create(we.NAME),this.setValue(s)}}class Ry extends ur{get zIndex(){return lr.get(et.UNION)||100}create(e,t){const n=t.getExecutor(yy);return n?new Ay(e,n):(console.error("No function "+e),Yt.create(we.NAME))}checkAndCreateNodeType(e,t){if(!(e instanceof st))return!1;const s=e.getToken().trim();return s.charAt(0)==='"'&&s.charAt(s.length-1)==='"'||s!==wt.COLON?!1:this.create(s,t)}}Nn.add(new Ry);class Iy extends kn{constructor(e){super(e),this._operatorString=e}get nodeType(){return et.VALUE}execute(){this.setValue(o_.create(this._operatorString))}}class xy extends ur{get zIndex(){return lr.get(et.VALUE)||100}_checkValueNode(e){if(isNaN(Number(e))){const t=e.trim(),n=t.charAt(0),s=t.charAt(t.length-1);if(n==='"'&&s==='"')return this.create(t);if(n==="{"&&s==="}")return this.create(t);if(t===Us.TRUE||t===Us.FALSE)return this.create(t)}else return this.create(e);return!1}create(e){return new Iy(e)}checkAndCreateNodeType(e){return e instanceof st?!1:this._checkValueNode(e)}}Nn.add(new xy);class Dy{constructor(){this._lambdaPrivacyVar=new Map}registerLambdaPrivacyVar(e,t){this._lambdaPrivacyVar.set(e,t)}getCurrentPrivacyVar(e){return this._lambdaPrivacyVar.get(e)}}class Bl{constructor(){this._parserDataLoader=new ry}parse(e){this._astNodeFactoryList=Nn.getData(),this._parserDataLoader.setLambdaRuntime(new Dy);const t=new Ih(Wi);return this._parse(e,t)}_lambdaParameterHandler(e,t){const n=t.getLambdaId(),s=new Ih(Wi),i=this._parserDataLoader.getLambdaRuntime().getCurrentPrivacyVar(n);if(!i)return!1;const a=[...i.keys()],l=e.getChildren(),u=l.length;for(let d=0;d<u;d++){const g=l[d];if(g instanceof st)this._parse(g,s);else return!1}const c=s.getChildren(),h=c.length;for(let d=0;d<h;d++){const g=c[d];i.set(a[d],g)}return s.setParent(t),t}_getTopParent(e){let t=e;for(;t.getParent();)t=t.getParent(),console.log(t);return t}_parse(e,t){const n=e.getChildren(),s=n.length,o=[];let i=!1;if(e.getToken()===zi)i=t;else{if(e.getToken()===Dl){let l=this._lambdaParameterHandler(e,t);return l===!1&&(l=Yt.create(we.ERROR)),l}if(i=this._checkAstNode(e),i===!1)return Yt.create(we.ERROR)}for(let l=0;l<s;l++){if(i.nodeType===et.LAMBDA&&t.nodeType!==et.LAMBDA&&l!==0&&l!==s-1)continue;const u=n[l];let c=!1;if(u instanceof st){if(c=this._parse(u,i),c===i)continue}else c=this._checkAstNode(u);if(c===!1)return Yt.create(we.ERROR);switch(c=this._getTopParent(c),c.nodeType){case et.ERROR:return c;case et.FUNCTION:o.push(c);break;case et.LAMBDA:o.push(c);break;case et.LAMBDA_PARAMETER:o.push(c);break;case et.OPERATOR:const h=o.pop(),d=o.pop();if(d)d.setParent(c);else return Yt.create(we.ERROR);if(h)h.setParent(c);else return Yt.create(we.ERROR);o.push(c);break;case et.REFERENCE:o.push(c);break;case et.ROOT:o.push(c);break;case et.UNION:o.push(c);break;case et.VALUE:o.push(c);break;case et.PREFIX:o.push(c);break;case et.SUFFIX:o.push(c);break}}const a=o.length;for(let l=0;l<a;l++)o[l].setParent(i);return i}_checkAstNode(e){let t=!1;const n=this._astNodeFactoryList.length;for(let s=0;s<n&&(t=this._astNodeFactoryList[s].checkAndCreateNodeType(e,this._parserDataLoader),t===!1);s++);return t}_findTopNode(){}getDataLoader(){return this._parserDataLoader}static create(){return this.maker||(this.maker=new Bl,this.maker._parserDataLoader.initialize()),this.maker}}class Yi{constructor(e){this._interpreterDatasetConfig=e,this._runtimeData={},this._unitArrayFormulaData={}}_checkAsyncNode(e,t){const n=e.getChildren(),s=n.length;for(let o=0;o<s;o++){const i=n[o];t.push(i.isAsync()),this._checkAsyncNode(i,t)}}async _executeAsync(e){const t=e.getChildren(),n=t.length;for(let s=0;s<n;s++){const o=t[s];this._executeAsync(o)}return e.nodeType===et.FUNCTION&&e.isAsync()?await e.executeAsync(this._interpreterDatasetConfig):e.execute(this._interpreterDatasetConfig,this._runtimeData),Promise.resolve($i.SUCCESS)}_execute(e){const t=e.getChildren(),n=t.length;for(let s=0;s<n;s++){const o=t[s];this._execute(o)}return e.execute(this._interpreterDatasetConfig,this._runtimeData),$i.SUCCESS}_objectValueToCellValue(e){if(e.isErrorObject())return{v:e.getErrorType(),t:xn.STRING};if(e.isValueObject()){const t=e,n=t.getValue();return t.isNumber()?{v:n,t:xn.NUMBER}:t.isBoolean()?{v:n,t:xn.BOOLEAN}:{v:n,t:xn.STRING}}}async executeAsync(e){if(!e)return Me.create(we.VALUE);await this._executeAsync(e);const t=e.getValue();return Promise.resolve(t)}execute(e){return e?(this._execute(e),e.getValue()):Me.create(we.VALUE)}executePreCalculateNode(e){return e.execute(this._interpreterDatasetConfig,this._runtimeData),e.getValue()}checkAsyncNode(e){const t=[];this._checkAsyncNode(e,t);for(let n=0,s=t.length;n<s;n++)if(t[n]===!0)return!0;return!1}setRuntimeData(e,t,n,s,o){this._runtimeData[s]===void 0&&(this._runtimeData[s]={});const i=this._runtimeData[s];i[n]===void 0&&(i[n]=new _e),this._unitArrayFormulaData[s]===void 0&&(this._unitArrayFormulaData[s]={});const a=this._unitArrayFormulaData[s];a[n]===void 0&&(a[n]=new _e);const l=i[n],u=a[n];if(o.isReferenceObject()||o.isValueObject()&&o.isArray()){const c=o,{startRow:h,startColumn:d,endRow:g,endColumn:m}=c.getRangePosition();c.iterator((f,p,b)=>{l.setValue(p-h+e,b-d+t,this._objectValueToCellValue(f))}),u.setValue(e,t,{startRow:e,startColumn:t,endRow:g-h+1+e,endColumn:m-d+1+t})}else l.setValue(e,t,this._objectValueToCellValue(o))}getSheetData(e){return this._runtimeData[e]}getSheetArrayFormula(e){return this._unitArrayFormulaData[e]}setProps(e){this._interpreterDatasetConfig=e}setCurrentPosition(e,t,n,s){!this._interpreterDatasetConfig||(this._interpreterDatasetConfig.currentRow=e,this._interpreterDatasetConfig.currentColumn=t,this._interpreterDatasetConfig.currentSheetId=n,this._interpreterDatasetConfig.currentUnitId=s)}static create(e){return new Yi(e)}}const Oy=1e5;class Fy{constructor(){this._cache=new bf(Oy)}_hash(e){return yf(e)}set(e,t){const n=this._hash(e);this._cache.set(n,t)}get(e){const t=this._hash(e);return this._cache.get(t)}}const h_=new Fy;function My(r){let e=h_.get(r);if(e)return e;const t=new Ol(r),n=t.treeMaker();return t.suffixExpressionHandler(n),e=Bl.create().parse(n),h_.set(r,e),e}class Ny{constructor(){this.children=[],this.parents=[],this._state=0,this.rangeList=[]}_pushParent(e){this.parents.push(e)}setAdded(){this._state=1}isAdded(){return this._state===1}setSkip(){this._state=2}isSkip(){return this._state===2}compareRangeData(e){const t=e.startRow,n=e.startColumn,s=e.endRow,o=e.endColumn;return!(this.row<t||this.row>s||this.column<n||this.column>o)}dependencyRange(e){if(this.rangeList.length===0)return!1;for(let t=0,n=this.rangeList.length;t<n;t++){const s=this.rangeList[t],o=s.unitId,i=s.sheetId,a=s.rangeData;if(!e.has(o))continue;const l=e.get(o);if(!l.has(i))continue;const u=l.get(i),{startRow:c,startColumn:h,endRow:d,endColumn:g}=u;if(!(a.startRow>d||a.endRow<c||a.startColumn>g||a.endColumn<h))return!0}return!1}pushChildren(e){this.children.push(e),e._pushParent(this)}pushRangeList(e){this.rangeList.push(e)}dependency(e){if(this.rangeList.length===0)return!1;for(let t=0,n=this.rangeList.length;t<n;t++){const s=this.rangeList[t],o=s.unitId,i=s.sheetId,a=s.rangeData;if(e.unitId===o&&e.sheetId===i&&e.compareRangeData(a))return!0}return!1}}class Mh{constructor(e,t=!1){this._formulaData=e,this._forceCalculate=t,this._updateRangeFlattenCache=new Map}updateRangeFlatten(e){if(!this._forceCalculate){this._updateRangeFlattenCache=new Map;for(let t=0;t<e.length;t++){const n=e[t],s=n.rangeData,o=n.sheetId,i=n.unitId;this._addFlattenCache(i,o,s)}}}_addFlattenCache(e,t,n){let s=this._updateRangeFlattenCache.get(e);s||(s=new Map,this._updateRangeFlattenCache.set(e,s)),s.set(t,n)}_isPreCalculateNode(e){return e.nodeType===et.UNION||e.nodeType===et.PREFIX&&e.getToken()===_n.AT||e.nodeType===et.SUFFIX&&e.getToken()===Lo.POUND}_nodeTraversalRef(e,t){const n=e.getChildren(),s=n.length;for(let o=0;o<s;o++){const i=n[o];if(this._isPreCalculateNode(i)){t.push(i);continue}else i.nodeType===et.REFERENCE&&t.push(i);this._nodeTraversalRef(i,t)}}_nodeTraversalReferenceFunction(e,t){const n=e.getChildren(),s=n.length;for(let o=0;o<s;o++){const i=n[o];if(i.nodeType===et.FUNCTION&&i.isAddress()){t.push(i);continue}this._nodeTraversalReferenceFunction(i,t)}}async _executeNode(e,t){let n;return t.checkAsyncNode(e)?n=await t.executeAsync(e):n=t.execute(e),n}async _getRangeListByNode(e,t){const n=[],s=[];this._nodeTraversalRef(e,n),this._nodeTraversalReferenceFunction(e,s);const o=[];for(let i=0,a=n.length;i<a;i++){const l=n[i],c=(await this._executeNode(l,t)).toUnitRange();o.push(c)}for(let i=0,a=s.length;i<a;i++){const l=s[i],c=(await this._executeNode(l,t)).toUnitRange();o.push(c)}return o}_includeTree(e){const t=e.unitId,n=e.sheetId;if(!this._updateRangeFlattenCache.has(t))return!1;const s=this._updateRangeFlattenCache.get(t);if(!s.has(n))return!1;const o=s.get(n);return!!e.compareRangeData(o)}_getUpdateTreeListAndMakeDependency(e){const t=[],n=new Set;for(let s=0,o=e.length;s<o;s++){const i=e[s];for(let a=0,l=e.length;a<l;a++){const u=e[a];i!==u&&i.dependency(u)&&i.pushChildren(u)}(this._forceCalculate||i.dependencyRange(this._updateRangeFlattenCache)||this._includeTree(i))&&!n.has(i)&&(t.push(i),n.add(i))}return t}_calculateRunList(e){let t=e;const n=[];for(;t.length>0;){let s=t.pop();if(s===void 0||s.isSkip())continue;if(s.isAdded()){n.push(s);continue}const o=[];for(let i=0,a=s.parents.length;i<a;i++){const l=s.parents[i];o.push(l)}o.length==0?(n.push(s),s.setSkip()):(s.setAdded(),t.push(s),t=t.concat(o))}return n.reverse()}async generate(e=[],t){this.updateRangeFlatten(e);const n=Yi.create(t),s=Object.keys(this._formulaData),o=[];for(let a of s){const l=this._formulaData[a],u=Object.keys(l);for(let c of u)new _e(l[c]).forValue((d,g,m)=>{const f=m.formula,p=My(f),b=new Ny;b.node=p,b.formula=f,b.unitId=a,b.sheetId=c,b.row=d,b.column=g,o.push(b)})}for(let a=0,l=o.length;a<l;a++){const u=o[a];n.setCurrentPosition(u.row,u.column,u.sheetId,u.unitId);const c=await this._getRangeListByNode(u.node,n);for(let h=0,d=c.length;h<d;h++)u.pushRangeList(c[h])}const i=this._getUpdateTreeListAndMakeDependency(o);return Promise.resolve(this._calculateRunList(i))}static create(e,t=!1){return new Mh(e,t)}}class Nh extends sn{constructor(e){super("formulaEngine")}async execute(e,t,n,s=!1,o=[]){const a=await Mh.create(t,s).generate(o,n),l=Yi.create(n);for(let u=0,c=a.length;u<c;u++){const h=a[u],d=h.node;let g;l.setCurrentPosition(h.row,h.column,h.sheetId,h.unitId),l.checkAsyncNode(d)?g=await l.executeAsync(d):g=l.execute(d),l.setRuntimeData(h.row,h.column,h.sheetId,h.unitId,g)}return{sheetData:l.getSheetData(e),arrayFormulaData:l.getSheetArrayFormula(e)}}calculate(e){var a,l;(a=this.getObserver("onBeforeFormulaCalculateObservable"))==null||a.notifyObservers(e);const t=new Ol(e),n=t.treeMaker();t.suffixExpressionHandler(n),(l=this.getObserver("onAfterFormulaLexerObservable"))==null||l.notifyObservers(n);const o=Bl.create().parse(n),i=Yi.create();i.checkAsyncNode(o)?i.executeAsync(o).then(c=>{console.log("formulaResult",c)}):console.log(i.execute(o))}initialize(){}onMapping(e){}onMounted(e){this.initialize()}onDestroy(){}static create(e){return new Nh(e)}}var ky={formula:{formulaLabel:"\u6C42\u548C",formulaRightLabel:"\u66F4\u591A\u516C\u5F0F",ok:"\u786E\u5B9A",cancel:"\u53D6\u6D88",clearValidation:"\u6E05\u9664\u9A8C\u8BC1",formula:{sum:"\u6C42\u548C",average:"\u5E73\u5747\u503C",count:"\u8BA1\u6570",max:"\u6700\u5927\u503C",min:"\u6700\u5C0F\u503C",if:"if\u516C\u5F0F\u751F\u6210\u5668",more:"\u66F4\u591A\u51FD\u6570..."},functionList:{SUMIF:{d:"\u5BF9\u8303\u56F4\u4E2D\u7B26\u5408\u6307\u5B9A\u6761\u4EF6\u7684\u503C\u6C42\u548C\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u6839\u636E\u6761\u4EF6\u8FDB\u884C\u68C0\u6D4B\u7684\u8303\u56F4\u3002"},rangeAll:{name:"\u6761\u4EF6",detail:`\u8981\u5E94\u7528\u4E8E\u8303\u56F4\u7684\u6A21\u5F0F\u6216\u6D4B\u8BD5\u6761\u4EF6\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6587\u672C\uFF0C\u5219\u6761\u4EF6\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u3002\u6761\u4EF6\u53EF\u4EE5\u5305\u542B\u901A\u914D\u7B26\uFF0C\u5305\u62EC\u7528\u4E8E\u5339\u914D\u5355\u4E2A\u5B57\u7B26\u7684?\u6216\u7528\u4E8E\u5339\u914D\u96F6\u4E2A\u6216\u8FDE\u7EED\u591A\u4E2A\u5B57\u7B26\u7684*\u3002\u8981\u5339\u914D\u95EE\u53F7\u661F\u53F7\u672C\u8EAB\uFF0C\u8BF7\u5728\u8BE5\u5B57\u7B26\u524D\u9762\u52A0\u4E0A\u6CE2\u6D6A\u53F7(~)\u524D\u7F00\uFF08\u5373~?\u548C~*\uFF09\u3002\u5B57\u7B26\u4E32\u6761\u4EF6\u5FC5\u987B\u7528\u5F15\u53F7\u62EC\u8D77\u6765\u3002\u51FD\u6570\u4F1A\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u4E0E\u6761\u4EF6\u662F\u5426\u76F8\u7B49\u6216\u5339\u914D\uFF08\u5982\u679C\u4F7F\u7528\u4E86\u901A\u914D\u7B26\uFF09\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6570\u5B57\uFF0C\u5219\u6761\u4EF6\u53EF\u4EE5\u662F\u5B57\u7B26\u4E32\u4E5F\u53EF\u4EE5\u662F\u6570\u5B57\u3002\u5982\u679C\u7ED9\u5B9A\u7684\u6761\u4EF6\u662F\u4E00\u4E2A\u6570\u5B57\uFF0C\u5219\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u6761\u4EF6\u3002\u53E6\u5916\uFF0C\u6761\u4EF6\u4E5F\u53EF\u80FD\u662F\u5305\u542B\u6570\u5B57\u7684\u5B57\u7B26\u4E32\uFF08\u4E5F\u5C06\u5BF9\u5176\u8FDB\u884C\u76F8\u7B49\u68C0\u6D4B\uFF09\uFF0C\u6216\u8005\u5E26\u6709\u4EE5\u4E0B\u524D\u7F00\u7684\u6570\u5B57\uFF1A=\uFF08\u68C0\u67E5\u662F\u5426\u76F8\u7B49\uFF09\u3001>\uFF08\u68C0\u67E5\u8303\u56F4\u5355\u5143\u683C\u7684\u503C\u662F\u5426\u5927\u4E8E\u6761\u4EF6\u503C\uFF09\u6216<\uFF08\u68C0\u67E5\u8303\u56F4\u5355\u5143\u683C\u7684\u503C\u662F\u5426\u5C0F\u4E8E\u6761\u4EF6\u503C\uFF09`},range1:{name:"\u6C42\u548C\u8303\u56F4",detail:"\u8981\u6C42\u548C\u7684\u8303\u56F4\uFF08\u5982\u679C\u4E0E\u8303\u56F4\u4E0D\u540C\uFF09\u3002"}}},TAN:{d:"\u8FD4\u56DE\u5DF2\u77E5\u89D2\u5EA6\u7684\u6B63\u5207\u503C\u3002",p:{rangeNumber:{name:"\u89D2\u5EA6",detail:"\u8981\u6C42\u5176\u6B63\u5207\u503C\u7684\u89D2\u5EA6\uFF0C\u4EE5\u5F27\u5EA6\u8868\u793A\u3002"}}},TANH:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u5B9E\u6570\u7684\u53CC\u66F2\u6B63\u5207\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CC\u66F2\u6B63\u5207\u503C\u7684\u5B9E\u6570\u3002"}}},CEILING:{d:"\u5C06\u6570\u503C\u5411\u4E0A\u53D6\u6574\u4E3A\u6700\u63A5\u8FD1\u7684\u6307\u5B9A\u56E0\u6570\u7684\u500D\u6570\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u5411\u4E0A\u820D\u5165\u7684\u6570\u503C\u3002"},rangeNumber1:{name:"\u56E0\u6570",detail:"\u8981\u5C06\u503C\u820D\u5165\u5230\u6B64\u6570\u7684\u6574\u6570\u500D\u3002"}}},ATAN:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u53CD\u6B63\u5207\u503C\uFF0C\u4EE5\u5F27\u5EA6\u8868\u793A\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CD\u6B63\u5207\u503C\u7684\u6570\u503C\u3002"}}},ASINH:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u53CD\u53CC\u66F2\u6B63\u5F26\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CD\u53CC\u66F2\u6B63\u5F26\u503C\u7684\u6570\u503C\u3002"}}},ABS:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u7EDD\u5BF9\u503C\u3002",p:{rangeNumber:{name:"value",detail:"\u8981\u8FD4\u56DE\u5176\u7EDD\u5BF9\u503C\u7684\u6570\u3002"}}},COUNTBLANK:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u8303\u56F4\u5185\u7684\u7A7A\u5355\u5143\u683C\u6570\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u7EDF\u8BA1\u7A7A\u767D\u5355\u5143\u683C\u6570\u91CF\u7684\u8303\u56F4\u3002"}}},COSH:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u5B9E\u6570\u7684\u53CC\u66F2\u4F59\u5F26\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CC\u66F2\u4F59\u5F26\u503C\u7684\u5B9E\u6570\u503C\u3002"}}},COUNTIF:{d:"\u8FD4\u56DE\u8303\u56F4\u5185\u6EE1\u8DB3\u67D0\u4E2A\u6761\u4EF6\u7684\u5355\u5143\u683C\u7684\u6570\u91CF\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u6839\u636E\u6761\u4EF6\u8FDB\u884C\u68C0\u6D4B\u7684\u8303\u56F4\u3002"},rangeAll:{name:"\u6761\u4EF6",detail:`\u8981\u5E94\u7528\u4E8E\u8303\u56F4\u7684\u6A21\u5F0F\u6216\u6D4B\u8BD5\u6761\u4EF6\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6587\u672C\uFF0C\u5219\u6761\u4EF6\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u3002\u6761\u4EF6\u53EF\u4EE5\u5305\u542B\u901A\u914D\u7B26\uFF0C\u5305\u62EC\u7528\u4E8E\u5339\u914D\u5355\u4E2A\u5B57\u7B26\u7684?\u6216\u7528\u4E8E\u5339\u914D\u96F6\u4E2A\u6216\u8FDE\u7EED\u591A\u4E2A\u5B57\u7B26\u7684*\u3002\u8981\u5339\u914D\u95EE\u53F7\u661F\u53F7\u672C\u8EAB\uFF0C\u8BF7\u5728\u8BE5\u5B57\u7B26\u524D\u9762\u52A0\u4E0A\u6CE2\u6D6A\u53F7(~)\u524D\u7F00\uFF08\u5373~?\u548C~*\uFF09\u3002\u5B57\u7B26\u4E32\u6761\u4EF6\u5FC5\u987B\u7528\u5F15\u53F7\u62EC\u8D77\u6765\u3002\u51FD\u6570\u4F1A\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u4E0E\u6761\u4EF6\u662F\u5426\u76F8\u7B49\u6216\u5339\u914D\uFF08\u5982\u679C\u4F7F\u7528\u4E86\u901A\u914D\u7B26\uFF09\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6570\u5B57\uFF0C\u5219\u6761\u4EF6\u53EF\u4EE5\u662F\u5B57\u7B26\u4E32\u4E5F\u53EF\u4EE5\u662F\u6570\u5B57\u3002\u5982\u679C\u7ED9\u5B9A\u7684\u6761\u4EF6\u662F\u4E00\u4E2A\u6570\u5B57\uFF0C\u5219\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u6761\u4EF6\u3002\u53E6\u5916\uFF0C\u6761\u4EF6\u4E5F\u53EF\u80FD\u662F\u5305\u542B\u6570\u5B57\u7684\u5B57\u7B26\u4E32\uFF08\u4E5F\u5C06\u5BF9\u5176\u8FDB\u884C\u76F8\u7B49\u68C0\u6D4B\uFF09\uFF0C\u6216\u8005\u5E26\u6709\u4EE5\u4E0B\u524D\u7F00\u7684\u6570\u5B57\uFF1A=\u3001>\u3001>=\u3001<\u6216<=\uFF0C\u8FD9\u4E9B\u6761\u4EF6\u5C06\u5206\u522B\u7528\u4E8E\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u3001\u5927\u4E8E\u3001\u5927\u4E8E\u7B49\u4E8E\u3001\u5C0F\u4E8E\u3001\u5C0F\u4E8E\u7B49\u4E8E\u6761\u4EF6\u503C\u3002`}}},ERFC:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u4E92\u8865\u9AD8\u65AF\u8BEF\u5DEE\u51FD\u6570\u3002",p:{rangeNumber:{name:"z",detail:"\u8981\u4E3A\u5176\u8BA1\u7B97\u4E92\u8865\u9AD8\u65AF\u8BEF\u5DEE\u51FD\u6570\u7684\u6570\u503C\u3002"}}},VLOOKUP:{d:"\u7EB5\u5411\u67E5\u627E\u3002\u5728\u8303\u56F4\u7684\u7B2C\u4E00\u5217\u4E2D\u81EA\u4E0A\u800C\u4E0B\u641C\u7D22\u67D0\u4E2A\u952E\u503C\uFF0C\u5E76\u8FD4\u56DE\u6240\u627E\u5230\u7684\u884C\u4E2D\u6307\u5B9A\u5355\u5143\u683C\u7684\u503C\u3002",p:{rangeAll:{name:"\u641C\u7D22\u952E\u503C",detail:'\u8981\u641C\u7D22\u7684\u503C\uFF0C\u5982 42\u3001"Cats" \u6216 I24\u3002'},rangeAll1:{name:"\u8303\u56F4",detail:"\u8981\u8FDB\u884C\u641C\u7D22\u7684\u8303\u56F4\u3002VLOOKUP \u5C06\u5728\u8BE5\u8303\u56F4\u7684\u7B2C\u4E00\u5217\u4E2D\u641C\u7D22\u641C\u7D22\u952E\u503C\u4E2D\u6307\u5B9A\u7684\u952E\u503C\u3002"},rangeNumber:{name:"\u7D22\u5F15",detail:`\u8981\u8FD4\u56DE\u7684\u503C\u7684\u5217\u7D22\u5F15\uFF0C\u8303\u56F4\u4E2D\u7684\u7B2C\u4E00\u5217\u7F16\u53F7\u4E3A 1\u3002

\u5982\u679C\u7D22\u5F15\u4E0D\u662F\u4ECB\u4E8E 1 \u548C\u8303\u56F4\u4E2D\u7684\u5217\u6570\u4E4B\u95F4\uFF0C\u5C06\u8FD4\u56DE #VALUE! \u3002`},rangeAll2:{name:"\u5DF2\u6392\u5E8F",detail:`[\u9ED8\u8BA4\u503C\u4E3A TRUE() ] - \u6307\u793A\u8981\u641C\u7D22\u7684\u5217\uFF08\u6307\u5B9A\u8303\u56F4\u7684\u7B2C\u4E00\u5217\uFF09\u662F\u5426\u5DF2\u6392\u5E8F\u3002\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u5EFA\u8BAE\u8BBE\u4E3A FALSE()\u3002

\u5EFA\u8BAE\u5C06\u5DF2\u6392\u5E8F\u8BBE\u4E3A FALSE\u3002\u5982\u679C\u8BBE\u4E3A FALSE\uFF0C\u5C06\u8FD4\u56DE\u5B8C\u5168\u5339\u914D\u9879\u3002\u5982\u679C\u5B58\u5728\u591A\u4E2A\u5339\u914D\u503C\uFF0C\u5C06\u8FD4\u56DE\u627E\u5230\u7684\u7B2C\u4E00\u4E2A\u503C\u5BF9\u5E94\u7684\u5355\u5143\u683C\u7684\u5185\u5BB9\uFF0C\u5982\u679C\u627E\u4E0D\u5230\u5339\u914D\u503C\uFF0C\u5219\u8FD4\u56DE #N/A\u3002

\u5982\u679C\u5C06\u5DF2\u6392\u5E8F\u8BBE\u4E3A TRUE \u6216\u7701\u7565\uFF0C\u5C06\u8FD4\u56DE\uFF08\u5C0F\u4E8E\u6216\u7B49\u4E8E\u641C\u7D22\u952E\u503C\u7684\uFF09\u6700\u63A5\u8FD1\u7684\u5339\u914D\u9879\u3002\u5982\u679C\u641C\u7D22\u7684\u5217\u4E2D\u6240\u6709\u7684\u503C\u5747\u5927\u4E8E\u641C\u7D22\u952E\u503C\uFF0C\u5219\u8FD4\u56DE #N/A\u3002`}}},TIME:{d:"\u5C06\u7ED9\u5B9A\u7684\u5C0F\u65F6\u3001\u5206\u949F\u548C\u79D2\u8F6C\u6362\u4E3A\u65F6\u95F4\u3002",p:{rangeNumber:{name:"\u5C0F\u65F6",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u5C0F\u65F6\u3002

\u4EFB\u4F55\u5927\u4E8E 23 \u7684\u503C\u90FD\u4F1A\u9664\u4EE5 24\uFF0C\u4F59\u6570\u5C06\u4F5C\u4E3A\u5C0F\u65F6\u503C\u3002`},rangeNumber1:{name:"\u5206\u949F",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u5206\u949F\u3002

\u4EFB\u4F55\u5927\u4E8E 59 \u7684\u503C\u5C06\u8F6C\u6362\u4E3A\u5C0F\u65F6\u548C\u5206\u949F\u3002`},rangeNumber2:{name:"\u79D2",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u79D2\u3002

\u4EFB\u4F55\u5927\u4E8E 59 \u7684\u503C\u5C06\u8F6C\u6362\u4E3A\u5C0F\u65F6\u3001\u5206\u949F\u548C\u79D2\u3002`}}},EFFECT:{d:"\u6839\u636E\u540D\u4E49\u5229\u7387\u53CA\u6BCF\u5E74\u7684\u590D\u5229\u8BA1\u606F\u671F\u6570\u6765\u8BA1\u7B97\u5B9E\u9645\u5E74\u5229\u7387\u3002",p:{rangeNumber:{name:"nominal_rate",detail:"\u6BCF\u5E74\u7684\u540D\u4E49\u5229\u7387\u3002"},rangeNumber1:{name:"npery",detail:"\u6BCF\u5E74\u7684\u590D\u5229\u8BA1\u7B97\u671F\u6570\u3002"}}},BIN2DEC:{d:"\u5C06\u4E8C\u8FDB\u5236\u6570\u8F6C\u6362\u4E3A\u5341\u8FDB\u5236\u6570\u3002",p:{rangeAll:{name:"number",detail:`\u8981\u8F6C\u6362\u4E3A\u5341\u8FDB\u5236\u6570\u7684\u5E26\u7B26\u53F7\u768410\u4F4D\u4E8C\u8FDB\u5236\u6570\u503C\uFF08\u4EE5\u5B57\u7B26\u4E32\u5F62\u5F0F\u63D0\u4F9B\uFF09\u3002

\u5E26\u7B26\u53F7\u7684\u4E8C\u8FDB\u5236\u6570\u7684\u6700\u9AD8\u4F4D\u662F\u7B26\u53F7\u4F4D\uFF1B\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8D1F\u6570\u662F\u4EE5\u4E8C\u7684\u8865\u7801\u5F62\u5F0F\u8868\u793A\u7684\u3002

\u5BF9\u4E8E\u6B64\u51FD\u6570\uFF0C\u6700\u5927\u7684\u6B63\u6570\u8F93\u5165\u503C\u4E3A0111111111\uFF0C\u6700\u5C0F\u7684\u8D1F\u6570\u8F93\u5165\u503C\u4E3A1000000000\u3002

\u5982\u679C\u6240\u63D0\u4F9B\u7684\u5E26\u7B26\u53F7\u7684\u4E8C\u8FDB\u5236\u6570\u662F\u6709\u6548\u7684\u4E8C\u8FDB\u5236\u6570\uFF0C\u4F1A\u81EA\u52A8\u5C06\u5176\u8F6C\u6362\u4E3A\u76F8\u5E94\u7684\u5B57\u7B26\u4E32\u8F93\u5165\u3002\u4F8B\u5982\uFF0CBIN2DEC(100)\u548CBIN2DEC("100")\u5F97\u51FA\u7684\u7ED3\u679C\u76F8\u540C\uFF0C\u5747\u4E3A4\u3002`}}},TRUE:{d:"\u8FD4\u56DE\u903B\u8F91\u503C TRUE\u3002"},NE:{d:"\u5982\u679C\u6307\u5B9A\u7684\u503C\u4E0D\u76F8\u7B49\uFF0C\u5219\u8FD4\u56DE\u201CTRUE\u201D\uFF1B\u5426\u5219\u8FD4\u56DE\u201CFALSE\u201D\u3002\u76F8\u5F53\u4E8E\u201C<>\u201D\u8FD0\u7B97\u7B26\u3002",p:{rangeAll:{name:"value1",detail:"\u7B2C\u4E00\u4E2A\u503C\u3002"},rangeAll1:{name:"value2",detail:"\u8981\u68C0\u67E5\u662F\u5426\u4E0E value1 \u4E0D\u76F8\u7B49\u7684\u503C\u3002"}}},SEX_BY_IDCARD:{d:"\u6839\u636E\u4E2D\u56FD\u8EAB\u4EFD\u8BC1\u53F7\u8BA1\u7B97\u51FA\u6027\u522B\u3002\u652F\u630115\u4F4D\u621618\u4F4D\u8EAB\u4EFD\u8BC1",p:{rangeAll:{name:"\u8EAB\u4EFD\u8BC1\u53F7",detail:"15\u4F4D\u6216\u800518\u4F4D\u7684\u8EAB\u4EFD\u8BC1\u53F7\u6216\u8303\u56F4\u3002"}}}},formulaMore:{valueTitle:"\u503C",tipSelectDataRange:"\u9009\u53D6\u6570\u636E\u8303\u56F4",tipDataRangeTile:"\u6570\u636E\u8303\u56F4",findFunctionTitle:"\u67E5\u627E\u51FD\u6570",tipInputFunctionName:"\u8BF7\u8F93\u5165\u60A8\u8981\u67E5\u627E\u7684\u51FD\u6570\u540D\u79F0\u6216\u51FD\u6570\u529F\u80FD\u7684\u7B80\u8981\u63CF\u8FF0",whole:"\u5168\u90E8",Math:"\u6570\u5B66",Statistical:"\u7EDF\u8BA1",Lookup:"\u67E5\u627E",universheet:"UniverSheet\u5185\u7F6E",dataMining:"\u6570\u636E\u6316\u6398",Database:"\u6570\u636E\u6E90",Date:"\u65E5\u671F",Filter:"\u8FC7\u6EE4\u5668",Financial:"\u8D22\u52A1",Engineering:"\u5DE5\u7A0B\u8BA1\u7B97",Logical:"\u903B\u8F91",Operator:"\u8FD0\u7B97\u7B26",Text:"\u6587\u672C",Parser:"\u8F6C\u6362\u5DE5\u5177",Array:"\u6570\u7EC4",other:"\u5176\u5B83",selectFunctionTitle:"\u9009\u62E9\u51FD\u6570",calculationResult:"\u8BA1\u7B97\u7ED3\u679C",tipSuccessText:"\u6210\u529F",tipParamErrorText:"\u53C2\u6570\u7C7B\u578B\u9519\u8BEF",helpClose:"\u5173\u95ED",helpCollapse:"\u6536\u8D77",helpExample:"\u793A\u4F8B",helpAbstract:"\u6458\u8981",execfunctionError:'\u63D0\u793A", "\u516C\u5F0F\u5B58\u5728\u9519\u8BEF',execfunctionSelfError:"\u516C\u5F0F\u4E0D\u53EF\u5F15\u7528\u5176\u672C\u8EAB\u7684\u5355\u5143\u683C",execfunctionSelfErrorResult:"\u516C\u5F0F\u4E0D\u53EF\u5F15\u7528\u5176\u672C\u8EAB\u7684\u5355\u5143\u683C\uFF0C\u4F1A\u5BFC\u81F4\u8BA1\u7B97\u7ED3\u679C\u4E0D\u51C6\u786E",allowRepeatText:"\u53EF\u91CD\u590D",allowOptionText:"\u53EF\u9009",selectCategory:"\u6216\u9009\u62E9\u7C7B\u522B"},ifFormula:{tipNotBelongToIf:"\u8BE5\u5355\u5143\u683C\u51FD\u6570\u4E0D\u5C5E\u4E8Eif\u516C\u5F0F\uFF01",tipSelectCell:"\u8BF7\u9009\u62E9\u5355\u5143\u683C\u63D2\u5165\u51FD\u6570",ifGenCompareValueTitle:"\u6BD4\u8F83\u503C",ifGenSelectCellTitle:"\u70B9\u51FB\u9009\u62E9\u5355\u5143\u683C",ifGenRangeTitle:"\u8303\u56F4",ifGenRangeTo:"\u81F3",ifGenRangeEvaluate:"\u8303\u56F4\u8BC4\u4F30",ifGenSelectRangeTitle:"\u70B9\u51FB\u9009\u62E9\u8303\u56F4",ifGenCutWay:"\u5212\u5206\u65B9\u5F0F",ifGenCutSame:"\u5212\u5206\u503C\u76F8\u540C",ifGenCutNpiece:"\u5212\u5206\u4E3AN\u4EFD",ifGenCutCustom:"\u81EA\u5B9A\u4E49\u8F93\u5165",ifGenCutConfirm:"\u751F\u6210",ifGenTipSelectCell:"\u9009\u62E9\u5355\u5143\u683C",ifGenTipSelectCellPlace:"\u8BF7\u9009\u62E9\u5355\u5143\u683C",ifGenTipSelectRange:"\u9009\u62E9\u5355\u8303\u56F4",ifGenTipSelectRangePlace:"\u8BF7\u9009\u62E9\u8303\u56F4",ifGenTipNotNullValue:"\u6BD4\u8F83\u503C\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipLableTitile:"\u6807\u7B7E",ifGenTipRangeNotforNull:"\u8303\u56F4\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipCutValueNotforNull:"\u5212\u5206\u503C\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipNotGenCondition:"\u6CA1\u6709\u751F\u6210\u53EF\u7528\u7684\u6761\u4EF6\uFF01"}}},By={formula:{formulaLabel:"SUM",formulaRightLabel:"more formule",ok:"Ok",cancel:"Cancel",clearValidation:"Clear Validation",formula:{sum:"sum",average:"average",count:"count",max:"max",min:"min",if:"If formula generator",more:"More functions..."},functionList:{SUMIF:{d:"Returns a conditional sum across a range.",p:{range:{name:"range",detail:"The range which is tested against `criterion`."},rangeAll:{name:"criterion",detail:"The pattern or test to apply to `range`."},range1:{name:"sum_range",detail:"The range to be summed, if different from `range`."}}},TAN:{d:"Returns the tangent of an angle provided in radians.",p:{rangeNumber:{name:"angle",detail:"The angle to find the tangent of, in radians."}}},TANH:{d:"Returns the hyperbolic tangent of any real number.",p:{rangeNumber:{name:"value",detail:"Any real value to calculate the hyperbolic tangent of."}}},CEILING:{d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",p:{rangeNumber:{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`."},rangeNumber1:{name:"factor",detail:"The number to whose multiples `value` will be rounded."}}},ATAN:{d:"Returns the inverse tangent of a value, in radians.",p:{rangeNumber:{name:"value",detail:"The value for which to calculate the inverse tangent."}}},ASINH:{d:"Returns the inverse hyperbolic sine of a number.",p:{rangeNumber:{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine."}}},ABS:{d:"Returns the absolute value of a number.",p:{rangeNumber:{name:"value",detail:"The number of which to return the absolute value."}}},COUNTBLANK:{d:"Returns the number of empty values in a list of values and ranges.",p:{range:{name:"value1",detail:"The first value or range in which to count the number of blanks."}}},COSH:{d:"Returns the hyperbolic cosine of any real number.",p:{rangeNumber:{name:"value",detail:"Any real value to calculate the hyperbolic cosine of."}}},COUNTIF:{d:"Returns a conditional count across a range.",p:{range:{name:"range",detail:"The range that is tested against `criterion`."},rangeAll:{name:"criterion",detail:"The pattern or test to apply to `range`."}}},ERFC:{d:"Returns the complementary Gauss error function of a value.",p:{rangeNumber:{name:"z",detail:"The number for which to calculate the complementary Gauss error function."}}},VLOOKUP:{d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",p:{rangeAll:{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.'},rangeAll1:{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`. "},rangeNumber:{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1."},rangeAll2:{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned."}}},TIME:{d:"Converts a provided hour, minute, and second into a time.",p:{rangeNumber:{name:"hour",detail:"0The hour component of the time."},rangeNumber1:{name:"minute",detail:"The minute component of the time."},rangeNumber2:{name:"second",detail:"The second component of the time."}}},EFFECT:{d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",p:{rangeNumber:{name:"nominal_rate",detail:"The nominal interest rate per year."},rangeNumber1:{name:"periods_per_year",detail:"The number of compounding periods per year."}}},BIN2DEC:{d:"Converts a signed binary number to decimal format.",p:{rangeAll:{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string."}}},TRUE:{d:"Returns the logical value `TRUE`."},NE:{d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",p:{rangeAll:{name:"value1",detail:"The first value."},rangeAll1:{name:"value2",detail:"The value to test against `value1` for inequality."}}},SEX_BY_IDCARD:{d:"Calculate gender based on Chinese ID number. Support 15 or 18",p:{rangeAll:{name:"ID number",detail:"15-digit or 18-digit ID number or range."}}}},functiontype:{0:"Math",1:"Statistical",2:"Lookup",3:"UniverSheet",4:"Data Mining",5:"Database",6:"Date",7:"Filter",8:"Financial",9:"Engineering",10:"Logical",11:"Operator",12:"Text",13:"Parser",14:"Array",15:"Other"},formulaMore:{valueTitle:"Value",tipSelectDataRange:"Select data range",tipDataRangeTile:"Data range",findFunctionTitle:"Search function",tipInputFunctionName:"Function name or brief description of function",whole:"Whole",Math:"Math",Statistical:"Statistical",Lookup:"Lookup",universheet:"UniverSheet",dataMining:"Data Mining",Database:"Database",Date:"Date",Filter:"Filter",Financial:"Financial",Engineering:"Engineering",Logical:"Logical",Operator:"Operator",Text:"Text",Parser:"Parser",Array:"Array",other:"Other",selectFunctionTitle:"Select a function",calculationResult:"Result",tipSuccessText:"Success",tipParamErrorText:"Parameter type error",helpClose:"Close",helpCollapse:"Collapse",helpExample:"Example",helpAbstract:"Abstract",execfunctionError:"Error in the formula",execfunctionSelfError:"The formula cannot refer to its own cell",execfunctionSelfErrorResult:"The formula cannot refer to its own cell, which will lead to inaccurate calculation results",allowRepeatText:"Repeat",allowOptionText:"Option",selectCategory:"Or select a category"},ifFormula:{tipNotBelongToIf:"This cell function does not belong to the if formula!",tipSelectCell:"Please select the cell to insert the function",ifGenCompareValueTitle:"Comparison value",ifGenSelectCellTitle:"Click to select cell",ifGenRangeTitle:"Range",ifGenRangeTo:"to",ifGenRangeEvaluate:"Range evaluate",ifGenSelectRangeTitle:"Click to select range",ifGenCutWay:"Partition way",ifGenCutSame:"Same Partition value",ifGenCutNpiece:"Partition by N",ifGenCutCustom:"Custom",ifGenCutConfirm:"Confirm",ifGenTipSelectCell:"Select cells",ifGenTipSelectCellPlace:"Please select cells",ifGenTipSelectRange:"Select range",ifGenTipSelectRangePlace:"Please select range",ifGenTipNotNullValue:"The comparison value cannot be empty!",ifGenTipLableTitile:"Label",ifGenTipRangeNotforNull:"The range cannot be empty!",ifGenTipCutValueNotforNull:"The partition value cannot be empty!",ifGenTipNotGenCondition:"No conditions are available for generation!"}}};class Ly{constructor(e){this._formulaData={},this._calculationChain=[],this._recalculationMode=Ah.AUTOMATIC,e!=null&&e.formulaData&&(this._formulaData=e.formulaData),e!=null&&e.calculationChain&&(this._calculationChain=e.calculationChain),e!=null&&e.recalculationMode&&(this._recalculationMode=e.recalculationMode)}getFormulaData(){return this._formulaData}setFormulaData(e){this._formulaData=e}}class kh extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const e=this._render.renderFunction("SumIcon"),{label:t}=this.props;return _("div",{style:{display:"flex",alignItems:"center"}},_(e,null),t)}}class Py{constructor(e,t){this._plugin=e,this._formulaDataModel=new Ly(t),this._context=this._plugin.getContext(),this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET),this._initRegisterComponent(),this._sheetPlugin.addToolButton({name:Xt,locale:Xt,hideSelectedIcon:!0,customLabel:{name:Xt+kh.name,props:{locale:"formula.formula.sum"}},type:5,show:Lp.show,tooltipLocale:"formula.formulaLabel",children:[{locale:"formula.formula.sum",suffix:"SUM"},{locale:"formula.formula.average",suffix:"AVERAGE"},{locale:"formula.formula.max",suffix:"MAX"},{locale:"formula.formula.min",suffix:"MIN",border:!0},{locale:"formula.formula.if",suffix:"IF"},{locale:"formula.formula.more",onClick:()=>this._plugin.getSearchFormulaController().showFormulaModal("SearchFormula",!0)}]})}_initRegisterComponent(){this._sheetPlugin.registerComponent(Xt+kh.name,kh)}getDataModel(){return this._formulaDataModel}setFormulaEngine(e){this._formulaEngine=e}getFormulaEngine(){return this._formulaEngine}toInterpreterCalculateProps(e=!0){return(e||!this._interpreterCalculatePropsCache)&&(this._interpreterCalculatePropsCache=this._toInterpreterCalculateProps()),this._interpreterCalculatePropsCache}getCommandManager(){return this._context.getCommandManager()}getWorkbook(){return this._context.getWorkBook()}getUnitId(){return this.getWorkbook().getUnitId()}_toInterpreterCalculateProps(){const e=this._context.getWorkBook(),t=e.getSheets(),n={},s={},o={},i=e.getUnitId();for(let h of t)n[h.getSheetId()]=h.getCellMatrix(),o[h.getName()]=h.getSheetId();s[i]=n;const a=this._formulaDataModel.getFormulaData(),l=e.getActiveSheet(),u=l.getRowCount(),c=l.getColumnCount();return{unitData:s,formulaData:a,sheetNameMap:o,currentRow:-1,currentColumn:-1,currentSheetId:"",currentUnitId:i,rowCount:u,columnCount:c}}}function Hy(r){const e=r.getDataModel(),n=r.getFormulaEngine().execute(r.getUnitId(),e.getFormulaData(),r.toInterpreterCalculateProps(),!0),s=r.getCommandManager(),o=r.getWorkbook();n.then(i=>{if(!i)return;const{sheetData:a,arrayFormulaData:l}=i;if(!a)return;const u=Object.keys(a),c=[];for(let d=0,g=u.length;d<g;d++){const m=u[d];a[m].forValue((p,b,v)=>{const w={actionName:$.SET_RANGE_DATA_ACTION,sheetId:m,cellValue:{[p]:{[b]:v}}};c.push(pr.make(w).removeCollaboration().removeUndo().removeExtension().getAction())})}const h=new ge({WorkBookUnit:o},...c);s.invoke(h)})}class Uy extends sh{setValue(e){this._cell.value=e}execute(){this.setValue(this._value)}}class zy extends q1{get zIndex(){return 0}create(e,t){return new Uy(e,t)}check(e){const{row:t,column:n}=e,s=this._plugin.getFormulaController().getDataModel().getFormulaData();let o;return Object.keys(s).forEach(i=>{const a=s[i],l=Object.keys(a);for(let u=0,c=l.length;u<c;u++){const h=l[u],d=a[h];Object.keys(d).forEach(g=>{d[g].forEach((f,p)=>{if(Number(g)===t&&f===n)return o=this._plugin.getFormulaPromptController().cellInputHandler.functionHTMLGenerate(p.formula),!1})})}}),o?this.create(e,o):!1}}class Wy extends ih{setValue(e){this._cell.value=e}execute(){this.setValue(this._value)}}class Vy extends Q1{get zIndex(){return 0}create(e,t){return new Wy(e,t)}check(e){const{row:t,column:n}=e,s=this._plugin.getFormulaController().getDataModel().getFormulaData();let o;return Object.keys(s).forEach(i=>{const a=s[i],l=Object.keys(a);for(let u=0,c=l.length;u<c;u++){const h=l[u],d=a[h];Object.keys(d).forEach(g=>{d[g].forEach((f,p)=>{if(Number(g)===t&&f===n)return o=p.formula,!1})})}}),o?this.create(e,o):!1}}class $y extends si{execute(){const e=this._plugin.getFormulaEngine(),t=this._plugin.getFormulaController(),n=t.getDataModel(),s=W.deepClone(n.getFormulaData()),o=this._plugin.getContext().getWorkBook().getUnitId(),i=this.actionDataList,a=[];let l=!1;i.forEach(u=>{if(u.operation!=null&&!pr.hasExtension(u))return!1;if(u.actionName===$.SET_RANGE_DATA_ACTION){const{sheetId:c,cellValue:h}=u;if(W.isEmptyObject(s))return;const d=new _e(s[o][c]);if(h==null)return;const g=new _e(h);g.forValue((m,f,p)=>{var v;const b=p.m;W.isStringNumber(b)?(l=!0,(v=d.getRow(m))!=null&&v.get(f)&&d.deleteValue(m,f)):lf(b)&&(l=!0,d.setValue(m,f,{formula:b,row:m,column:f,sheetId:c}))}),a.push({unitId:o,sheetId:c,rangeData:g.getDataRange()})}}),!(a.length===0||!l)&&e.execute(o,s,t.toInterpreterCalculateProps(),!1,a).then(u=>{const{sheetData:c,arrayFormulaData:h}=u;if(!c){console.error("No sheetData from Formula Engine!");return}const d=Object.keys(c),g=[];d.forEach(v=>{const w=c[v];w.forValue((S,T,D)=>{const R=w.getValue(S,T);R&&R.p&&delete R.p,R&&Number.isNaN(R.v)&&(R.v=0);const I={actionName:$.SET_RANGE_DATA_ACTION,sheetId:v,cellValue:{[S]:{[T]:R||{}}}},y=pr.make(I).removeCollaboration().removeUndo().removeExtension().getAction();g.push(y)})});const m={actionName:yh.SET_FORMULA_RANGE_DATA_ACTION,sheetId:i[0].sheetId,formulaData:s},f=this._plugin.getContext().getWorkBook(),p=this._plugin.getContext().getCommandManager(),b=new ge({WorkBookUnit:f},...g,m);p.invoke(b)})}}class Gy extends fa{get zIndex(){return 1}create(e){return new $y(e,this._plugin)}}function Xy(r){r.pushToObserve("onSearchFormulaModalDidMountObservable"),r.pushToObserve("onSearchItemDidMountObservable"),r.pushToObserve("onSearchFunctionDidMountObservable"),r.pushToObserve("onHelpFunctionDidMountObservable")}var xt={functionModal:"univer-function-modal",functionSearch:"univer-function-search",functionSelect:"univer-function-select",functionLabel:"univer-function-label",functionSelector:"univer-function-selector",selectButton:"univer-select-button",functionList:"univer-function-list",functionLists:"univer-function-lists",functionListsItem:"univer-function-lists-item",functionListsItemActive:"univer-function-lists-item-active",functionParamModal:"univer-function-param-modal",functionParamList:"univer-function-param-list",functionParamDesc:"univer-function-param-desc",functionParamDescDetails:"univer-function-param-desc-details",functionBtn:"univer-function-btn",btn:"univer-btn"};class Bh extends Oe{constructor(){super(...arguments),this.functionListRef=Ae()}initialize(){var n;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const t=(n=this.props.funList.children)==null?void 0:n.filter(s=>s.t===0);this.state={functionList:t,type:0}}changeInput(e){var o;const t=e.target.value;let{functionList:n,type:s}=this.state;t?n=n==null?void 0:n.filter(i=>{var a,l;return((a=i.n)==null?void 0:a.includes(t))||((l=i.d)==null?void 0:l.includes(t))?i:null}):n=(o=this.props.funList.children)==null?void 0:o.filter(i=>i.t===s),this.setState({functionList:n})}selectType(e,t){var o;const{funList:n}=this.props,s=(o=n.children)==null?void 0:o.filter(i=>i.t===t);this.setState({functionList:s,type:t},()=>{this.highLightLi(0)})}componentDidMount(){this.highLightLi(0)}highLightLi(e){const t=this.functionListRef.current.querySelectorAll(`.${xt.functionListsItem}`);for(let n=0;n<t.length;n++)t[n].classList.remove(xt.functionListsItemActive);t[e].classList.add(xt.functionListsItemActive),t[e].click()}handleClick(e,t){const{funList:n}=this.props;this.highLightLi(t),n.onClick(e)}render(){const e=this._render.renderFunction("Input"),{input:t,select:n,funList:s}=this.props,{functionList:o}=this.state;if(!!t)return _("div",{className:xt.functionModal},_("div",{className:xt.functionSearch},_("div",{className:xt.functionLabel},t.label),_(e,{placeholder:t.placeholder,onChange:es(this.changeInput.bind(this),50)})),_("div",{className:xt.functionSelect},_("div",{className:xt.functionLabel},n.label),_("div",{className:xt.functionSelector},_(ul,{onClick:this.selectType.bind(this),type:0,children:n.children,hideSelectedIcon:!0}))),_("div",{className:xt.functionList,ref:this.functionListRef},_("div",{className:xt.functionLabel},s.label),_("ul",{className:xt.functionLists},o==null?void 0:o.map((i,a)=>_("li",{className:`${xt.functionListsItem}`,onClick:()=>this.handleClick(i,a)},_("div",{className:xt.functionListsItemName},i.n),_("div",{className:xt.functionListsItemDetail},i.d))))))}}class d_ extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={modalData:[]}}componentDidMount(){this._context.getPluginManager().getPluginByName(Xt).getObserver("onSearchFormulaModalDidMountObservable").notifyObservers(this)}setModal(e){const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);e.forEach(n=>{var o;const s=t.getRegisterComponent(n.children.name);if(s){const i=(o=n.children.props)!=null?o:{};n.modal=_(s,{...i})}}),this.setState({modalData:e})}render(){const e=this._render.renderFunction("Modal"),{modalData:t}=this.state;return _(Rt,null,t.map(n=>{var s;if(!!n.show)return _(e,{isDrag:!0,mask:n.mask,title:(s=n.label)==null?void 0:s.funParams.n,visible:n.show,group:n.group,onCancel:n.onCancel},n.modal)}))}}class Lh extends Oe{initialize(){this.state={description:{},rangeList:[],index:0}}componentDidMount(){var s;this._context.getPluginManager().getPluginByName(Xt).getObserver("onSearchItemDidMountObservable").notifyObservers(this);const{funParams:t}=this.props,n=(s=t==null?void 0:t.funParams.p)==null?void 0:s[0];this.setState({description:n})}handleClick(e){var s;const{funParams:t}=this.props,n=(s=t==null?void 0:t.funParams.p)==null?void 0:s[e];this.setState({description:n,index:e})}changeRange(e){const{index:t,rangeList:n}=this.state;n[t]=e,this.setState({rangeList:n})}render(){var i,a,l;const{funParams:e,calc:t,onTableClick:n}=this.props,{description:s,rangeList:o}=this.state;if(!!e)return _("div",{className:xt.functionParamModal},_("div",{className:xt.functionParamList},(a=(i=e.funParams)==null?void 0:i.p)==null?void 0:a.map((u,c)=>_("div",null,_("span",null,u.name,"\uFF1A"),_(Op,{onTableClick:n,value:o[c],onClick:()=>this.handleClick(c)}),_("span",null,"=","{}")))),_("div",{className:xt.functionParamDesc},_("div",{className:xt.functionParamDescDetail},(l=e.funParams)==null?void 0:l.d),_("div",{className:xt.functionParamDescDetails},_("p",null,s.name,": ",s.detail))),_("div",{className:xt.functionParamResult},t,"="))}}class Yy{constructor(e){this._plugin=e,this._funParams={funParams:{}},this._modalData=[{name:"SearchFormula",show:!1,group:[{locale:"button.confirm",type:"primary",onClick:this.showSearchItemModal.bind(this)},{locale:"button.cancel"}],onCancel:()=>this.showFormulaModal("SearchFormula",!1),children:{name:Xt+Bh.name,props:{input:{locale:"formula.formulaMore.findFunctionTitle",placeholderLocale:"formula.formulaMore.tipInputFunctionName"},select:{locale:"formula.formulaMore.selectCategory",children:kp},funList:{onClick:this.selectFunParams.bind(this),locale:"formula.formulaMore.selectFunctionTitle",children:Bp}}}},{name:"SearchItem",label:this._funParams,show:!1,mask:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showFormulaModal("SearchItem",!1),children:{name:Xt+Lh.name,props:{funParams:this._funParams,calcLocale:"formula.formulaMore.calculationResult",range:"A1:B10",onTableClick:()=>this.showCellRangeModal(!0)}}}],this._cellRangeModalData={name:"cellRangeModal",titleLocale:"formula.formulaMore.tipSelectDataRange",show:!1,mask:!1,group:[{locale:"button.confirm",type:"primary"}],onCancel:()=>this.showFormulaModal("cellRangeModal",!1),children:{props:{placeholderLocale:""}}},this._initRegisterComponent(),this._initialize()}_initialize(){var t;this._plugin.getObserver("onSearchFormulaModalDidMountObservable").add(n=>{this._formulaModal=n,this._modalData=this._resetLabel(this._modalData),this._cellRangeModalData=this._resetLabel(this._cellRangeModalData)}),this._plugin.getObserver("onSearchItemDidMountObservable").add(n=>{this._searchItem=n}),(t=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET).getObserver("onChangeSelectionObserver"))==null||t.add(n=>{var o;const s=n.getCurrentCellInfo();this._searchItem.changeRange((o=s==null?void 0:s.startColumn.toString())!=null?o:"")})}_initRegisterComponent(){const e=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET);e.registerModal(Xt+d_.name,d_),e.registerModal(Xt+Lh.name,Lh),e.registerComponent(Xt+Bh.name,Bh)}_resetLocale(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}_findLocale(e){for(let t in e)if(t==="locale")e.label=this._resetLocale(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this._resetLocale(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this._findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this._resetLabel(e[t]));return e}_resetLabel(e){if(e instanceof Array){for(let t=0;t<e.length;t++){let n=e[t];n=this._findLocale(n),n.children&&(n.children=this._resetLabel(n.children))}return e}if(e instanceof Object)return e=this._findLocale(e),e}selectFunParams(e){this._funParams.funParams=e}showFormulaModal(e,t){const n=this._modalData.findIndex(s=>s.name===e);n>-1&&(this._modalData[n].show=t,this._formulaModal.setModal(this._modalData))}showCellRangeModal(e){this._cellRangeModalData.show=e;const t=this._plugin.getPluginByName(Pe.SPREADSHEET);(t==null?void 0:t.getModalGroupControl().getModal(Sl.name)).setModal(this._cellRangeModalData),this.showFormulaModal("SearchItem",!1)}showSearchItemModal(){this.showFormulaModal("SearchFormula",!1),this.showFormulaModal("SearchItem",!0)}}const ji={zh:[{n:"SUM",t:0,d:"\u8FD4\u56DE\u4E00\u7EC4\u6570\u503C\u548C/\u6216\u5355\u5143\u683C\u7684\u603B\u548C\u3002",a:"\u8FD4\u56DE\u4E00\u7EC4\u6570\u503C\u548C/\u6216\u5355\u5143\u683C\u7684\u603B\u548C\u3002",m:[1,255],p:[{name:"\u503C1",detail:"\u8981\u76F8\u52A0\u7684\u7B2C\u4E00\u4E2A\u6570\u503C\u6216\u8303\u56F4\u3002",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"\u503C2",detail:"[\u53EF\u9009] - \u8981\u76F8\u52A0\u7684\u5176\u4ED6\u6570\u503C\u6216\u8303\u56F4\u3002",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"\u4F7F\u7528\u6307\u5B9A\u7684\u6C47\u603B\u51FD\u6570\uFF0C\u8FD4\u56DE\u4E00\u7CFB\u5217\u7EB5\u5411\u5355\u5143\u683C\u7684\u5206\u7C7B\u6C47\u603B\u3002",a:"\u4F7F\u7528\u6307\u5B9A\u7684\u6C47\u603B\u51FD\u6570",m:[2,256],p:[{name:"\u51FD\u6570\u4EE3\u7801",detail:`\u7528\u4E8E\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u51FD\u6570\u3002

1\u4EE3\u8868AVERAGE

2\u4EE3\u8868COUNT

3\u4EE3\u8868COUNTA

4\u4EE3\u8868MAX

5\u4EE3\u8868MIN

6\u4EE3\u8868PRODUCT

7\u4EE3\u8868STDEV

8\u4EE3\u8868STDEVP

9\u4EE3\u8868SUM

10\u4EE3\u8868VAR

11\u4EE3\u8868VARP

\u901A\u8FC7\u5728\u8FD9\u4E9B2\u4F4D\u4EE3\u7801\u524D\u9644\u52A010\uFF08\u5BF9\u4E8E1\u4F4D\u4EE3\u7801\uFF09\u62161\uFF08\u5BF9\u4E8E2\u4F4D\u4EE3\u7801\uFF09\uFF0C\u53EF\u4EE5\u5C06\u9690\u85CF\u503C\u5FFD\u7565\u3002\u4F8B\u5982\uFF0C102\u4EE3\u8868\u5FFD\u7565\u9690\u85CF\u5355\u5143\u683C\u7684COUNT\uFF0C\u800C110\u5219\u4EE3\u8868\u5FFD\u7565\u9690\u85CF\u503C\u7684VAR\u3002`,example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"\u8303\u56F41",detail:"\u8981\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u7B2C\u4E00\u4E2A\u8303\u56F4\u3002",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"\u8303\u56F42",detail:"[\u53EF\u9009] - \u8981\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u5176\u4ED6\u8303\u56F4\u3002",example:"B2:B8",require:"o",repeat:"y",type:"range"}]}],en:[{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]}]};var Bn={searchFunction:"univer-search-function",formulaDetail:"univer-formula-detail",searchFunctionActive:"univer-search-function-active",helpFunction:"univer-help-function",helpFunctionTitle:"univer-help-function-title",helpFunctionContent:"univer-help-function-content",helpFunctionContentParams:"univer-help-function-content-params",helpFunctionContentTitle:"univer-help-function-content-title",helpFunctionContentDetail:"univer-help-function-content-detail",helpFunctionActive:"univer-help-function-active"};class g_ extends Oe{initialize(){this.state={activeIndex:0,lang:"",locale:[],formula:[],functionInfo:null,helpFormulaActive:!1,position:{left:0,top:0}}}componentWillMount(){this.setLocale()}componentDidMount(){this._context.getPluginManager().getPluginByName(Xt).getObserver("onHelpFunctionDidMountObservable").notifyObservers(this)}updateState(e,t=0,n="",s={left:0,top:0}){const o=this.state.formula.find(i=>i.n===n)||{};this.setState({helpFormulaActive:e,functionInfo:o,activeIndex:t,position:s})}getState(){return this.state}setLocale(){const e=this._context.getLocale().options.currentLocale;this.setState({lang:e,formula:ji[`${e}`],functionInfo:ji[`${e}`][0]})}render(e,t){const{activeIndex:n,functionInfo:s,helpFormulaActive:o,position:i}=t;return _("div",{className:Bn.helpFunction,style:{display:o?"block":"none",position:"absolute",left:`${i.left}px`,top:`${i.top}px`}},_("div",{class:Bn.helpFunctionTitle},_(m_,{title:s.n,value:s.p,type:"name",active:n})),_("div",{className:Bn.helpFunctionContent},_("div",null,"\u793A\u4F8B"),_(m_,{title:s.n,value:s.p,type:"example",active:n}),_(f_,{title:"\u6458\u8981",value:s.d}),_(Rt,null,s&&s.p&&s.p.map((a,l)=>_(f_,{className:n===l?Bn.helpFunctionActive:"",title:a.name,value:a.detail,active:n})))))}}const f_=r=>_("div",{className:`${Bn.helpFunctionContentParams} ${r.className}`},_("div",{className:Bn.helpFunctionContentTitle},r.title),_("div",{className:Bn.helpFunctionContentDetail},r.value)),m_=r=>_("div",null,_("span",null,r.title,"("),r.value&&r.value.map((e,t)=>_("span",{className:r.active===t?Bn.helpFunctionActive:""},e[`${r.type}`],",")),_("span",null,")"));class p_ extends Oe{initialize(){this.state={lang:"",locale:[],formulaValue:"",functionList:[],selectIndex:0,formula:[],searchActive:!1,position:{left:0,top:0}}}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentDidMount(){this.setState({functionList:this.state.locale}),this._context.getPluginManager().getPluginByName(Xt).getObserver("onSearchFunctionDidMountObservable").notifyObservers(this)}componentWillUpdate(e){}setLocale(){const e=this._context.getLocale().options.currentLocale;this.setState({lang:e,locale:ji[`${e}`]})}onKeyDown(e){}updateState(e,t=[],n=0,s={left:0,top:0}){this.setState({searchActive:e,formula:t,selectIndex:n,position:s})}getState(){return this.state}render(e,t){const{selectIndex:n,formula:s,searchActive:o,position:i}=t;return _("ul",{className:Bn.searchFunction,onKeyDown:this.onKeyDown.bind(this),style:{display:o?"block":"none",position:"absolute",left:`${i.left}px`,top:`${i.top}px`}},s.map((a,l)=>_("li",{className:n===l?Bn.searchFunctionActive:""},_("div",{className:Bn.formulaName},a.n),_("div",{className:Bn.formulaDetail},a.a))))}}const jy=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];class Ky{constructor(e){this.functionHTMLIndex=0,this.functionRangeIndex=[],this.operator="===|!==|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",this.operatorjson=this.covertOperatorjson(),this.rangestart=!1,this.rangedrag_column_start=!1,this.rangedrag_row_start=!1,this.functionlistPosition={},this.editor=e}covertOperatorjson(){let e=this.operator.split("|"),t={};for(let n=0;n<e.length;n++)t[e[n].toString()]=1;return t}getFormula(){return this.formula||[]}getInputValue(){return this.editor.innerHTML}setInputValue(e){this.editor.innerHTML=Qa(e)}getHelpFormula(){return[this.funcName,this.paramindex]}getFunctionlistPosition(){return this.functionlistPosition}functionInputHandler(e,t){let n=this,s=e,o=s.innerHTML,i=s.textContent||"";setTimeout(()=>{var l,u;let a=s.textContent||"";if(a=Qa(a),n.funcName=null,a.length>0&&a.substr(0,1)==="="&&(t!==229||a.length===1)){a=n.functionHTMLGenerate(a),o=n.functionHTMLGenerate(i);let c=window.getSelection();if(c)if((c==null?void 0:c.anchorNode)instanceof HTMLElement&&((l=c.anchorNode)==null?void 0:l.matches("div"))){let d=Rr("span",s).length;n.functionRangeIndex=[d-1,Rr("span",s)[d-1].textContent.length]}else n.functionRangeIndex=[Wm((u=c.anchorNode)==null?void 0:u.parentNode),c.anchorOffset];else{let d=document.selection.createRange();n.functionRangeIndex=d}s.innerHTML=a,n.functionRange(s,a,o),n.canceFunctionrangeSelected(),n.rangestart=!1,n.rangedrag_column_start=!1,n.rangedrag_row_start=!1;const h=n.getrangeseleciton();n.helpFunctionExe(s,h)}else i.substr(0,1)},1)}findrangeindex(e,t){let n=this,s=/<span.*?>/g,o=e.replace(s,""),i=t.replace(s,""),a=o.split("</span>"),l=i.split("</span>");a.pop(),l.pop();let u=n.functionRangeIndex;l.length>a.length?a.length:l.length;let c=l.length,h=a.length;if(c===h){let d=u[0],g=l[d],m=a[d];if(g==null)return l.length<=d?u=[l.length-1,l.length-1]:a.length<=d&&(u=[a.length-1,a.length-1]),u;if(g.length===m.length)return l[d+1]!=null&&a[d+1]!=null&&l[d+1].length<a[d+1].length&&(u[0]+=1,u[1]=1),u;if(g.length>m.length)return g!=null&&a[d+1]!=null&&a[d+1].substr(0,1)==='"'&&(g.indexOf("{")>-1||g.indexOf("}")>-1)&&(u[0]+=1,u[1]=1),u;if(g.length<m.length)return u[1]>m.length&&(u[1]=m.length),u}else if(c>h){let d=u[0],g=l[d],m=a[d];if(m==null)if(a[d-1].indexOf("{")>-1){u[0]-=1;let f=a[d-1].search("{");u[1]+=f}else u[0]=0,u[1]=0;else{if(g.length===m.length)return a[d+1]!=null&&(a[d+1].substr(0,1)==='"'||a[d+1].substr(0,1)==="{"||a[d+1].substr(0,1)==="}")?(u[0]+=1,u[1]=1):g!=null&&g.length>2&&g.substr(0,1)==='"'&&g.substr(g.length-1,1)==='"'||(a[d]!=null&&a[d]==='")'||a[d]!=null&&a[d]==='"}'||a[d]!=null&&a[d]==="{)"?u[1]=1:u[1]=m.length),u;if(g.length>m.length)return a[d+1]!=null&&(a[d+1].substr(0,1)==='"'||a[d+1].substr(0,1)==="{"||a[d+1].substr(0,1)==="}")&&(u[0]+=1,u[1]=1),u;if(g.length<m.length)return u}return u}else if(c<h){let d=u[0],g=l[d],m=a[d];if(g==null)u[0]=a.length-1,m!=null?u[1]=m.length:u[1]=1;else{if(g.length===m.length)return l[d+1]!=null&&(l[d+1].substr(0,1)==='"'||l[d+1].substr(0,1)==="{"||l[d+1].substr(0,1)==="}")?u[1]=m.length:a[d+1]!=null&&a[d+1].substr(0,1)==='"'&&(a[d+1].substr(0,1)==="{"||a[d+1].substr(0,1)==="}")?(u[0]+=1,u[1]=1):m!=null&&m.substr(0,1)==='"'&&m.substr(m.length-1,1)==='"'&&g.substr(0,1)==='"'&&g.substr(g.length-1,1)===")"||m!=null&&m.substr(0,1)==="{"&&m.substr(m.length-1,1)==="}"&&g.substr(0,1)==="{"&&g.substr(g.length-1,1)===")"?u[1]=m.length:(u[0]=u[0]+h-c,a.length>l.length?u[1]=a[d+1].length:u[1]=1),u;if(g.length>m.length)return g!=null&&g.substr(0,1)==='"'?u[1]=m.length:a[d+1]!=null&&/{.*?}/.test(a[d+1])?(u[0]+=1,u[1]=a[d+1].length):g!=null&&a[d+1].substr(0,1)==='"'&&(g.indexOf("{")>-1||g.indexOf("}")>-1)?(u[0]+=1,u[1]=1):(u[0]=u[0]+h-c-1,u[1]=a[d-1].length),u;if(g.length<m.length)return u}return u}return null}setCaretPosition(e,t,n){try{let s=e,o=document.createRange(),i=window.getSelection();o.setStart(s.childNodes[t],n),o.collapse(!0),i==null||i.removeAllRanges(),i==null||i.addRange(o),s.focus()}catch{}}functionRange(e,t,n){let s=this,o=window.getSelection(),i=s.findrangeindex(t,n);if(i==null&&o)o.selectAllChildren(e[0]),o.collapseToEnd();else if(i!=null){let a=Rr("span",e);s.setCaretPosition(Array.isArray(a)?a[i[0]]:a,0,i[1])}}functionHTMLGenerate(e){let t=this;return e.length===0||e.substr(0,1)!=="="?e:(t.functionHTMLIndex=0,`<span dir="auto" class="universheet-formula-text-color">=</span>${t.functionHTML(e)}`)}functionHTML(e){let t=this;if(t.operatorjson==null){let l=t.operator.split("|"),u={};for(let c=0;c<l.length;c++)u[l[c].toString()]=1;t.operatorjson=u}e.substr(0,1)==="="&&(e=e.substr(1));let n=e.split(""),s=0,o="",i="",a={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;s<n.length;){let l=n[s];if(l==="("&&a.squote===0&&a.dquote===0&&a.braces===0)a.bracket+=1,o.length>0?i+=`<span dir="auto" class="universheet-formula-text-func">${o}</span><span dir="auto" class="universheet-formula-text-lpar">(</span>`:i+='<span dir="auto" class="universheet-formula-text-lpar">(</span>',o="";else if(l===")"&&a.squote===0&&a.dquote===0&&a.braces===0)a.bracket-=1,i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-rpar">)</span>`,o="";else if(l==="{"&&a.squote===0&&a.dquote===0)o+="{",a.braces+=1;else if(l==="}"&&a.squote===0&&a.dquote===0)o+="}",a.braces-=1;else if(l==='"'&&a.squote===0)a.dquote>0?(o.length>0?i+=`${o}"</span>`:i+='"</span>',a.dquote-=1,o=""):(a.dquote+=1,o.length>0?i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-string">"`:i+='<span dir="auto" class="universheet-formula-text-string">"',o="");else if(l==="'"&&a.dquote===0)o+="'",a.squote=a.squote===0?1:0;else if(l===","&&a.squote===0&&a.dquote===0&&a.braces===0)i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-comma">,</span>`,o="";else if(l==="&"&&a.squote===0&&a.dquote===0&&a.braces===0)o.length>0?(i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-calc">&</span>`,o=""):i+='<span dir="auto" class="universheet-formula-text-calc">&</span>';else if(l in t.operatorjson&&a.squote===0&&a.dquote===0&&a.braces===0){let u="";s+1<n.length&&(u=n[s+1]);let c=s-1,h=null;if(c>=0)do h=n[c--];while(c>=0&&h===" ");l+u in t.operatorjson?(o.length>0?(i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-calc">${l}${u}</span>`,o=""):i+=`<span dir="auto" class="universheet-formula-text-calc">${l}${u}</span>`,s++):!/[^0-9]/.test(u)&&l==="-"&&(h==="("||h==null||h===","||h===" "||h in t.operatorjson)?o+=l:o.length>0?(i+=`${t.functionHTML(o)}<span dir="auto" class="universheet-formula-text-calc">${l}</span>`,o=""):i+=`<span dir="auto" class="universheet-formula-text-calc">${l}</span>`}else o+=l;if(s===n.length-1){if(t.iscelldata(o.trim()))i+=`<span class="universheet-formula-functionrange-cell" rangeindex="${t.functionHTMLIndex}" dir="auto" style="color:${jy[t.functionHTMLIndex]};">${o}</span>`,t.functionHTMLIndex++;else if(a.dquote>0)i+=`${o}</span>`;else if(o.indexOf("</span>")===-1&&o.length>0){let u=/{.*?}/;if(u.test(o.trim())){let c=u.exec(o)[0],h=o.search(u),d="";h>0&&(d+=`<span dir="auto" class="universheet-formula-text-color">${o.substr(0,h)}</span>`),d+=`<span dir="auto" style="color:#959a05" class="universheet-formula-text-array">${c}</span>`,h+c.length<o.length&&(d+=`<span dir="auto" class="universheet-formula-text-color">${o.substr(h+c.length,o.length)}</span>`),i+=d}else i+=`<span dir="auto" class="universheet-formula-text-color">${o}</span>`}}s++}return i}canceFunctionrangeSelected(){}iscelldata(e){let t=e.split("!"),n;t.length>1?n=t[1]:n=t[0];let s=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(n.indexOf(":")===-1){let l=parseInt(n.replace(/[^0-9]/g,""))-1,u=W.ABCatNum(n.replace(/[^A-Za-z]/g,""));return!Number.isNaN(l)&&!Number.isNaN(u)&&n.toString().match(s)?!0:(!Number.isNaN(l)||!Number.isNaN(u),!1)}o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,n=n.split(":");let i=[],a=[];return i[0]=parseInt(n[0].replace(/[^0-9]/g,""))-1,i[1]=parseInt(n[1].replace(/[^0-9]/g,""))-1,i[0]>i[1]||(a[0]=W.ABCatNum(n[0].replace(/[^A-Za-z]/g,"")),a[1]=W.ABCatNum(n[1].replace(/[^A-Za-z]/g,"")),a[0]>a[1])?!1:!!(n[0].toString().match(o)&&n[1].toString().match(o))}getrangeseleciton(){var o,i,a;let e=window.getSelection(),t=e.anchorNode,n=e.anchorOffset,s=t==null?void 0:t.parentElement.querySelectorAll("span");if(((o=t==null?void 0:t.parentNode)==null?void 0:o.nodeName)==="SPAN"&&n!==0){let l=t.textContent.trim();if(l.length===0&&t.parentNode.previousSibling){let u=t.parentNode.previousSibling;return l=u.textContent.trim(),l.substring(l.length-1,1),u}return l.substring(n-1,1),t.parentNode}if(((i=t==null?void 0:t.parentElement)==null?void 0:i.className)==="universheet-rich-text-editor"){let l=(a=t.textContent)==null?void 0:a.trim();if(l.length===0&&t.parentElement.querySelectorAll("span").length>1){let u=t==null?void 0:t.parentElement.querySelectorAll("span");const c=u[`${u.length-2}`].textContent;return l=c&&c.trim()||"",u[s.length-1]}return t.parentElement.querySelectorAll("span")[s.length-1]}return null}searchFunction(e){let t=this;const n="zh";this.formula=[];let s=ji[`${n}`],o=t.getrangeseleciton();if(t.searchFunctionCell=o,o==null||e==null)return;let i=e.innerText,a=o.textContent.toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||i.substr(0,1)!=="=")return;let u={f:[],s:[],t:[]},c=0;for(let d=0;d<s.length;d++){let g=s[d],m=g.n;if(m===a?(u.f.unshift(g),c++):m.substr(0,a.length)===a?(u.s.unshift(g),c++):m.indexOf(a)>-1&&(u.t.unshift(g),c++),c>=10)break}let h=u.t.concat(u.s.concat(u.f));this.formula=h}helpFunctionExe(e,t){let n=this,o=ji["zh"];if(document.querySelectorAll("#universheet-formula-help-c").length===0)for(let d=0;d<o.length;d++)n.functionlistPosition[o[d].n]=d;if(!t)return;let i=t,a=e.querySelectorAll("span"),l=[].indexOf.call(t.parentNode.querySelectorAll(t.tagName),t),u=l;if(i==null)return;let c=null,h=null;if(a[`${u}`].className==="universheet-rich-text-editor")c=a[`${u}`].textContent;else{let d=null,g=[-1,-1];for(;--u>0;)if(d=a[`${u}`],d.className==="universheet-formula-text-func"||d.textContent.trim().toUpperCase()in n.functionlistPosition){c=d.textContent,h=null;let m=!0;for(let f=u;f<=l;f++)if(h||(h=0),!(f>=g[0]&&f<=g[1])){if(d=a[`${f}`],d.className==="universheet-formula-text-rpar"){g=[u,f],c=null,m=!1;break}d.className==="universheet-formula-text-comma"&&h++}if(m)break}}c!=null&&(this.funcName=c,this.paramindex=h)}searchFunctionEnter(e){let t=this,n=e,s=t.searchFunctionCell;s.innerText=n;const o=document.createElement("span");o.dir="auto",o.className="universheet-formula-text-color",o.innerText="(",Zy(o,s),t.setCaretPosition(o,0,1)}}function Zy(r,e){let t=e.parentNode;t.lastChild===e?t.appendChild(r):t.insertBefore(r,e.nextSibling)}class qy{constructor(e){this._plugin=e,this._context=this._plugin.getContext(),this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET),this._initialize(),this._initRegisterComponent()}_initRegisterComponent(){this._sheetPlugin.registerModal(Xt+p_.name,p_),this._sheetPlugin.registerModal(Xt+g_.name,g_)}_initialize(){var e,t,n;(e=this._sheetPlugin.getObserver("onRichTextDidMountObservable"))==null||e.add(s=>{this.richTextEle=ts(s.container),this.richTextEditEle=Rr("div",this.richTextEle),this.cellInputHandler=new Ky(this.richTextEditEle)}),(t=this._sheetPlugin.getObserver("onRichTextKeyDownObservable"))==null||t.add(s=>{s.ctrlKey,s.altKey,s.shiftKey;let o=s.keyCode;(!(o>=112&&o<=123||o<=46||o===144||o===108||s.ctrlKey||s.altKey||s.shiftKey&&(o===37||o===38||o===39||o===40||o===gr.WIN||o===gr.WIN_R||o===gr.MENU))||o===8||o===32||o===46||s.ctrlKey&&o===86)&&this.cellInputHandler.functionInputHandler(this.richTextEditEle,o)}),(n=this._sheetPlugin.getObserver("onRichTextKeyUpObservable"))==null||n.add(s=>{let o=s.keyCode;if(o===gr.ENTER)this._searchFunction.updateState(!1),this._helpFunction.updateState(!1);else if(!(o>=112&&o<=123||o<=46||o===144||o===108||s.ctrlKey||s.altKey||s.shiftKey&&(o===37||o===38||o===39||o===40||o===gr.WIN||o===gr.WIN_R||o===gr.MENU))||o===8||o===32||o===46||s.ctrlKey&&o===86){this.cellInputHandler.searchFunction(this.richTextEditEle);const a=this.cellInputHandler.getFormula();let l=this.cellInputHandler.getHelpFormula();const u=parseInt(this.richTextEle.style.left),c=parseInt(this.richTextEle.style.top)+parseInt(this.richTextEle.style.minHeight),h={left:u,top:c};a[0]?(this._searchFunction.updateState(!0,a,0,h),this._helpFunction.updateState(!1)):l[0]?(this._helpFunction.updateState(!0,l[1],l[0].toUpperCase(),h),this._searchFunction.updateState(!1)):(this._searchFunction.updateState(!1,a),this._helpFunction.updateState(!1))}const i=this.cellInputHandler.getInputValue();if(i.length>0&&i.substr(0,1)==="="&&(o!==229||i.length===1)&&o===13){s.preventDefault(),s.stopPropagation();const a=this._searchFunction.getState();if(a.searchActive){const l=a.formula[a.selectIndex];this.cellInputHandler.searchFunctionEnter(l.n)}}}),this._plugin.getObserver("onSearchFunctionDidMountObservable").add(s=>{this._searchFunction=s,console.log("get search function",s)}),this._plugin.getObserver("onHelpFunctionDidMountObservable").add(s=>{this._helpFunction=s,console.log("get help function",s)})}}class Ll extends sn{constructor(e){super(Xt),this._config=e}static create(e){return new Ll(e)}installTo(e){e.installPlugin(this);let n=this.getContext().getPluginManager().getPluginByName("formulaEngine");n||(n=new Nh,e.installPlugin(n)),this._formulaController=new Py(this,this._config),this._searchFormulaController=new Yy(this),this._formulaPromptController=new qy(this),this._formulaController.setFormulaEngine(n),Hy(this._formulaController)}initialize(e){this.context=e,this.getContext().getLocale().load({en:By,zh:ky}),this.registerExtension()}onMapping(e){}onMounted(e){Xy(this),this.initialize(e)}onDestroy(){this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._formulaActionExtensionFactory)}registerExtension(){Ns.create().add(new zy(this)),ks.create().add(new Vy(this));const n=this.context.getCommandManager().getActionExtensionManager().getRegister();this._formulaActionExtensionFactory=new Gy(this),n.add(this._formulaActionExtensionFactory)}getFormulaEngine(){return this._formulaController.getFormulaEngine()}getFormulaController(){return this._formulaController}getSearchFormulaController(){return this._searchFormulaController}getFormulaPromptController(){return this._formulaPromptController}}var Jy=Object.freeze(Object.defineProperty({__proto__:null,FormulaPlugin:Ll,Cache:AS,DEFAULT_FORMULA_DATA:RS,DEFAULT_FORMULA_DATA_DOWN:IS,DEFAULT_FORMULA_DATA_DEMO:xS,DEFAULT_FORMULA_DATA_DEMO1:DS,SelectCategoryType:kp,FunList:Bp,FORMULA_PLUGIN_NAME:Xt,CONFIG:Lp,RecalculationModeType:Ah},Symbol.toStringTag,{value:"Module"})),Pl=(r=>(r.SET_NUMFMT_RANGE_DATA_ACTION="SetNumfmtRangeDataAction",r))(Pl||{});const Qy=[{locale:"defaultFmt.Automatic.text",selected:!0},{locale:"defaultFmt.PlainText.text",border:!0},{locale:"defaultFmt.Number.text",suffixLocale:"defaultFmt.Number.example"},{locale:"defaultFmt.Percent.text",suffixLocale:"defaultFmt.Percent.example"},{locale:"defaultFmt.Scientific.text",suffixLocale:"defaultFmt.Scientific.example",border:!0},{locale:"defaultFmt.Accounting.text",suffixLocale:"defaultFmt.Accounting.example"},{locale:"defaultFmt.Thousand.text",suffixLocale:"defaultFmt.Thousand.example"},{locale:"defaultFmt.Currency.text",suffixLocale:"defaultFmt.Currency.example"},{locale:"defaultFmt.Digit.text",suffixLocale:"defaultFmt.Digit.example",border:!0},{locale:"defaultFmt.Date.text",suffixLocale:"defaultFmt.Date.example"},{locale:"defaultFmt.Time.text",suffixLocale:"defaultFmt.Time.example"},{locale:"defaultFmt.Time24H.text",suffixLocale:"defaultFmt.Time24H.example"},{locale:"defaultFmt.DateTime.text",suffixLocale:"defaultFmt.DateTime.example"},{locale:"defaultFmt.DateTime24H.text",suffixLocale:"defaultFmt.DateTime.example"}],e7=[{locale:"currencyDetail.RMB",suffix:"\xA5"},{locale:"currencyDetail.USdollar",suffix:"$"},{locale:"currencyDetail.EUR",suffix:"\u20AC"},{locale:"currencyDetail.GBP",suffix:"\uFFE1"},{locale:"currencyDetail.HK",suffix:"$"},{locale:"currencyDetail.JPY",suffix:"\uFFE5"},{locale:"currencyDetail.AlbanianLek",suffix:"Lek"},{locale:"currencyDetail.AlgerianDinar",suffix:"din"},{locale:"currencyDetail.Afghani",suffix:"Af"},{locale:"currencyDetail.ArgentinePeso",suffix:"$"},{locale:"currencyDetail.UnitedArabEmiratesDirham",suffix:"dh"},{locale:"currencyDetail.ArubanFlorin",suffix:"Afl"},{locale:"currencyDetail.OmaniRial",suffix:"Rial"},{locale:"currencyDetail.Azerbaijanimanat",suffix:"?"},{locale:"currencyDetail.EgyptianPound",suffix:"\uFFE1"},{locale:"currencyDetail.EthiopianBirr",suffix:"Birr"},{locale:"currencyDetail.AngolaKwanza",suffix:"Birr"}],t7=[{label:"1930-08-05",suffix:"yyyy-MM-dd"},{label:"1930/08/05",suffix:"yyyy/MM/dd"},{label:"1930\u5E7408\u670805\u65E5",suffix:'yyyy"\u5E74"MM"\u6708"dd"\u65E5"'},{label:"08-05",suffix:"MM-dd"},{label:"8\u67085\u65E5",suffix:'M"\u6708"d"\u65E5"'},{label:"13:30:30",suffix:"h:mm:ss"},{label:"13:30",suffix:"h:mm"},{label:"\u4E0B\u534801:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 hh:mm"},{label:"\u4E0B\u53481:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 h:mm"},{label:"\u4E0B\u53481:30:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 h:mm:ss"},{label:"08-05 \u4E0B\u5348 01:30",suffix:"MM-dd \u4E0A\u5348/\u4E0B\u5348 hh:mm"}],n7=[{label:"1235",suffix:"0"},{label:"1234.56",suffix:"0.00"},{label:"12345",suffix:"#,##0"},{label:"1,234.56",suffix:"#,##0.00"},{label:"1,235",suffix:"#,##0_);(#,##0)"},{label:"1,235",suffix:"#,##0_);[Red](#,##0)"},{label:"1,234.56",suffix:"#,##0.00_);(#,##0.00)"},{label:"1,234.56",suffix:"#,##0.00_);[Red](#,##0.00)"},{label:"$1,235",suffix:"$#,##0_);($#,##0)"},{label:"$1,235",suffix:"$#,##0_);[Red]($#,##0)"}],kr="NUMFMT_PLUGIN_NAME",r7={show:!0};function __(r,e,t){const i=r.getContext().getPluginManager().getPluginByName(kr).getNumfmtBySheetIdConfig(e),a=new _e(i),l=new _e;return new _e(t).forValue((u,c,h)=>{const d=a.getValue(u,c);a.setValue(u,c,h),l.setValue(u,c,d)}),l.toJSON()}class s7 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,numfmtMatrix:this.do()}}do(){return this.redo()}redo(){return __(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.numfmtMatrix)}undo(){__(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.numfmtMatrix)}validate(){return!1}}He.register(Pl.SET_NUMFMT_RANGE_DATA_ACTION,s7);function o7(r){r.pushToObserve("onNumfmtModalDidMountObservable")}const Hl={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"},i7=1e-10;function b_(r,e,t){const n=r<0?-1:1,s=10**(e||2),o=10**(t||2);let i=Math.abs(r),a=0,l=0,u=0,c=1,h,d;if(r=i,r%1===0)d=[r*n,1];else if(r<1e-19)d=[n,1e19];else if(r>1e19)d=[1e19*n,1];else{do if(i=1/(i-Math.floor(i)),h=c,c=c*Math.floor(i)+a,a=h,l=u,u=Math.floor(r*c+.5),u>=s||c>=o)return[n*l,a];while(Math.abs(r-u/c)>=i7&&i!==Math.floor(i));d=[n*u,c]}return d}const v_=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,C_={positive:"+",decimal:".",negative:"-",percent:"%",isDefault:!1,nan:"NaN",exponent:"E",group:" ",infinity:"\u221E",colors:["black","blue","cyan","green","magenta","red","white","yellow"],ampm:["AM","PM"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhu\u02BBl-Q.","Dhu\u02BBl-H."],mmmm6:["Muharram","Safar","Rabi\u02BB I","Rabi\u02BB II","Jumada I","Jumada II","Rajab","Sha\u02BBban","Ramadan","Shawwal","Dhu\u02BBl-Qi\u02BBdah","Dhu\u02BBl-Hijjah"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Po=C_;function Ph(r){return{...C_,...r}}function Hh(r){if(typeof r=="number")return Hl[r&65535]||null;const e=parseInt(r,16);return isFinite(e)&&Hl[e&65535]?Hl[e&65535]||null:v_.test(r)?r:null}function Ul(r){const e=v_.exec(r);if(!e)throw new SyntaxError(`Malformed locale: ${r}`);return{lang:e[1]+(e[2]?`_${e[2]}`:""),language:e[1],territory:e[2]||"",codeset:e[3]||"",modifier:e[4]||""}}function E_(r){const e=Hh(r);let t=null;if(e){const n=Ul(e);t=Po[n.lang]||Po[n.language]||null}return t}function ft(r,e){const t=typeof e=="object"?e:Ul(e);return Po[t.lang]=Ph(r),t.language!==t.lang&&!Po[t.language]&&(Po[t.language]=Ph(r)),Po[t.lang]}const Uh=Ph({group:","});Uh.isDefault=!0,ft({group:",",ampm:["\u4E0A\u5348","\u4E0B\u5348"],mmmm:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],ddd:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"]},"zh_CN"),ft({group:",",nan:"\u975E\u6578\u503C",ampm:["\u4E0A\u5348","\u4E0B\u5348"],mmmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],ddd:["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"]},"zh_TW"),ft({group:",",ampm:["\u5348\u524D","\u5348\u5F8C"],mmmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],ddd:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"]},"ja"),ft({group:",",ampm:["\uC624\uC804","\uC624\uD6C4"],mmmm:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],mmm:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],dddd:["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],ddd:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"]},"ko"),ft({group:",",ampm:["\u0E01\u0E48\u0E2D\u0E19\u0E40\u0E17\u0E35\u0E48\u0E22\u0E07","\u0E2B\u0E25\u0E31\u0E07\u0E40\u0E17\u0E35\u0E48\u0E22\u0E07"],mmmm:["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],mmm:["\u0E21.\u0E04.","\u0E01.\u0E1E.","\u0E21\u0E35.\u0E04.","\u0E40\u0E21.\u0E22.","\u0E1E.\u0E04.","\u0E21\u0E34.\u0E22.","\u0E01.\u0E04.","\u0E2A.\u0E04.","\u0E01.\u0E22.","\u0E15.\u0E04.","\u0E1E.\u0E22.","\u0E18.\u0E04."],dddd:["\u0E27\u0E31\u0E19\u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C","\u0E27\u0E31\u0E19\u0E08\u0E31\u0E19\u0E17\u0E23\u0E4C","\u0E27\u0E31\u0E19\u0E2D\u0E31\u0E07\u0E04\u0E32\u0E23","\u0E27\u0E31\u0E19\u0E1E\u0E38\u0E18","\u0E27\u0E31\u0E19\u0E1E\u0E24\u0E2B\u0E31\u0E2A\u0E1A\u0E14\u0E35","\u0E27\u0E31\u0E19\u0E28\u0E38\u0E01\u0E23\u0E4C","\u0E27\u0E31\u0E19\u0E40\u0E2A\u0E32\u0E23\u0E4C"],ddd:["\u0E2D\u0E32.","\u0E08.","\u0E2D.","\u0E1E.","\u0E1E\u0E24.","\u0E28.","\u0E2A."]},"th"),ft({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","\xFAnora","b\u0159ezna","dubna","kv\u011Btna","\u010Dervna","\u010Dervence","srpna","z\xE1\u0159\xED","\u0159\xEDjna","listopadu","prosince"],mmm:["led","\xFAno","b\u0159e","dub","kv\u011B","\u010Dvn","\u010Dvc","srp","z\xE1\u0159","\u0159\xEDj","lis","pro"],dddd:["ned\u011Ble","pond\u011Bl\xED","\xFAter\xFD","st\u0159eda","\u010Dtvrtek","p\xE1tek","sobota"],ddd:["ne","po","\xFAt","st","\u010Dt","p\xE1","so"]},"cs"),ft({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],ddd:["s\xF8n.","man.","tir.","ons.","tor.","fre.","l\xF8r."]},"da"),ft({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),ft({group:","},"en"),ft({decimal:",",nan:"ep\xE4luku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kes\xE4kuuta","hein\xE4kuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kes\xE4k.","hein\xE4k.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),ft({group:"\u202F",decimal:",",mmmm:["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],mmm:["janv.","f\xE9vr.","mars","avr.","mai","juin","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),ft({group:".",decimal:",",mmmm:["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","M\xE4rz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),ft({group:".",decimal:",",ampm:["\u03C0.\u03BC.","\u03BC.\u03BC."],mmmm:["\u0399\u03B1\u03BD\u03BF\u03C5\u03B1\u03C1\u03AF\u03BF\u03C5","\u03A6\u03B5\u03B2\u03C1\u03BF\u03C5\u03B1\u03C1\u03AF\u03BF\u03C5","\u039C\u03B1\u03C1\u03C4\u03AF\u03BF\u03C5","\u0391\u03C0\u03C1\u03B9\u03BB\u03AF\u03BF\u03C5","\u039C\u03B1\u0390\u03BF\u03C5","\u0399\u03BF\u03C5\u03BD\u03AF\u03BF\u03C5","\u0399\u03BF\u03C5\u03BB\u03AF\u03BF\u03C5","\u0391\u03C5\u03B3\u03BF\u03CD\u03C3\u03C4\u03BF\u03C5","\u03A3\u03B5\u03C0\u03C4\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5","\u039F\u03BA\u03C4\u03C9\u03B2\u03C1\u03AF\u03BF\u03C5","\u039D\u03BF\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5","\u0394\u03B5\u03BA\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5"],mmm:["\u0399\u03B1\u03BD","\u03A6\u03B5\u03B2","\u039C\u03B1\u03C1","\u0391\u03C0\u03C1","\u039C\u03B1\u0390","\u0399\u03BF\u03C5\u03BD","\u0399\u03BF\u03C5\u03BB","\u0391\u03C5\u03B3","\u03A3\u03B5\u03C0","\u039F\u03BA\u03C4","\u039D\u03BF\u03B5","\u0394\u03B5\u03BA"],dddd:["\u039A\u03C5\u03C1\u03B9\u03B1\u03BA\u03AE","\u0394\u03B5\u03C5\u03C4\u03AD\u03C1\u03B1","\u03A4\u03C1\u03AF\u03C4\u03B7","\u03A4\u03B5\u03C4\u03AC\u03C1\u03C4\u03B7","\u03A0\u03AD\u03BC\u03C0\u03C4\u03B7","\u03A0\u03B1\u03C1\u03B1\u03C3\u03BA\u03B5\u03C5\u03AE","\u03A3\u03AC\u03B2\u03B2\u03B1\u03C4\u03BF"],ddd:["\u039A\u03C5\u03C1","\u0394\u03B5\u03C5","\u03A4\u03C1\u03AF","\u03A4\u03B5\u03C4","\u03A0\u03AD\u03BC","\u03A0\u03B1\u03C1","\u03A3\u03AC\u03B2"]},"el"),ft({decimal:",",ampm:["de.","du."],mmmm:["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],mmm:["jan.","febr.","m\xE1rc.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."],dddd:["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),ft({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["jan\xFAar","febr\xFAar","mars","apr\xEDl","ma\xED","j\xFAn\xED","j\xFAl\xED","\xE1g\xFAst","september","okt\xF3ber","n\xF3vember","desember"],mmm:["jan.","feb.","mar.","apr.","ma\xED","j\xFAn.","j\xFAl.","\xE1g\xFA.","sep.","okt.","n\xF3v.","des."],dddd:["sunnudagur","m\xE1nudagur","\xFEri\xF0judagur","mi\xF0vikudagur","fimmtudagur","f\xF6studagur","laugardagur"],ddd:["sun.","m\xE1n.","\xFEri.","mi\xF0.","fim.","f\xF6s.","lau."]},"is"),ft({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),ft({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","luned\xEC","marted\xEC","mercoled\xEC","gioved\xEC","venerd\xEC","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),ft({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],ddd:["s\xF8n.","man.","tir.","ons.","tor.","fre.","l\xF8r."]},"nb"),ft({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrze\u015Bnia","pa\u017Adziernika","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa\u017A","lis","gru"],dddd:["niedziela","poniedzia\u0142ek","wtorek","\u015Broda","czwartek","pi\u0105tek","sobota"],ddd:["niedz.","pon.","wt.","\u015Br.","czw.","pt.","sob."]},"pl"),ft({group:".",decimal:",",mmmm:["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."]},"pt"),ft({decimal:",",nan:"\u043D\u0435\xA0\u0447\u0438\u0441\u043B\u043E",mmmm:["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],mmm:["\u044F\u043D\u0432.","\u0444\u0435\u0432\u0440.","\u043C\u0430\u0440.","\u0430\u043F\u0440.","\u043C\u0430\u044F","\u0438\u044E\u043D.","\u0438\u044E\u043B.","\u0430\u0432\u0433.","\u0441\u0435\u043D\u0442.","\u043E\u043A\u0442.","\u043D\u043E\u044F\u0431.","\u0434\u0435\u043A."],dddd:["\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043F\u044F\u0442\u043D\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043E\u0442\u0430"],ddd:["\u0432\u0441","\u043F\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043F\u0442","\u0441\u0431"]},"ru"),ft({decimal:",",mmmm:["janu\xE1ra","febru\xE1ra","marca","apr\xEDla","m\xE1ja","j\xFAna","j\xFAla","augusta","septembra","okt\xF3bra","novembra","decembra"],mmm:["jan","feb","mar","apr","m\xE1j","j\xFAn","j\xFAl","aug","sep","okt","nov","dec"],dddd:["nede\u013Ea","pondelok","utorok","streda","\u0161tvrtok","piatok","sobota"],ddd:["ne","po","ut","st","\u0161t","pi","so"]},"sk"),ft({group:".",decimal:",",ampm:["a.\xA0m.","p.\xA0m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],ddd:["dom.","lun.","mar.","mi\xE9.","jue.","vie.","s\xE1b."]},"es"),ft({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["s\xF6ndag","m\xE5ndag","tisdag","onsdag","torsdag","fredag","l\xF6rdag"],ddd:["s\xF6n","m\xE5n","tis","ons","tors","fre","l\xF6r"]},"sv"),ft({group:".",decimal:",",ampm:["\xD6\xD6","\xD6S"],mmmm:["Ocak","\u015Eubat","Mart","Nisan","May\u0131s","Haziran","Temmuz","A\u011Fustos","Eyl\xFCl","Ekim","Kas\u0131m","Aral\u0131k"],mmm:["Oca","\u015Eub","Mar","Nis","May","Haz","Tem","A\u011Fu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","\xC7ar","Per","Cum","Cmt"]},"tr");function jn(r,e=0){if(typeof r!="number")return r;if(r<0)return-jn(-r,e);if(e){const t=10**(e||0)||1;return jn(r*t,0)/t}return Math.round(r)}function a7(r){if(r===0)return r;const e=Math.ceil(Math.log10(r<0?-r:r)),t=10**(16-Math.floor(e));return Math.round(r*t)/t}const l7={total:1,sign:0,period:0,int:1,frac:0};function u7(r,e=!0){const t=Math.abs(r);if(!t)return l7;const n=e&&r<0?1:0,s=Math.floor(t),o=Math.floor(Math.log10(t)+1);let i=0,a=0;if(s!==t){i=1;const l=String(jn(o<0?t*10**-o:t/10**o,15));let u=l.length,c=!0,h=0;for(;h<=l.length;){if(l[h]==="."){u--;break}else l[h]==="0"&&c?u--:c=!1;h++}a=u-o,a<0&&(a=0,i=0)}return{total:n+Math.max(o,1)+i+a,digits:Math.max(o,0)+a,sign:n,period:i,int:Math.max(o,1),frac:a}}const Ki=(r,e)=>r.replace(/\./,e.decimal);function w_(r,e,t,n){const s=t|0,o=t<0&&(!e.condition||e.condition[0]==="<>"||e.condition[0]===">="||e.condition[0]===">");if(typeof t=="string")r.push(t);else if(t===s)o&&r.push(n.negative),r.push(Math.abs(s));else{o&&r.push(n.negative);let i=0;const a=Math.abs(t);a&&(i=Math.floor(Math.log10(a)));let l=i<0?a*10**-i:a/10**i;l===10&&(l=1,i++);const u=u7(a),c=()=>{const h=Math.abs(i);let d;l===1?d=l:d=jn(l,5),r.push(Ki(`${d}`,n),n.exponent,i<0?n.negative:n.positive,h<10?"0":"",h)};if(i>=-4&&i<=-1){const h=a.toPrecision(10+i).replace(/0+$/,"");r.push(Ki(h,n))}else if(i===10){const h=a.toFixed(10).slice(0,12).replace(/\.$/,"");r.push(Ki(h,n))}else if(Math.abs(i)<=9)if(u.total<=11){const d=jn(a,9).toFixed(u.frac);r.push(Ki(d,n))}else i===9?r.push(Math.floor(a)):i>=0&&i<9?r.push(jn(a,9-i)):c();else u.total>=12?c():Math.floor(a)===a?r.push(Math.floor(a)):r.push(Ki(jn(a,9).toFixed(u.frac),n))}return r}const zl=2,Wl=2**2,zh=2**3,Ho=2**4,Uo=2**5,zo=2**6,Wh=2**7,Vh=2**8,$h=2**9,c7=0,h7=2958466,d7=-694324,g7=35830291,f7=-1,T_=1,Wo=6,Kn={"#":"",0:"0","?":"\xA0"},m7={"@":"text","-":"minus","+":"plus"},p7=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],An=Math.floor;function S_(r,e=!0){if(e&&r>=0){if(r===0)return[1900,1,0];if(r===60)return[1900,2,29];if(r<60)return[1900,r<32?1:2,(r-1)%31+1]}let t=r+68569+2415019;const n=An(4*t/146097);t-=An((146097*n+3)/4);const s=An(4e3*(t+1)/1461001);t=t-An(1461*s/4)+31;const o=An(80*t/2447),i=t-An(2447*o/80);t=An(o/11);const a=o+2-12*t;return[100*(n-49)+s+t|0,a|0,i|0]}function _7(r){return S_(r+1462)}function b7(r){if(r===60)throw new Error("#VALUE!");if(r<=1)return[1317,8,29];if(r<60)return[1317,r<32?9:10,1+(r-2)%30];const e=10631/30,t=8.01/60;let n=r+466935;const s=An(n/10631);n-=10631*s;const o=An((n-t)/e);n-=An(o*e+t);const i=An((n+28.5001)/29.5);return i===13?[30*s+o,12,30]:[30*s+o,i,n-An(29.5001*i-29)]}function y_(r,e=0,t=!0){const n=An(r);return e===Wo?b7(n):e===f7?_7(n):S_(n,t)}const A_={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},Vl=86400,v7=(r,e)=>e?r<d7||r>=g7:r<c7||r>=h7;function R_(r,e,t,n){let s="",o="",i="",a="",l="",u=0,c=r|0,h=0,d=0,g=1,m=0,f=0,p=0,b=0,v=0,w=0;const S=n||Uh;if(!e.text&&isFinite(e.scale)&&e.scale!==1&&(r=a7(r*e.scale)),e.exponential){let y=Math.abs(r);y&&(u=Math.round(Math.log10(y))),e.int_max>1&&(u=Math.floor(u/e.int_max)*e.int_max),y=u<0?y*10**-u:y/10**u,r=r<0?-y:y,s+=Math.abs(u)}if(e.integer){const y=Math.abs(jn(r,e.fractions?1:e.frac_max));l+=y<1?"":Math.floor(y)}if(e.grouping){let y="",O=l.length;for(O>e.group_pri&&(O-=e.group_pri,y=S.group+l.slice(O,O+e.group_pri)+y);O>e.group_sec;)O-=e.group_sec,y=S.group+l.slice(O,O+e.group_sec)+y;l=O?l.slice(0,O)+y:y}e.dec_fractions&&(a=String(jn(r,e.frac_max)).split(".")[1]||"");let T=!1;if(e.fractions){const y=Math.abs(e.integer?r%1:r);if(y)if(T=!0,isFinite(e.denominator))i+=e.denominator,o+=jn(y*e.denominator),o==="0"&&(o="",i="",T=!1,l||(l="0"));else{const O=e.integer?e.num_max:1/0,M=b_(y,O,e.den_max);o+=M[0],i+=M[1],e.integer&&o==="0"&&(l||(l="0"),o="",i="",T=!1)}}if(e.date_eval&&v7(r,t.dateSpanLarge)){if(t.dateErrorThrows)throw new Error("Date out of bounds");return t.dateErrorNumber?w_([],{},r,S).join(""):t.overflow}if(e.date){c=r|0;const y=Vl*(r-c);if(h=Math.floor(y),w=y-h,Math.abs(w)<1e-6?w=0:w>.9999&&(w=0,h+=1,h===Vl&&(h=0,c+=1)),c||e.date_system){const O=y_(r,e.date_system,t.leap1900);d=O[0],g=O[1],m=O[2]}if(h||w){const O=e.date&$h||e.date&Vh||e.date&Wh||e.date&zo||e.date&Uo||e.date&Ho;(O===$h&&w>.9995||O===Vh&&w>.995||O===Wh&&w>.95||O===zo&&w>=.5||O===Uo&&w>=.5||O===Ho&&w>=.5)&&(h++,w=0);const M=h<0?Vl+h:h;v=Math.floor(M)%60,b=Math.floor(M/60)%60,p=Math.floor(M/60/60)%60}f=(6+c)%7}if(e.int_padding&&(l=e.int_padding.length===1?l||e.int_padding:e.int_padding.substring(0,e.int_padding.length-l.length)+l),e.num_padding&&(o=e.num_padding.length===1?o||e.num_padding:e.num_padding.substring(0,e.num_padding.length-o.length)+o),e.den_padding&&(i=e.den_padding.length===1?i||e.den_padding:i+e.den_padding.slice(i.length)),e.man_padding){const y=e.exp_plus?"+":"";s=e.man_padding.length===1?(u<0?"-":y)+(s||e.man_padding):(u<0?"-":y)+e.man_padding.slice(0,e.man_padding.length-s.length)+s}const D=[];let R=0;const I={int:0,frac:0,man:0,num:0,den:0};for(let y=0,O=e.tokens.length;y<O;y++){const M=e.tokens[y],F=M.num?M.num.length:0;if(M.type==="string")M.rule?M.rule==="num"?T?D.push(M.value):(e.num_min>0||e.den_min>0)&&D.push(M.value.replace(/./g,Kn["?"])):M.rule==="num+int"?T&&l?D.push(M.value):e.den_min>0&&(l||e.num_min)&&D.push(M.value.replace(/./g,Kn["?"])):M.rule==="den"&&(T?D.push(M.value):(e.den_min>0||e.den_min>0)&&D.push(M.value.replace(/./g,Kn["?"]))):D.push(M.value);else if(M.type==="error")D.push(t.invalid);else if(M.type==="point")D.push(e.date?M.value:S.decimal);else if(M.type==="general")w_(D,e,r,S);else if(M.type==="exp")D.push(S.exponent);else if(M.type==="minus")M.volatile&&e.date||(M.volatile&&!e.fractions&&(e.integer||e.dec_fractions)?(l&&l!=="0"||a)&&D.push(S.negative):D.push(S.negative));else if(M.type==="plus")D.push(S.positive);else if(M.type==="text")D.push(r);else if(M.type==="div")T?D.push("/"):e.num_min>0||e.den_min>0?D.push(Kn["?"]):D.push(Kn["#"]);else if(M.type==="int")if(e.int_pattern.length===1)D.push(l);else{const x=R?e.int_pattern.join("").length-I.int:1/0,E=R===e.int_pattern.length-1?0:e.int_pattern.join("").length-(I.int+M.num.length);D.push(l.substring(l.length-x,l.length-E)),R++,I.int+=M.num.length}else if(M.type==="frac"){const x=I.frac;for(let E=0;E<F;E++)D.push(a[E+x]||Kn[M.num[E]]);I.frac+=F}else if(M.type in A_)e[`${M.type}_pattern`].length===1?(M.type==="int"&&D.push(l),M.type==="frac"&&D.push(a),M.type==="man"&&D.push(s),M.type==="num"&&D.push(o),M.type==="den"&&D.push(i)):(D.push(A_[M.type].slice(I[M.type],I[M.type]+F)),I[M.type]+=F);else if(M.type==="year")d<0&&D.push(S.negative),D.push(String(Math.abs(d)).padStart(4,"0"));else if(M.type==="year-short"){const x=d%100;D.push(x<10?"0":"",x)}else if(M.type==="month")D.push(M.pad&&g<10?"0":"",g);else if(M.type==="monthname-single")e.date_system===Wo?D.push(S.mmmm6[g-1].charAt(0)):D.push(S.mmmm[g-1].charAt(0));else if(M.type==="monthname-short")e.date_system===Wo?D.push(S.mmm6[g-1]):D.push(S.mmm[g-1]);else if(M.type==="monthname")e.date_system===Wo?D.push(S.mmmm6[g-1]):D.push(S.mmmm[g-1]);else if(M.type==="weekday-short")D.push(S.ddd[f]);else if(M.type==="weekday")D.push(S.dddd[f]);else if(M.type==="day")D.push(M.pad&&m<10?"0":"",m);else if(M.type==="hour"){const x=p%e.clock||(e.clock<24?e.clock:0);D.push(M.pad&&x<10?"0":"",x)}else if(M.type==="min")D.push(M.pad&&b<10?"0":"",b);else if(M.type==="sec")D.push(M.pad&&v<10?"0":"",v);else if(M.type==="subsec"){D.push(S.decimal);const x=w.toFixed(e.sec_decimals);D.push(x.slice(2,2+M.decimals))}else if(M.type==="am"){const x=p<12?0:1;M.short&&!n?D.push("AP"[x]):D.push(S.ampm[x])}else if(M.type==="hour-elap"){r<0&&D.push(S.negative);const x=c*24+Math.floor(Math.abs(h)/(60*60));D.push(String(Math.abs(x)).padStart(M.pad,"0"))}else if(M.type==="min-elap"){r<0&&D.push(S.negative);const x=c*1440+Math.floor(Math.abs(h)/60);D.push(String(Math.abs(x)).padStart(M.pad,"0"))}else if(M.type==="sec-elap"){r<0&&D.push(S.negative);const x=c*Vl+Math.abs(h);D.push(String(Math.abs(x)).padStart(M.pad,"0"))}else if(M.type==="b-year")D.push(d+543);else if(M.type==="b-year-short"){const x=(d+543)%100;D.push(x<10?"0":"",x)}}return t.nbsp?D.join(""):D.join("").replace(/\u00a0/g," ")}const Gh={};function Zi(r,e,t){return e[`${t}_max`]=r.length,e[`${t}_min`]=r.replace(/#/g,"").length,e}function $l(r){if(!(r in Gh)){const e=[],t=r.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,n=>"?".repeat(n.length));for(let n=0;n<t.length;n++){const s=t.charAt(n);e[n]=s in Kn?Kn[s]:s}Gh[r]=e.join("")}return Gh[r]}function Kt(r,e){typeof r=="string"&&(r=r.replace(/ /g,Kn["?"]),r={type:"string",value:r}),r.type==="string"&&e.length&&e[e.length-1].type==="string"?e[e.length-1].value+=r.value:e.push(r)}function Vo(r){const e=[],t={scale:1,percent:!1,text:!1,denominator:0,date:0,generated:!1,exponential:!1,exp_plus:!1,grouping:!1,date_eval:!1,locale:"",condition:null,date_system:null,sec_decimals:0,general:!1,integer:!1,group_sec:0,fractions:!1,group_pri:0,color:"",clock:24,int_padding:"",man_padding:"",num_padding:"",den_padding:"",dec_fractions:!1,pattern:"",int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:e};let n=`${r}`,s="int",o=!1,i=null,a=[],l,u=!1,c;for(;n&&!o;){if(c=/^General/i.exec(n))t.general=!0,Kt({type:"general"},e);else if(s==="int"&&(c=/^[#?0]+(?:,[#?0]+)*/.exec(n))||s==="den"&&(c=/^[#?\d]+/.exec(n))||(c=/^[#?0]+/.exec(n)))t[`${s}_pattern`].push(c[0]),i={type:s,num:c[0]},Kt(i,e);else if((c=/^\//.exec(n))&&t[`${s}_pattern`].length){if(!i)throw new SyntaxError(`Missing a numerator in pattern ${r}`);t.fractions=!0,t.num_pattern.push(t[`${s}_pattern`].pop()),i.type="num",s="den",Kt({type:"div"},e)}else if(c=/^,+/.exec(n)){const f=n.charAt(1)in Kn;l.slice(-1)in Kn&&(c[0].length>1||!f)?t.scale=.001**c[0].length:Kt(c[0],e)}else if(c=/^;/.exec(n)){o=!0;break}else if(c=/^[@+-]/.exec(n))c[0]==="@"&&(t.text=!0),Kt({type:m7[c[0]]},e);else if(c=/^(?:\[(h+|m+|s+)\])/i.exec(n)){const f=c[1].toLowerCase(),p=f[0],b={type:"",size:0,date:1,raw:c[0],pad:f.length};p==="h"?(b.size=Ho,b.type="hour-elap"):p==="m"?(b.size=Uo,b.type="min-elap"):(b.size=zo,b.type="sec-elap"),t.date|=b.size,a.push(b),Kt(b,e)}else if(c=/^(?:B2)/i.exec(n))u||(t.date_system=Wo);else if(c=/^(?:B1)/i.exec(n))u||(t.date_system=T_);else if(c=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(n)){const f={type:"",size:0,date:1,raw:c[0],pad:0,indeterminate:!1,used:!1},p=c[0].toLowerCase(),b=p[0];if(p==="y"||p==="yy")f.size=zl,f.type="year-short";else if(b==="y"||b==="e")f.size=zl,f.type="year";else if(p==="b"||p==="bb")f.size=zl,f.type="b-year-short";else if(b==="b")f.size=zl,f.type="b-year";else if(p==="d"||p==="dd")f.size=zh,f.type="day",f.pad=/dd/.test(p)?1:0;else if(p==="ddd")f.size=zh,f.type="weekday-short";else if(b==="d")f.size=zh,f.type="weekday";else if(b==="h")f.size=Ho,f.type="hour",f.pad=/hh/i.test(p)?1:0;else if(b==="m"){p.length===3?(f.size=Wl,f.type="monthname-short"):p.length===5?(f.size=Wl,f.type="monthname-single"):p.length>=4&&(f.size=Wl,f.type="monthname");const v=a[a.length-1];!f.type&&v&&!v.used&&v.size&(Ho|zo)&&(v.used=!0,f.size=Uo,f.type="min",f.pad=/mm/.test(p)?1:0),f.type||(f.size=Wl,f.type="month",f.pad=/mm/.test(p)?1:0,f.indeterminate=!0)}else if(b==="s"){f.size=zo,f.type="sec",f.pad=/ss/.test(p)?1:0;const v=a[a.length-1];v&&v.size&Uo?f.used=!0:v&&v.indeterminate&&(delete v.indeterminate,v.size=Uo,v.type="min",f.used=!0)}t.date|=f.size,t.date_eval=!0,a.push(f),Kt(f,e)}else if(c=/^(?:AM\/PM|am\/pm|A\/P)/.exec(n))t.clock=12,t.date|=Ho,t.date_eval=!0,Kt({type:"am",short:c[0]==="A/P"},e);else if(t.date&&(c=/^\.0{1,3}/i.exec(n))){const f=c[0].length-1,p=[zo,Wh,Vh,$h][f];t.date|=p,t.date_eval=!0,t.sec_decimals=Math.max(t.sec_decimals,f),Kt({type:"subsec",size:p,decimals:f,date:1,raw:c[0]},e)}else if((c=/^\\(.)/.exec(n))||(c=/^"([^"]*?)"/.exec(n)))Kt(c[1],e);else if(c=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(n))t.condition=[c[1],parseFloat(c[2])];else if(c=/^\[\$([^\]]+)\]/.exec(n)){const f=c[1].split("-"),p=f.length<2?"":f[f.length-1],b=f[0];b&&Kt(b,e);const v=Hh(p);v&&(t.locale=v);const w=parseInt(p,16);isFinite(w)&&w&16711680&&(w>>16&255)===6&&(t.date_system=Wo),u=!0}else if(c=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(n))t.color=c[2]?p7[parseInt(c[2],10)]||"#000":c[1].toLowerCase();else if(!(c=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(n))){if(c=/^%/.exec(n))t.scale=100,t.percent=!0,Kt("%",e);else if(c=/^_(\\.|.)/.exec(n))Kt(" ",e);else if(c=/^\./.exec(n))Kt({type:"point",value:c[0]},e),t.dec_fractions=!0,s="frac";else if(c=/^[Ee]([+-]?|(?=[0#?]))/.exec(n))t.exponential=!0,t.exp_plus=c[1]==="+",s="man",Kt({type:"exp",plus:c[1]==="+"},e);else if(!(c=/^\*(\\.|.)/.exec(n))){if(c=/^[BENn[]/.exec(n))throw new SyntaxError(`Unexpected char ${n.charAt(0)} in pattern ${r}`);c=[n[0]],Kt(c[0],e)}}l=c[0],n=n.slice(c?c[0].length:1)}if(t.pattern=r.slice(0,r.length-n.length),/^((?:\[[^\]]+\])+)(;|$)/.test(t.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(t.pattern)&&Kt({type:"text"},e),t.fractions&&t.dec_fractions||t.fractions&&t.exponential)throw new SyntaxError(`Invalid pattern: ${t.pattern}`);const h=t.int_pattern.join("");if(t.grouping=h.indexOf(",")>=0,t.grouping){const f=h.split(","),p=f.length;p===2?(t.group_pri=f[1].length,t.group_sec=t.group_pri):p>2&&(t.group_pri=f[p-1].length,t.group_sec=f[p-2].length)}else t.group_pri=0,t.group_sec=0;Zi(h.replace(/[,]/g,""),t,"int"),Zi(t.frac_pattern.join(""),t,"frac"),Zi(t.man_pattern.join(""),t,"man");let d=t.num_pattern.join(""),g=t.den_pattern.join("");const m=/\?/.test(g)||/\?/.test(d);if(g=g.replace(/\d/g,m?"?":"#"),m&&(g=g.replace(/#$/g,"?")),Zi(d,t,"num"),Zi(g,t,"den"),m&&(d=d.replace(/#$/g,"?")),t.int_padding=$l(t.int_pattern.join("")),t.man_padding=$l(t.man_pattern.join("")),t.num_padding=$l(d),t.den_padding=$l(g),t.den_pattern.length&&(t.denominator=parseInt(t.den_pattern.join("").replace(/\D/g,""),10)),t.integer=!!t.int_pattern.join("").length,t.fractions&&e.forEach((f,p)=>{const b=e[p+1];f.type==="string"&&b&&(b.type==="num"?f.rule="num+int":b.type==="div"?f.rule="num":b.type==="den"&&(f.rule="den"))}),(t.date||t.general)&&(t.int_pattern.length||t.frac_pattern.length||t.scale!==1||t.text))throw new Error("Illegal format");return t.date_system||(t.date_system=T_),t}const I_=Vo("@"),Xh="black";function x_(r,e){for(let t=0;t<3;t++){const n=e[t];if(n){let s;if(n.condition){const o=n.condition[0],i=n.condition[1];o==="="?s=r===i:o===">"?s=r>i:o==="<"?s=r<i:o===">="?s=r>=i:o==="<="?s=r<=i:o==="<>"&&(s=r!==i)}else s=!0;if(s)return n}}}function C7(r,e){if(typeof r!="number"||!isFinite(r))return(e[3]?e[3].color:I_.color)||Xh;const t=x_(r,e);return t&&t.color||Xh}function E7(r,e,t){const n=E_(t.locale),s=e[3]?e[3]:I_;if(typeof r=="boolean"&&(r=r?"TRUE":"FALSE"),r==null)return"";if(typeof r!="number")return R_(r,s,t,n);if(!isFinite(r)){const i=n||Uh;return isNaN(r)?i.nan:(r<0?i.negative:"")+i.infinity}const o=x_(r,e);return o?R_(r,o,t,n):""}function w7(r){return!!(r[0]&&r[0].date||r[1]&&r[1].date||r[2]&&r[2].date||r[3]&&r[3].date)}function T7(r){const[e,t,n,s]=r;return!!((!e||e.generated)&&(!t||t.generated)&&(!n||n.generated)&&s&&s.text&&!s.generated)}function S7(r){return!!(r[0]&&r[0].percent||r[1]&&r[1].percent||r[2]&&r[2].percent||r[3]&&r[3].percent)}const Gl={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},Yh={...Gl};function jh(r={}){if(r===null&&(r=Gl),r){for(const e in r)if(e in Gl){const t=r[e];t==null?Yh[e]=Gl[e]:Yh[e]=t}}return{...Yh}}function D_(r){const e=[];let t=!1,n,s=null,o=r,i=0,a=null,l=0,u=0;do{if(a=Vo(o),a.condition&&(u++,t=!0),a.text){if(s)throw new Error("Unexpected partition");s=a}a.locale&&(n=Hh(a.locale)),e.push(a),i=o.charAt(a.pattern.length)===";"?1:0,o=o.slice(a.pattern.length+i),l++}while(i&&l<4&&u<3);if(u>2)throw new Error("Unexpected condition");if(i)throw new Error("Unexpected partition");if(!t){if(e.length<4&&s)for(let c=0,h=e.length;c<h;c++)e[c]===s&&e.splice(c,1);if(e.length<1&&s&&(e[0]=Vo("General"),e[0].generated=!0),e.length<2){const c=Vo(e[0].pattern);c.tokens.unshift({type:"minus",volatile:!0}),c.generated=!0,e.push(c)}if(e.length<3){const c=Vo(e[0].pattern);c.generated=!0,e.push(c)}if(e.length<4)if(s)e.push(s);else{const c=Vo("@");c.generated=!0,e.push(c)}e[0].condition=[">",0],e[1].condition=["<",0],e[2].condition=null}return{pattern:r,partitions:e,locale:n}}function y7(r){try{return D_(r)}catch(e){const t={tokens:[{type:"error"}]};return{pattern:r,locale:null,partitions:[t,t,t,t],error:e.message}}}const Xl=Math.floor,Kh=86400;function Yl(r,e){let t=null;if(Array.isArray(r)){const[n,s,o,i,a,l]=r;t=Date.UTC(n,s==null?0:s-1,o!=null?o:1,i||0,a||0,l||0)}else r instanceof Date&&(t=r.getTime(),(!e||!e.ignoreTimezone)&&(t-=r.getTimezoneOffset()*60*1e3));if(t!=null&&isFinite(t)){const n=t/864e5;return n-(n<=-25509?-25568:-25569)}return r}function O_(r,e){let t=r|0;const n=Kh*(r-t);let s=Xl(n);n-s>.9999&&(s+=1,s===Kh&&(s=0,t+=1));const o=s<0?Kh+s:s,[i,a,l]=y_(r,0,e&&e.leap1900),u=Xl(o/60/60)%60,c=Xl(o/60)%60,h=Xl(o)%60;if(e&&e.nativeDate){const d=new Date(0);return d.setUTCFullYear(i,a-1,l),d.setUTCHours(u,c,h),d}return[i,a,l,u,c,h]}const A7=["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","M-d","M-j","d-F","d-M","n-d","n-j","j-F","j-M","M-Y","n-Y","m-d","F-d","m-j","F-j","m-Y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],Zn={};function qn(r,e){if(r){const t=r[0];e[t]=e[t]||{},qn(r.slice(1),e[t])}else e.$=!0}A7.forEach(r=>{qn(r,Zn),qn(`${r} x`,Zn),qn(`${r} l`,Zn),qn(`${r} l x`,Zn),qn(`l ${r}`,Zn),qn(`l ${r} x`,Zn),qn(`${r} D`,Zn),qn(`${r} D x`,Zn),qn(`D ${r}`,Zn),qn(`D ${r} x`,Zn)});const R7={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},I7={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},x7={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},D7=new Date().getUTCFullYear();function F_(r){const e=/^([\s+%$(-]*)(((?:(?:\d[\d,]*)(?:\.\d*)?|(?:\.\d+)))([eE][+-]?\d+)?)([\s%$)]*)$/.exec(r);if(e){const[,t,n,s,o,i]=e;let a=1,l="",u=!1,c=!1,h=!1,d=!1,g=!1,m=!1,f=parseFloat(n.replace(/,/g,""));if(!isFinite(f))return null;for(let b=0;b<t.length;b++){const v=t[b];if(v==="-"){if(u||c)return null;u=!0,a=-1}else if(v==="$"){if(g)return null;g=!0}else if(v==="("){if(c||u)return null;c=!0,a=-1}else if(v==="%"){if(d)return null;d=!0}}for(let b=0;b<i.length;b++){const v=i[b];if(v==="$"){if(g)return null;g=!0,m=!0}else if(v===")"){if(h||!c)return null;h=!0}else if(v==="%"){if(d)return null;d=!0}}if(o){if(d||g)return null;l="0.00E+00"}else if(d){if(g)return null;l=s.includes(".")?"0.00%":"0%",f*=.01}else g?m?l=s.includes(".")?"#,##0.00$":"#,##0$":l=s.includes(".")?"$#,##0.00":"$#,##0":s.includes(",")&&(l=s.includes(".")?"#,##0.00":"#,##0");const p={v:f*a,z:""};return l&&(p.z=l),p}}function O7(r,e,t){if(t<1||e<1||e>12)return!1;if(e===2){const s=r%4===0&&r%100!==0||r%400===0||r===1900?29:28;if(t>s)return!1}else if((e===4||e===6||e===9||e===11)&&t>30||(e===1||e===3||e===5||e===7||e===8||e===10||e===12)&&t>31)return!1;return!0}const cr=(r,e,t)=>{const n=t.path||"",s=Object.keys(e);for(let o=0;o<s.length;o++){let i;const a=s[o];if(!!e[a]){if(a==="$")r||(i=t);else if(a==="-"){const l=/^(\s*([./-]|,\s)\s*|\s+)/.exec(r);if(l){const u=l[1]==="-"||l[1]==="/"||l[1]==="."?l[1]:" ";if(!t.sep||t.sep===u){const c=l[0].replace(/\s+/g," ");i=cr(r.slice(l[0].length),e[a],{...t,sep:u,path:n+c})}}}else if(a===" "){const l=/^[,.]?\s+/.exec(r);if(l){const u=l[0].replace(/\s+/g," ");i=cr(r.slice(l[0].length),e[a],{...t,path:n+u})}}else if(a==="j"||a==="d"){const l=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(r);l&&(i=cr(r.slice(l[0].length),e[a],{...t,day:l[0],path:n+a}))}else if(a==="n"||a==="m"){const l=/^(0?[1-9]|1[012])\b/.exec(r);l&&(i=cr(r.slice(l[0].length),e[a],{...t,month:+l[0],_mon:l[0],path:n+a}))}else if(a==="F"||a==="M"){const l=/^([a-z]{3,9})\b/i.exec(r),u=l&&(a==="F"?I7:R7)[l[0].toLowerCase()];u&&(i=cr(r.slice(l[0].length),e[a],{...t,month:u,_mon:l[0],path:n+a}))}else if(a==="l"||a==="D"){const l=/^([a-z]{3,9})\b/i.exec(r);(l&&x7[l[0].toLowerCase()])===a&&(i=cr(r.slice(l[0].length),e[a],{...t,path:n+a}))}else if(a==="y"){const l=/^\d\d\b/.exec(r);if(l){const u=+l[0]>=30?+l[0]+1900:+l[0]+2e3;i=cr(r.slice(l[0].length),e[a],{...t,year:u,path:n+a})}}else if(a==="Y"){const l=/^\d\d\d\d\b/.exec(r);l&&(i=cr(r.slice(l[0].length),e[a],{...t,year:+l[0],path:n+a}))}else if(a==="x"){const l=Zh(r);l&&(i=cr("",e[a],{...t,time:l.v,tf:l.z,path:n+a}))}else throw new Error(`Unknown date token "${a}"`);if(i)return i}}};function M_(r,e){var n;if(!r)return null;const t=cr(r.trim(),Zn,{path:""});if(t){if(t.sep==="."&&t.path.length===3)return null;const s=+((n=t.year)!=null?n:D7);if(t.day||(t.day=1),!O7(s,t.month,t.day))return null;let o=-1/0;if(s<1900)return null;s<=1900&&t.month<=2?o=25568:s<1e4&&(o=25569);const i=Date.UTC(s,t.month-1,t.day)/864e5+o+(t.time||0);if(i>=0&&i<=2958465){const a=t._mon[0]==="0"||t.day[0]==="0"||t._mon.length===2&&t.day.length===2,l=t.path.replace(/[jdlDnmMFyYx-]/g,u=>u==="j"||u==="d"?a?"dd":"d":u==="D"?"ddd":u==="l"?"dddd":u==="n"||u==="m"?a?"mm":"m":u==="M"?"mmm":u==="F"?"mmmm":u==="y"?"yy":u==="x"?t.tf||"":u==="Y"?"yyyy":u);return e&&e.nativeDate?{v:O_(i,e),z:l}:{v:i,z:l}}}return null}function Zh(r){const e=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(r);if(e){const[,t,n,s,o,i]=e;if(o&&!s||!i&&!n&&!s)return null;let a=parseFloat(t)||0;if(i){if(a>=13)return null;(i[0]==="p"||i[0]==="P")&&(a+=12)}const l=parseFloat(n)||0,u=parseFloat(s)||0,c=parseFloat(o)||0;return{v:(a*60*60+l*60+u+c)/86400,z:`${t.length===2?"hh":"h"}:mm${s?":ss":""}${i?" AM/PM":""}`}}return null}function N_(r){return/^\s*true\s*$/i.test(r)?{v:!0}:/^\s*false\s*$/i.test(r)?{v:!1}:null}function F7(r,e){var t,n,s;return(s=(n=(t=F_(r))!=null?t:M_(r,e))!=null?n:Zh(r))!=null?s:N_(r)}const qi={};function M7(r,e={}){const{pattern:t,partitions:n,locale:s}=r,o=a=>{const l={...jh(),...e,...a};return s&&(l.locale=s),l},i=(a,l)=>{if(a){const u=o(l);return E7(Yl(a,u),n,u)}return String()};return i.color=(a,l={})=>{const u=o(l);return C7(Yl(a,u),n)},i.isPercent=()=>S7(n),i.isDate=()=>w7(n),i.isText=()=>T7(n),i.pattern=t,r.error&&(i.error=r.error),i.options=o,i.locale=s||e&&e.locale||"",Object.freeze(i)}function gt(r,e={}){r||(r="General");let t=null;return qi[r]?t=qi[r]:(t={...jh(),...e}.throws?D_(r):y7(r),t.error||(qi[r]=t)),M7(t,e)}gt.isDate=r=>gt(r,{throws:!1}).isDate(),gt.isPercent=r=>gt(r,{throws:!1}).isPercent(),gt.isText=r=>gt(r,{throws:!1}).isText(),gt.dateToSerial=Yl,gt.dateFromSerial=O_,gt.options=jh,gt.dec2frac=b_,gt.round=jn,gt.codeToLocale=Hl,gt.getLocale=E_,gt.parseLocale=Ul,gt.addLocale=(r,e)=>{const t=Ul(e);return delete qi[t.lang],delete qi[t.language],ft(r,t)};function N7(r,e,t,n=!1){const s=t&&typeof t=="object"?t:{locale:t,throws:!n};return gt(r,s)(Yl(e,s),s)}gt.format=N7,gt.is_date=gt.isDate,gt.parseNumber=F_,gt.parseDate=M_,gt.parseTime=Zh,gt.parseBool=N_,gt.parseValue=F7;class k7{constructor(){this._sheetsNumfmtConfig=new Map}getNumfmtBySheetIdConfig(e){let t=this._sheetsNumfmtConfig.get(e);return t||(t={},this._sheetsNumfmtConfig.set(e,t),t)}}var $o={formatContent:"univer-format-content",formatInput:"univer-format-input",formatSelected:"univer-format-selected",customFormat:"univer-custom-format",dropContent:"univer-drop-content",selectItemContent:"univer-select-item-content",customFormatMore:"univer-custom-format-more",selectItemSuffix:"univer-select-item-suffix",selectItem:"univer-select-item"};class B7{constructor(e){this._model=new k7,this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET);const t=s=>{const o=this._sheetPlugin.getSelectionManager(),i=this._plugin.getContext().getWorkBook(),a=i.getActiveSheet(),l=o.getActiveRangeList(),u=a.getCellMatrix();l!=null&&(l.getRangeList().forEach(c=>{let h=new _e;at.foreach(c,(f,p)=>{const b=u.getValue(f,p);if(b){const v=gt(s);h.setValue(f,p,{v:b.v,m:v(b.v)})}});const d={sheetId:a.getSheetId(),actionName:$.SET_RANGE_DATA_ACTION,cellValue:h.getData()},g=pr.make(d).removeExtension().getAction(),m=new ge({WorkBookUnit:i},g);i.getCommandManager().invoke(m)}),l.getRangeList().forEach(c=>{let h=new _e;at.foreach(c,(m,f)=>{h.setValue(m,f,s)});const d={sheetId:a.getSheetId(),actionName:Pl.SET_NUMFMT_RANGE_DATA_ACTION,numfmtMatrix:h.getData()};new ge({WorkBookUnit:i},d).invoke()}))},n=Qy.map((s,o)=>({onClick:()=>{switch(o){case 0:{t("G");break}case 1:{t("@");break}case 2:{t("#.##");break}case 3:{t("#.##%");break}case 4:{t("#.##E+");break}case 5:break;case 6:{t("\xA5#.##");break}case 7:break;case 8:{t("yyyy-mm-dd");break}case 9:{t("h:mm AM/PM");break}case 10:{t("h:mm");break}case 11:{t("yyyy-mm-dd h:mm AM/PM");break}case 12:{t("yyyy-mm-dd h:mm");break}}},...s}));this._numfmtList={name:kr,type:0,tooltipLocale:"toolbar.moreFormats",className:$o.customFormat,show:r7.show,border:!0,children:[...n,{locale:"defaultFmt.CustomFormats.text",customSuffix:{name:"RightIcon"},className:$o.customFormatMore,children:[{locale:"format.moreCurrency",onClick:()=>{this._plugin.getNumfmtModalController().showModal("currency",!0)}},{locale:"format.moreDateTime",onClick:()=>{this._plugin.getNumfmtModalController().showModal("date",!0)}},{locale:"format.moreNumber",onClick:()=>{this._plugin.getNumfmtModalController().showModal("number",!0)}}]}]},this._sheetPlugin.addToolButton(this._numfmtList)}getNumfmtBySheetIdConfig(e){return this._model.getNumfmtBySheetIdConfig(e)}setNumfmtByRange(e,t,n){const s=new _e;at.foreach(t,(u,c)=>{s.setValue(u,c,n)});const o=this._plugin.getContext(),i=o.getCommandManager(),a={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:t,cellValue:s.toJSON()},l=new ge({WorkBookUnit:o.getWorkBook()},a);i.invoke(l)}setNumfmtByCoords(e,t,n,s){const o=new _e;o.setValue(t,n,s);const i={startRow:t,startColumn:n,endRow:t,endColumn:n},a=this._plugin.getContext(),l=a.getCommandManager(),u={actionName:$.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:i,cellValue:o.toJSON()},c=new ge({WorkBookUnit:a.getWorkBook()},u);l.invoke(c)}}class Ji extends Oe{constructor(){super(...arguments),this._ref=Ae()}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender()}getInput(){const{input:e}=this.props,t=this._render.renderFunction("Input");if(e)return _("div",{className:$o.formatInput},_("span",null,e,":"),_(t,{type:"number",value:"2",onChange:this.handleChange.bind(this)}))}handleClick(e,t){const n=this._ref.current.querySelectorAll("li");for(let s=0;s<n.length;s++)n[s].classList.remove($o.formatSelected);n[t].classList.add($o.formatSelected),this.props.onClick(e)}handleChange(e){var n,s;const t=e.target.value;(s=(n=this.props).onChange)==null||s.call(n,t)}render(){const{data:e}=this.props;return _("div",{className:$o.formatContent,ref:this._ref},this.getInput(),_("ul",null,e.map((t,n)=>_("li",{onClick:()=>this.handleClick(t.value,n)},_("span",null,t.label),_("span",null,t.suffix)))))}}class k_ extends Oe{initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={modalData:[]}}componentDidMount(){this._context.getPluginManager().getPluginByName(kr).getObserver("onNumfmtModalDidMountObservable").notifyObservers(this)}setModal(e){const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);e.forEach(n=>{var o;const s=t.getRegisterComponent(n.children.name);if(s){const i=(o=n.children.props)!=null?o:{};n.modal=_(s,{...i})}}),this.setState({modalData:e})}render(){const e=this._render.renderFunction("Modal"),{modalData:t}=this.state;return _(Rt,null,t.map(n=>{if(!!n.show)return _(e,{title:n.title,visible:n.show,group:n.group,onCancel:n.onCancel},n.modal)}))}}class L7{constructor(e){const t=e.getContext().getLocale();this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET),this._modalData=[{name:"currency",locale:"toolbar.currencyFormat",show:!1,group:[{locale:"button.confirm",type:"primary",onClick:()=>{}},{locale:"button.cancel",onClick:()=>{}}],onCancel:()=>{this.showModal("currency",!1)},children:{name:kr+Ji.name,props:{data:this.resetContentData(e7),onClick:n=>console.dir(n),input:t.get("format.decimalPlaces"),onChange:n=>console.dir(n)}}},{name:"date",locale:"toolbar.currencyFormat",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>{this.showModal("currency",!1)},children:{name:kr+Ji.name,props:{data:t7,onClick:n=>console.dir(n)}}},{name:"number",locale:"toolbar.numberFormat",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>{this.showModal("number",!1)},children:{name:kr+Ji.name,props:{data:n7,onClick:n=>console.dir(n)}}}],this._initRegisterComponent(),this._initialize()}_initialize(){this._plugin.getObserver("onNumfmtModalDidMountObservable").add(e=>{this._numfmtModal=e,this.resetModalData()})}_initRegisterComponent(){this._sheetPlugin.registerComponent(kr+Ji.name,Ji),this._sheetPlugin.registerModal(kr+k_.name,k_)}resetContentData(e){const t=this._plugin.getContext().getLocale();for(let n=0;n<e.length;n++)e[n].locale&&(e[n].label=t.get(e[n].locale));return e}resetModalData(){const e=this._plugin.getContext().getLocale();this._modalData.forEach(t=>{t.title=e.get(t.locale),t.group&&t.group.length&&t.group.forEach(n=>{n.label=e.get(n.locale)})}),this._numfmtModal.setModal(this._modalData)}showModal(e,t){const n=this._modalData.findIndex(s=>s.name===e);n>-1&&(this._modalData[n].show=t,this.resetModalData())}}var P7={currencyDetail:{RMB:"\u4EBA\u6C11\u5E01",USdollar:"\u7F8E\u5143",EUR:"\u6B27\u5143",GBP:"\u82F1\u9551",HK:"\u6E2F\u5143",JPY:"\u65E5\u5143",AlbanianLek:"\u963F\u5C14\u5DF4\u5C3C\u4E9A\u5217\u514B",AlgerianDinar:"\u963F\u5C14\u53CA\u5229\u4E9A\u7B2C\u7EB3\u5C14",Afghani:"\u963F\u5BCC\u6C57\u5C3C",ArgentinePeso:"\u963F\u6839\u5EF7\u6BD4\u7D22",UnitedArabEmiratesDirham:"\u963F\u62C9\u4F2F\u8054\u5408\u914B\u957F\u56FD\u8FEA\u62C9\u59C6",ArubanFlorin:"\u963F\u9C81\u5DF4\u5F17\u7F57\u6797",OmaniRial:"\u963F\u66FC\u91CC\u4E9A\u5C14",Azerbaijanimanat:"\u963F\u585E\u62DC\u7586\u9A6C\u7EB3\u7279",EgyptianPound:"\u57C3\u53CA\u9551",EthiopianBirr:"\u57C3\u585E\u4FC4\u6BD4\u4E9A\u6BD4\u5C14",AngolaKwanza:"\u5B89\u54E5\u62C9\u5BBD\u624E",AustralianDollar:"\u6FB3\u5927\u5229\u4E9A\u5143",Patacas:"\u6FB3\u95E8\u5143",BarbadosDollar:"\u5DF4\u5DF4\u591A\u65AF\u5143",PapuaNewGuineaKina:"\u5DF4\u5E03\u4E9A\u65B0\u51E0\u5185\u4E9A\u57FA\u90A3",BahamianDollar:"\u5DF4\u54C8\u9A6C\u5143",PakistanRupee:"\u5DF4\u57FA\u65AF\u5766\u5362\u6BD4",ParaguayanGuarani:"\u5DF4\u62C9\u572D\u74DC\u62C9\u5C3C",BahrainiDinar:"\u5DF4\u6797\u7B2C\u7EB3\u5C14",PanamanianBalboa:"\u5DF4\u62FF\u9A6C\u5DF4\u6CE2\u4E9A",Brazilianreal:"\u5DF4\u897F\u91CC\u4E9A\u4F0A",Belarusianruble:"\u767D\u4FC4\u7F57\u65AF\u5362\u5E03",BermudianDollar:"\u767E\u6155\u5927\u5143",BulgarianLev:"\u4FDD\u52A0\u5229\u4E9A\u5217\u5F17",IcelandKrona:"\u51B0\u5C9B\u514B\u6717",BosniaHerzegovinaConvertibleMark:"\u6CE2\u9ED1\u53EF\u5151\u6362\u9A6C\u514B",PolishZloty:"\u6CE2\u5170\u5179\u7F57\u63D0",Boliviano:"\u73BB\u5229\u7EF4\u4E9A\u8BFA",BelizeDollar:"\u4F2F\u5229\u5179\u5143",BotswanaPula:"\u535A\u8328\u74E6\u7EB3\u666E\u62C9",NotDannuzhamu:"\u4E0D\u4E39\u52AA\u624E\u59C6",BurundiFranc:"\u5E03\u9686\u8FEA\u6CD5\u90CE",NorthKoreanWon:"\u671D\u9C9C\u5706",DanishKrone:"\u4E39\u9EA6\u514B\u6717",EastCaribbeanDollar:"\u4E1C\u52A0\u52D2\u6BD4\u5143",DominicaPeso:"\u591A\u7C73\u5C3C\u52A0\u6BD4\u7D22",RussianRuble:"\u4FC4\u56FD\u5362\u5E03",EritreanNakfa:"\u5384\u7ACB\u7279\u91CC\u4E9A\u7EB3\u514B\u6CD5",CFAfranc:"\u975E\u6D32\u91D1\u878D\u5171\u540C\u4F53\u6CD5\u90CE",PhilippinePeso:"\u83F2\u5F8B\u5BBE\u6BD4\u7D22",FijiDollar:"\u6590\u6D4E\u5143",CapeVerdeEscudo:"\u4F5B\u5F97\u89D2\u57C3\u65AF\u5E93\u591A",FalklandIslandsPound:"\u798F\u514B\u5170\u7FA4\u5C9B\u9551",GambianDalasi:"\u5188\u6BD4\u4E9A\u8FBE\u62C9\u897F",Congolesefranc:"\u521A\u679C\u6CD5\u90CE",ColombianPeso:"\u54E5\u4F26\u6BD4\u4E9A\u6BD4\u7D22",CostaRicanColon:"\u54E5\u65AF\u8FBE\u9ECE\u52A0\u79D1\u6717",CubanPeso:"\u53E4\u5DF4\u6BD4\u7D22",Cubanconvertiblepeso:"\u53E4\u5DF4\u53EF\u5151\u6362\u6BD4\u7D22",GuyanaDollar:"\u572D\u4E9A\u90A3\u5143",KazakhstanTenge:"\u54C8\u8428\u514B\u65AF\u5766\u575A\u6208",Haitiangourde:"\u6D77\u5730\u53E4\u5FB7",won:"\u97E9\u5143",NetherlandsAntillesGuilder:"\u8377\u5C5E\u5B89\u7684\u5217\u65AF\u76FE",Honduraslempiras:"\u6D2A\u90FD\u62C9\u65AF\u62C9\u4F26\u76AE\u62C9",DjiboutiFranc:"\u5409\u5E03\u63D0\u6CD5\u90CE",KyrgyzstanSom:"\u5409\u5C14\u5409\u65AF\u65AF\u5766\u7D22\u59C6",GuineaFranc:"\u51E0\u5185\u4E9A\u6CD5\u90CE",CanadianDollar:"\u52A0\u62FF\u5927\u5143",GhanaianCedi:"\u52A0\u7EB3\u585E\u5730",Cambodianriel:"\u67EC\u57D4\u5BE8\u745E\u5C14",CzechKoruna:"\u6377\u514B\u514B\u6717",ZimbabweDollar:"\u6D25\u5DF4\u5E03\u97E6\u5143",QatariRiyal:"\u5361\u5854\u5C14\u91CC\u4E9A\u5C14",CaymanIslandsDollar:"\u5F00\u66FC\u7FA4\u5C9B\u5143",Comorianfranc:"\u79D1\u6469\u7F57\u6CD5\u90CE",KuwaitiDinar:"\u79D1\u5A01\u7279\u7B2C\u7EB3\u5C14",CroatianKuna:"\u514B\u7F57\u5730\u4E9A\u5E93\u7EB3",KenyanShilling:"\u80AF\u5C3C\u4E9A\u5148\u4EE4",LesothoLoti:"\u83B1\u7D22\u6258\u6D1B\u8482",LaoKip:"\u8001\u631D\u57FA\u666E",LebanesePound:"\u9ECE\u5DF4\u5AE9\u9551",Lithuanianlitas:"\u7ACB\u9676\u5B9B\u7ACB\u7279",LibyanDinar:"\u5229\u6BD4\u4E9A\u7B2C\u7EB3\u5C14",LiberianDollar:"\u5229\u6BD4\u4E9A\u5143",RwandaFranc:"\u5362\u65FA\u8FBE\u6CD5\u90CE",RomanianLeu:"\u7F57\u9A6C\u5C3C\u4E9A\u5217\u4F0A",MalagasyAriary:"\u9A6C\u8FBE\u52A0\u65AF\u52A0\u963F\u91CC\u4E9A\u91CC",MaldivianRufiyaa:"\u9A6C\u5C14\u4EE3\u592B\u62C9\u83F2\u4E9A",MalawiKwacha:"\u9A6C\u62C9\u7EF4\u514B\u74E6\u67E5",MalaysianRinggit:"\u9A6C\u6765\u897F\u4E9A\u6797\u5409\u7279",MacedoniawearingDinar:"\u9A6C\u5176\u987F\u6234\u7B2C\u7EB3\u5C14",MauritiusRupee:"\u6BDB\u91CC\u6C42\u65AF\u5362\u6BD4",MauritanianOuguiya:"\u6BDB\u91CC\u5854\u5C3C\u4E9A\u4E4C\u5409\u4E9A",MongolianTugrik:"\u8499\u53E4\u56FE\u683C\u91CC\u514B",BangladeshiTaka:"\u5B5F\u52A0\u62C9\u5854\u5361",PeruvianNuevoSol:"\u79D8\u9C81\u65B0\u7D22\u5C14",MyanmarKyat:"\u7F05\u7538\u5F00\u4E9A\u7279",MoldovanLeu:"\u6469\u5C14\u591A\u74E6\u5217\u4F0A",MoroccanDirham:"\u6469\u6D1B\u54E5\u8FEA\u62C9\u59C6",MozambiqueMetical:"\u83AB\u6851\u6BD4\u514B\u6885\u8482\u5361\u5C14",MexicanPeso:"\u58A8\u897F\u54E5\u6BD4\u7D22",NamibianDollar:"\u7EB3\u7C73\u6BD4\u4E9A\u5143",SouthAfricanRand:"\u5357\u975E\u5170\u7279",SouthSudanesePound:"\u5357\u82CF\u4E39\u9551",NicaraguaCordoba:"\u5C3C\u52A0\u62C9\u74DC\u79D1\u591A\u5DF4",NepaleseRupee:"\u5C3C\u6CCA\u5C14\u5362\u6BD4",NigerianNaira:"\u5C3C\u65E5\u5229\u4E9A\u5948\u62C9",NorwegianKrone:"\u632A\u5A01\u514B\u6717",GeorgianLari:"\u4E54\u6CBB\u4E9A\u62C9\u745E",RMBOffshore:"\u4EBA\u6C11\u5E01\uFF08\u79BB\u5CB8\uFF09",SwedishKrona:"\u745E\u5178\u514B\u6717",SwissFranc:"\u745E\u58EB\u6CD5\u90CE",SerbianDinar:"\u585E\u5C14\u7EF4\u4E9A\u7B2C\u7EB3\u5C14",SierraLeone:"\u585E\u62C9\u5229\u6602\u5229\u6602",SeychellesRupee:"\u585E\u820C\u5C14\u5362\u6BD4",SaudiRiyal:"\u6C99\u7279\u91CC\u4E9A\u5C14",SaoTomeDobra:"\u5723\u591A\u7F8E\u591A\u5E03\u62C9",SaintHelenapound:"\u5723\u8D6B\u52D2\u62FF\u7FA4\u5C9B\u78C5",SriLankaRupee:"\u65AF\u91CC\u5170\u5361\u5362\u6BD4",SwazilandLilangeni:"\u65AF\u5A01\u58EB\u5170\u91CC\u5170\u5409\u5C3C",SudanesePound:"\u82CF\u4E39\u9551",Surinamesedollar:"\u82CF\u91CC\u5357\u5143",SolomonIslandsDollar:"\u6240\u7F57\u95E8\u7FA4\u5C9B\u5143",SomaliShilling:"\u7D22\u9A6C\u91CC\u5148\u4EE4",TajikistanSomoni:"\u5854\u5409\u514B\u65AF\u5766\u7D22\u83AB\u5C3C",PacificFranc:"\u592A\u5E73\u6D0B\u6CD5\u90CE",ThaiBaht:"\u6CF0\u56FD\u94E2",TanzanianShilling:"\u5766\u6851\u5C3C\u4E9A\u5148\u4EE4",TonganPaanga:"\u6C64\u52A0\u6F58\u52A0",TrinidadandTobagoDollar:"\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5\u5143",TunisianDinar:"\u7A81\u5C3C\u65AF\u7B2C\u7EB3\u5C14",TurkishLira:"\u571F\u8033\u5176\u91CC\u62C9",VanuatuVatu:"\u74E6\u52AA\u963F\u56FE\u74E6\u56FE",GuatemalanQuetzal:"\u5371\u5730\u9A6C\u62C9\u683C\u67E5\u5C14",CommissionBolivar:"\u59D4\u5185\u745E\u62C9\u535A\u5229\u74E6",BruneiDollar:"\u6587\u83B1\u5143",UgandanShilling:"\u4E4C\u5E72\u8FBE\u5148\u4EE4",UkrainianHryvnia:"\u4E4C\u514B\u5170\u683C\u91CC\u592B\u5C3C\u4E9A",UruguayanPeso:"\u4E4C\u62C9\u572D\u6BD4\u7D22",Uzbekistansom:"\u4E4C\u5179\u522B\u514B\u65AF\u5766\u82CF\u59C6",WesternSamoaTala:"\u897F\u8428\u6469\u4E9A\u5854\u62C9",SingaporeDollar:"\u65B0\u52A0\u5761\u5143",NT:"\u65B0\u53F0\u5E01",NewZealandDollar:"\u65B0\u897F\u5170\u5143",HungarianForint:"\u5308\u7259\u5229\u798F\u6797",SyrianPound:"\u53D9\u5229\u4E9A\u9551",JamaicanDollar:"\u7259\u4E70\u52A0\u5143",ArmenianDram:"\u4E9A\u7F8E\u5C3C\u4E9A\u5FB7\u62C9\u59C6",YemeniRial:"\u4E5F\u95E8\u91CC\u4E9A\u5C14",IraqiDinar:"\u4F0A\u62C9\u514B\u7B2C\u7EB3\u5C14",IranianRial:"\u4F0A\u6717\u91CC\u4E9A\u5C14",NewIsraeliShekel:"\u4EE5\u8272\u5217\u65B0\u8C22\u514B\u5C14",IndianRupee:"\u5370\u5EA6\u5362\u6BD4",IndonesianRupiah:"\u5370\u5EA6\u5C3C\u897F\u4E9A\u5362\u6BD4",JordanianDinar:"\u7EA6\u65E6\u7B2C\u7EB3\u5C14",VND:"\u8D8A\u5357\u76FE",ZambianKwacha:"\u8D5E\u6BD4\u4E9A\u514B\u74E6\u67E5",GibraltarPound:"\u76F4\u5E03\u7F57\u9640\u9551",ChileanPeso:"\u667A\u5229\u6BD4\u7D22",CFAFrancBEAC:"\u4E2D\u975E\u91D1\u878D\u5408\u4F5C\u6CD5\u90CE"}},H7={currencyDetail:{RMB:"RMB",USdollar:"US dollar",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"}};class U7 extends si{execute(){const e=new _e;this.actionDataList.forEach(n=>{if(n.operation!=null&&!pr.hasExtension(n))return!1;if(n.actionName===$.SET_RANGE_DATA_ACTION){let{cellValue:s,sheetId:o}=n;new _e(s).forValue((l,u,c)=>{const h=gt.parseValue(c.v);if(h){const d=gt(h.z);c.m=d(h.v),c.v=h.v||String(),e.setValue(l,u,h.z)}});const a={actionName:Pl.SET_NUMFMT_RANGE_DATA_ACTION,sheetId:o,cellValue:e.toJSON()};this.push(a)}})}}class z7 extends fa{get zIndex(){return 2}create(e){return new U7(e,this._plugin)}}class jl extends sn{constructor(e){super(kr)}static create(e){return new jl(e)}onMounted(e){o7(this),e.getLocale().load({en:H7,zh:P7}),this._numfmtActionExtensionFactory=new z7(this),this._numfmtModalController=new L7(this),this._controller=new B7(this),this.context.getCommandManager().getActionExtensionManager().getRegister().add(this._numfmtActionExtensionFactory)}onDestroy(){super.onDestroy(),this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._numfmtActionExtensionFactory)}getNumfmtBySheetIdConfig(e){return this._controller.getNumfmtBySheetIdConfig(e)}setNumfmtByRange(e,t,n){this._controller.setNumfmtByRange(e,t,n)}setNumfmtByCoords(e,t,n,s){this._controller.setNumfmtByCoords(e,t,n,s)}getNumfmtModalController(){return this._numfmtModalController}}var W7=Object.freeze(Object.defineProperty({__proto__:null,NumfmtPlugin:jl},Symbol.toStringTag,{value:"Module"})),V7={},$7={};const qh="ClipboardPlugin",Jn=class{static async writeText(r,e){var t;if(Jn.clipboard)return Jn.clipboard.writeText(r).then(()=>!0,n=>console.dir(n));(t=e==null?void 0:e.clipboardData)==null||t.setData("text/html",r)}static async write(r,e){var t,n,s;if(Jn.clipboard){const o=new Blob([r.data],{type:(t=r.type)!=null?t:"text/html"}),i=[new ClipboardItem({"text/html":o})];return Jn.clipboard.write(i).then(()=>!0,()=>!1)}(s=e==null?void 0:e.clipboardData)==null||s.setData((n=r.type)!=null?n:"text/html",r.data)}static async readText(){return Jn.clipboard?Jn.clipboard.readText().then(r=>r,()=>null):Jn.textArea?new Promise((r,e)=>{r(Jn.textArea.value)}).then(r=>r).then(()=>null):null}static async read(r){if(Jn.clipboard){const s=await Jn.clipboard.read(),o=[];for(const i of s)for(const a of i.types){const l=await i.getType(a),u=new FileReader;a==="image/png"?u.readAsDataURL(l):u.readAsText(l);const c=new Promise((h,d)=>{u.onload=g=>{const m={type:a,result:u.result};h(m)}}).then(h=>h,()=>null);o.push(c)}return Promise.all(o)}const e=[],t=r==null?void 0:r.clipboardData,n=t==null?void 0:t.types;if(console.dir(n),!n)return null;for(let s=0;s<n.length;s++)e.push({type:n[s],result:t.getData(n[s])});return e}};let hr=Jn;hr.clipboard=window.navigator.clipboard;class B_ extends Oe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{prefix:e,placeholder1:t,suffix:n,placeholder2:s}=this.props,o=this._render.renderFunction("Input");return _("div",null,e,_(o,{type:"number",placeholder:t}),n||"\xD7",s?_(o,{type:"number",placeholder:s}):"")}}class G7{constructor(e,t,n){this._context=e;const s=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);this._initRegisterComponent(n),s==null||s.addRightMenu(t),this._context.getObserverManager().requiredObserver("onKeyCopyObservable","core").add(i=>{this.copy(i)})}getContext(){return this._context}copy(e){e.preventDefault()}_initRegisterComponent(e){const t=this._context.getPluginManager().getPluginByName(Pe.SPREADSHEET);for(let n=0;n<e.length;n++)t.registerComponent(qh+e[n].name,e[n])}}class X7 extends G7{constructor(e){const t=[{locale:["rightClick.copy"],onClick:()=>this.copyTo()},{customLabel:{name:Fo.name,props:{locale:"rightClick.copyAs"}},children:[{locale:["Json","rightClick.firstLineTitle"],onClick:()=>this.copyJsonHead()},{locale:["Json","rightClick.untitled"],onClick:()=>this.copyJsonNoHead()},{locale:["rightClick.array1"],onClick:()=>this.copyArray1()},{locale:["rightClick.array2"],onClick:()=>this.copyArray2()},{customLabel:{name:qh+B_.name,props:{prefixLocale:"rightClick.array3",placeholder1Locale:"rightClick.row",suffixLocale:"rightClick.column",placeholder2Locale:"rightClick.column"}}}]}];super(e,t,[B_])}_getSheetInfo(){const e=this.getContext().getWorkBook().getActiveSheet(),t=this.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET),n=t==null?void 0:t.getMainComponent(),s=t==null?void 0:t.getSelectionManager().getCurrentControls(),o=s==null?void 0:s.map(i=>{const a=i.model;return{startRow:a.startRow,startColumn:a.startColumn,endRow:a.endRow,endColumn:a.endColumn}});return{sheet:e,spreadsheet:n,selections:o}}_getRangeInfo(){const{sheet:e,selections:t}=this._getSheetInfo();if(!t.length)return;const n=e.getRange(t[0]),s=n.getValues();if(!!s.length)return{range:n,rangeData:s}}_getCopyContent(){const{sheet:e,spreadsheet:t,selections:n}=this._getSheetInfo();if(n.length>1)return;const s=e.getRowManager().getRowData(),o=e.getColumnManager().getColumnData();let i=[],a=[];for(let h=0;h<n.length;h++){let d=n[h],g=d.startRow,m=d.endRow,f=d.startColumn,p=d.endColumn;for(let b=g;b<=m;b++){const v=s.get(b);if(!(v&&v.hd)){i.includes(b)||i.push(b);for(let w=f;w<=p;w++){const S=o.get(w);S&&S.hd||a.includes(w)||a.push(w)}}}}let l="",u="";for(let h=0;h<i.length;h++){let d=i[h];l+="<tr>";for(let g=0;g<a.length;g++){let m=a[g],f=e.getRange(d,m).getValue(),p="",b="",v="";if(d===i[0]){const R=o.get(m);R&&R.w?`${R.w}`:u+='<colgroup width="72px"></colgroup>'}const w=s.get(d);w&&w.h?b+=`height:${w.h}px;`:b+="height:19px;";const S=o.get(m);if(S&&S.w?b+=`width:${S.w}px;`:b+="width:72px;",f&&f.s){const R=this.getContext().getWorkBook().getStyles().get(f.s);R&&(b+=tl(R))}const T=t==null?void 0:t.getCellByIndex(d,m);if((T==null?void 0:T.isMerged)||!(T!=null&&T.isMerged)&&(T==null?void 0:T.isMergedMainCell))if(T.isMergedMainCell)v=`rowSpan="${T.mergeInfo.endRow-T.mergeInfo.startRow+1}" colSpan="${T.mergeInfo.endColumn-T.mergeInfo.startColumn+1}"`;else continue;if(b.includes("data-rotate")){let R=b.split(";").find(M=>M.includes("data-rotate"));const I=R==null?void 0:R.match(/\d+/g);let y=0,O=0;I!=null&&I.length&&(y=+I[0],O=+I[1]),p+=`<td ${v} ${O?`data-vertical=${O}`:""} style="display:inline-block;transform: rotate(${y}deg);${b}">`}else p=`<td ${v} style="${b}">`;let D;f?f.p?D=Pc(f.p):(D=e.getRange(d,m).getDisplayValue(),D==null&&(D="")):D="",p+=D,p+="</td>",l+=p}l+="</tr>"}return`<table data-type="universheet_copy_action_table">${u}${l}</table>`}async copy(e){const t=this._getCopyContent();t&&hr.write({data:t},e)}async copyTo(...e){const t=this._getCopyContent();t&&await hr.write({data:t})}async copyJsonHead(...e){var i,a,l;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let o=[];if(s.length===1){let u={};for(let c=0;c<s[0].length;c++){const h=(i=n.getValues()[0][c])==null?void 0:i.v;typeof h=="string"||typeof h=="number"?u[h]="":u[""]=""}o.push(u)}else for(let u=1;u<s.length;u++){let c={};for(let h=0;h<s[0].length;h++){const d=(a=n.getValues()[0][h])==null?void 0:a.v,g=(l=n.getValues()[u][h])==null?void 0:l.v;typeof d=="string"||typeof d=="number"?c[d]=g:c[""]=g}o.push(c)}await hr.writeText(JSON.stringify(o))}async copyJsonNoHead(...e){var i;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let o=[];for(let a=0;a<s.length;a++){let l={};for(let u=0;u<s[0].length;u++){const c=(i=n.getValues()[a][u])==null?void 0:i.v;l[W.chatAtABC(u+n.getRangeData().startColumn)]=c}o.push(l)}await hr.writeText(JSON.stringify(o))}async copyArray1(...e){var i;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let o=[];for(let a=0;a<s.length;a++)for(let l=0;l<s[0].length;l++){const u=(i=n.getValues()[a][l])==null?void 0:i.v;o.push(u)}await hr.writeText(JSON.stringify(o))}async copyArray2(...e){var i;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let o=[];for(let a=0;a<s.length;a++)for(let l=0;l<s[0].length;l++){const u=(i=n.getValues()[a][l])==null?void 0:i.v;o.push(u)}await hr.writeText(JSON.stringify(o))}async copyArrayMore(e){var g,m,f;if(e.key!=="Enter")return;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let o=[];for(let p=0;p<s.length;p++)for(let b=0;b<s[0].length;b++)o.push(s[p][b]);let i="0",a="0";const l=e.target,u=(g=l==null?void 0:l.previousSibling)==null?void 0:g.textContent;if(!u)return;if(u.length>1?(i=l.value,a=((m=l.parentNode)==null?void 0:m.querySelectorAll("input")[1]).value):(a=l.value,i=((f=l.parentNode)==null?void 0:f.querySelectorAll("input")[0]).value),i===""&&a===""){await hr.writeText(JSON.stringify(o));return}if(i===""?i="1":i=`${parseInt(i)}`,a===""?a="1":a=`${parseInt(a)}`,+i<1||+a<1)return;let c=o.length,h=0,d=[];for(let p=0;p<+i;p++){let b=[];for(let v=0;v<+a;v++)if(b.push(o[h++]),h>=c){await hr.writeText(JSON.stringify(d));return}d.push(b)}await hr.writeText(JSON.stringify(d))}}class Y7{constructor(e,t){this._context=e,this._context.getPluginManager().getRequirePluginByName(Pe.SPREADSHEET).addRightMenu(t)}getContext(){return this._context}paste(e){}}class j7 extends Y7{constructor(e){const t=[{locale:["rightClick.paste"],onClick:()=>{}}];super(e,t)}pasteTo(e){if(!e||(e==null?void 0:e.length)===0)return;const t=this.getContext().getWorkBook().getActiveSheet();if(!t)return;const n=this.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET);if(!n||!(n==null?void 0:n.getMainComponent()))return;const o=n==null?void 0:n.getSelectionManager().getCurrentControls(),i=o==null?void 0:o.map(b=>{const v=b.model;return{startRow:v.startRow,startColumn:v.startColumn,endRow:v.endRow,endColumn:v.endColumn}});if(!i.length||i.length>1)return;const a=i[0];let l=e.length,u=e[0].length,c=a.startRow,h=c+l-1,d=a.startColumn,g=d+u-1;if(t.getMerges().getByRowColumn(c,h,d,g))return;const f=Km(e,a),p=f.mergeData;for(let b=0;b<p.length;b++)t.getMerges().add(p[b]);t.getRange(c,d,h,g).setRangeDatas(f.data)}paste(e){this.pasteTo(e)}}class K7 extends Wa{execute(){const e=this._data.html||this._data.plain;let t;e&&(e.indexOf("<table")>-1&&e.indexOf("<td")>-1?t=Ym(e):t=jm(e)),this._plugin.getUniverPaste().pasteTo(t)}}class Z7 extends Ac{get zIndex(){return 1}create(e){return new K7(e,this._plugin)}check(e){const t=e.html||e.plain;return t&&t.indexOf("<table")>-1&&t.indexOf("<td")>-1?this.create(e):!1}}class q7 extends Wa{execute(){}}class J7 extends Ac{get zIndex(){return 2}create(e){return new q7(e,this._plugin)}check(e){return!1}}class Kl extends sn{constructor(){super(qh),this._copyResolvers=[],this._pasteResolvers=[]}static create(){return new Kl}initialize(){this.registerExtension()}registerExtension(){const e=this.getContext().getPluginManager().getRequirePluginByName(Pe.BASE_COMPONENT).getRegisterManager().getClipboardExtensionManager().getRegister();this._clipboardExtensionFactory=new Z7(this),e.add(this._clipboardExtensionFactory),this._clipboardOfficeExtensionFactory=new J7(this),e.add(this._clipboardOfficeExtensionFactory)}installTo(e){e.installPlugin(this)}onDestroy(){const e=this.getContext().getPluginManager().getRequirePluginByName(Pe.BASE_COMPONENT).getRegisterManager().getClipboardExtensionManager().getRegister();e.delete(this._clipboardExtensionFactory),e.delete(this._clipboardOfficeExtensionFactory)}onMounted(e){super.onMounted(e),e.getLocale().load({en:$7,zh:V7}),this._univerPaste=new j7(e),this.installCopyResolver({name:"univerCopy",resolver:new X7(e)}),this.initialize()}getUniverPaste(){return this._univerPaste}installCopyResolver(e){if(this._copyResolvers.findIndex(n=>n.name===e.name)>-1)return!1;this._copyResolvers.push(e)}}var Q7=Object.freeze(Object.defineProperty({__proto__:null,ClipboardPlugin:Kl},Symbol.toStringTag,{value:"Module"})),eA={importXlsx:{tooltip:"\u5BFC\u5165",upload:"\u4E0A\u4F20XLSX"}},tA={importXlsx:{tooltip:"Import",upload:"Upload XLSX"}};const L_="importXlsx";var P_={exports:{}};/*!

    JSZip v3.10.1 - A JavaScript class for generating and reading zip files
    <http://stuartk.com/jszip>

    (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
    Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

    JSZip uses the library pako released under the MIT license :
    https://github.com/nodeca/pako/blob/main/LICENSE
    */(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,s,o){function i(u,c){if(!s[u]){if(!n[u]){var h=typeof ua=="function"&&ua;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var g=s[u]={exports:{}};n[u][0].call(g.exports,function(m){var f=n[u][1][m];return i(f||m)},g,g.exports,t,n,s,o)}return s[u].exports}for(var a=typeof ua=="function"&&ua,l=0;l<o.length;l++)i(o[l]);return i}({1:[function(t,n,s){var o=t("./utils"),i=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var u,c,h,d,g,m,f,p=[],b=0,v=l.length,w=v,S=o.getTypeOf(l)!=="string";b<l.length;)w=v-b,h=S?(u=l[b++],c=b<v?l[b++]:0,b<v?l[b++]:0):(u=l.charCodeAt(b++),c=b<v?l.charCodeAt(b++):0,b<v?l.charCodeAt(b++):0),d=u>>2,g=(3&u)<<4|c>>4,m=1<w?(15&c)<<2|h>>6:64,f=2<w?63&h:64,p.push(a.charAt(d)+a.charAt(g)+a.charAt(m)+a.charAt(f));return p.join("")},s.decode=function(l){var u,c,h,d,g,m,f=0,p=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var v,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&w--,l.charAt(l.length-2)===a.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=i.uint8array?new Uint8Array(0|w):new Array(0|w);f<l.length;)u=a.indexOf(l.charAt(f++))<<2|(d=a.indexOf(l.charAt(f++)))>>4,c=(15&d)<<4|(g=a.indexOf(l.charAt(f++)))>>2,h=(3&g)<<6|(m=a.indexOf(l.charAt(f++))),v[p++]=u,g!==64&&(v[p++]=c),m!==64&&(v[p++]=h);return v}},{"./support":30,"./utils":32}],2:[function(t,n,s){var o=t("./external"),i=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,h,d,g,m){this.compressedSize=c,this.uncompressedSize=h,this.crc32=d,this.compression=g,this.compressedContent=m}u.prototype={getContentWorker:function(){var c=new i(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new i(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,h,d){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,s){var o=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,s){var o=t("./utils"),i=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(u,c,h,d){var g=i,m=d+h;u^=-1;for(var f=d;f<m;f++)u=u>>>8^g[255&(u^c[f])];return-1^u}(0|l,a,a.length,0):function(u,c,h,d){var g=i,m=d+h;u^=-1;for(var f=d;f<m;f++)u=u>>>8^g[255&(u^c.charCodeAt(f))];return-1^u}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(t,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,n,s){var o=null;o=typeof Promise!="undefined"?Promise:t("lie"),n.exports={Promise:o}},{lie:37}],7:[function(t,n,s){var o=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",i=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),u=o?"uint8array":"array";function c(h,d){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=d,this.meta={}}s.magic="\b\0",a.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(u,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(d){h.push({data:d,meta:h.meta})}},s.compressWorker=function(h){return new c("Deflate",h)},s.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,s){function o(g,m){var f,p="";for(f=0;f<m;f++)p+=String.fromCharCode(255&g),g>>>=8;return p}function i(g,m,f,p,b,v){var w,S,T=g.file,D=g.compression,R=v!==u.utf8encode,I=a.transformTo("string",v(T.name)),y=a.transformTo("string",u.utf8encode(T.name)),O=T.comment,M=a.transformTo("string",v(O)),F=a.transformTo("string",u.utf8encode(O)),x=y.length!==T.name.length,E=F.length!==O.length,N="",X="",L="",ne=T.dir,G=T.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};m&&!f||(Q.crc32=g.crc32,Q.compressedSize=g.compressedSize,Q.uncompressedSize=g.uncompressedSize);var P=0;m&&(P|=8),R||!x&&!E||(P|=2048);var V=0,pe=0;ne&&(V|=16),b==="UNIX"?(pe=798,V|=function(Z,ie){var be=Z;return Z||(be=ie?16893:33204),(65535&be)<<16}(T.unixPermissions,ne)):(pe=20,V|=function(Z){return 63&(Z||0)}(T.dosPermissions)),w=G.getUTCHours(),w<<=6,w|=G.getUTCMinutes(),w<<=5,w|=G.getUTCSeconds()/2,S=G.getUTCFullYear()-1980,S<<=4,S|=G.getUTCMonth()+1,S<<=5,S|=G.getUTCDate(),x&&(X=o(1,1)+o(c(I),4)+y,N+="up"+o(X.length,2)+X),E&&(L=o(1,1)+o(c(M),4)+F,N+="uc"+o(L.length,2)+L);var oe="";return oe+=`
\0`,oe+=o(P,2),oe+=D.magic,oe+=o(w,2),oe+=o(S,2),oe+=o(Q.crc32,4),oe+=o(Q.compressedSize,4),oe+=o(Q.uncompressedSize,4),oe+=o(I.length,2),oe+=o(N.length,2),{fileRecord:h.LOCAL_FILE_HEADER+oe+I+N,dirRecord:h.CENTRAL_FILE_HEADER+o(pe,2)+oe+o(M.length,2)+"\0\0\0\0"+o(V,4)+o(p,4)+I+N+M}}var a=t("../utils"),l=t("../stream/GenericWorker"),u=t("../utf8"),c=t("../crc32"),h=t("../signature");function d(g,m,f,p){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=f,this.encodeFileName=p,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,l),d.prototype.push=function(g){var m=g.meta.percent||0,f=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,l.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:f?(m+100*(f-p-1))/f:100}}))},d.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var m=this.streamFiles&&!g.file.dir;if(m){var f=i(g,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(g){this.accumulate=!1;var m=this.streamFiles&&!g.file.dir,f=i(g,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),m)this.push({data:function(p){return h.DATA_DESCRIPTOR+o(p.crc32,4)+o(p.compressedSize,4)+o(p.uncompressedSize,4)}(g),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var g=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var f=this.bytesWritten-g,p=function(b,v,w,S,T){var D=a.transformTo("string",T(S));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(b,2)+o(b,2)+o(v,4)+o(w,4)+o(D.length,2)+D}(this.dirRecords.length,f,g,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(g){this._sources.push(g);var m=this;return g.on("data",function(f){m.processChunk(f)}),g.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),g.on("error",function(f){m.error(f)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(g){var m=this._sources;if(!l.prototype.error.call(this,g))return!1;for(var f=0;f<m.length;f++)try{m[f].error(g)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var g=this._sources,m=0;m<g.length;m++)g[m].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,s){var o=t("../compressions"),i=t("./ZipFileWorker");s.generateWorker=function(a,l,u){var c=new i(l.streamFiles,u,l.platform,l.encodeFileName),h=0;try{a.forEach(function(d,g){h++;var m=function(v,w){var S=v||w,T=o[S];if(!T)throw new Error(S+" is not a valid compression method !");return T}(g.options.compression,l.compression),f=g.options.compressionOptions||l.compressionOptions||{},p=g.dir,b=g.date;g._compressWorker(m,f).withStreamInfo("file",{name:d,dir:p,date:b,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(c)}),c.entriesCount=h}catch(d){c.error(d)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,s){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new o;for(var a in this)typeof this[a]!="function"&&(i[a]=this[a]);return i}}(o.prototype=t("./object")).loadAsync=t("./load"),o.support=t("./support"),o.defaults=t("./defaults"),o.version="3.10.1",o.loadAsync=function(i,a){return new o().loadAsync(i,a)},o.external=t("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,s){var o=t("./utils"),i=t("./external"),a=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function h(d){return new i.Promise(function(g,m){var f=d.decompressed.getContentWorker().pipe(new u);f.on("error",function(p){m(p)}).on("end",function(){f.streamInfo.crc32!==d.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}n.exports=function(d,g){var m=this;return g=o.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(d)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",d,!0,g.optimizedBinaryString,g.base64).then(function(f){var p=new l(g);return p.load(f),p}).then(function(f){var p=[i.Promise.resolve(f)],b=f.files;if(g.checkCRC32)for(var v=0;v<b.length;v++)p.push(h(b[v]));return i.Promise.all(p)}).then(function(f){for(var p=f.shift(),b=p.files,v=0;v<b.length;v++){var w=b[v],S=w.fileNameStr,T=o.resolve(w.fileNameStr);m.file(T,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:g.createFolders}),w.dir||(m.file(T).unsafeOriginalName=S)}return p.zipComment.length&&(m.comment=p.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,s){var o=t("../utils"),i=t("../stream/GenericWorker");function a(l,u){i.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}o.inherits(a,i),a.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,s){var o=t("readable-stream").Readable;function i(a,l,u){o.call(this,l),this._helper=a;var c=this;a.on("data",function(h,d){c.push(h)||c._helper.pause(),u&&u(d)}).on("error",function(h){c.emit("error",h)}).on("end",function(){c.push(null)})}t("../utils").inherits(i,o),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,n,s){n.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(o,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,i);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,i)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var i=new Buffer(o);return i.fill(0),i},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(t,n,s){function o(T,D,R){var I,y=a.getTypeOf(D),O=a.extend(R||{},c);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(T=b(T)),O.createFolders&&(I=p(T))&&v.call(this,I,!0);var M=y==="string"&&O.binary===!1&&O.base64===!1;R&&R.binary!==void 0||(O.binary=!M),(D instanceof h&&D.uncompressedSize===0||O.dir||!D||D.length===0)&&(O.base64=!1,O.binary=!0,D="",O.compression="STORE",y="string");var F=null;F=D instanceof h||D instanceof l?D:m.isNode&&m.isStream(D)?new f(T,D):a.prepareContent(T,D,O.binary,O.optimizedBinaryString,O.base64);var x=new d(T,F,O);this.files[T]=x}var i=t("./utf8"),a=t("./utils"),l=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),c=t("./defaults"),h=t("./compressedObject"),d=t("./zipObject"),g=t("./generate"),m=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),p=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var D=T.lastIndexOf("/");return 0<D?T.substring(0,D):""},b=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},v=function(T,D){return D=D!==void 0?D:c.createFolders,T=b(T),this.files[T]||o.call(this,T,null,{dir:!0,createFolders:D}),this.files[T]};function w(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var D,R,I;for(D in this.files)I=this.files[D],(R=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&T(R,I)},filter:function(T){var D=[];return this.forEach(function(R,I){T(R,I)&&D.push(I)}),D},file:function(T,D,R){if(arguments.length!==1)return T=this.root+T,o.call(this,T,D,R),this;if(w(T)){var I=T;return this.filter(function(O,M){return!M.dir&&I.test(O)})}var y=this.files[this.root+T];return y&&!y.dir?y:null},folder:function(T){if(!T)return this;if(w(T))return this.filter(function(y,O){return O.dir&&T.test(y)});var D=this.root+T,R=v.call(this,D),I=this.clone();return I.root=R.name,I},remove:function(T){T=this.root+T;var D=this.files[T];if(D||(T.slice(-1)!=="/"&&(T+="/"),D=this.files[T]),D&&!D.dir)delete this.files[T];else for(var R=this.filter(function(y,O){return O.name.slice(0,T.length)===T}),I=0;I<R.length;I++)delete this.files[R[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var D,R={};try{if((R=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");a.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var I=R.comment||this.comment||"";D=g.generateWorker(this,R,I)}catch(y){(D=new l("error")).error(y)}return new u(D,R.type||"string",R.mimeType)},generateAsync:function(T,D){return this.generateInternalStream(T).accumulate(D)},generateNodeStream:function(T,D){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(D)}};n.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,s){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,s){var o=t("./DataReader");function i(a){o.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}t("../utils").inherits(i,o),i.prototype.byteAt=function(a){return this.data[this.zero+a]},i.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),h=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===u&&this.data[d+2]===c&&this.data[d+3]===h)return d-this.zero;return-1},i.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),h=a.charCodeAt(3),d=this.readData(4);return l===d[0]&&u===d[1]&&c===d[2]&&h===d[3]},i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,n,s){var o=t("../utils");function i(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,u=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=a,u},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=i},{"../utils":32}],19:[function(t,n,s){var o=t("./Uint8ArrayReader");function i(a){o.call(this,a)}t("../utils").inherits(i,o),i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,s){var o=t("./DataReader");function i(a){o.call(this,a)}t("../utils").inherits(i,o),i.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},i.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},i.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},i.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,n,s){var o=t("./ArrayReader");function i(a){o.call(this,a)}t("../utils").inherits(i,o),i.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,s){var o=t("../utils"),i=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");n.exports=function(h){var d=o.getTypeOf(h);return o.checkSupport(d),d!=="string"||i.uint8array?d==="nodebuffer"?new u(h):i.uint8array?new c(o.transformTo("uint8array",h)):new a(o.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,s){var o=t("./GenericWorker"),i=t("../utils");function a(l){o.call(this,"ConvertWorker to "+l),this.destType=l}i.inherits(a,o),a.prototype.processChunk=function(l){this.push({data:i.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,s){var o=t("./GenericWorker"),i=t("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,o),a.prototype.processChunk=function(l){this.streamInfo.crc32=i(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,s){var o=t("../utils"),i=t("./GenericWorker");function a(l){i.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(a,i),a.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}i.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,s){var o=t("../utils"),i=t("./GenericWorker");function a(l){i.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=o.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}o.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,s){function o(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,a){return this._listeners[i].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,a){if(this._listeners[i])for(var l=0;l<this._listeners[i].length;l++)this._listeners[i][l].call(this,a)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var a=this;return i.on("data",function(l){a.processChunk(l)}),i.on("end",function(){a.end()}),i.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,a){return this.extraStreamInfo[i]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},n.exports=o},{}],29:[function(t,n,s){var o=t("../utils"),i=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),h=null;if(u.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(m,f){return new c.Promise(function(p,b){var v=[],w=m._internalType,S=m._outputType,T=m._mimeType;m.on("data",function(D,R){v.push(D),f&&f(R)}).on("error",function(D){v=[],b(D)}).on("end",function(){try{var D=function(R,I,y){switch(R){case"blob":return o.newBlob(o.transformTo("arraybuffer",I),y);case"base64":return l.encode(I);default:return o.transformTo(R,I)}}(S,function(R,I){var y,O=0,M=null,F=0;for(y=0;y<I.length;y++)F+=I[y].length;switch(R){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(M=new Uint8Array(F),y=0;y<I.length;y++)M.set(I[y],O),O+=I[y].length;return M;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+R+"'")}}(w,v),T);p(D)}catch(R){b(R)}v=[]}).resume()})}function g(m,f,p){var b=f;switch(f){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=f,this._mimeType=p,o.checkSupport(b),this._worker=m.pipe(new i(b)),m.lock()}catch(v){this._worker=new a("error"),this._worker.error(v)}}g.prototype={accumulate:function(m){return d(this,m)},on:function(m,f){var p=this;return m==="data"?this._worker.on(m,function(b){f.call(p,b.data,b.meta)}):this._worker.on(m,function(){o.delay(f,arguments,p)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},m)}},n.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",s.nodebuffer=typeof Buffer!="undefined",s.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")s.blob=!1;else{var o=new ArrayBuffer(0);try{s.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(o),s.blob=i.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,s){for(var o=t("./utils"),i=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}s.utf8encode=function(g){return i.nodebuffer?a.newBufferFrom(g,"utf-8"):function(m){var f,p,b,v,w,S=m.length,T=0;for(v=0;v<S;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(b-56320),v++),T+=p<128?1:p<2048?2:p<65536?3:4;for(f=i.uint8array?new Uint8Array(T):new Array(T),v=w=0;w<T;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(b-56320),v++),p<128?f[w++]=p:(p<2048?f[w++]=192|p>>>6:(p<65536?f[w++]=224|p>>>12:(f[w++]=240|p>>>18,f[w++]=128|p>>>12&63),f[w++]=128|p>>>6&63),f[w++]=128|63&p);return f}(g)},s.utf8decode=function(g){return i.nodebuffer?o.transformTo("nodebuffer",g).toString("utf-8"):function(m){var f,p,b,v,w=m.length,S=new Array(2*w);for(f=p=0;f<w;)if((b=m[f++])<128)S[p++]=b;else if(4<(v=u[b]))S[p++]=65533,f+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&f<w;)b=b<<6|63&m[f++],v--;1<v?S[p++]=65533:b<65536?S[p++]=b:(b-=65536,S[p++]=55296|b>>10&1023,S[p++]=56320|1023&b)}return S.length!==p&&(S.subarray?S=S.subarray(0,p):S.length=p),o.applyFromCharCode(S)}(g=o.transformTo(i.uint8array?"uint8array":"array",g))},o.inherits(h,l),h.prototype.processChunk=function(g){var m=o.transformTo(i.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var f=m;(m=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),m.set(f,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var p=function(v,w){var S;for((w=w||v.length)>v.length&&(w=v.length),S=w-1;0<=S&&(192&v[S])==128;)S--;return S<0||S===0?w:S+u[v[S]]>w?S:w}(m),b=m;p!==m.length&&(i.uint8array?(b=m.subarray(0,p),this.leftOver=m.subarray(p,m.length)):(b=m.slice(0,p),this.leftOver=m.slice(p,m.length))),this.push({data:s.utf8decode(b),meta:g.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=h,o.inherits(d,l),d.prototype.processChunk=function(g){this.push({data:s.utf8encode(g.data),meta:g.meta})},s.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,s){var o=t("./support"),i=t("./base64"),a=t("./nodejsUtils"),l=t("./external");function u(f){return f}function c(f,p){for(var b=0;b<f.length;++b)p[b]=255&f.charCodeAt(b);return p}t("setimmediate"),s.newBlob=function(f,p){s.checkSupport("blob");try{return new Blob([f],{type:p})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(f),b.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(f,p,b){var v=[],w=0,S=f.length;if(S<=b)return String.fromCharCode.apply(null,f);for(;w<S;)p==="array"||p==="nodebuffer"?v.push(String.fromCharCode.apply(null,f.slice(w,Math.min(w+b,S)))):v.push(String.fromCharCode.apply(null,f.subarray(w,Math.min(w+b,S)))),w+=b;return v.join("")},stringifyByChar:function(f){for(var p="",b=0;b<f.length;b++)p+=String.fromCharCode(f[b]);return p},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(f){var p=65536,b=s.getTypeOf(f),v=!0;if(b==="uint8array"?v=h.applyCanBeUsed.uint8array:b==="nodebuffer"&&(v=h.applyCanBeUsed.nodebuffer),v)for(;1<p;)try{return h.stringifyByChunk(f,b,p)}catch{p=Math.floor(p/2)}return h.stringifyByChar(f)}function g(f,p){for(var b=0;b<f.length;b++)p[b]=f[b];return p}s.applyFromCharCode=d;var m={};m.string={string:u,array:function(f){return c(f,new Array(f.length))},arraybuffer:function(f){return m.string.uint8array(f).buffer},uint8array:function(f){return c(f,new Uint8Array(f.length))},nodebuffer:function(f){return c(f,a.allocBuffer(f.length))}},m.array={string:d,array:u,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(f)}},m.arraybuffer={string:function(f){return d(new Uint8Array(f))},array:function(f){return g(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:u,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(new Uint8Array(f))}},m.uint8array={string:d,array:function(f){return g(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:u,nodebuffer:function(f){return a.newBufferFrom(f)}},m.nodebuffer={string:d,array:function(f){return g(f,new Array(f.length))},arraybuffer:function(f){return m.nodebuffer.uint8array(f).buffer},uint8array:function(f){return g(f,new Uint8Array(f.length))},nodebuffer:u},s.transformTo=function(f,p){if(p=p||"",!f)return p;s.checkSupport(f);var b=s.getTypeOf(p);return m[b][f](p)},s.resolve=function(f){for(var p=f.split("/"),b=[],v=0;v<p.length;v++){var w=p[v];w==="."||w===""&&v!==0&&v!==p.length-1||(w===".."?b.pop():b.push(w))}return b.join("/")},s.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(f)?"nodebuffer":o.uint8array&&f instanceof Uint8Array?"uint8array":o.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(f){if(!o[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(f){var p,b,v="";for(b=0;b<(f||"").length;b++)v+="\\x"+((p=f.charCodeAt(b))<16?"0":"")+p.toString(16).toUpperCase();return v},s.delay=function(f,p,b){setImmediate(function(){f.apply(b||null,p||[])})},s.inherits=function(f,p){function b(){}b.prototype=p.prototype,f.prototype=new b},s.extend=function(){var f,p,b={};for(f=0;f<arguments.length;f++)for(p in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],p)&&b[p]===void 0&&(b[p]=arguments[f][p]);return b},s.prepareContent=function(f,p,b,v,w){return l.Promise.resolve(p).then(function(S){return o.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader!="undefined"?new l.Promise(function(T,D){var R=new FileReader;R.onload=function(I){T(I.target.result)},R.onerror=function(I){D(I.target.error)},R.readAsArrayBuffer(S)}):S}).then(function(S){var T=s.getTypeOf(S);return T?(T==="arraybuffer"?S=s.transformTo("uint8array",S):T==="string"&&(w?S=i.decode(S):b&&v!==!0&&(S=function(D){return c(D,o.uint8array?new Uint8Array(D.length):new Array(D.length))}(S))),S):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,s){var o=t("./reader/readerFor"),i=t("./utils"),a=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(d)+", expected "+i.pretty(h)+")")}},isSignature:function(h,d){var g=this.reader.index;this.reader.setIndex(h);var m=this.reader.readString(4)===d;return this.reader.setIndex(g),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",g=i.transformTo(d,h);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,d,g,m=this.zip64EndOfCentralSize-44;0<m;)h=this.reader.readInt(2),d=this.reader.readInt(4),g=this.reader.readData(d),this.zip64ExtensibleData[h]={id:h,length:d,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,d;for(h=0;h<this.files.length;h++)d=this.files[h],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var d=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var m=d-g;if(0<m)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(h){this.reader=o(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,s){var o=t("./reader/readerFor"),i=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),h=t("./support");function d(g,m){this.options=g,this.loadOptions=m}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var m,f;if(g.skip(22),this.fileNameLength=g.readInt(2),f=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(p){for(var b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&c[b].magic===p)return c[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,m,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var m=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(m),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=o(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var m,f,p,b=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<b;)m=g.readInt(2),f=g.readInt(2),p=g.readData(f),this.extraFields[m]={id:m,length:f,value:p};g.setIndex(b)},handleUTF8:function(){var g=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var f=i.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var b=i.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var m=o(g.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:u.utf8decode(m.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var m=o(g.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:u.utf8decode(m.readData(g.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,s){function o(m,f,p){this.name=m,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=f,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var i=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),l=t("./utf8"),u=t("./compressedObject"),c=t("./stream/GenericWorker");o.prototype={internalStream:function(m){var f=null,p="string";try{if(!m)throw new Error("No output type specified.");var b=(p=m.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),f=this._decompressWorker();var v=!this._dataBinary;v&&!b&&(f=f.pipe(new l.Utf8EncodeWorker)),!v&&b&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(w){(f=new c("error")).error(w)}return new i(f,p,"")},async:function(m,f){return this.internalStream(m).accumulate(f)},nodeStream:function(m,f){return this.internalStream(m||"nodebuffer").toNodejsStream(f)},_compressWorker:function(m,f){if(this._data instanceof u&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(p,m,f)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<h.length;g++)o.prototype[h[g]]=d;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,s){(function(o){var i,a,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var u=0,c=new l(m),h=o.document.createTextNode("");c.observe(h,{characterData:!0}),i=function(){h.data=u=++u%2}}else if(o.setImmediate||o.MessageChannel===void 0)i="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var f=o.document.createElement("script");f.onreadystatechange=function(){m(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},o.document.documentElement.appendChild(f)}:function(){setTimeout(m,0)};else{var d=new o.MessageChannel;d.port1.onmessage=m,i=function(){d.port2.postMessage(0)}}var g=[];function m(){var f,p;a=!0;for(var b=g.length;b;){for(p=g,g=[],f=-1;++f<b;)p[f]();b=g.length}a=!1}n.exports=function(f){g.push(f)!==1||a||i()}}).call(this,typeof Vr!="undefined"?Vr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(t,n,s){var o=t("immediate");function i(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function h(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==i&&f(this,b)}function d(b,v,w){this.promise=b,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function g(b,v,w){o(function(){var S;try{S=v(w)}catch(T){return a.reject(b,T)}S===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,S)})}function m(b){var v=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof v=="function")return function(){v.apply(b,arguments)}}function f(b,v){var w=!1;function S(R){w||(w=!0,a.reject(b,R))}function T(R){w||(w=!0,a.resolve(b,R))}var D=p(function(){v(T,S)});D.status==="error"&&S(D.value)}function p(b,v){var w={};try{w.value=b(v),w.status="success"}catch(S){w.status="error",w.value=S}return w}(n.exports=h).prototype.finally=function(b){if(typeof b!="function")return this;var v=this.constructor;return this.then(function(w){return v.resolve(b()).then(function(){return w})},function(w){return v.resolve(b()).then(function(){throw w})})},h.prototype.catch=function(b){return this.then(null,b)},h.prototype.then=function(b,v){if(typeof b!="function"&&this.state===u||typeof v!="function"&&this.state===l)return this;var w=new this.constructor(i);return this.state!==c?g(w,this.state===u?b:v,this.outcome):this.queue.push(new d(w,b,v)),w},d.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},d.prototype.otherCallFulfilled=function(b){g(this.promise,this.onFulfilled,b)},d.prototype.callRejected=function(b){a.reject(this.promise,b)},d.prototype.otherCallRejected=function(b){g(this.promise,this.onRejected,b)},a.resolve=function(b,v){var w=p(m,v);if(w.status==="error")return a.reject(b,w.value);var S=w.value;if(S)f(b,S);else{b.state=u,b.outcome=v;for(var T=-1,D=b.queue.length;++T<D;)b.queue[T].callFulfilled(v)}return b},a.reject=function(b,v){b.state=l,b.outcome=v;for(var w=-1,S=b.queue.length;++w<S;)b.queue[w].callRejected(v);return b},h.resolve=function(b){return b instanceof this?b:a.resolve(new this(i),b)},h.reject=function(b){var v=new this(i);return a.reject(v,b)},h.all=function(b){var v=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=b.length,S=!1;if(!w)return this.resolve([]);for(var T=new Array(w),D=0,R=-1,I=new this(i);++R<w;)y(b[R],R);return I;function y(O,M){v.resolve(O).then(function(F){T[M]=F,++D!==w||S||(S=!0,a.resolve(I,T))},function(F){S||(S=!0,a.reject(I,F))})}},h.race=function(b){var v=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=b.length,S=!1;if(!w)return this.resolve([]);for(var T=-1,D=new this(i);++T<w;)R=b[T],v.resolve(R).then(function(I){S||(S=!0,a.resolve(D,I))},function(I){S||(S=!0,a.reject(D,I))});var R;return D}},{immediate:36}],38:[function(t,n,s){var o={};(0,t("./lib/utils/common").assign)(o,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,s){var o=t("./zlib/deflate"),i=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,h=0,d=-1,g=0,m=8;function f(b){if(!(this instanceof f))return new f(b);this.options=i.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},b||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var w=o.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(w!==h)throw new Error(l[w]);if(v.header&&o.deflateSetHeader(this.strm,v.header),v.dictionary){var S;if(S=typeof v.dictionary=="string"?a.string2buf(v.dictionary):c.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(w=o.deflateSetDictionary(this.strm,S))!==h)throw new Error(l[w]);this._dict_set=!0}}function p(b,v){var w=new f(v);if(w.push(b,!0),w.err)throw w.msg||l[w.err];return w.result}f.prototype.push=function(b,v){var w,S,T=this.strm,D=this.options.chunkSize;if(this.ended)return!1;S=v===~~v?v:v===!0?4:0,typeof b=="string"?T.input=a.string2buf(b):c.call(b)==="[object ArrayBuffer]"?T.input=new Uint8Array(b):T.input=b,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new i.Buf8(D),T.next_out=0,T.avail_out=D),(w=o.deflate(T,S))!==1&&w!==h)return this.onEnd(w),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(i.shrinkBuf(T.output,T.next_out))):this.onData(i.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&w!==1);return S===4?(w=o.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===h):S!==2||(this.onEnd(h),!(T.avail_out=0))},f.prototype.onData=function(b){this.chunks.push(b)},f.prototype.onEnd=function(b){b===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Deflate=f,s.deflate=p,s.deflateRaw=function(b,v){return(v=v||{}).raw=!0,p(b,v)},s.gzip=function(b,v){return(v=v||{}).gzip=!0,p(b,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,s){var o=t("./zlib/inflate"),i=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=t("./zlib/gzheader"),d=Object.prototype.toString;function g(f){if(!(this instanceof g))return new g(f);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},f||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||f&&f.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&(15&p.windowBits)==0&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=o.inflateInit2(this.strm,p.windowBits);if(b!==l.Z_OK)throw new Error(u[b]);this.header=new h,o.inflateGetHeader(this.strm,this.header)}function m(f,p){var b=new g(p);if(b.push(f,!0),b.err)throw b.msg||u[b.err];return b.result}g.prototype.push=function(f,p){var b,v,w,S,T,D,R=this.strm,I=this.options.chunkSize,y=this.options.dictionary,O=!1;if(this.ended)return!1;v=p===~~p?p:p===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?R.input=a.binstring2buf(f):d.call(f)==="[object ArrayBuffer]"?R.input=new Uint8Array(f):R.input=f,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new i.Buf8(I),R.next_out=0,R.avail_out=I),(b=o.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&y&&(D=typeof y=="string"?a.string2buf(y):d.call(y)==="[object ArrayBuffer]"?new Uint8Array(y):y,b=o.inflateSetDictionary(this.strm,D)),b===l.Z_BUF_ERROR&&O===!0&&(b=l.Z_OK,O=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&b!==l.Z_STREAM_END&&(R.avail_in!==0||v!==l.Z_FINISH&&v!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=a.utf8border(R.output,R.next_out),S=R.next_out-w,T=a.buf2string(R.output,w),R.next_out=S,R.avail_out=I-S,S&&i.arraySet(R.output,R.output,w,S,0),this.onData(T)):this.onData(i.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(O=!0)}while((0<R.avail_in||R.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(v=l.Z_FINISH),v===l.Z_FINISH?(b=o.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):v!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},g.prototype.onData=function(f){this.chunks.push(f)},g.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},s.Inflate=g,s.inflate=m,s.inflateRaw=function(f,p){return(p=p||{}).raw=!0,m(f,p)},s.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,s){var o=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";s.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},s.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var i={arraySet:function(l,u,c,h,d){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+h),d);else for(var g=0;g<h;g++)l[d+g]=u[c+g]},flattenChunks:function(l){var u,c,h,d,g,m;for(u=h=0,c=l.length;u<c;u++)h+=l[u].length;for(m=new Uint8Array(h),u=d=0,c=l.length;u<c;u++)g=l[u],m.set(g,d),d+=g.length;return m}},a={arraySet:function(l,u,c,h,d){for(var g=0;g<h;g++)l[d+g]=u[c+g]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,i)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(o)},{}],42:[function(t,n,s){var o=t("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new o.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(h,d){if(d<65537&&(h.subarray&&a||!h.subarray&&i))return String.fromCharCode.apply(null,o.shrinkBuf(h,d));for(var g="",m=0;m<d;m++)g+=String.fromCharCode(h[m]);return g}l[254]=l[254]=1,s.string2buf=function(h){var d,g,m,f,p,b=h.length,v=0;for(f=0;f<b;f++)(64512&(g=h.charCodeAt(f)))==55296&&f+1<b&&(64512&(m=h.charCodeAt(f+1)))==56320&&(g=65536+(g-55296<<10)+(m-56320),f++),v+=g<128?1:g<2048?2:g<65536?3:4;for(d=new o.Buf8(v),f=p=0;p<v;f++)(64512&(g=h.charCodeAt(f)))==55296&&f+1<b&&(64512&(m=h.charCodeAt(f+1)))==56320&&(g=65536+(g-55296<<10)+(m-56320),f++),g<128?d[p++]=g:(g<2048?d[p++]=192|g>>>6:(g<65536?d[p++]=224|g>>>12:(d[p++]=240|g>>>18,d[p++]=128|g>>>12&63),d[p++]=128|g>>>6&63),d[p++]=128|63&g);return d},s.buf2binstring=function(h){return c(h,h.length)},s.binstring2buf=function(h){for(var d=new o.Buf8(h.length),g=0,m=d.length;g<m;g++)d[g]=h.charCodeAt(g);return d},s.buf2string=function(h,d){var g,m,f,p,b=d||h.length,v=new Array(2*b);for(g=m=0;g<b;)if((f=h[g++])<128)v[m++]=f;else if(4<(p=l[f]))v[m++]=65533,g+=p-1;else{for(f&=p===2?31:p===3?15:7;1<p&&g<b;)f=f<<6|63&h[g++],p--;1<p?v[m++]=65533:f<65536?v[m++]=f:(f-=65536,v[m++]=55296|f>>10&1023,v[m++]=56320|1023&f)}return c(v,m)},s.utf8border=function(h,d){var g;for((d=d||h.length)>h.length&&(d=h.length),g=d-1;0<=g&&(192&h[g])==128;)g--;return g<0||g===0?d:g+l[h[g]]>d?g:d}},{"./common":41}],43:[function(t,n,s){n.exports=function(o,i,a,l){for(var u=65535&o|0,c=o>>>16&65535|0,h=0;a!==0;){for(a-=h=2e3<a?2e3:a;c=c+(u=u+i[l++]|0)|0,--h;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(t,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,s){var o=function(){for(var i,a=[],l=0;l<256;l++){i=l;for(var u=0;u<8;u++)i=1&i?3988292384^i>>>1:i>>>1;a[l]=i}return a}();n.exports=function(i,a,l,u){var c=o,h=u+l;i^=-1;for(var d=u;d<h;d++)i=i>>>8^c[255&(i^a[d])];return-1^i}},{}],46:[function(t,n,s){var o,i=t("../utils/common"),a=t("./trees"),l=t("./adler32"),u=t("./crc32"),c=t("./messages"),h=0,d=4,g=0,m=-2,f=-1,p=4,b=2,v=8,w=9,S=286,T=30,D=19,R=2*S+1,I=15,y=3,O=258,M=O+y+1,F=42,x=113,E=1,N=2,X=3,L=4;function ne(A,se){return A.msg=c[se],se}function G(A){return(A<<1)-(4<A?9:0)}function Q(A){for(var se=A.length;0<=--se;)A[se]=0}function P(A){var se=A.state,re=se.pending;re>A.avail_out&&(re=A.avail_out),re!==0&&(i.arraySet(A.output,se.pending_buf,se.pending_out,re,A.next_out),A.next_out+=re,se.pending_out+=re,A.total_out+=re,A.avail_out-=re,se.pending-=re,se.pending===0&&(se.pending_out=0))}function V(A,se){a._tr_flush_block(A,0<=A.block_start?A.block_start:-1,A.strstart-A.block_start,se),A.block_start=A.strstart,P(A.strm)}function pe(A,se){A.pending_buf[A.pending++]=se}function oe(A,se){A.pending_buf[A.pending++]=se>>>8&255,A.pending_buf[A.pending++]=255&se}function Z(A,se){var re,B,k=A.max_chain_length,Y=A.strstart,le=A.prev_length,ae=A.nice_match,j=A.strstart>A.w_size-M?A.strstart-(A.w_size-M):0,he=A.window,H=A.w_mask,z=A.prev,J=A.strstart+O,ue=he[Y+le-1],de=he[Y+le];A.prev_length>=A.good_match&&(k>>=2),ae>A.lookahead&&(ae=A.lookahead);do if(he[(re=se)+le]===de&&he[re+le-1]===ue&&he[re]===he[Y]&&he[++re]===he[Y+1]){Y+=2,re++;do;while(he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&he[++Y]===he[++re]&&Y<J);if(B=O-(J-Y),Y=J-O,le<B){if(A.match_start=se,ae<=(le=B))break;ue=he[Y+le-1],de=he[Y+le]}}while((se=z[se&H])>j&&--k!=0);return le<=A.lookahead?le:A.lookahead}function ie(A){var se,re,B,k,Y,le,ae,j,he,H,z=A.w_size;do{if(k=A.window_size-A.lookahead-A.strstart,A.strstart>=z+(z-M)){for(i.arraySet(A.window,A.window,z,z,0),A.match_start-=z,A.strstart-=z,A.block_start-=z,se=re=A.hash_size;B=A.head[--se],A.head[se]=z<=B?B-z:0,--re;);for(se=re=z;B=A.prev[--se],A.prev[se]=z<=B?B-z:0,--re;);k+=z}if(A.strm.avail_in===0)break;if(le=A.strm,ae=A.window,j=A.strstart+A.lookahead,he=k,H=void 0,H=le.avail_in,he<H&&(H=he),re=H===0?0:(le.avail_in-=H,i.arraySet(ae,le.input,le.next_in,H,j),le.state.wrap===1?le.adler=l(le.adler,ae,H,j):le.state.wrap===2&&(le.adler=u(le.adler,ae,H,j)),le.next_in+=H,le.total_in+=H,H),A.lookahead+=re,A.lookahead+A.insert>=y)for(Y=A.strstart-A.insert,A.ins_h=A.window[Y],A.ins_h=(A.ins_h<<A.hash_shift^A.window[Y+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[Y+y-1])&A.hash_mask,A.prev[Y&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=Y,Y++,A.insert--,!(A.lookahead+A.insert<y)););}while(A.lookahead<M&&A.strm.avail_in!==0)}function be(A,se){for(var re,B;;){if(A.lookahead<M){if(ie(A),A.lookahead<M&&se===h)return E;if(A.lookahead===0)break}if(re=0,A.lookahead>=y&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+y-1])&A.hash_mask,re=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),re!==0&&A.strstart-re<=A.w_size-M&&(A.match_length=Z(A,re)),A.match_length>=y)if(B=a._tr_tally(A,A.strstart-A.match_start,A.match_length-y),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=y){for(A.match_length--;A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+y-1])&A.hash_mask,re=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart,--A.match_length!=0;);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else B=a._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(B&&(V(A,!1),A.strm.avail_out===0))return E}return A.insert=A.strstart<y-1?A.strstart:y-1,se===d?(V(A,!0),A.strm.avail_out===0?X:L):A.last_lit&&(V(A,!1),A.strm.avail_out===0)?E:N}function Ce(A,se){for(var re,B,k;;){if(A.lookahead<M){if(ie(A),A.lookahead<M&&se===h)return E;if(A.lookahead===0)break}if(re=0,A.lookahead>=y&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+y-1])&A.hash_mask,re=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=y-1,re!==0&&A.prev_length<A.max_lazy_match&&A.strstart-re<=A.w_size-M&&(A.match_length=Z(A,re),A.match_length<=5&&(A.strategy===1||A.match_length===y&&4096<A.strstart-A.match_start)&&(A.match_length=y-1)),A.prev_length>=y&&A.match_length<=A.prev_length){for(k=A.strstart+A.lookahead-y,B=a._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-y),A.lookahead-=A.prev_length-1,A.prev_length-=2;++A.strstart<=k&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+y-1])&A.hash_mask,re=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),--A.prev_length!=0;);if(A.match_available=0,A.match_length=y-1,A.strstart++,B&&(V(A,!1),A.strm.avail_out===0))return E}else if(A.match_available){if((B=a._tr_tally(A,0,A.window[A.strstart-1]))&&V(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return E}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(B=a._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<y-1?A.strstart:y-1,se===d?(V(A,!0),A.strm.avail_out===0?X:L):A.last_lit&&(V(A,!1),A.strm.avail_out===0)?E:N}function fe(A,se,re,B,k){this.good_length=A,this.max_lazy=se,this.nice_length=re,this.max_chain=B,this.func=k}function Te(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*R),this.dyn_dtree=new i.Buf16(2*(2*T+1)),this.bl_tree=new i.Buf16(2*(2*D+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(I+1),this.heap=new i.Buf16(2*S+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*S+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Le(A){var se;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=b,(se=A.state).pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?F:x,A.adler=se.wrap===2?0:1,se.last_flush=h,a._tr_init(se),g):ne(A,m)}function Ze(A){var se=Le(A);return se===g&&function(re){re.window_size=2*re.w_size,Q(re.head),re.max_lazy_match=o[re.level].max_lazy,re.good_match=o[re.level].good_length,re.nice_match=o[re.level].nice_length,re.max_chain_length=o[re.level].max_chain,re.strstart=0,re.block_start=0,re.lookahead=0,re.insert=0,re.match_length=re.prev_length=y-1,re.match_available=0,re.ins_h=0}(A.state),se}function Ne(A,se,re,B,k,Y){if(!A)return m;var le=1;if(se===f&&(se=6),B<0?(le=0,B=-B):15<B&&(le=2,B-=16),k<1||w<k||re!==v||B<8||15<B||se<0||9<se||Y<0||p<Y)return ne(A,m);B===8&&(B=9);var ae=new Te;return(A.state=ae).strm=A,ae.wrap=le,ae.gzhead=null,ae.w_bits=B,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=k+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+y-1)/y),ae.window=new i.Buf8(2*ae.w_size),ae.head=new i.Buf16(ae.hash_size),ae.prev=new i.Buf16(ae.w_size),ae.lit_bufsize=1<<k+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new i.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=se,ae.strategy=Y,ae.method=re,Ze(A)}o=[new fe(0,0,0,0,function(A,se){var re=65535;for(re>A.pending_buf_size-5&&(re=A.pending_buf_size-5);;){if(A.lookahead<=1){if(ie(A),A.lookahead===0&&se===h)return E;if(A.lookahead===0)break}A.strstart+=A.lookahead,A.lookahead=0;var B=A.block_start+re;if((A.strstart===0||A.strstart>=B)&&(A.lookahead=A.strstart-B,A.strstart=B,V(A,!1),A.strm.avail_out===0)||A.strstart-A.block_start>=A.w_size-M&&(V(A,!1),A.strm.avail_out===0))return E}return A.insert=0,se===d?(V(A,!0),A.strm.avail_out===0?X:L):(A.strstart>A.block_start&&(V(A,!1),A.strm.avail_out),E)}),new fe(4,4,8,4,be),new fe(4,5,16,8,be),new fe(4,6,32,32,be),new fe(4,4,16,16,Ce),new fe(8,16,32,32,Ce),new fe(8,16,128,128,Ce),new fe(8,32,128,256,Ce),new fe(32,128,258,1024,Ce),new fe(32,258,258,4096,Ce)],s.deflateInit=function(A,se){return Ne(A,se,v,15,8,0)},s.deflateInit2=Ne,s.deflateReset=Ze,s.deflateResetKeep=Le,s.deflateSetHeader=function(A,se){return A&&A.state?A.state.wrap!==2?m:(A.state.gzhead=se,g):m},s.deflate=function(A,se){var re,B,k,Y;if(!A||!A.state||5<se||se<0)return A?ne(A,m):m;if(B=A.state,!A.output||!A.input&&A.avail_in!==0||B.status===666&&se!==d)return ne(A,A.avail_out===0?-5:m);if(B.strm=A,re=B.last_flush,B.last_flush=se,B.status===F)if(B.wrap===2)A.adler=0,pe(B,31),pe(B,139),pe(B,8),B.gzhead?(pe(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),pe(B,255&B.gzhead.time),pe(B,B.gzhead.time>>8&255),pe(B,B.gzhead.time>>16&255),pe(B,B.gzhead.time>>24&255),pe(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),pe(B,255&B.gzhead.os),B.gzhead.extra&&B.gzhead.extra.length&&(pe(B,255&B.gzhead.extra.length),pe(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(A.adler=u(A.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=69):(pe(B,0),pe(B,0),pe(B,0),pe(B,0),pe(B,0),pe(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),pe(B,3),B.status=x);else{var le=v+(B.w_bits-8<<4)<<8;le|=(2<=B.strategy||B.level<2?0:B.level<6?1:B.level===6?2:3)<<6,B.strstart!==0&&(le|=32),le+=31-le%31,B.status=x,oe(B,le),B.strstart!==0&&(oe(B,A.adler>>>16),oe(B,65535&A.adler)),A.adler=1}if(B.status===69)if(B.gzhead.extra){for(k=B.pending;B.gzindex<(65535&B.gzhead.extra.length)&&(B.pending!==B.pending_buf_size||(B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),P(A),k=B.pending,B.pending!==B.pending_buf_size));)pe(B,255&B.gzhead.extra[B.gzindex]),B.gzindex++;B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=73)}else B.status=73;if(B.status===73)if(B.gzhead.name){k=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),P(A),k=B.pending,B.pending===B.pending_buf_size)){Y=1;break}Y=B.gzindex<B.gzhead.name.length?255&B.gzhead.name.charCodeAt(B.gzindex++):0,pe(B,Y)}while(Y!==0);B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),Y===0&&(B.gzindex=0,B.status=91)}else B.status=91;if(B.status===91)if(B.gzhead.comment){k=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),P(A),k=B.pending,B.pending===B.pending_buf_size)){Y=1;break}Y=B.gzindex<B.gzhead.comment.length?255&B.gzhead.comment.charCodeAt(B.gzindex++):0,pe(B,Y)}while(Y!==0);B.gzhead.hcrc&&B.pending>k&&(A.adler=u(A.adler,B.pending_buf,B.pending-k,k)),Y===0&&(B.status=103)}else B.status=103;if(B.status===103&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&P(A),B.pending+2<=B.pending_buf_size&&(pe(B,255&A.adler),pe(B,A.adler>>8&255),A.adler=0,B.status=x)):B.status=x),B.pending!==0){if(P(A),A.avail_out===0)return B.last_flush=-1,g}else if(A.avail_in===0&&G(se)<=G(re)&&se!==d)return ne(A,-5);if(B.status===666&&A.avail_in!==0)return ne(A,-5);if(A.avail_in!==0||B.lookahead!==0||se!==h&&B.status!==666){var ae=B.strategy===2?function(j,he){for(var H;;){if(j.lookahead===0&&(ie(j),j.lookahead===0)){if(he===h)return E;break}if(j.match_length=0,H=a._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++,H&&(V(j,!1),j.strm.avail_out===0))return E}return j.insert=0,he===d?(V(j,!0),j.strm.avail_out===0?X:L):j.last_lit&&(V(j,!1),j.strm.avail_out===0)?E:N}(B,se):B.strategy===3?function(j,he){for(var H,z,J,ue,de=j.window;;){if(j.lookahead<=O){if(ie(j),j.lookahead<=O&&he===h)return E;if(j.lookahead===0)break}if(j.match_length=0,j.lookahead>=y&&0<j.strstart&&(z=de[J=j.strstart-1])===de[++J]&&z===de[++J]&&z===de[++J]){ue=j.strstart+O;do;while(z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&J<ue);j.match_length=O-(ue-J),j.match_length>j.lookahead&&(j.match_length=j.lookahead)}if(j.match_length>=y?(H=a._tr_tally(j,1,j.match_length-y),j.lookahead-=j.match_length,j.strstart+=j.match_length,j.match_length=0):(H=a._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++),H&&(V(j,!1),j.strm.avail_out===0))return E}return j.insert=0,he===d?(V(j,!0),j.strm.avail_out===0?X:L):j.last_lit&&(V(j,!1),j.strm.avail_out===0)?E:N}(B,se):o[B.level].func(B,se);if(ae!==X&&ae!==L||(B.status=666),ae===E||ae===X)return A.avail_out===0&&(B.last_flush=-1),g;if(ae===N&&(se===1?a._tr_align(B):se!==5&&(a._tr_stored_block(B,0,0,!1),se===3&&(Q(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),P(A),A.avail_out===0))return B.last_flush=-1,g}return se!==d?g:B.wrap<=0?1:(B.wrap===2?(pe(B,255&A.adler),pe(B,A.adler>>8&255),pe(B,A.adler>>16&255),pe(B,A.adler>>24&255),pe(B,255&A.total_in),pe(B,A.total_in>>8&255),pe(B,A.total_in>>16&255),pe(B,A.total_in>>24&255)):(oe(B,A.adler>>>16),oe(B,65535&A.adler)),P(A),0<B.wrap&&(B.wrap=-B.wrap),B.pending!==0?g:1)},s.deflateEnd=function(A){var se;return A&&A.state?(se=A.state.status)!==F&&se!==69&&se!==73&&se!==91&&se!==103&&se!==x&&se!==666?ne(A,m):(A.state=null,se===x?ne(A,-3):g):m},s.deflateSetDictionary=function(A,se){var re,B,k,Y,le,ae,j,he,H=se.length;if(!A||!A.state||(Y=(re=A.state).wrap)===2||Y===1&&re.status!==F||re.lookahead)return m;for(Y===1&&(A.adler=l(A.adler,se,H,0)),re.wrap=0,H>=re.w_size&&(Y===0&&(Q(re.head),re.strstart=0,re.block_start=0,re.insert=0),he=new i.Buf8(re.w_size),i.arraySet(he,se,H-re.w_size,re.w_size,0),se=he,H=re.w_size),le=A.avail_in,ae=A.next_in,j=A.input,A.avail_in=H,A.next_in=0,A.input=se,ie(re);re.lookahead>=y;){for(B=re.strstart,k=re.lookahead-(y-1);re.ins_h=(re.ins_h<<re.hash_shift^re.window[B+y-1])&re.hash_mask,re.prev[B&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=B,B++,--k;);re.strstart=B,re.lookahead=y-1,ie(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=y-1,re.match_available=0,A.next_in=ae,A.input=j,A.avail_in=le,re.wrap=Y,g},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,s){n.exports=function(o,i){var a,l,u,c,h,d,g,m,f,p,b,v,w,S,T,D,R,I,y,O,M,F,x,E,N;a=o.state,l=o.next_in,E=o.input,u=l+(o.avail_in-5),c=o.next_out,N=o.output,h=c-(i-o.avail_out),d=c+(o.avail_out-257),g=a.dmax,m=a.wsize,f=a.whave,p=a.wnext,b=a.window,v=a.hold,w=a.bits,S=a.lencode,T=a.distcode,D=(1<<a.lenbits)-1,R=(1<<a.distbits)-1;e:do{w<15&&(v+=E[l++]<<w,w+=8,v+=E[l++]<<w,w+=8),I=S[v&D];t:for(;;){if(v>>>=y=I>>>24,w-=y,(y=I>>>16&255)===0)N[c++]=65535&I;else{if(!(16&y)){if((64&y)==0){I=S[(65535&I)+(v&(1<<y)-1)];continue t}if(32&y){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}O=65535&I,(y&=15)&&(w<y&&(v+=E[l++]<<w,w+=8),O+=v&(1<<y)-1,v>>>=y,w-=y),w<15&&(v+=E[l++]<<w,w+=8,v+=E[l++]<<w,w+=8),I=T[v&R];n:for(;;){if(v>>>=y=I>>>24,w-=y,!(16&(y=I>>>16&255))){if((64&y)==0){I=T[(65535&I)+(v&(1<<y)-1)];continue n}o.msg="invalid distance code",a.mode=30;break e}if(M=65535&I,w<(y&=15)&&(v+=E[l++]<<w,(w+=8)<y&&(v+=E[l++]<<w,w+=8)),g<(M+=v&(1<<y)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(v>>>=y,w-=y,(y=c-h)<M){if(f<(y=M-y)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(x=b,(F=0)===p){if(F+=m-y,y<O){for(O-=y;N[c++]=b[F++],--y;);F=c-M,x=N}}else if(p<y){if(F+=m+p-y,(y-=p)<O){for(O-=y;N[c++]=b[F++],--y;);if(F=0,p<O){for(O-=y=p;N[c++]=b[F++],--y;);F=c-M,x=N}}}else if(F+=p-y,y<O){for(O-=y;N[c++]=b[F++],--y;);F=c-M,x=N}for(;2<O;)N[c++]=x[F++],N[c++]=x[F++],N[c++]=x[F++],O-=3;O&&(N[c++]=x[F++],1<O&&(N[c++]=x[F++]))}else{for(F=c-M;N[c++]=N[F++],N[c++]=N[F++],N[c++]=N[F++],2<(O-=3););O&&(N[c++]=N[F++],1<O&&(N[c++]=N[F++]))}break}}break}}while(l<u&&c<d);l-=O=w>>3,v&=(1<<(w-=O<<3))-1,o.next_in=l,o.next_out=c,o.avail_in=l<u?u-l+5:5-(l-u),o.avail_out=c<d?d-c+257:257-(c-d),a.hold=v,a.bits=w}},{}],49:[function(t,n,s){var o=t("../utils/common"),i=t("./adler32"),a=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=1,h=2,d=0,g=-2,m=1,f=852,p=592;function b(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(F){var x;return F&&F.state?(x=F.state,F.total_in=F.total_out=x.total=0,F.msg="",x.wrap&&(F.adler=1&x.wrap),x.mode=m,x.last=0,x.havedict=0,x.dmax=32768,x.head=null,x.hold=0,x.bits=0,x.lencode=x.lendyn=new o.Buf32(f),x.distcode=x.distdyn=new o.Buf32(p),x.sane=1,x.back=-1,d):g}function S(F){var x;return F&&F.state?((x=F.state).wsize=0,x.whave=0,x.wnext=0,w(F)):g}function T(F,x){var E,N;return F&&F.state?(N=F.state,x<0?(E=0,x=-x):(E=1+(x>>4),x<48&&(x&=15)),x&&(x<8||15<x)?g:(N.window!==null&&N.wbits!==x&&(N.window=null),N.wrap=E,N.wbits=x,S(F))):g}function D(F,x){var E,N;return F?(N=new v,(F.state=N).window=null,(E=T(F,x))!==d&&(F.state=null),E):g}var R,I,y=!0;function O(F){if(y){var x;for(R=new o.Buf32(512),I=new o.Buf32(32),x=0;x<144;)F.lens[x++]=8;for(;x<256;)F.lens[x++]=9;for(;x<280;)F.lens[x++]=7;for(;x<288;)F.lens[x++]=8;for(u(c,F.lens,0,288,R,0,F.work,{bits:9}),x=0;x<32;)F.lens[x++]=5;u(h,F.lens,0,32,I,0,F.work,{bits:5}),y=!1}F.lencode=R,F.lenbits=9,F.distcode=I,F.distbits=5}function M(F,x,E,N){var X,L=F.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new o.Buf8(L.wsize)),N>=L.wsize?(o.arraySet(L.window,x,E-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(N<(X=L.wsize-L.wnext)&&(X=N),o.arraySet(L.window,x,E-N,X,L.wnext),(N-=X)?(o.arraySet(L.window,x,E-N,N,0),L.wnext=N,L.whave=L.wsize):(L.wnext+=X,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=X))),0}s.inflateReset=S,s.inflateReset2=T,s.inflateResetKeep=w,s.inflateInit=function(F){return D(F,15)},s.inflateInit2=D,s.inflate=function(F,x){var E,N,X,L,ne,G,Q,P,V,pe,oe,Z,ie,be,Ce,fe,Te,Le,Ze,Ne,A,se,re,B,k=0,Y=new o.Buf8(4),le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return g;(E=F.state).mode===12&&(E.mode=13),ne=F.next_out,X=F.output,Q=F.avail_out,L=F.next_in,N=F.input,G=F.avail_in,P=E.hold,V=E.bits,pe=G,oe=Q,se=d;e:for(;;)switch(E.mode){case m:if(E.wrap===0){E.mode=13;break}for(;V<16;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(2&E.wrap&&P===35615){Y[E.check=0]=255&P,Y[1]=P>>>8&255,E.check=a(E.check,Y,2,0),V=P=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&P)<<8)+(P>>8))%31){F.msg="incorrect header check",E.mode=30;break}if((15&P)!=8){F.msg="unknown compression method",E.mode=30;break}if(V-=4,A=8+(15&(P>>>=4)),E.wbits===0)E.wbits=A;else if(A>E.wbits){F.msg="invalid window size",E.mode=30;break}E.dmax=1<<A,F.adler=E.check=1,E.mode=512&P?10:12,V=P=0;break;case 2:for(;V<16;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(E.flags=P,(255&E.flags)!=8){F.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){F.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=P>>8&1),512&E.flags&&(Y[0]=255&P,Y[1]=P>>>8&255,E.check=a(E.check,Y,2,0)),V=P=0,E.mode=3;case 3:for(;V<32;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.head&&(E.head.time=P),512&E.flags&&(Y[0]=255&P,Y[1]=P>>>8&255,Y[2]=P>>>16&255,Y[3]=P>>>24&255,E.check=a(E.check,Y,4,0)),V=P=0,E.mode=4;case 4:for(;V<16;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.head&&(E.head.xflags=255&P,E.head.os=P>>8),512&E.flags&&(Y[0]=255&P,Y[1]=P>>>8&255,E.check=a(E.check,Y,2,0)),V=P=0,E.mode=5;case 5:if(1024&E.flags){for(;V<16;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.length=P,E.head&&(E.head.extra_len=P),512&E.flags&&(Y[0]=255&P,Y[1]=P>>>8&255,E.check=a(E.check,Y,2,0)),V=P=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(G<(Z=E.length)&&(Z=G),Z&&(E.head&&(A=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),o.arraySet(E.head.extra,N,L,Z,A)),512&E.flags&&(E.check=a(E.check,N,Z,L)),G-=Z,L+=Z,E.length-=Z),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(G===0)break e;for(Z=0;A=N[L+Z++],E.head&&A&&E.length<65536&&(E.head.name+=String.fromCharCode(A)),A&&Z<G;);if(512&E.flags&&(E.check=a(E.check,N,Z,L)),G-=Z,L+=Z,A)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(G===0)break e;for(Z=0;A=N[L+Z++],E.head&&A&&E.length<65536&&(E.head.comment+=String.fromCharCode(A)),A&&Z<G;);if(512&E.flags&&(E.check=a(E.check,N,Z,L)),G-=Z,L+=Z,A)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;V<16;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(P!==(65535&E.check)){F.msg="header crc mismatch",E.mode=30;break}V=P=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),F.adler=E.check=0,E.mode=12;break;case 10:for(;V<32;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}F.adler=E.check=b(P),V=P=0,E.mode=11;case 11:if(E.havedict===0)return F.next_out=ne,F.avail_out=Q,F.next_in=L,F.avail_in=G,E.hold=P,E.bits=V,2;F.adler=E.check=1,E.mode=12;case 12:if(x===5||x===6)break e;case 13:if(E.last){P>>>=7&V,V-=7&V,E.mode=27;break}for(;V<3;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}switch(E.last=1&P,V-=1,3&(P>>>=1)){case 0:E.mode=14;break;case 1:if(O(E),E.mode=20,x!==6)break;P>>>=2,V-=2;break e;case 2:E.mode=17;break;case 3:F.msg="invalid block type",E.mode=30}P>>>=2,V-=2;break;case 14:for(P>>>=7&V,V-=7&V;V<32;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if((65535&P)!=(P>>>16^65535)){F.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&P,V=P=0,E.mode=15,x===6)break e;case 15:E.mode=16;case 16:if(Z=E.length){if(G<Z&&(Z=G),Q<Z&&(Z=Q),Z===0)break e;o.arraySet(X,N,L,Z,ne),G-=Z,L+=Z,Q-=Z,ne+=Z,E.length-=Z;break}E.mode=12;break;case 17:for(;V<14;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(E.nlen=257+(31&P),P>>>=5,V-=5,E.ndist=1+(31&P),P>>>=5,V-=5,E.ncode=4+(15&P),P>>>=4,V-=4,286<E.nlen||30<E.ndist){F.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;V<3;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.lens[le[E.have++]]=7&P,P>>>=3,V-=3}for(;E.have<19;)E.lens[le[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,re={bits:E.lenbits},se=u(0,E.lens,0,19,E.lencode,0,E.work,re),E.lenbits=re.bits,se){F.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;fe=(k=E.lencode[P&(1<<E.lenbits)-1])>>>16&255,Te=65535&k,!((Ce=k>>>24)<=V);){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(Te<16)P>>>=Ce,V-=Ce,E.lens[E.have++]=Te;else{if(Te===16){for(B=Ce+2;V<B;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(P>>>=Ce,V-=Ce,E.have===0){F.msg="invalid bit length repeat",E.mode=30;break}A=E.lens[E.have-1],Z=3+(3&P),P>>>=2,V-=2}else if(Te===17){for(B=Ce+3;V<B;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}V-=Ce,A=0,Z=3+(7&(P>>>=Ce)),P>>>=3,V-=3}else{for(B=Ce+7;V<B;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}V-=Ce,A=0,Z=11+(127&(P>>>=Ce)),P>>>=7,V-=7}if(E.have+Z>E.nlen+E.ndist){F.msg="invalid bit length repeat",E.mode=30;break}for(;Z--;)E.lens[E.have++]=A}}if(E.mode===30)break;if(E.lens[256]===0){F.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,re={bits:E.lenbits},se=u(c,E.lens,0,E.nlen,E.lencode,0,E.work,re),E.lenbits=re.bits,se){F.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,re={bits:E.distbits},se=u(h,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,re),E.distbits=re.bits,se){F.msg="invalid distances set",E.mode=30;break}if(E.mode=20,x===6)break e;case 20:E.mode=21;case 21:if(6<=G&&258<=Q){F.next_out=ne,F.avail_out=Q,F.next_in=L,F.avail_in=G,E.hold=P,E.bits=V,l(F,oe),ne=F.next_out,X=F.output,Q=F.avail_out,L=F.next_in,N=F.input,G=F.avail_in,P=E.hold,V=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;fe=(k=E.lencode[P&(1<<E.lenbits)-1])>>>16&255,Te=65535&k,!((Ce=k>>>24)<=V);){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(fe&&(240&fe)==0){for(Le=Ce,Ze=fe,Ne=Te;fe=(k=E.lencode[Ne+((P&(1<<Le+Ze)-1)>>Le)])>>>16&255,Te=65535&k,!(Le+(Ce=k>>>24)<=V);){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}P>>>=Le,V-=Le,E.back+=Le}if(P>>>=Ce,V-=Ce,E.back+=Ce,E.length=Te,fe===0){E.mode=26;break}if(32&fe){E.back=-1,E.mode=12;break}if(64&fe){F.msg="invalid literal/length code",E.mode=30;break}E.extra=15&fe,E.mode=22;case 22:if(E.extra){for(B=E.extra;V<B;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.length+=P&(1<<E.extra)-1,P>>>=E.extra,V-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;fe=(k=E.distcode[P&(1<<E.distbits)-1])>>>16&255,Te=65535&k,!((Ce=k>>>24)<=V);){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if((240&fe)==0){for(Le=Ce,Ze=fe,Ne=Te;fe=(k=E.distcode[Ne+((P&(1<<Le+Ze)-1)>>Le)])>>>16&255,Te=65535&k,!(Le+(Ce=k>>>24)<=V);){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}P>>>=Le,V-=Le,E.back+=Le}if(P>>>=Ce,V-=Ce,E.back+=Ce,64&fe){F.msg="invalid distance code",E.mode=30;break}E.offset=Te,E.extra=15&fe,E.mode=24;case 24:if(E.extra){for(B=E.extra;V<B;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}E.offset+=P&(1<<E.extra)-1,P>>>=E.extra,V-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){F.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(Q===0)break e;if(Z=oe-Q,E.offset>Z){if((Z=E.offset-Z)>E.whave&&E.sane){F.msg="invalid distance too far back",E.mode=30;break}ie=Z>E.wnext?(Z-=E.wnext,E.wsize-Z):E.wnext-Z,Z>E.length&&(Z=E.length),be=E.window}else be=X,ie=ne-E.offset,Z=E.length;for(Q<Z&&(Z=Q),Q-=Z,E.length-=Z;X[ne++]=be[ie++],--Z;);E.length===0&&(E.mode=21);break;case 26:if(Q===0)break e;X[ne++]=E.length,Q--,E.mode=21;break;case 27:if(E.wrap){for(;V<32;){if(G===0)break e;G--,P|=N[L++]<<V,V+=8}if(oe-=Q,F.total_out+=oe,E.total+=oe,oe&&(F.adler=E.check=E.flags?a(E.check,X,oe,ne-oe):i(E.check,X,oe,ne-oe)),oe=Q,(E.flags?P:b(P))!==E.check){F.msg="incorrect data check",E.mode=30;break}V=P=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;V<32;){if(G===0)break e;G--,P+=N[L++]<<V,V+=8}if(P!==(4294967295&E.total)){F.msg="incorrect length check",E.mode=30;break}V=P=0}E.mode=29;case 29:se=1;break e;case 30:se=-3;break e;case 31:return-4;case 32:default:return g}return F.next_out=ne,F.avail_out=Q,F.next_in=L,F.avail_in=G,E.hold=P,E.bits=V,(E.wsize||oe!==F.avail_out&&E.mode<30&&(E.mode<27||x!==4))&&M(F,F.output,F.next_out,oe-F.avail_out)?(E.mode=31,-4):(pe-=F.avail_in,oe-=F.avail_out,F.total_in+=pe,F.total_out+=oe,E.total+=oe,E.wrap&&oe&&(F.adler=E.check=E.flags?a(E.check,X,oe,F.next_out-oe):i(E.check,X,oe,F.next_out-oe)),F.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(pe==0&&oe===0||x===4)&&se===d&&(se=-5),se)},s.inflateEnd=function(F){if(!F||!F.state)return g;var x=F.state;return x.window&&(x.window=null),F.state=null,d},s.inflateGetHeader=function(F,x){var E;return F&&F.state?(2&(E=F.state).wrap)==0?g:((E.head=x).done=!1,d):g},s.inflateSetDictionary=function(F,x){var E,N=x.length;return F&&F.state?(E=F.state).wrap!==0&&E.mode!==11?g:E.mode===11&&i(1,x,N,0)!==E.check?-3:M(F,x,N,N)?(E.mode=31,-4):(E.havedict=1,d):g},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,s){var o=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,h,d,g,m,f,p,b){var v,w,S,T,D,R,I,y,O,M=b.bits,F=0,x=0,E=0,N=0,X=0,L=0,ne=0,G=0,Q=0,P=0,V=null,pe=0,oe=new o.Buf16(16),Z=new o.Buf16(16),ie=null,be=0;for(F=0;F<=15;F++)oe[F]=0;for(x=0;x<g;x++)oe[h[d+x]]++;for(X=M,N=15;1<=N&&oe[N]===0;N--);if(N<X&&(X=N),N===0)return m[f++]=20971520,m[f++]=20971520,b.bits=1,0;for(E=1;E<N&&oe[E]===0;E++);for(X<E&&(X=E),F=G=1;F<=15;F++)if(G<<=1,(G-=oe[F])<0)return-1;if(0<G&&(c===0||N!==1))return-1;for(Z[1]=0,F=1;F<15;F++)Z[F+1]=Z[F]+oe[F];for(x=0;x<g;x++)h[d+x]!==0&&(p[Z[h[d+x]]++]=x);if(R=c===0?(V=ie=p,19):c===1?(V=i,pe-=257,ie=a,be-=257,256):(V=l,ie=u,-1),F=E,D=f,ne=x=P=0,S=-1,T=(Q=1<<(L=X))-1,c===1&&852<Q||c===2&&592<Q)return 1;for(;;){for(I=F-ne,O=p[x]<R?(y=0,p[x]):p[x]>R?(y=ie[be+p[x]],V[pe+p[x]]):(y=96,0),v=1<<F-ne,E=w=1<<L;m[D+(P>>ne)+(w-=v)]=I<<24|y<<16|O|0,w!==0;);for(v=1<<F-1;P&v;)v>>=1;if(v!==0?(P&=v-1,P+=v):P=0,x++,--oe[F]==0){if(F===N)break;F=h[d+p[x]]}if(X<F&&(P&T)!==S){for(ne===0&&(ne=X),D+=E,G=1<<(L=F-ne);L+ne<N&&!((G-=oe[L+ne])<=0);)L++,G<<=1;if(Q+=1<<L,c===1&&852<Q||c===2&&592<Q)return 1;m[S=P&T]=X<<24|L<<16|D-f|0}}return P!==0&&(m[D+P]=F-ne<<24|4194304|0),b.bits=X,0}},{"../utils/common":41}],51:[function(t,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,s){var o=t("../utils/common"),i=0,a=1;function l(k){for(var Y=k.length;0<=--Y;)k[Y]=0}var u=0,c=29,h=256,d=h+1+c,g=30,m=19,f=2*d+1,p=15,b=16,v=7,w=256,S=16,T=17,D=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(d+2));l(M);var F=new Array(2*g);l(F);var x=new Array(512);l(x);var E=new Array(256);l(E);var N=new Array(c);l(N);var X,L,ne,G=new Array(g);function Q(k,Y,le,ae,j){this.static_tree=k,this.extra_bits=Y,this.extra_base=le,this.elems=ae,this.max_length=j,this.has_stree=k&&k.length}function P(k,Y){this.dyn_tree=k,this.max_code=0,this.stat_desc=Y}function V(k){return k<256?x[k]:x[256+(k>>>7)]}function pe(k,Y){k.pending_buf[k.pending++]=255&Y,k.pending_buf[k.pending++]=Y>>>8&255}function oe(k,Y,le){k.bi_valid>b-le?(k.bi_buf|=Y<<k.bi_valid&65535,pe(k,k.bi_buf),k.bi_buf=Y>>b-k.bi_valid,k.bi_valid+=le-b):(k.bi_buf|=Y<<k.bi_valid&65535,k.bi_valid+=le)}function Z(k,Y,le){oe(k,le[2*Y],le[2*Y+1])}function ie(k,Y){for(var le=0;le|=1&k,k>>>=1,le<<=1,0<--Y;);return le>>>1}function be(k,Y,le){var ae,j,he=new Array(p+1),H=0;for(ae=1;ae<=p;ae++)he[ae]=H=H+le[ae-1]<<1;for(j=0;j<=Y;j++){var z=k[2*j+1];z!==0&&(k[2*j]=ie(he[z]++,z))}}function Ce(k){var Y;for(Y=0;Y<d;Y++)k.dyn_ltree[2*Y]=0;for(Y=0;Y<g;Y++)k.dyn_dtree[2*Y]=0;for(Y=0;Y<m;Y++)k.bl_tree[2*Y]=0;k.dyn_ltree[2*w]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function fe(k){8<k.bi_valid?pe(k,k.bi_buf):0<k.bi_valid&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function Te(k,Y,le,ae){var j=2*Y,he=2*le;return k[j]<k[he]||k[j]===k[he]&&ae[Y]<=ae[le]}function Le(k,Y,le){for(var ae=k.heap[le],j=le<<1;j<=k.heap_len&&(j<k.heap_len&&Te(Y,k.heap[j+1],k.heap[j],k.depth)&&j++,!Te(Y,ae,k.heap[j],k.depth));)k.heap[le]=k.heap[j],le=j,j<<=1;k.heap[le]=ae}function Ze(k,Y,le){var ae,j,he,H,z=0;if(k.last_lit!==0)for(;ae=k.pending_buf[k.d_buf+2*z]<<8|k.pending_buf[k.d_buf+2*z+1],j=k.pending_buf[k.l_buf+z],z++,ae===0?Z(k,j,Y):(Z(k,(he=E[j])+h+1,Y),(H=R[he])!==0&&oe(k,j-=N[he],H),Z(k,he=V(--ae),le),(H=I[he])!==0&&oe(k,ae-=G[he],H)),z<k.last_lit;);Z(k,w,Y)}function Ne(k,Y){var le,ae,j,he=Y.dyn_tree,H=Y.stat_desc.static_tree,z=Y.stat_desc.has_stree,J=Y.stat_desc.elems,ue=-1;for(k.heap_len=0,k.heap_max=f,le=0;le<J;le++)he[2*le]!==0?(k.heap[++k.heap_len]=ue=le,k.depth[le]=0):he[2*le+1]=0;for(;k.heap_len<2;)he[2*(j=k.heap[++k.heap_len]=ue<2?++ue:0)]=1,k.depth[j]=0,k.opt_len--,z&&(k.static_len-=H[2*j+1]);for(Y.max_code=ue,le=k.heap_len>>1;1<=le;le--)Le(k,he,le);for(j=J;le=k.heap[1],k.heap[1]=k.heap[k.heap_len--],Le(k,he,1),ae=k.heap[1],k.heap[--k.heap_max]=le,k.heap[--k.heap_max]=ae,he[2*j]=he[2*le]+he[2*ae],k.depth[j]=(k.depth[le]>=k.depth[ae]?k.depth[le]:k.depth[ae])+1,he[2*le+1]=he[2*ae+1]=j,k.heap[1]=j++,Le(k,he,1),2<=k.heap_len;);k.heap[--k.heap_max]=k.heap[1],function(de,ze){var De,Be,ce,Se,ve,$e,Ve=ze.dyn_tree,qe=ze.max_code,U=ze.stat_desc.static_tree,q=ze.stat_desc.has_stree,Je=ze.stat_desc.extra_bits,Ws=ze.stat_desc.extra_base,ls=ze.stat_desc.max_length,Ko=0;for(Se=0;Se<=p;Se++)de.bl_count[Se]=0;for(Ve[2*de.heap[de.heap_max]+1]=0,De=de.heap_max+1;De<f;De++)ls<(Se=Ve[2*Ve[2*(Be=de.heap[De])+1]+1]+1)&&(Se=ls,Ko++),Ve[2*Be+1]=Se,qe<Be||(de.bl_count[Se]++,ve=0,Ws<=Be&&(ve=Je[Be-Ws]),$e=Ve[2*Be],de.opt_len+=$e*(Se+ve),q&&(de.static_len+=$e*(U[2*Be+1]+ve)));if(Ko!==0){do{for(Se=ls-1;de.bl_count[Se]===0;)Se--;de.bl_count[Se]--,de.bl_count[Se+1]+=2,de.bl_count[ls]--,Ko-=2}while(0<Ko);for(Se=ls;Se!==0;Se--)for(Be=de.bl_count[Se];Be!==0;)qe<(ce=de.heap[--De])||(Ve[2*ce+1]!==Se&&(de.opt_len+=(Se-Ve[2*ce+1])*Ve[2*ce],Ve[2*ce+1]=Se),Be--)}}(k,Y),be(he,ue,k.bl_count)}function A(k,Y,le){var ae,j,he=-1,H=Y[1],z=0,J=7,ue=4;for(H===0&&(J=138,ue=3),Y[2*(le+1)+1]=65535,ae=0;ae<=le;ae++)j=H,H=Y[2*(ae+1)+1],++z<J&&j===H||(z<ue?k.bl_tree[2*j]+=z:j!==0?(j!==he&&k.bl_tree[2*j]++,k.bl_tree[2*S]++):z<=10?k.bl_tree[2*T]++:k.bl_tree[2*D]++,he=j,ue=(z=0)===H?(J=138,3):j===H?(J=6,3):(J=7,4))}function se(k,Y,le){var ae,j,he=-1,H=Y[1],z=0,J=7,ue=4;for(H===0&&(J=138,ue=3),ae=0;ae<=le;ae++)if(j=H,H=Y[2*(ae+1)+1],!(++z<J&&j===H)){if(z<ue)for(;Z(k,j,k.bl_tree),--z!=0;);else j!==0?(j!==he&&(Z(k,j,k.bl_tree),z--),Z(k,S,k.bl_tree),oe(k,z-3,2)):z<=10?(Z(k,T,k.bl_tree),oe(k,z-3,3)):(Z(k,D,k.bl_tree),oe(k,z-11,7));he=j,ue=(z=0)===H?(J=138,3):j===H?(J=6,3):(J=7,4)}}l(G);var re=!1;function B(k,Y,le,ae){oe(k,(u<<1)+(ae?1:0),3),function(j,he,H,z){fe(j),z&&(pe(j,H),pe(j,~H)),o.arraySet(j.pending_buf,j.window,he,H,j.pending),j.pending+=H}(k,Y,le,!0)}s._tr_init=function(k){re||(function(){var Y,le,ae,j,he,H=new Array(p+1);for(j=ae=0;j<c-1;j++)for(N[j]=ae,Y=0;Y<1<<R[j];Y++)E[ae++]=j;for(E[ae-1]=j,j=he=0;j<16;j++)for(G[j]=he,Y=0;Y<1<<I[j];Y++)x[he++]=j;for(he>>=7;j<g;j++)for(G[j]=he<<7,Y=0;Y<1<<I[j]-7;Y++)x[256+he++]=j;for(le=0;le<=p;le++)H[le]=0;for(Y=0;Y<=143;)M[2*Y+1]=8,Y++,H[8]++;for(;Y<=255;)M[2*Y+1]=9,Y++,H[9]++;for(;Y<=279;)M[2*Y+1]=7,Y++,H[7]++;for(;Y<=287;)M[2*Y+1]=8,Y++,H[8]++;for(be(M,d+1,H),Y=0;Y<g;Y++)F[2*Y+1]=5,F[2*Y]=ie(Y,5);X=new Q(M,R,h+1,d,p),L=new Q(F,I,0,g,p),ne=new Q(new Array(0),y,0,m,v)}(),re=!0),k.l_desc=new P(k.dyn_ltree,X),k.d_desc=new P(k.dyn_dtree,L),k.bl_desc=new P(k.bl_tree,ne),k.bi_buf=0,k.bi_valid=0,Ce(k)},s._tr_stored_block=B,s._tr_flush_block=function(k,Y,le,ae){var j,he,H=0;0<k.level?(k.strm.data_type===2&&(k.strm.data_type=function(z){var J,ue=4093624447;for(J=0;J<=31;J++,ue>>>=1)if(1&ue&&z.dyn_ltree[2*J]!==0)return i;if(z.dyn_ltree[18]!==0||z.dyn_ltree[20]!==0||z.dyn_ltree[26]!==0)return a;for(J=32;J<h;J++)if(z.dyn_ltree[2*J]!==0)return a;return i}(k)),Ne(k,k.l_desc),Ne(k,k.d_desc),H=function(z){var J;for(A(z,z.dyn_ltree,z.l_desc.max_code),A(z,z.dyn_dtree,z.d_desc.max_code),Ne(z,z.bl_desc),J=m-1;3<=J&&z.bl_tree[2*O[J]+1]===0;J--);return z.opt_len+=3*(J+1)+5+5+4,J}(k),j=k.opt_len+3+7>>>3,(he=k.static_len+3+7>>>3)<=j&&(j=he)):j=he=le+5,le+4<=j&&Y!==-1?B(k,Y,le,ae):k.strategy===4||he===j?(oe(k,2+(ae?1:0),3),Ze(k,M,F)):(oe(k,4+(ae?1:0),3),function(z,J,ue,de){var ze;for(oe(z,J-257,5),oe(z,ue-1,5),oe(z,de-4,4),ze=0;ze<de;ze++)oe(z,z.bl_tree[2*O[ze]+1],3);se(z,z.dyn_ltree,J-1),se(z,z.dyn_dtree,ue-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,H+1),Ze(k,k.dyn_ltree,k.dyn_dtree)),Ce(k),ae&&fe(k)},s._tr_tally=function(k,Y,le){return k.pending_buf[k.d_buf+2*k.last_lit]=Y>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&Y,k.pending_buf[k.l_buf+k.last_lit]=255&le,k.last_lit++,Y===0?k.dyn_ltree[2*le]++:(k.matches++,Y--,k.dyn_ltree[2*(E[le]+h+1)]++,k.dyn_dtree[2*V(Y)]++),k.last_lit===k.lit_bufsize-1},s._tr_align=function(k){oe(k,2,3),Z(k,w,M),function(Y){Y.bi_valid===16?(pe(Y,Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0):8<=Y.bi_valid&&(Y.pending_buf[Y.pending++]=255&Y.bi_buf,Y.bi_buf>>=8,Y.bi_valid-=8)}(k)}},{"../utils/common":41}],53:[function(t,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,s){(function(o){(function(i,a){if(!i.setImmediate){var l,u,c,h,d=1,g={},m=!1,f=i.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(i);p=p&&p.setTimeout?p:i,l={}.toString.call(i.process)==="[object process]"?function(S){process.nextTick(function(){v(S)})}:function(){if(i.postMessage&&!i.importScripts){var S=!0,T=i.onmessage;return i.onmessage=function(){S=!1},i.postMessage("","*"),i.onmessage=T,S}}()?(h="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",w,!1):i.attachEvent("onmessage",w),function(S){i.postMessage(h+S,"*")}):i.MessageChannel?((c=new MessageChannel).port1.onmessage=function(S){v(S.data)},function(S){c.port2.postMessage(S)}):f&&"onreadystatechange"in f.createElement("script")?(u=f.documentElement,function(S){var T=f.createElement("script");T.onreadystatechange=function(){v(S),T.onreadystatechange=null,u.removeChild(T),T=null},u.appendChild(T)}):function(S){setTimeout(v,0,S)},p.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var T=new Array(arguments.length-1),D=0;D<T.length;D++)T[D]=arguments[D+1];var R={callback:S,args:T};return g[d]=R,l(d),d++},p.clearImmediate=b}function b(S){delete g[S]}function v(S){if(m)setTimeout(v,0,S);else{var T=g[S];if(T){m=!0;try{(function(D){var R=D.callback,I=D.args;switch(I.length){case 0:R();break;case 1:R(I[0]);break;case 2:R(I[0],I[1]);break;case 3:R(I[0],I[1],I[2]);break;default:R.apply(a,I)}})(T)}finally{b(S),m=!1}}}}function w(S){S.source===i&&typeof S.data=="string"&&S.data.indexOf(h)===0&&v(+S.data.slice(h.length))}})(typeof self=="undefined"?o===void 0?this:o:self)}).call(this,typeof Vr!="undefined"?Vr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(P_);var Qi=P_.exports;/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Jh=function(r,e){return Jh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},Jh(r,e)};function Go(r,e){Jh(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ea=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],H_={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},Zl="docProps/core.xml",U_="docProps/app.xml",nA="xl/workbook.xml",rA="xl/calcChain.xml",Br="xl/styles.xml",sA="xl/sharedStrings.xml",oA="xl/theme/theme1.xml",iA="xl/_rels/workbook.xml.rels",aA={Boolean:"b",Date:"d",Error:"e",InlineString:"inlineStr",Number:"n",SharedString:"s",String:"str"},z_={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},lA={0:"00000000",1:"00FFFFFF",2:"00FF0000",3:"0000FF00",4:"000000FF",5:"00FFFF00",6:"00FF00FF",7:"0000FFFF",8:"00000000",9:"00FFFFFF",10:"00FF0000",11:"0000FF00",12:"000000FF",13:"00FFFF00",14:"00FF00FF",15:"0000FFFF",16:"00800000",17:"00008000",18:"00000080",19:"00808000",20:"00800080",21:"00008080",22:"00C0C0C0",23:"00808080",24:"009999FF",25:"00993366",26:"00FFFFCC",27:"00CCFFFF",28:"00660066",29:"00FF8080",30:"000066CC",31:"00CCCCFF",32:"00000080",33:"00FF00FF",34:"00FFFF00",35:"0000FFFF",36:"00800080",37:"00800000",38:"00008080",39:"000000FF",40:"0000CCFF",41:"00CCFFFF",42:"00CCFFCC",43:"00FFFF99",44:"0099CCFF",45:"00FF99CC",46:"00CC99FF",47:"00FFCC99",48:"003366FF",49:"0033CCCC",50:"0099CC00",51:"00FFCC00",52:"00FF9900",53:"00FF6600",54:"00666699",55:"00969696",56:"00003366",57:"00339966",58:"00003300",59:"00333300",60:"00993300",61:"00993366",62:"00333399",63:"00333333",64:null,65:null},uA={none:0,thin:1,hair:2,dotted:3,dashed:4,dashDot:5,dashDotDot:6,double:7,medium:8,mediumDashed:9,mediumDashDot:10,mediumDashDotDot:11,slantDashDot:12,thick:13},cA={0:"defualt",1:"Roman",2:"Swiss",3:"Modern",4:"Script",5:"Decorative"};function ql(r,e,t){e===void 0&&(e={}),t===void 0&&(t="1");var n=r.split("!"),s="",o="",i=-1;if(n.length>1){s=n[0],o=n[1];var a=e[s];a==null?i=parseInt(t):i=parseInt(a)}else i=parseInt(t),o=n[0];if(o.indexOf(":")==-1){var l=parseInt(o.replace(/[^0-9]/g,""))-1,u=Lr(o.replace(/[^A-Za-z]/g,""));return!isNaN(l)&&!isNaN(u)?{row:[l,l],column:[u,u],sheetIndex:i}:null}else{var c=o.split(":"),l=[],u=[];return l[0]=parseInt(c[0].replace(/[^0-9]/g,""))-1,l[1]=parseInt(c[1].replace(/[^0-9]/g,""))-1,l[0]>l[1]||(u[0]=Lr(c[0].replace(/[^A-Za-z]/g,"")),u[1]=Lr(c[1].replace(/[^A-Za-z]/g,"")),u[0]>u[1])?null:{row:l,column:u,sheetIndex:i}}}function Lr(r){r=r.toUpperCase();var e=r.length;if(e==0)return NaN;for(var t=r.split(""),n=ea.length,s=0,o=e-1;o>=0;o--)o==e-1?s+=H_[t[o]]:s+=Math.pow(n,e-o-1)*(H_[t[o]]+1);return s}function Xo(r){var e=ea.length;if(r<e)return ea[r];for(var t=0,n="",s=1,o=0;r>=e/(e-1)*(Math.pow(e,s++)-1);)o=s;var i=r-e/(e-1)*(Math.pow(e,o-1)-1);t=i+1;for(var a=o;a>0;a--){var l=t;if(a==1)return l=l%e,l==0&&(l=26),n+ea[l-1];l=Math.ceil(l/Math.pow(e,a-1)),n+=ea[l-1],a>1&&(t=t-(l-1)*e)}}function W_(){return .75}function Jl(r){if(r==null)return 0;var e=r/914400,t=e*72,n=t/W_();return n}function _t(r,e,t){var n=r[e];return n=n==null?t:n,n}function V_(r){var e=Math.round((r-.83)*8+5);return e}function $_(r){var e=Math.round(r/W_());return e}function hA(r,e){var t=r.substring(r.length-6,r.length),n=gA("#"+t),s=mA(n[0],n[1],n[2]);if(e>0)s[2]=s[2]*(1-e)+e;else if(e<0)s[2]=s[2]*(1+e);else return"#"+t;var o=fA(s[0],s[1],s[2]);return dA("RGB("+o.join(",")+")")}function dA(r){var e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(r)){for(var t=r.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),n="#",s=0;s<t.length;s++){var o=Number(t[s]).toString(16);o.length<2&&(o="0"+o),n+=o}return n.length!==7&&(n=r),n}else if(e.test(r)){var i=r.replace(/#/,"").split("");if(i.length===6)return r;if(i.length===3){for(var a="#",s=0;s<i.length;s+=1)a+=i[s]+i[s];return a}}return r}function gA(r){var e=r.toLowerCase(),t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e&&t.test(e)){if(e.length===4){for(var n="#",s=1;s<4;s+=1)n+=e.slice(s,s+1).concat(e.slice(s,s+1));e=n}for(var o=[],s=1;s<7;s+=2)o.push(parseInt("0x"+e.slice(s,s+2)));return o}return null}function fA(r,e,t){var n,s,o;if(e==0)n=s=o=t;else{var i=function(c,h,d){return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?c+(h-c)*6*d:d<.5?h:d<.6666666666666666?c+(h-c)*(.6666666666666666-d)*6:c},a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;n=i(l,a,r+.3333333333333333),s=i(l,a,r),o=i(l,a,r-.3333333333333333)}return[Math.round(n*255),Math.round(s*255),Math.round(o*255)]}function mA(r,e,t){r/=255,e/=255,t/=255;var n=Math.max(r,e,t),s=Math.min(r,e,t),o,i,a=(n+s)/2;if(n==s)o=i=0;else{var l=n-s;switch(i=a>.5?l/(2-n-s):l/(n+s),n){case r:o=(e-t)/l+(e<t?6:0);break;case e:o=(t-r)/l+2;break;case t:o=(r-e)/l+4;break}o/=6}return[o,i,a]}function pA(r){r==null&&(r="Sheet");for(var e=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",n=0;n<5;n++)t+=e[Math.round(Math.random()*(e.length-1))];var s=new Date().getTime();return r+"_"+t+"_"+s}function ta(r){return r==null||r.length==0?r:r.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&apos;/g,"'").replace(/&iexcl;/g,"\xA1").replace(/&cent;/g,"\xA2").replace(/&pound;/g,"\xA3").replace(/&curren;/g,"\xA4").replace(/&yen;/g,"\xA5").replace(/&brvbar;/g,"\xA6").replace(/&sect;/g,"\xA7").replace(/&uml;/g,"\xA8").replace(/&copy;/g,"\xA9").replace(/&ordf;/g,"\xAA").replace(/&laquo;/g,"\xAB").replace(/&not;/g,"\xAC").replace(/&shy;/g,"\xAD").replace(/&reg;/g,"\xAE").replace(/&macr;/g,"\xAF").replace(/&deg;/g,"\xB0").replace(/&plusmn;/g,"\xB1").replace(/&sup2;/g,"\xB2").replace(/&sup3;/g,"\xB3").replace(/&acute;/g,"\xB4").replace(/&micro;/g,"\xB5").replace(/&para;/g,"\xB6").replace(/&middot;/g,"\xB7").replace(/&cedil;/g,"\xB8").replace(/&sup1;/g,"\xB9").replace(/&ordm;/g,"\xBA").replace(/&raquo;/g,"\xBB").replace(/&frac14;/g,"\xBC").replace(/&frac12;/g,"\xBD").replace(/&frac34;/g,"\xBE").replace(/&iquest;/g,"\xBF").replace(/&times;/g,"\xD7").replace(/&divide;/g,"\xF7").replace(/&Agrave;/g,"\xC0").replace(/&Aacute;/g,"\xC1").replace(/&Acirc;/g,"\xC2").replace(/&Atilde;/g,"\xC3").replace(/&Auml;/g,"\xC4").replace(/&Aring;/g,"\xC5").replace(/&AElig;/g,"\xC6").replace(/&Ccedil;/g,"\xC7").replace(/&Egrave;/g,"\xC8").replace(/&Eacute;/g,"\xC9").replace(/&Ecirc;/g,"\xCA").replace(/&Euml;/g,"\xCB").replace(/&Igrave;/g,"\xCC").replace(/&Iacute;/g,"\xCD").replace(/&Icirc;/g,"\xCE").replace(/&Iuml;/g,"\xCF").replace(/&ETH;/g,"\xD0").replace(/&Ntilde;/g,"\xD1").replace(/&Ograve;/g,"\xD2").replace(/&Oacute;/g,"\xD3").replace(/&Ocirc;/g,"\xD4").replace(/&Otilde;/g,"\xD5").replace(/&Ouml;/g,"\xD6").replace(/&Oslash;/g,"\xD8").replace(/&Ugrave;/g,"\xD9").replace(/&Uacute;/g,"\xDA").replace(/&Ucirc;/g,"\xDB").replace(/&Uuml;/g,"\xDC").replace(/&Yacute;/g,"\xDD").replace(/&THORN;/g,"\xDE").replace(/&szlig;/g,"\xDF").replace(/&agrave;/g,"\xE0").replace(/&aacute;/g,"\xE1").replace(/&acirc;/g,"\xE2").replace(/&atilde;/g,"\xE3").replace(/&auml;/g,"\xE4").replace(/&aring;/g,"\xE5").replace(/&aelig;/g,"\xE6").replace(/&ccedil;/g,"\xE7").replace(/&egrave;/g,"\xE8").replace(/&eacute;/g,"\xE9").replace(/&ecirc;/g,"\xEA").replace(/&euml;/g,"\xEB").replace(/&igrave;/g,"\xEC").replace(/&iacute;/g,"\xED").replace(/&icirc;/g,"\xEE").replace(/&iuml;/g,"\xEF").replace(/&eth;/g,"\xF0").replace(/&ntilde;/g,"\xF1").replace(/&ograve;/g,"\xF2").replace(/&oacute;/g,"\xF3").replace(/&ocirc;/g,"\xF4").replace(/&otilde;/g,"\xF5").replace(/&ouml;/g,"\xF6").replace(/&oslash;/g,"\xF8").replace(/&ugrave;/g,"\xF9").replace(/&uacute;/g,"\xFA").replace(/&ucirc;/g,"\xFB").replace(/&uuml;/g,"\xFC").replace(/&yacute;/g,"\xFD").replace(/&thorn;/g,"\xFE").replace(/&yuml;/g,"\xFF")}var Ql=function(){function r(){}return r.trim=function(e){return e==null&&(e=""),e.replace(/(^\s*)|(\s*$)/g,"")},r.functionCopy=function(e,t,n){var s=this;if(s.operatorjson==null){for(var o=s.operator.split("|"),i={},a=0;a<o.length;a++)i[o[a].toString()]=1;s.operatorjson=i}t==null&&(t="down"),n==null&&(n=1),e.substr(0,1)=="="&&(e=e.substr(1));for(var l=e.split(""),u=0,c="",h="",d={bracket:0,comma:0,squote:0,dquote:0};u<l.length;){var g=l[u];if(g=="("&&d.dquote==0)d.bracket+=1,c.length>0?h+=c+"(":h+="(",c="";else if(g==")"&&d.dquote==0)d.bracket-=1,h+=s.functionCopy(c,t,n)+")",c="";else if(g=='"'&&d.squote==0)d.dquote>0?(h+=c+'"',d.dquote-=1,c=""):(d.dquote+=1,c+='"');else if(g==","&&d.dquote==0)h+=s.functionCopy(c,t,n)+",",c="";else if(g=="&"&&d.dquote==0)c.length>0?(h+=s.functionCopy(c,t,n)+"&",c=""):h+="&";else if(g in s.operatorjson&&d.dquote==0){var m="";u+1<l.length&&(m=l[u+1]);var f=u-1,p=null;if(f>=0)do p=l[f--];while(f>=0&&p==" ");g+m in s.operatorjson?(c.length>0?(h+=s.functionCopy(c,t,n)+g+m,c=""):h+=g+m,u++):!/[^0-9]/.test(m)&&g=="-"&&(p=="("||p==null||p==","||p==" "||p in s.operatorjson)?c+=g:c.length>0?(h+=s.functionCopy(c,t,n)+g,c=""):h+=g}else c+=g;u==l.length-1&&(s.iscelldata(s.trim(c))?t=="down"?h+=s.downparam(s.trim(c),n):t=="up"?h+=s.upparam(s.trim(c),n):t=="left"?h+=s.leftparam(s.trim(c),n):t=="right"&&(h+=s.rightparam(s.trim(c),n)):h+=s.trim(c)),u++}return h},r.downparam=function(e,t){return this.updateparam("d",e,t)},r.upparam=function(e,t){return this.updateparam("u",e,t)},r.leftparam=function(e,t){return this.updateparam("l",e,t)},r.rightparam=function(e,t){return this.updateparam("r",e,t)},r.updateparam=function(e,t,n){var s=this,o=t.split("!"),i,a="";if(o.length>1?(i=o[1],a=o[0]+"!"):i=o[0],i.indexOf(":")==-1){var l=parseInt(i.replace(/[^0-9]/g,"")),u=Lr(i.replace(/[^A-Za-z]/g,"")),c=s.isfreezonFuc(i),h=c[0]?"$":"",d=c[1]?"$":"";return e=="u"&&!c[0]?l-=n:e=="r"&&!c[1]?u+=n:e=="l"&&!c[1]?u-=n:c[0]||(l+=n),l<0||u<0?s.error.r:!isNaN(l)&&!isNaN(u)?a+d+Xo(u)+h+l:isNaN(l)?isNaN(u)?t:a+d+Xo(u):a+h+l}else{i=i.split(":");var l=[],u=[];if(l[0]=parseInt(i[0].replace(/[^0-9]/g,"")),l[1]=parseInt(i[1].replace(/[^0-9]/g,"")),l[0]>l[1]||(u[0]=Lr(i[0].replace(/[^A-Za-z]/g,"")),u[1]=Lr(i[1].replace(/[^A-Za-z]/g,"")),u[0]>u[1]))return t;var g=s.isfreezonFuc(i[0]),m=s.isfreezonFuc(i[1]),f=g[0]?"$":"",p=g[1]?"$":"",b=m[0]?"$":"",v=m[1]?"$":"";return e=="u"?(g[0]||(l[0]-=n),m[0]||(l[1]-=n)):e=="r"?(g[1]||(u[0]+=n),m[1]||(u[1]+=n)):e=="l"?(g[1]||(u[0]-=n),m[1]||(u[1]-=n)):(g[0]||(l[0]+=n),m[0]||(l[1]+=n)),l[0]<0||u[0]<0?s.error.r:isNaN(u[0])&&isNaN(u[1])?a+f+l[0]+":"+b+l[1]:isNaN(l[0])&&isNaN(l[1])?a+p+Xo(u[0])+":"+v+Xo(u[1]):a+p+Xo(u[0])+f+l[0]+":"+v+Xo(u[1])+b+l[1]}},r.iscelldata=function(e){var t=e.split("!"),n;t.length>1?n=t[1]:n=t[0];var s=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(n.indexOf(":")==-1){var i=parseInt(n.replace(/[^0-9]/g,""))-1,a=Lr(n.replace(/[^A-Za-z]/g,""));return!isNaN(i)&&!isNaN(a)&&n.toString().match(s)?!0:(isNaN(i)&&isNaN(a),!1)}else{o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,n=n.split(":");var i=[],a=[];return i[0]=parseInt(n[0].replace(/[^0-9]/g,""))-1,i[1]=parseInt(n[1].replace(/[^0-9]/g,""))-1,i[0]>i[1]||(a[0]=Lr(n[0].replace(/[^A-Za-z]/g,"")),a[1]=Lr(n[1].replace(/[^A-Za-z]/g,"")),a[0]>a[1])?!1:!!(n[0].toString().match(o)&&n[1].toString().match(o))}},r.isfreezonFuc=function(e){var t=e.replace(/[^0-9]/g,""),n=e.replace(/[^A-Za-z]/g,""),s=e.substr(e.indexOf(t)-1,1),o=e.substr(e.indexOf(n)-1,1),i=[!1,!1];return s=="$"&&(i[0]=!0),o=="$"&&(i[1]=!0),i},r.operator="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",r.error={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},r.operatorjson=null,r}();function _A(r){var e=/[^\u4e00-\u9fa5]/,t=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return t.test(r)?!0:!e.test(r)}function bA(r){var e=/[^\u0800-\u4e00]/;return!e.test(r)}function vA(r){return r>12592&&r<12687||r>=44032&&r<=55203}function CA(r,e){var t,n,s,o;e||(e={});var i=function(){try{return new window.XMLHttpRequest}catch{}},a=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch{}},l=typeof window!="undefined"&&window.ActiveXObject?function(){return i()||a()}:i;typeof e=="function"?(o=e,e={}):typeof e.callback=="function"&&(o=e.callback),n=function(c){o(null,c)},s=function(c){o(c,null)};try{var u=l();u.open("GET",r,!0),"responseType"in u&&(u.responseType="arraybuffer"),u.overrideMimeType&&u.overrideMimeType("text/plain; charset=x-user-defined"),u.onreadystatechange=function(c){if(u.readyState===4)if(u.status===200||u.status===0)try{n(function(h){return h.response||h.responseText}(u))}catch(h){s(new Error(h))}else s(new Error("Ajax error for "+r+" : "+this.status+" "+this.statusText))},e.progress&&(u.onprogress=function(c){e.progress({path:r,originalEvent:c,percent:c.loaded/c.total*100,loaded:c.loaded,total:c.total})}),u.send()}catch(c){s(new Error(c),null)}return t}var G_=function(){function r(){}return r.prototype.getElementsByOneTag=function(e,t){var n;if(e.indexOf("|")>-1){for(var s=e.split("|"),o="",i=0;i<s.length;i++){var a=s[i];o+="|<"+a+" [^>]+?[^/]>[\\s\\S]*?</"+a+">|<"+a+" [^>]+?/>|<"+a+">[\\s\\S]*?</"+a+">|<"+a+"/>"}o=o.substr(1,o.length),n=new RegExp(o,"g")}else n=new RegExp("<"+e+" [^>]+?[^/]>[\\s\\S]*?</"+e+">|<"+e+" [^>]+?/>|<"+e+">[\\s\\S]*?</"+e+">|<"+e+"/>","g");var l=t.match(n);return l==null?[]:l},r}(),EA=function(r){Go(e,r);function e(t){var n=r.call(this)||this;return n.originFile=t,n}return e.prototype.getElementsByTagName=function(t,n){var s=this.getFileByName(n),o=t.split("/"),i;for(var a in o){var l=o[a];if(i==null)i=this.getElementsByOneTag(l,s);else if(i instanceof Array){var u=[];for(var c in i){var h=i[c];u=u.concat(this.getElementsByOneTag(l,h))}i=u}else i=this.getElementsByOneTag(l,i)}for(var d=[],g=0;g<i.length;g++){var m=new wA(i[g]);d.push(m)}return d},e.prototype.getFileByName=function(t){for(var n in this.originFile)if(n.indexOf(t)>-1)return this.originFile[n];return""},e}(G_),wA=function(r){Go(e,r);function e(t){var n=r.call(this)||this;n.elementString=t,n.setValue();var s=new RegExp('[a-zA-Z0-9_:]*?=".*?"',"g"),o=n.container.match(s);if(n.attributeList={},o!=null)for(var i in o){var a=o[i];if(a.length!=0){var l=a.substr(0,a.indexOf("=")),u=a.substr(a.indexOf("=")+1);l==null||u==null||l.length==0||u.length==0||(n.attributeList[l]=u.substr(1,u.length-2))}}return n}return e.prototype.get=function(t){return this.attributeList[t]},e.prototype.getInnerElements=function(t){for(var n=this.getElementsByOneTag(t,this.elementString),s=[],o=0;o<n.length;o++){var i=new e(n[o]);s.push(i)}return s.length==0?null:s},e.prototype.setValue=function(){var t=this.elementString;if(t.substr(t.length-2,2)=="/>")this.value="",this.container=t;else{var n=this.getFirstTag(),s=new RegExp("(<"+n+" [^>]+?[^/]>)([\\s\\S]*?)</"+n+">|(<"+n+">)([\\s\\S]*?)</"+n+">","g"),o=s.exec(t);o!=null&&(o[1]!=null?(this.container=o[1],this.value=o[2]):(this.container=o[3],this.value=o[4]))}},e.prototype.getFirstTag=function(){var t=this.elementString,n=t.substr(0,t.indexOf(" "));return(n==""||n.indexOf(">")>-1)&&(n=t.substr(0,t.indexOf(">"))),n=n.substr(1,n.length),n},e}(G_);function TA(r,e){var t={};if(r==null||r.length==0)return e;for(var n in e){var s=e[n],o=parseInt(n),i=r[o];if(i==null)t[n]=s;else{var a=i.attributeList.rgb;t[n]=a}}return t}function Yo(r,e,t){var n=r.attributeList,s=e.clrScheme,o=e.indexedColors;e.mruColors;var i=TA(o,lA),a=n.indexed,l=n.rgb,u=n.theme,c=n.tint,h;if(a!=null){var d=parseInt(a);h=i[d],h!=null&&(h=h.substring(h.length-6,h.length),h="#"+h)}else if(l!=null)l=l.substring(l.length-6,l.length),h="#"+l;else if(u!=null){var g=parseInt(u);g==0?g=1:g==1?g=0:g==2?g=3:g==3&&(g=2);var m=s[g];if(m!=null){var f=m.getInnerElements("a:sysClr|a:srgbClr");if(f!=null){var p=f[0],b=p.attributeList;p.container.indexOf("sysClr")>-1?b.lastClr!=null?h="#"+b.lastClr:b.val!=null&&(h="#"+b.val):p.container.indexOf("srgbClr")>-1&&(h="#"+b.val)}}}if(c!=null){var v=parseFloat(c);h!=null&&(h=hA(h,v))}return h}function dr(r,e){var t=r.getInnerElements(e),n;if(t!=null&&t.length>0)if(e=="b"||e=="i"||e=="strike")n="1";else if(e=="u"){var s=t[0].attributeList.val;s=="double"?n="2":s=="singleAccounting"?n="3":s=="doubleAccounting"?n="4":n="1"}else if(e=="vertAlign"){var s=t[0].attributeList.val;s=="subscript"?n="1":s=="superscript"&&(n="2")}else n=t[0].attributeList.val;return n}var X_=function(){function r(){}return r}(),Y_=function(){function r(){}return r}(),SA=function(){function r(){}return r}(),j_=function(){function r(){}return r}(),yA=function(){function r(){}return r}(),eu=function(){function r(){}return r}(),tu=function(){function r(){}return r}(),AA=function(){function r(){}return r}(),RA=function(){function r(){}return r}(),IA=function(){function r(){}return r}(),xA=function(){function r(){}return r}(),DA=function(){function r(){}return r}(),K_=function(){function r(){}return r}(),OA=function(){function r(){}return r}(),FA=function(r){Go(e,r);function e(t,n,s,o,i,a){var l=r.call(this)||this;l.cell=t,l.sheetFile=i,l.styles=n,l.sharedStrings=s,l.readXml=a,l.mergeCells=o;var u=t.attributeList,c=u.r,h=u.s,d=u.t,g=ql(c);return l.r=g.row[0],l.c=g.column[0],l.v=l.generateValue(h,d),l}return e.prototype.generateValue=function(t,n){var s=this,o=this.cell.getInnerElements("v"),i=this.cell.getInnerElements("f");o==null&&(o=this.cell.getInnerElements("t"));var a=this.styles.cellXfs,l=this.styles.cellStyleXfs;this.styles.cellStyles;var u=this.styles.fonts,c=this.styles.fills,h=this.styles.borders,d=this.styles.numfmts,g=this.styles.clrScheme,m=this.sharedStrings,f=new yA;if(i!=null){var p=i[0],b=p.attributeList,v=b.t,w=b.ref,S=b.si,T=i[0].value;v=="shared"&&(this._fomulaRef=w,this._formulaType=v,this._formulaSi=S),(w!=null||T!=null&&T.length>0)&&(T=ta(T),f.f="="+T)}var D=null,R;if(t!=null){var I=parseInt(t),y=a[I],O=y.attributeList.xfId,M=void 0,F=void 0,x=void 0,E=void 0,N=void 0,X=void 0,L=void 0,ne=void 0;if(O!=null){var G=l[parseInt(O)],b=G.attributeList,Q=b.applyNumberFormat,P=b.applyFont,V=b.applyFill,pe=b.applyBorder,oe=b.applyAlignment;if(b.applyProtection,R=b.quotePrefix,Q!="0"&&b.numFmtId!=null&&(M=b.numFmtId),P!="0"&&b.fontId!=null&&(F=b.fontId),V!="0"&&b.fillId!=null&&(x=b.fillId),pe!="0"&&b.borderId!=null&&(E=b.borderId),oe!=null&&oe!="0"){var Z=G.getInnerElements("alignment");if(Z!=null){var ie=Z[0].attributeList;ie.horizontal!=null&&(N=ie.horizontal),ie.vertical!=null&&(X=ie.vertical),ie.wrapText!=null&&(L=ie.wrapText),ie.textRotation!=null&&(ne=ie.textRotation),ie.shrinkToFit!=null&&ie.shrinkToFit,ie.indent!=null&&ie.indent}}}var be=y.attributeList.applyNumberFormat,Ce=y.attributeList.applyFont,fe=y.attributeList.applyFill,Te=y.attributeList.applyBorder,Le=y.attributeList.applyAlignment;if(y.attributeList.applyProtection!=null&&y.attributeList.applyProtection,y.attributeList.quotePrefix!=null&&(R=y.attributeList.quotePrefix),be!="0"&&y.attributeList.numFmtId!=null&&(M=y.attributeList.numFmtId),Ce!="0"&&(F=y.attributeList.fontId),fe!="0"&&(x=y.attributeList.fillId),Te!="0"&&(E=y.attributeList.borderId),Le!="0"){var Z=y.getInnerElements("alignment");if(Z!=null&&Z.length>0){var b=Z[0].attributeList;b.horizontal!=null&&(N=b.horizontal),b.vertical!=null&&(X=b.vertical),b.wrapText!=null&&(L=b.wrapText),b.textRotation!=null&&(ne=b.textRotation),b.shrinkToFit!=null&&b.shrinkToFit,b.indent!=null&&b.indent}}if(M!=null){var Ze=d[parseInt(M)],Ne=new eu;Ne.fa=ta(Ze),Ne.t=n,f.ct=Ne}if(x!=null){var A=parseInt(x),se=c[A],re=this.getBackgroundByFill(se,g);re!=null&&(f.bg=re)}if(F!=null){var B=parseInt(F),k=u[B];if(k!=null){var Y=k.getInnerElements("sz"),le=k.getInnerElements("color"),ae=k.getInnerElements("name"),j=k.getInnerElements("family");k.getInnerElements("charset");var he=k.getInnerElements("b"),H=k.getInnerElements("i"),z=k.getInnerElements("strike"),J=k.getInnerElements("u");if(Y!=null&&Y.length>0){var ue=Y[0].attributeList.val;ue!=null&&(f.fs=parseInt(ue))}if(le!=null&&le.length>0){var de=le[0],ze=Yo(de,this.styles);ze!=null&&(f.fc=ze)}if(j!=null&&j.length>0){var De=j[0].attributeList.val;De!=null&&(D=cA[De])}if(ae!=null&&ae.length>0){var De=ae[0].attributeList.val;De!=null&&(f.ff=De)}if(he!=null&&he.length>0){var Be=he[0].attributeList.val;Be=="0"?f.bl=0:f.bl=1}if(H!=null&&H.length>0){var ce=H[0].attributeList.val;ce=="0"?f.it=0:f.it=1}if(z!=null&&z.length>0){var Se=z[0].attributeList.val;Se=="0"?f.cl=0:f.cl=1}if(J!=null&&J.length>0){var ve=J[0].attributeList.val;ve=="single"?f.un=1:ve=="double"?f.un=2:ve=="singleAccounting"?f.un=3:ve=="doubleAccounting"?f.un=4:f.un=0}}}if(N!=null&&(N=="center"||N=="centerContinuous"?f.ht=0:N=="left"?f.ht=1:N=="right"?f.ht=2:N=="distributed"?f.ht=0:N=="fill"||N=="general"?f.ht=1:N=="justify"?f.ht=0:f.ht=1),X!=null&&(X=="bottom"?f.vt=2:X=="center"||X=="distributed"||X=="justify"?f.vt=0:(X=="top",f.vt=1)),L!=null&&L=="1"?f.tb=2:f.tb=1,ne!=null&&(ne=="255"?f.tr=3:(f.tr=0,f.rt=parseInt(ne))),E!=null){var $e=parseInt(E),Ve=h[$e],qe=new RA;qe.rangeType="cell";var U=new IA;U.row_index=this.r,U.col_index=this.c;var q=Ve.getInnerElements("left"),Je=Ve.getInnerElements("right"),Ws=Ve.getInnerElements("top"),ls=Ve.getInnerElements("bottom"),Ko=Ve.getInnerElements("diagonal"),CR=Ve.getInnerElements("start"),ER=Ve.getInnerElements("end"),Qh=this.getBorderInfo(q),ed=this.getBorderInfo(Je),td=this.getBorderInfo(Ws),nd=this.getBorderInfo(ls);this.getBorderInfo(Ko);var rd=this.getBorderInfo(CR),sd=this.getBorderInfo(ER),Vs=!1;rd!=null&&rd.color!=null&&(U.l=rd,Vs=!0),sd!=null&&sd.color!=null&&(U.r=sd,Vs=!0),Qh!=null&&Qh.color!=null&&(U.l=Qh,Vs=!0),ed!=null&&ed.color!=null&&(U.r=ed,Vs=!0),td!=null&&td.color!=null&&(U.t=td,Vs=!0),nd!=null&&nd.color!=null&&(U.b=nd,Vs=!0),Vs&&(qe.value=U,this._borderObject=qe)}}else f.tb=1;if(o!=null){var Zo=o[0].value;if(/&#\d+;/.test(Zo)&&(Zo=this.htmlDecode(Zo)),n==aA.SharedString){var wR=parseInt(o[0].value),Q_=m[wR],eb=Q_.getInnerElements("r");if(eb==null){var tb=Q_.getInnerElements("t");if(tb!=null){var Qn="";if(tb.forEach(function(TR){Qn+=TR.value}),Qn=ta(Qn),D=="Roman"&&Qn.length>0){var ou=Qn.split(""),iu=null,na="",od=null,nb="Times New Roman";f.ff!=null&&(nb=f.ff);var Ne=f.ct;Ne==null&&(Ne=new eu),Ne.s==null&&(Ne.s=[]);for(var ra=0;ra<ou.length;ra++){var $s=ou[ra],Gs=null,qo=nb;if(_A($s)?(Gs="c",qo="\u5B8B\u4F53"):bA($s)?(Gs="j",qo="Yu Gothic"):vA($s)?(Gs="k",qo="Malgun Gothic"):Gs="e",Gs!=iu&&iu!=null||ra==ou.length-1){var bt=new tu;if(bt.ff=od,f.fc!=null&&(bt.fc=f.fc),f.fs!=null&&(bt.fs=f.fs),f.cl!=null&&(bt.cl=f.cl),f.un!=null&&(bt.un=f.un),f.bl!=null&&(bt.bl=f.bl),f.it!=null&&(bt.it=f.it),ra==ou.length-1)if(Gs==iu)bt.ff=qo,bt.v=na+$s;else{bt.ff=od,bt.v=na,Ne.s.push(bt);var Pr=new tu;Pr.ff=qo,Pr.v=$s,f.fc!=null&&(Pr.fc=f.fc),f.fs!=null&&(Pr.fs=f.fs),f.cl!=null&&(Pr.cl=f.cl),f.un!=null&&(Pr.un=f.un),f.bl!=null&&(Pr.bl=f.bl),f.it!=null&&(Pr.it=f.it),Ne.s.push(Pr);break}else bt.v=na;Ne.s.push(bt),na=$s}else na+=$s;iu=Gs,od=qo}Ne.t="inlineStr",f.ct=Ne}else if(Qn=this.replaceSpecialWrap(Qn),Qn.indexOf(`\r
`)>-1||Qn.indexOf(`
`)>-1){var bt=new tu;bt.v=Qn;var Ne=f.ct;Ne==null&&(Ne=new eu),f.ff!=null&&(bt.ff=f.ff),f.fc!=null&&(bt.fc=f.fc),f.fs!=null&&(bt.fs=f.fs),f.cl!=null&&(bt.cl=f.cl),f.un!=null&&(bt.un=f.un),f.bl!=null&&(bt.bl=f.bl),f.it!=null&&(bt.it=f.it),Ne.t="inlineStr",Ne.s=[bt],f.ct=Ne}else f.v=Qn,R="1"}}else{var rb=[];eb.forEach(function(sb){var id=sb.getInnerElements("t"),ad=sb.getInnerElements("rPr"),it=new tu;if(id!=null&&id.length>0){var sa=id[0].value;sa=s.replaceSpecialWrap(sa),sa=ta(sa),it.v=sa}if(ad!=null&&ad.length>0){var er=ad[0],ob=dr(er,"sz"),ib=dr(er,"rFont");dr(er,"family"),dr(er,"charset"),dr(er,"scheme");var ab=dr(er,"b"),lb=dr(er,"i"),ub=dr(er,"u"),cb=dr(er,"strike"),hb=dr(er,"vertAlign"),ld=void 0,ud=er.getInnerElements("color");ud!=null&&ud.length>0&&(ld=Yo(ud[0],s.styles));var cd=void 0;ib!=null&&(cd=ib),cd!=null?it.ff=cd:f.ff!=null&&(it.ff=f.ff),ld!=null?it.fc=ld:f.fc!=null&&(it.fc=f.fc),ob!=null?it.fs=parseInt(ob):f.fs!=null&&(it.fs=f.fs),cb!=null?it.cl=parseInt(cb):f.cl!=null&&(it.cl=f.cl),ub!=null?it.un=parseInt(ub):f.un!=null&&(it.un=f.un),ab!=null?it.bl=parseInt(ab):f.bl!=null&&(it.bl=f.bl),lb!=null?it.it=parseInt(lb):f.it!=null&&(it.it=f.it),hb!=null&&(it.va=parseInt(hb))}else it.ff==null&&f.ff!=null&&(it.ff=f.ff),it.fc==null&&f.fc!=null&&(it.fc=f.fc),it.fs==null&&f.fs!=null&&(it.fs=f.fs),it.cl==null&&f.cl!=null&&(it.cl=f.cl),it.un==null&&f.un!=null&&(it.un=f.un),it.bl==null&&f.bl!=null&&(it.bl=f.bl),it.it==null&&f.it!=null&&(it.it=f.it);rb.push(it)});var Ne=f.ct;Ne==null&&(Ne=new eu),Ne.t="inlineStr",Ne.s=rb,f.ct=Ne}}else Zo=ta(Zo),f.v=Zo}return R!=null&&(f.qp=parseInt(R)),f},e.prototype.replaceSpecialWrap=function(t){return t=t.replace(/_x000D_/g,"").replace(/&#13;&#10;/g,`\r
`).replace(/&#13;/g,"\r").replace(/&#10;/g,`
`),t},e.prototype.getBackgroundByFill=function(t,n){var s=t.getInnerElements("patternFill");if(s!=null){var o=s[0],i=o.getInnerElements("fgColor"),a=o.getInnerElements("bgColor"),l=void 0,u=void 0;if(i!=null){var c=i[0];l=Yo(c,this.styles)}if(a!=null){var h=a[0];u=Yo(h,this.styles)}if(l!=null)return l;if(u!=null)return u}else{var d=t.getInnerElements("gradientFill");if(d!=null)return null}},e.prototype.getBorderInfo=function(t){if(t==null)return null;var n=t[0],s=n.attributeList;this.styles.clrScheme;var o=s.style;if(o==null||o=="none")return null;var i=n.getInnerElements("color"),a="#000000";if(i!=null){var l=i[0];a=Yo(l,this.styles),a==null&&(a="#000000")}var u=new xA;return u.style=uA[o],u.color=a,u},e.prototype.htmlDecode=function(t){return t.replace(/&#(x)?([^&]{1,5});?/g,function(n,s,o){return String.fromCharCode(parseInt(o,s?16:10))})},e}(j_),MA=function(r){Go(e,r);function e(t,n,s,o,i){o===void 0&&(o=!1);var a=r.call(this)||this;a.isInitialCell=o,a.readXml=i.readXml,a.sheetFile=i.sheetFile,a.styles=i.styles,a.sharedStrings=i.sharedStrings,a.calcChainEles=i.calcChain,a.sheetList=i.sheetList,a.imageList=i.imageList,a.name=t,a.index=n,a.order=s.toString(),a.config=new AA,a.celldata=[],a.mergeCells=a.readXml.getElementsByTagName("mergeCells/mergeCell",a.sheetFile),a.styles.clrScheme;var l=a.readXml.getElementsByTagName("sheetViews/sheetView",a.sheetFile),u="1",c="0",h="100",d="A1";if(l.length>0){var g=l[0].attributeList;u=_t(g,"showGridLines","1"),c=_t(g,"tabSelected","0"),h=_t(g,"zoomScale","100");var m=l[0].getInnerElements("selection");if(m!=null&&m.length>0){d=_t(m[0].attributeList,"activeCell","A1");var f=ql(d,a.sheetList,n);a.luckysheet_select_save=[],a.luckysheet_select_save.push(f)}}a.showGridLines=u,a.status=c,a.zoomRatio=parseInt(h)/100;var p=a.readXml.getElementsByTagName("sheetPr/tabColor",a.sheetFile);if(p!=null&&p.length>0){var b=p[0],g=b.attributeList,v=Yo(b,a.styles);a.color=v}var w=a.readXml.getElementsByTagName("sheetFormatPr",a.sheetFile),S,T;if(w.length>0){var g=w[0].attributeList;S=_t(g,"defaultColWidth","9.21"),T=_t(g,"defaultRowHeight","19")}a.defaultColWidth=V_(parseFloat(S)),a.defaultRowHeight=$_(parseFloat(T)),a.generateConfigColumnLenAndHidden();var D=a.generateConfigRowLenAndHiddenAddCell();if(a.formulaRefList!=null)for(var R in a.formulaRefList){var I=a.formulaRefList[R],y=I.mainRef,O=y.cellValue,M=y.fv,F=O.r,x=O.c;for(var E in I)if(E!="mainRef"){var N=I[E],X=N.cellValue;if(X!=null){var L=X.r,ne=X.c,G=M,Q=L-F,P=ne-x;Q>0?G="="+Ql.functionCopy(G,"down",Q):Q<0&&(G="="+Ql.functionCopy(G,"up",Math.abs(Q))),P>0?G="="+Ql.functionCopy(G,"right",P):P<0&&(G="="+Ql.functionCopy(G,"left",Math.abs(P))),X.v.f=G}}}a.calcChain==null&&(a.calcChain=[]);for(var V={},ne=0;ne<a.calcChainEles.length;ne++){var pe=a.calcChainEles[ne],g=pe.attributeList;if(g.i==n){var L=g.r,oe=g.i;g.l,g.s,g.a,g.t;var f=ql(L),Z=new K_;Z.r=f.row[0],Z.c=f.column[0],Z.index=a.index,a.calcChain.push(Z),V["r"+L+"c"+ne]=null}}for(var R in D.formulaList)if(!(R in V)){var ie=D.formulaList[R],Z=new K_;Z.r=ie.r,Z.c=ie.c,Z.index=a.index,a.calcChain.push(Z)}if(a.mergeCells!=null)for(var oe=0;oe<a.mergeCells.length;oe++){var be=a.mergeCells[oe],g=be.attributeList,Ce=g.ref;if(Ce!=null){var f=ql(Ce,a.sheetList,n),fe=new DA;fe.r=f.row[0],fe.c=f.column[0],fe.rs=f.row[1]-f.row[0]+1,fe.cs=f.column[1]-f.column[0]+1,a.config.merge==null&&(a.config.merge={}),a.config.merge[f.row[0]+"_"+f.column[0]]=fe}}var Te=i.drawingFile,Le=i.drawingRelsFile;if(Te!=null&&Le!=null){var Ze=a.readXml.getElementsByTagName("xdr:twoCellAnchor",Te);if(Ze!=null&&Ze.length>0)for(var oe=0;oe<Ze.length;oe++){var Ne=Ze[oe],A=_t(Ne.attributeList,"editAs","twoCell"),se=Ne.getInnerElements("xdr:from"),re=Ne.getInnerElements("xdr:to"),B=Ne.getInnerElements("a:blip");if(se!=null&&B!=null&&se.length>0&&B.length>0){var k=se[0],Y=re[0],le=B[0],ae=_t(le.attributeList,"r:embed",null),j=a.getBase64ByRid(ae,Le),he=0,H=0,z=0,J=0;j.fromCol=a.getXdrValue(k.getInnerElements("xdr:col")),j.fromColOff=Jl(a.getXdrValue(k.getInnerElements("xdr:colOff"))),j.fromRow=a.getXdrValue(k.getInnerElements("xdr:row")),j.fromRowOff=Jl(a.getXdrValue(k.getInnerElements("xdr:rowOff"))),j.toCol=a.getXdrValue(Y.getInnerElements("xdr:col")),j.toColOff=Jl(a.getXdrValue(Y.getInnerElements("xdr:colOff"))),j.toRow=a.getXdrValue(Y.getInnerElements("xdr:row")),j.toRowOff=Jl(a.getXdrValue(Y.getInnerElements("xdr:rowOff"))),j.originWidth=z,j.originHeight=J,A=="absolute"?j.type="3":A=="oneCell"?j.type="2":j.type="1",j.isFixedPos=!1,j.fixedLeft=0,j.fixedTop=0;var ue={color:"#000",radius:0,style:"solid",width:0};j.border=ue;var de={height:J,offsetLeft:0,offsetTop:0,width:z};j.crop=de;var ze={height:J,left:he,top:H,width:z};j.default=ze,a.images==null&&(a.images={}),a.images[pA("image")]=j}}}return a}return e.prototype.getXdrValue=function(t){return t==null||t.length==0?null:parseInt(t[0].value)},e.prototype.getBase64ByRid=function(t,n){var s=this.readXml.getElementsByTagName("Relationships/Relationship",n);if(s!=null&&s.length>0)for(var o=0;o<s.length;o++){var i=s[o],a=i.attributeList,l=_t(a,"Id",null),u=_t(a,"Target",null);if(l==t){u=u.replace(/\.\.\//g,""),u="xl/"+u;var c=this.imageList.getImageByName(u);return c}}return null},e.prototype.generateConfigColumnLenAndHidden=function(){for(var t=this.readXml.getElementsByTagName("cols/col",this.sheetFile),n=0;n<t.length;n++){var s=t[n],o=s.attributeList,i=_t(o,"min",null),a=_t(o,"max",null),l=_t(o,"width",null),u=_t(o,"hidden",null),c=_t(o,"customWidth",null);if(!(i==null||a==null))for(var h=parseInt(i)-1,d=parseInt(a)-1,g=parseFloat(l),m=h;m<=d;m++)l!=null&&(this.config.columnlen==null&&(this.config.columnlen={}),this.config.columnlen[m]=V_(g)),u=="1"&&(this.config.colhidden==null&&(this.config.colhidden={}),this.config.colhidden[m]=0,this.config.columnlen&&delete this.config.columnlen[m]),c!=null&&(this.config.customWidth==null&&(this.config.customWidth={}),this.config.customWidth[m]=1)}},e.prototype.generateConfigRowLenAndHiddenAddCell=function(){var t=this.readXml.getElementsByTagName("sheetData/row",this.sheetFile),n={},s={};n.formulaList=s;for(var o=0;o<t.length;o++){var i=t[o],a=i.attributeList,l=_t(a,"r",null),u=_t(a,"ht",null),c=_t(a,"hidden",null),h=_t(a,"customHeight",null);if(l!=null){var d=parseInt(l)-1;if(u!=null){var g=parseFloat(u);this.config.rowlen==null&&(this.config.rowlen={}),this.config.rowlen[d]=$_(g)}if(c=="1"&&(this.config.rowhidden==null&&(this.config.rowhidden={}),this.config.rowhidden[d]=0,this.config.rowlen&&delete this.config.rowlen[d]),h!=null&&(this.config.customHeight==null&&(this.config.customHeight={}),this.config.customHeight[d]=1),this.isInitialCell){var m=i.getInnerElements("c");for(var f in m){var p=m[f],b=new FA(p,this.styles,this.sharedStrings,this.mergeCells,this.sheetFile,this.readXml);if(b._borderObject!=null&&(this.config.borderInfo==null&&(this.config.borderInfo=[]),this.config.borderInfo.push(b._borderObject),delete b._borderObject),b._formulaType=="shared"){this.formulaRefList==null&&(this.formulaRefList={}),this.formulaRefList[b._formulaSi]==null&&(this.formulaRefList[b._formulaSi]={});var v=void 0;b.v!=null&&(v=b.v.f);var w={t:b._formulaType,ref:b._fomulaRef,si:b._formulaSi,fv:v,cellValue:b};b._fomulaRef!=null?this.formulaRefList[b._formulaSi].mainRef=w:this.formulaRefList[b._formulaSi][b.r+"_"+b.c]=w}if(b.v!=null&&b.v.f!=null){var S={r:b.r,c:b.c};n.formulaList["r"+b.r+"c"+b.c]=S}this.celldata.push(b)}}}}return n},e}(Y_),We={};We.G={concat:function(r,e){for(var t=0;t<e.cmds.length;t++)r.cmds.push(e.cmds[t]);for(var t=0;t<e.crds.length;t++)r.crds.push(e.crds[t])},getBB:function(r){for(var e=1e99,t=1e99,n=-e,s=-t,o=0;o<r.length;o+=2){var i=r[o],a=r[o+1];i<e?e=i:i>n&&(n=i),a<t?t=a:a>s&&(s=a)}return[e,t,n,s]},rectToPath:function(r){return{cmds:["M","L","L","L","Z"],crds:[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]]}},insideBox:function(r,e){return e[0]<=r[0]&&e[1]<=r[1]&&r[2]<=e[2]&&r[3]<=e[3]},isBox:function(r,e){var t=function(c,h){for(var d=0;d<8;d+=2){for(var g=!0,m=0;m<8;m++)if(Math.abs(h[m]-c[m+d&7])>=2){g=!1;break}if(g)return!0}return!1};if(r.cmds.length>10)return!1;var n=r.cmds.join(""),s=r.crds,o=!1;if(n=="MLLLZ"&&s.length==8||n=="MLLLLZ"&&s.length==10){s.length==10&&(s=s.slice(0,8));var i=e[0],a=e[1],l=e[2],u=e[3];o||(o=t(s,[i,a,l,a,l,u,i,u])),o||(o=t(s,[i,u,l,u,l,a,i,a]))}return o},boxArea:function(r){var e=r[2]-r[0],t=r[3]-r[1];return e*t},newPath:function(r){r.pth={cmds:[],crds:[]}},moveTo:function(r,e,t){var n=We.M.multPoint(r.ctm,[e,t]);r.pth.cmds.push("M"),r.pth.crds.push(n[0],n[1]),r.cpos=n},lineTo:function(r,e,t){var n=We.M.multPoint(r.ctm,[e,t]);r.cpos[0]==n[0]&&r.cpos[1]==n[1]||(r.pth.cmds.push("L"),r.pth.crds.push(n[0],n[1]),r.cpos=n)},curveTo:function(r,e,t,n,s,o,i){var a;a=We.M.multPoint(r.ctm,[e,t]),e=a[0],t=a[1],a=We.M.multPoint(r.ctm,[n,s]),n=a[0],s=a[1],a=We.M.multPoint(r.ctm,[o,i]),o=a[0],i=a[1],r.cpos=a,r.pth.cmds.push("C"),r.pth.crds.push(e,t,n,s,o,i)},closePath:function(r){r.pth.cmds.push("Z")},arc:function(r,e,R,n,s,o,i){if(i)for(;o>s;)o-=2*Math.PI;else for(;o<s;)o+=2*Math.PI;var a=(o-s)/4,l=Math.cos(a/2),u=-Math.sin(a/2),c=(4-l)/3,h=u==0?u:(1-l)*(3-l)/(3*u),d=c,g=-h,m=l,f=-u,p=[c,h],b=[d,g],v=[m,f],w={cmds:[r.pth.cmds.length==0?"M":"L","C","C","C","C"],crds:[l,u,c,h,d,g,m,f]},S=[1,0,0,1,0,0];We.M.rotate(S,-a);for(var T=0;T<3;T++)p=We.M.multPoint(S,p),b=We.M.multPoint(S,b),v=We.M.multPoint(S,v),w.crds.push(p[0],p[1],b[0],b[1],v[0],v[1]);var D=[n,0,0,n,e,R];We.M.rotate(S,-s+a/2),We.M.concat(S,D),We.M.multArray(S,w.crds),We.M.multArray(r.ctm,w.crds),We.G.concat(r.pth,w);var R=w.crds.pop();e=w.crds.pop(),r.cpos=[e,R]},toPoly:function(r){if(r.cmds[0]!="M"||r.cmds[r.cmds.length-1]!="Z")return null;for(var e=1;e<r.cmds.length-1;e++)if(r.cmds[e]!="L")return null;var t=[],n=r.crds.length;r.crds[0]==r.crds[n-2]&&r.crds[1]==r.crds[n-1]&&(n-=2);for(var e=0;e<n;e+=2)t.push([r.crds[e],r.crds[e+1]]);return We.G.polyArea(r.crds)<0&&t.reverse(),t},fromPoly:function(r){for(var e={cmds:[],crds:[]},t=0;t<r.length;t++)e.crds.push(r[t][0],r[t][1]),e.cmds.push(t==0?"M":"L");return e.cmds.push("Z"),e},polyArea:function(r){if(r.length<6)return 0;for(var e=r.length-2,t=(r[0]-r[e])*(r[e+1]+r[1]),n=0;n<e;n+=2)t+=(r[n+2]-r[n])*(r[n+1]+r[n+3]);return-t*.5},polyClip:function(r,e){var t,n,s,o,i=function(d){return(n[0]-t[0])*(d[1]-t[1])>(n[1]-t[1])*(d[0]-t[0])},a=function(){var d=[t[0]-n[0],t[1]-n[1]],g=[s[0]-o[0],s[1]-o[1]],m=t[0]*n[1]-t[1]*n[0],f=s[0]*o[1]-s[1]*o[0],p=1/(d[0]*g[1]-d[1]*g[0]);return[(m*g[0]-f*d[0])*p,(m*g[1]-f*d[1])*p]},l=r;t=e[e.length-1];for(var u in e){var n=e[u],c=l;l=[],s=c[c.length-1];for(var h in c){var o=c[h];i(o)?(i(s)||l.push(a()),l.push(o)):i(s)&&l.push(a()),s=o}t=n}return l}},We.M={getScale:function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))},translate:function(r,e,t){We.M.concat(r,[1,0,0,1,e,t])},rotate:function(r,e){We.M.concat(r,[Math.cos(e),-Math.sin(e),Math.sin(e),Math.cos(e),0,0])},scale:function(r,e,t){We.M.concat(r,[e,0,0,t,0,0])},concat:function(r,e){var t=r[0],n=r[1],s=r[2],o=r[3],i=r[4],a=r[5];r[0]=t*e[0]+n*e[2],r[1]=t*e[1]+n*e[3],r[2]=s*e[0]+o*e[2],r[3]=s*e[1]+o*e[3],r[4]=i*e[0]+a*e[2]+e[4],r[5]=i*e[1]+a*e[3]+e[5]},invert:function(r){var e=r[0],t=r[1],n=r[2],s=r[3],o=r[4],i=r[5],a=e*s-t*n;r[0]=s/a,r[1]=-t/a,r[2]=-n/a,r[3]=e/a,r[4]=(n*i-s*o)/a,r[5]=(t*o-e*i)/a},multPoint:function(r,e){var t=e[0],n=e[1];return[t*r[0]+n*r[2]+r[4],t*r[1]+n*r[3]+r[5]]},multArray:function(r,e){for(var t=0;t<e.length;t+=2){var n=e[t],s=e[t+1];e[t]=n*r[0]+s*r[2]+r[4],e[t+1]=n*r[1]+s*r[3]+r[5]}}},We.C={srgbGamma:function(r){return r<.0031308?12.92*r:1.055*Math.pow(r,.4166666666666667)-.055},cmykToRgb:function(r){var e=r[0],t=r[1],n=r[2],s=r[3],o=255+e*(-4.387332384609988*e+54.48615194189176*t+18.82290502165302*n+212.25662451639585*s+-285.2331026137004)+t*(1.7149763477362134*t-5.6096736904047315*n+-17.873870861415444*s-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*s+17.5119270841813)+s*(-21.86122147463605*s-189.48180835922747),i=255+e*(8.841041422036149*e+60.118027045597366*t+6.871425592049007*n+31.159100130055922*s+-79.2970844816548)+t*(-15.310361306967817*t+17.575251261109482*n+131.35250912493976*s-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*s-24.86741582555878)+s*(-20.737325471181034*s-187.80453709719578),a=255+e*(.8842522430003296*e+8.078677503112928*t+30.89978309703729*n-.23883238689178934*s+-14.183576799673286)+t*(10.49593273432072*t+63.02378494754052*n+50.606957656360734*s-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*s+-193.58209356861505)+s*(-22.33816807309886*s-180.12613974708367);return[Math.max(0,Math.min(1,o/255)),Math.max(0,Math.min(1,i/255)),Math.max(0,Math.min(1,a/255))]},labToRgb:function(r){for(var e=903.3,t=.008856,n=r[0],s=r[1],o=r[2],i=(n+16)/116,a=i*i*i,l=i-o/200,u=l*l*l,c=s/500+i,h=c*c*c,d=u>t?u:(116*l-16)/e,g=a>t?a:(116*i-16)/e,m=h>t?h:(116*c-16)/e,f=m*96.72,p=g*100,b=d*81.427,v=[f/100,p/100,b/100],w=[3.1338561,-1.6168667,-.4906146,-.9787684,1.9161415,.033454,.0719453,-.2289914,1.4052427],S=[w[0]*v[0]+w[1]*v[1]+w[2]*v[2],w[3]*v[0]+w[4]*v[1]+w[5]*v[2],w[6]*v[0]+w[7]*v[1]+w[8]*v[2]],T=0;T<3;T++)S[T]=Math.max(0,Math.min(1,We.C.srgbGamma(S[T])));return S}},We.getState=function(r){return{font:We.getFont(),dd:{flat:1},space:"/DeviceGray",ca:1,colr:[0,0,0],sspace:"/DeviceGray",CA:1,COLR:[0,0,0],bmode:"/Normal",SA:!1,OPM:0,AIS:!1,OP:!1,op:!1,SMask:"/None",lwidth:1,lcap:0,ljoin:0,mlimit:10,SM:.1,doff:0,dash:[],ctm:[1,0,0,1,0,0],cpos:[0,0],pth:{cmds:[],crds:[]},cpth:r?We.G.rectToPath(r):null}},We.getFont=function(){return{Tc:0,Tw:0,Th:100,Tl:0,Tf:"Helvetica-Bold",Tfs:1,Tmode:0,Trise:0,Tk:0,Tal:0,Tun:0,Tm:[1,0,0,1,0,0],Tlm:[1,0,0,1,0,0],Trm:[1,0,0,1,0,0]}};var je=function(){};je.Parse=function(r,e){r=new Uint8Array(r);for(var t=0,n={fill:!1,strk:!1,bb:[0,0,1,1],wbb:[0,0,1,1],fnt:{nam:"Arial",hgh:25,und:!1,orn:0},tclr:[0,0,0],talg:0},s,o=[],i=[],a=je.B.readShort,l=je.B.readUshort,u=je.B.readInt,c=je.B.readUint,h=je.B.readFloat;;){var d=c(r,t);t+=4;var g=je.K[d],m=c(r,t);t+=4;var f=t,p=null,b=0;if(g=="EOF")break;if(g=="HEADER")n.bb=je._readBox(r,f),f+=16,e.StartPage(n.bb[0],n.bb[1],n.bb[2],n.bb[3]),s=We.getState(n.bb);else if(g=="SAVEDC")i.push(JSON.stringify(s),JSON.stringify(n));else if(g=="RESTOREDC"){var v=u(r,f);for(f+=4;v<-1;)i.pop(),i.pop();n=JSON.parse(i.pop()),s=JSON.parse(i.pop())}else if(g=="SELECTCLIPPATH")s.cpth=JSON.parse(JSON.stringify(s.pth));else if(["SETMAPMODE","SETPOLYFILLMODE","SETBKMODE","SETICMMODE","SETROP2","EXTSELECTCLIPRGN"].indexOf(g)==-1){if(g=="SETMITERLIMIT")s.mlimit=c(r,f);else if(g=="SETTEXTCOLOR")n.tclr=[r[f]/255,r[f+1]/255,r[f+2]/255];else if(g=="SETTEXTALIGN")n.talg=c(r,f);else if(g=="SETVIEWPORTEXTEX"||g=="SETVIEWPORTORGEX"){n.vbb==null&&(n.vbb=[]);var w=g=="SETVIEWPORTORGEX"?0:2;n.vbb[w]=u(r,f),f+=4,n.vbb[w+1]=u(r,f),f+=4,g=="SETVIEWPORTEXTEX"&&je._updateCtm(n,s)}else if(g=="SETWINDOWEXTEX"||g=="SETWINDOWORGEX"){var w=g=="SETWINDOWORGEX"?0:2;n.wbb[w]=u(r,f),f+=4,n.wbb[w+1]=u(r,f),f+=4,g=="SETWINDOWEXTEX"&&je._updateCtm(n,s)}else if(g=="COMMENT")c(r,f),f+=4;else if(g=="SELECTOBJECT"){var S=c(r,f);if(f+=4,S==2147483648)n.fill=!0,s.colr=[1,1,1];else if(S==2147483653)n.fill=!1;else if(S==2147483655)n.strk=!0,n.lwidth=1,s.COLR=[0,0,0];else if(S==2147483656)n.strk=!1;else if(S!=2147483661){if(S!=2147483662){var T=o[S];if(T.t=="b"){if(n.fill=T.stl!=1,T.stl!=0){if(T.stl!=1)throw T.stl+" e"}s.colr=T.clr}else if(T.t=="p")n.strk=T.stl!=5,s.lwidth=T.wid,s.COLR=T.clr;else if(T.t=="f")n.fnt=T,s.font.Tf=T.nam,s.font.Tfs=Math.abs(T.hgh),s.font.Tun=T.und;else throw"e"}}}else if(g=="DELETEOBJECT"){var S=c(r,f);if(f+=4,o[S]!=null)o[S]=null;else throw"e"}else if(g=="CREATEBRUSHINDIRECT")b=c(r,f),f+=4,p={t:"b"},p.stl=c(r,f),f+=4,p.clr=[r[f]/255,r[f+1]/255,r[f+2]/255],f+=4,p.htc=c(r,f),f+=4;else if(g=="CREATEPEN"||g=="EXTCREATEPEN")b=c(r,f),f+=4,p={t:"p"},g=="EXTCREATEPEN"?(f+=16,p.stl=c(r,f),f+=4,p.wid=c(r,f),f+=4,f+=4):(p.stl=c(r,f),f+=4,p.wid=c(r,f),f+=4,f+=4),p.clr=[r[f]/255,r[f+1]/255,r[f+2]/255],f+=4;else if(g=="EXTCREATEFONTINDIRECTW"){b=c(r,f),f+=4,p={t:"f",nam:""},p.hgh=u(r,f),f+=4,f+=8,p.orn=u(r,f)/10,f+=4;var D=c(r,f);for(f+=4,p.und=r[f+1],p.stk=r[f+2],f+=8;l(r,f)!=0;)p.nam+=String.fromCharCode(l(r,f)),f+=2;D>500&&(p.nam+="-Bold")}else if(g=="EXTTEXTOUTW"){f+=16;var R=c(r,f);f+=4,h(r,f),f+=4,h(r,f),f+=4;var I=u(r,f);f+=4;var y=u(r,f);f+=4,s.font.Tm=[1,0,0,-1,0,0],We.M.rotate(s.font.Tm,n.fnt.orn*Math.PI/180),We.M.translate(s.font.Tm,I,y);var O=n.talg;if((O&6)==6)s.font.Tal=2;else if((O&7)==0)s.font.Tal=0;else throw O+" e";if((O&24)!=24)if((O&24)==0)We.M.translate(s.font.Tm,0,s.font.Tfs);else throw"e";var M=c(r,f);f+=4;var F=c(r,f);f+=4,c(r,f),f+=4,f+=16,c(r,f),f+=4,F+=t-8;for(var x="",E=0;E<M;E++){var N=l(r,F+E*2);x+=String.fromCharCode(N)}var X=s.colr;s.colr=n.tclr,e.PutText(s,x,x.length*s.font.Tfs*.5),s.colr=X}else if(g=="BEGINPATH")We.G.newPath(s);else if(g!="ENDPATH")if(g=="CLOSEFIGURE")We.G.closePath(s);else if(g=="MOVETOEX")We.G.moveTo(s,u(r,f),u(r,f+4));else if(g=="LINETO"){if(s.pth.cmds.length==0){var L=s.ctm.slice(0);We.M.invert(L);var ne=We.M.multPoint(L,s.cpos);We.G.moveTo(s,ne[0],ne[1])}We.G.lineTo(s,u(r,f),u(r,f+4))}else if(g=="POLYGON"||g=="POLYGON16"||g=="POLYLINE"||g=="POLYLINE16"||g=="POLYLINETO"||g=="POLYLINETO16"){f+=16;var G=g.startsWith("POLYGON"),Q=g.indexOf("TO")!=-1,P=c(r,f);f+=4,Q||We.G.newPath(s),f=je._drawPoly(r,f,P,s,g.endsWith("16")?2:4,G,Q),Q||je._draw(e,s,n,G)}else if(g=="POLYPOLYGON16"){f+=16;var G=g.startsWith("POLYPOLYGON"),Q=g.indexOf("TO")!=-1,V=c(r,f);f+=4,f+=4;var pe=f;f+=V*4,Q||We.G.newPath(s);for(var E=0;E<V;E++){var oe=l(r,pe+E*4);f=je._drawPoly(r,f,oe,s,g.endsWith("16")?2:4,G,Q)}Q||je._draw(e,s,n,G)}else if(g=="POLYBEZIER"||g=="POLYBEZIER16"||g=="POLYBEZIERTO"||g=="POLYBEZIERTO16"){f+=16;var Z=g.endsWith("16"),ie=Z?a:u,be=Z?2:4,P=c(r,f);for(f+=4,g.indexOf("TO")==-1&&(We.G.moveTo(s,ie(r,f),ie(r,f+be)),f+=2*be,P--);P>0;)We.G.curveTo(s,ie(r,f),ie(r,f+be),ie(r,f+2*be),ie(r,f+3*be),ie(r,f+4*be),ie(r,f+5*be)),f+=6*be,P-=3}else if(g=="RECTANGLE"||g=="ELLIPSE"){We.G.newPath(s);var Ce=je._readBox(r,f);if(g=="RECTANGLE")We.G.moveTo(s,Ce[0],Ce[1]),We.G.lineTo(s,Ce[2],Ce[1]),We.G.lineTo(s,Ce[2],Ce[3]),We.G.lineTo(s,Ce[0],Ce[3]);else{var fe=(Ce[0]+Ce[2])/2,Te=(Ce[1]+Ce[3])/2;We.G.arc(s,fe,Te,(Ce[2]-Ce[0])/2,0,2*Math.PI,!1)}We.G.closePath(s),je._draw(e,s,n,!0)}else if(g=="FILLPATH")e.Fill(s,!1);else if(g=="STROKEPATH")e.Stroke(s);else if(g=="STROKEANDFILLPATH")e.Fill(s,!1),e.Stroke(s);else if(g=="SETWORLDTRANSFORM"||g=="MODIFYWORLDTRANSFORM"){for(var Le=[],E=0;E<6;E++)Le.push(h(r,f+E*4));if(f+=24,g=="SETWORLDTRANSFORM")s.ctm=Le;else{var R=c(r,f);if(f+=4,R==2){var Ze=s.ctm;s.ctm=Le,We.M.concat(s.ctm,Ze)}else throw"e"}}else if(g=="SETSTRETCHBLTMODE")c(r,f),f+=4;else if(g=="STRETCHDIBITS"){var Ce=je._readBox(r,f);f+=16;var Ne=u(r,f);f+=4;var A=u(r,f);f+=4,u(r,f),f+=4,u(r,f),f+=4;var se=u(r,f);f+=4;var re=u(r,f);f+=4;var B=c(r,f)+t-8;f+=4,c(r,f),f+=4;var k=c(r,f)+t-8;f+=4,c(r,f),f+=4;var Y=c(r,f);if(f+=4,Y!=0)throw"e";c(r,f),f+=4;var le=u(r,f);f+=4;var ae=u(r,f);f+=4,c(r,B),B+=4;var j=c(r,B);B+=4;var he=c(r,B);if(B+=4,j!=se||he!=re)throw"e";var H=l(r,B);B+=2;var z=l(r,B);if(B+=2,z!=8&&z!=24&&z!=32)throw z+" e";var J=c(r,B);if(B+=4,J!=0)throw J+" e";c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4;var ue=Math.floor((j*H*z+31&-32)/8),de=new Uint8Array(j*he*4);if(z==8)for(var Te=0;Te<he;Te++)for(var fe=0;fe<j;fe++){var ze=Te*j+fe<<2,S=r[k+(he-1-Te)*ue+fe]<<2;de[ze]=r[B+S+2],de[ze+1]=r[B+S+1],de[ze+2]=r[B+S+0],de[ze+3]=255}if(z==24)for(var Te=0;Te<he;Te++)for(var fe=0;fe<j;fe++){var ze=Te*j+fe<<2,De=k+(he-1-Te)*ue+fe*3;de[ze]=r[De+2],de[ze+1]=r[De+1],de[ze+2]=r[De+0],de[ze+3]=255}if(z==32)for(var Te=0;Te<he;Te++)for(var fe=0;fe<j;fe++){var ze=Te*j+fe<<2,De=k+(he-1-Te)*ue+fe*4;de[ze]=r[De+2],de[ze+1]=r[De+1],de[ze+2]=r[De+0],de[ze+3]=r[De+3]}var Be=s.ctm.slice(0);s.ctm=[1,0,0,1,0,0],We.M.scale(s.ctm,le,-ae),We.M.translate(s.ctm,Ne,A+ae),We.M.concat(s.ctm,Be),e.PutImage(s,de,j,he),s.ctm=Be}else console.log(g,m)}p!=null&&(o[b]=p),t+=m-8}e.ShowPage(),e.Done()},je._readBox=function(r,e){for(var t=[],n=0;n<4;n++)t[n]=je.B.readInt(r,e+n*4);return t},je._updateCtm=function(r,e){var t=[1,0,0,1,0,0],n=r.wbb;r.bb;var s=r.vbb&&r.vbb.length==4?r.vbb:r.bb;We.M.translate(t,-n[0],-n[1]),We.M.scale(t,1/n[2],1/n[3]),We.M.scale(t,s[2],s[3]),e.ctm=t},je._draw=function(r,e,t,n){t.fill&&n&&r.Fill(e,!1),t.strk&&e.lwidth!=0&&r.Stroke(e)},je._drawPoly=function(r,e,t,n,s,o,i){for(var a=s==2?je.B.readShort:je.B.readInt,l=0;l<t;l++){var u=a(r,e);e+=s;var c=a(r,e);e+=s,l==0&&!i?We.G.moveTo(n,u,c):We.G.lineTo(n,u,c)}return o&&We.G.closePath(n),e},je.B={uint8:new Uint8Array(4),readShort:function(r,e){var t=je.B.uint8;return t[0]=r[e],t[1]=r[e+1],je.B.int16[0]},readUshort:function(r,e){var t=je.B.uint8;return t[0]=r[e],t[1]=r[e+1],je.B.uint16[0]},readInt:function(r,e){var t=je.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],je.B.int32[0]},readUint:function(r,e){var t=je.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],je.B.uint32[0]},readFloat:function(r,e){var t=je.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],je.B.flot32[0]},readASCII:function(r,e,t){for(var n="",s=0;s<t;s++)n+=String.fromCharCode(r[e+s]);return n}},je.B.int16=new Int16Array(je.B.uint8.buffer),je.B.uint16=new Uint16Array(je.B.uint8.buffer),je.B.int32=new Int32Array(je.B.uint8.buffer),je.B.uint32=new Uint32Array(je.B.uint8.buffer),je.B.flot32=new Float32Array(je.B.uint8.buffer),je.C={EMR_HEADER:1,EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122},je.K=[];var un=function(r,e){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.bb=null,this.currPage=0,this.needPage=r,this.scale=e};un.prototype.StartPage=function(r,e,t,n){if(this.currPage==this.needPage){this.bb=[r,e,t,n];var s=this.scale,o=window.devicePixelRatio,i=this.canvas,a=this.ctx;i.width=Math.round(t*s),i.height=Math.round(n*s),a.translate(0,n*s),a.scale(s,-s),i.setAttribute("style","border:1px solid; width:"+i.width/o+"px; height:"+i.height/o+"px")}},un.prototype.Fill=function(r,e){if(this.currPage==this.needPage){var t=this.ctx;t.beginPath(),this._setStyle(r,t),this._draw(r.pth,t),t.fill()}},un.prototype.Stroke=function(r){if(this.currPage==this.needPage){var e=this.ctx;e.beginPath(),this._setStyle(r,e),this._draw(r.pth,e),e.stroke()}},un.prototype.PutText=function(r,e,t){if(this.currPage==this.needPage){this._scale(r.ctm);var n=this.ctx;this._setStyle(r,n),n.save();var s=[1,0,0,-1,0,0];this._concat(s,r.font.Tm),this._concat(s,r.ctm),n.transform(s[0],s[1],s[2],s[3],s[4],s[5]),n.fillText(e,0,0),n.restore()}},un.prototype.PutImage=function(r,e,t,n,s){if(this.currPage==this.needPage){var o=this.ctx;if(e.length==t*n*4){if(e=e.slice(0),s&&s.length==t*n*4)for(var i=0;i<e.length;i+=4)e[i+3]=s[i+1];var a=document.createElement("canvas"),l=a.getContext("2d");a.width=t,a.height=n;for(var u=l.createImageData(t,n),i=0;i<e.length;i++)u.data[i]=e[i];l.putImageData(u,0,0),o.save();var c=[1,0,0,1,0,0];this._concat(c,[1/t,0,0,-1/n,0,1]),this._concat(c,r.ctm),o.transform(c[0],c[1],c[2],c[3],c[4],c[5]),o.drawImage(a,0,0),o.restore()}}},un.prototype.ShowPage=function(){this.currPage++},un.prototype.Done=function(){};function NA(r){return""+parseFloat(r.toFixed(2))}un.prototype._setStyle=function(r,e){var t=this._scale(r.ctm);e.fillStyle=this._getFill(r.colr,r.ca,e),e.strokeStyle=this._getFill(r.COLR,r.CA,e),e.lineCap=["butt","round","square"][r.lcap],e.lineJoin=["miter","round","bevel"][r.ljoin],e.lineWidth=r.lwidth*t;for(var n=r.dash.slice(0),s=0;s<n.length;s++)n[s]=NA(n[s]*t);e.setLineDash(n),e.miterLimit=r.mlimit*t;var o=r.font.Tf,i=o.toLowerCase(),a=i.indexOf("bold")!=-1?"bold ":"",l=i.indexOf("italic")!=-1||i.indexOf("oblique")!=-1?"italic ":"";e.font=a+l+r.font.Tfs+'px "'+o+'"'},un.prototype._getFill=function(r,e,t){if(r.typ==null)return this._colr(r,e);var n=r,s=n.crds,o=n.mat,i=this._scale(o),a;if(n.typ=="lin"){var l=this._multPoint(o,s.slice(0,2)),u=this._multPoint(o,s.slice(2));a=t.createLinearGradient(l[0],l[1],u[0],u[1])}else if(n.typ=="rad"){var l=this._multPoint(o,s.slice(0,2)),u=this._multPoint(o,s.slice(3));a=t.createRadialGradient(l[0],l[1],s[2]*i,u[0],u[1],s[5]*i)}for(var c=0;c<n.grad.length;c++)a.addColorStop(n.grad[c][0],this._colr(n.grad[c][1],e));return a},un.prototype._colr=function(r,e){return"rgba("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+","+e+")"},un.prototype._scale=function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))},un.prototype._concat=function(r,e){var t=r[0],n=r[1],s=r[2],o=r[3],i=r[4],a=r[5];r[0]=t*e[0]+n*e[2],r[1]=t*e[1]+n*e[3],r[2]=s*e[0]+o*e[2],r[3]=s*e[1]+o*e[3],r[4]=i*e[0]+a*e[2]+e[4],r[5]=i*e[1]+a*e[3]+e[5]},un.prototype._multPoint=function(r,e){var t=e[0],n=e[1];return[t*r[0]+n*r[2]+r[4],t*r[1]+n*r[3]+r[5]]},un.prototype._draw=function(r,e){for(var t=0,n=r.crds,s=0;s<r.cmds.length;s++){var o=r.cmds[s];o=="M"?(e.moveTo(n[t],n[t+1]),t+=2):o=="L"?(e.lineTo(n[t],n[t+1]),t+=2):o=="C"?(e.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):o=="Q"?(e.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):o=="Z"&&e.closePath()}};var kA=function(){function r(e){if(e!=null){this.images={};for(var t in e)if(t.indexOf("xl/media/")>-1){var n=t.split("."),s=n[n.length-1].toLowerCase();if(s in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1,emf:1})if(s=="emf"){var o=0,i=1,a=new un(o,i),l,u,c;je.K=[],l=je.C,u=je.K,c=4;for(var h in l)u[l[h]]=h.slice(c);je.Parse(e[t],a),this.images[t]=a.canvas.toDataURL("image/png")}else this.images[t]=e[t]}}}return r.prototype.getImageByName=function(e){if(e in this.images){var t=this.images[e];return new BA(e,t)}return null},r}(),BA=function(r){Go(e,r);function e(t,n){var s=r.call(this)||this;return s.src=n,s}return e.prototype.setDefault=function(){},e}(OA),Z_=function(r){Go(e,r);function e(t,n){var s=r.call(this)||this;s.columnWidthSet=[],s.rowHeightSet=[],s.files=t,s.fileName=n,s.readXml=new EA(t),s.getSheetNameList(),s.sharedStrings=s.readXml.getElementsByTagName("sst/si",sA),s.calcChain=s.readXml.getElementsByTagName("calcChain/c",rA),s.styles={},s.styles.cellXfs=s.readXml.getElementsByTagName("cellXfs/xf",Br),s.styles.cellStyleXfs=s.readXml.getElementsByTagName("cellStyleXfs/xf",Br),s.styles.cellStyles=s.readXml.getElementsByTagName("cellStyles/cellStyle",Br),s.styles.fonts=s.readXml.getElementsByTagName("fonts/font",Br),s.styles.fills=s.readXml.getElementsByTagName("fills/fill",Br),s.styles.borders=s.readXml.getElementsByTagName("borders/border",Br),s.styles.clrScheme=s.readXml.getElementsByTagName("a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink",oA),s.styles.indexedColors=s.readXml.getElementsByTagName("colors/indexedColors/rgbColor",Br),s.styles.mruColors=s.readXml.getElementsByTagName("colors/mruColors/color",Br),s.imageList=new kA(t);for(var o=s.readXml.getElementsByTagName("numFmt/numFmt",Br),i=JSON.parse(JSON.stringify(z_)),a=0;a<o.length;a++){var l=o[a].attributeList,u=_t(l,"numFmtId","49"),c=_t(l,"formatCode","@");u in z_||(i[u]=c)}return s.styles.numfmts=i,s}return e.prototype.getSheetNameList=function(){var t=this.readXml.getElementsByTagName("Relationships/Relationship",iA);if(t!=null){for(var n=new RegExp("worksheets/[^/]*?.xml"),s={},o=0;o<t.length;o++){var i=t[o],a=i.attributeList,l=a.Id,u=a.Target;n.test(u)&&(u.startsWith("/xl")?s[l]=u.substr(1):s[l]="xl/"+u)}this.sheetNameList=s}},e.prototype.getSheetFileBysheetId=function(t){return this.sheetNameList[t]},e.prototype.getWorkBookInfo=function(){var t=this.readXml.getElementsByTagName("Company",U_),n=this.readXml.getElementsByTagName("AppVersion",U_),s=this.readXml.getElementsByTagName("dc:creator",Zl),o=this.readXml.getElementsByTagName("cp:lastModifiedBy",Zl),i=this.readXml.getElementsByTagName("dcterms:created",Zl),a=this.readXml.getElementsByTagName("dcterms:modified",Zl);this.info=new SA,this.info.name=this.fileName,this.info.creator=s.length>0?s[0].value:"",this.info.lastmodifiedby=o.length>0?o[0].value:"",this.info.createdTime=i.length>0?i[0].value:"",this.info.modifiedTime=a.length>0?a[0].value:"",this.info.company=t.length>0?t[0].value:"",this.info.appversion=n.length>0?n[0].value:""},e.prototype.getSheetsFull=function(t){t===void 0&&(t=!0);var n=this.readXml.getElementsByTagName("sheets/sheet",nA),s={};for(var o in n){var i=n[o];s[i.attributeList.name]=i.attributeList.sheetId}this.sheets=[];var a=0;for(var o in n){var i=n[o],l=i.attributeList.name,u=i.attributeList.sheetId,c=i.attributeList["r:id"],h=this.getSheetFileBysheetId(c),d=this.readXml.getElementsByTagName("worksheet/drawing",h),g=void 0,m=void 0;if(d!=null&&d.length>0){var f=d[0].attributeList,p=_t(f,"r:id",null);p!=null&&(g=this.getDrawingFile(p,h),m=this.getDrawingRelsFile(g))}if(h!=null){var b=new MA(l,u,a,t,{sheetFile:h,readXml:this.readXml,sheetList:s,styles:this.styles,sharedStrings:this.sharedStrings,calcChain:this.calcChain,imageList:this.imageList,drawingFile:g,drawingRelsFile:m});this.columnWidthSet=[],this.rowHeightSet=[],this.imagePositionCaculation(b),this.sheets.push(b),a++}}},e.prototype.extendArray=function(t,n,s,o,i){if(!(t<n.length)){var a=n.length,l=t,u=0;a>0&&(u=n[a-1]);for(var c=a;c<=l;c++){var h=s,d=c.toString();d in o?h=0:d in i&&(h=i[d]),u+=Math.round(h+1),n.push(u)}}},e.prototype.imagePositionCaculation=function(t){var n=t.images,s=t.defaultColWidth,o=t.defaultRowHeight,i={};t.config.colhidden&&(i=t.config.colhidden);var a={};t.config.columnlen&&(a=t.config.columnlen);var l={};t.config.rowhidden&&(l=t.config.rowhidden);var u={};t.config.rowlen&&(u=t.config.rowlen);for(var c in n){var h=n[c],d=h.fromCol,g=h.fromColOff,m=h.fromRow,f=h.fromRowOff,p=h.toCol,b=h.toColOff,v=h.toRow,w=h.toRowOff,S=0,T=0,D=0,R=0;d>=this.columnWidthSet.length&&this.extendArray(d,this.columnWidthSet,s,i,a),d==0?S=0:S=this.columnWidthSet[d-1],S=S+g,m>=this.rowHeightSet.length&&this.extendArray(m,this.rowHeightSet,o,l,u),m==0?T=0:T=this.rowHeightSet[m-1],T=T+f,p>=this.columnWidthSet.length&&this.extendArray(p,this.columnWidthSet,s,i,a),p==0?D=0:D=this.columnWidthSet[p-1],D=D+b-S,v>=this.rowHeightSet.length&&this.extendArray(v,this.rowHeightSet,o,l,u),v==0?R=0:R=this.rowHeightSet[v-1],R=R+w-T,console.log(s,i,a),console.log(d,this.columnWidthSet[d],g),console.log(p,this.columnWidthSet[p],b,JSON.stringify(this.columnWidthSet)),h.originWidth=D,h.originHeight=R,h.crop.height=R,h.crop.width=D,h.default.height=R,h.default.left=S,h.default.top=T,h.default.width=D}console.log(this.columnWidthSet,this.rowHeightSet)},e.prototype.getDrawingFile=function(t,n){var s="xl/worksheets/_rels/",o=n.split("/"),i=o[o.length-1],a=s+i+".rels",l=this.readXml.getElementsByTagName("Relationships/Relationship",a);if(l.length>0)for(var u=0;u<l.length;u++){var c=l[u],h=c.attributeList,d=_t(h,"Id",null);if(d==t){var g=_t(h,"Target",null);if(g!=null)return g.replace(/\.\.\//g,"")}}return null},e.prototype.getDrawingRelsFile=function(t){var n="xl/drawings/_rels/",s=t.split("/"),o=s[s.length-1],i=n+o+".rels";return i},e.prototype.getSheetsWithoutCell=function(){this.getSheetsFull(!1)},e.prototype.Parse=function(){return this.getWorkBookInfo(),this.getSheetsFull(),this.toJsonString(this)},e.prototype.toJsonString=function(t){var n=new X_;return n.info=t.info,n.sheets=[],t.sheets.forEach(function(s){var o=new Y_;s.name!=null&&(o.name=s.name),s.color!=null&&(o.color=s.color),s.config!=null&&(o.config=s.config),s.index!=null&&(o.index=s.index),s.status!=null&&(o.status=s.status),s.order!=null&&(o.order=s.order),s.row!=null&&(o.row=s.row),s.column!=null&&(o.column=s.column),s.luckysheet_select_save!=null&&(o.luckysheet_select_save=s.luckysheet_select_save),s.scrollLeft!=null&&(o.scrollLeft=s.scrollLeft),s.scrollTop!=null&&(o.scrollTop=s.scrollTop),s.zoomRatio!=null&&(o.zoomRatio=s.zoomRatio),s.showGridLines!=null&&(o.showGridLines=s.showGridLines),s.defaultColWidth!=null&&(o.defaultColWidth=s.defaultColWidth),s.defaultRowHeight!=null&&(o.defaultRowHeight=s.defaultRowHeight),s.celldata!=null&&(o.celldata=[],s.celldata.forEach(function(i){var a=new j_;a.r=i.r,a.c=i.c,a.v=i.v,o.celldata.push(a)})),s.chart!=null&&(o.chart=s.chart),s.isPivotTable!=null&&(o.isPivotTable=s.isPivotTable),s.pivotTable!=null&&(o.pivotTable=s.pivotTable),s.luckysheet_conditionformat_save!=null&&(o.luckysheet_conditionformat_save=s.luckysheet_conditionformat_save),s.freezen!=null&&(o.freezen=s.freezen),s.calcChain!=null&&(o.calcChain=s.calcChain),s.images!=null&&(o.images=s.images),n.sheets.push(o)}),JSON.stringify(n)},e}(X_),q_=function(){function r(e){this.uploadFile=e}return r.prototype.unzipFile=function(e,t){Qi.loadAsync(this.uploadFile).then(function(n){var s={},o=Object.keys(n.files).length,i=0;n.forEach(function(a,l){var u=l.name,c=u.split("."),h=c[c.length-1].toLowerCase(),d="string";h in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?d="base64":h=="emf"&&(d="arraybuffer"),l.async(d).then(function(g){d=="base64"&&(g="data:image/"+h+";base64,"+g),s[l.name]=g,o==i+1&&e(s),i++})})},function(n){t(n)})},r.prototype.unzipFileByUrl=function(e,t,n){new Qi,CA(e,function(s,o){if(s)throw s;Qi.loadAsync(o).then(function(i){var a={},l=Object.keys(i.files).length,u=0;i.forEach(function(c,h){var d=h.name,g=d.split("."),m=g[g.length-1].toLowerCase(),f="string";m in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?f="base64":m=="emf"&&(f="arraybuffer"),h.async(f).then(function(p){f=="base64"&&(p="data:image/"+m+";base64,"+p),a[h.name]=p,l==u+1&&t(a),u++})})},function(i){n(i)})})},r.prototype.newZipFile=function(){var e=new Qi;this.workBook=e},r.prototype.addToZipFile=function(e,t){if(this.workBook==null){var n=new Qi;this.workBook=n}this.workBook.file(e,t)},r}(),LA=function(){function r(){}return r.transformExcelToLucky=function(e,t){var n=new q_(e);n.unzipFile(function(s){var o=new Z_(s,e.name),i=o.Parse(),a=JSON.parse(i);t!=null&&t(a,i)},function(s){console.error(s)})},r.transformExcelToLuckyByUrl=function(e,t,n){var s=new q_;s.unzipFileByUrl(e,function(o){var i=new Z_(o,t),a=i.Parse(),l=JSON.parse(a);n!=null&&n(l,a)},function(o){console.error(o)})},r.transformLuckyToExcel=function(e,t){},r}();class PA{constructor(e){this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Pe.SPREADSHEET),this._toolButton={name:L_,type:qc.FIX,locale:"importXlsx.tooltip",tooltipLocale:"importXlsx.tooltip",show:!0,hideSelectedIcon:!0,children:[{locale:"importXlsx.upload",onClick:()=>{this.upload()}}]},this._sheetPlugin.addToolButton(this._toolButton)}upload(){const e=document.createElement("input");e.type="file",e.accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",e.addEventListener("change",t=>{const n=t.currentTarget;this.handleFiles(n.files)}),e.click()}handleFiles(e){if(e==null||e.length==0){alert("No files wait for import");return}let n=e[0].name.split(".");if(n[n.length-1]!="xlsx"){alert("Currently only supports the import of xlsx files");return}const o=LA.transformExcelToLucky;o(e[0],i=>{if(i.sheets==null||i.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}const a={container:"universheet",data:i.sheets,title:i.info.name},u=vf(a).sheets;if(!u)return alert("No content");const c=this._plugin.getContext().getWorkBook();W.deepClone(c.getConfig().sheetOrder),Object.keys(u).forEach(h=>{const d=u[h];c.insertSheet(d)})})}}class HA extends Ic{execute(){this._plugin.getImportXlsxController().handleFiles(this._data)}}class UA extends V6{get zIndex(){return 1}create(e){return new HA(e,this._plugin)}check(e){const t=[];return e.forEach(n=>{n.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&t.push(n.file)}),t.length>0?this.create(t):!1}}class nu extends sn{constructor(e){super(L_)}static create(e){return new nu(e)}installTo(e){e.installPlugin(this)}initialize(){this.getContext().getLocale().load({en:tA,zh:eA}),this._importXlsxController=new PA(this),this.registerExtension()}registerExtension(){const e=this.getContext().getPluginManager().getRequirePluginByName(Pe.BASE_COMPONENT).getRegisterManager().getDragAndDropExtensionManager().getRegister();this._dragAndDropExtensionFactory=new UA(this),e.add(this._dragAndDropExtensionFactory)}onMounted(){this.initialize()}onDestroy(){this.getContext().getPluginManager().getRequirePluginByName(Pe.BASE_COMPONENT).getRegisterManager().getDragAndDropExtensionManager().getRegister().delete(this._dragAndDropExtensionFactory)}getImportXlsxController(){return this._importXlsxController}}var zA=Object.freeze(Object.defineProperty({__proto__:null,ImportXlsxPlugin:nu},Symbol.toStringTag,{value:"Module"}));const WA={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:lt.COLUMN,posOffset:100},positionV:{relativeFrom:ct.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:rn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Hn.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:vt.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:vt.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:vt.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:vt.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:21},{bulletAlignment:vt.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:42},{bulletAlignment:vt.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:cn.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:K.DRAWING},{elementId:"smallSub",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},ru={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:cn.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"smallSub",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},VA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:["sheet-01","sheet-02","sheet-03","sheet-04","sheet-05","sheet-06"],pluginMeta:{},styles:{1:{cl:{rgb:"blue"},fs:16,bd:{t:{s:C.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:C.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:C.THICK,cl:{rgb:"black"}},b:{s:C.THIN,cl:{rgb:"red"}}},ht:3},2:{bg:{rgb:"rgb(200, 2, 0)"},fs:24,ht:ut.RIGHT,vt:tn.TOP},3:{ht:ut.RIGHT,vt:tn.MIDDLE,tb:kt.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:te.FALSE},bd:{t:{s:C.THIN,cl:{rgb:"black"}},l:{s:C.THIN,cl:{rgb:"black"}},r:{s:C.THIN,cl:{rgb:"black"}},b:{s:C.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}},5:{tb:kt.WRAP}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-01":{type:Dt.GRID,id:"sheet-01",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:1,m:"1"},1:{v:1,m:"1"},2:{v:80,m:"80",s:"3"},3:{v:"\u5BCC\u6587\u672C\u7F16\u8F91",m:"\u5BCC\u6587\u672C\u7F16\u8F91",s:"2"}},2:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:"\u505A\u79FB\u52A8\u7AEF\u5F00\u53D1\u548C\u524D\u7AEF\u5F00\u53D1\u7684\u4EBA\u5458\uFF0C\u5BF9 MVC\u3001MVP\u3001MVVM \u8FD9\u51E0\u4E2A\u540D\u8BCD\u5E94\u8BE5\u90FD\u4E0D\u964C\u751F\uFF0C\u8FD9\u662F\u4E09\u4E2A\u6700\u5E38\u7528\u7684\u5E94\u7528\u67B6\u6784\u6A21\u5F0F\uFF0C\u76EE\u7684\u90FD\u662F\u4E3A\u4E86\u5C06\u4E1A\u52A1\u548C\u89C6\u56FE\u7684\u5B9E\u73B0\u4EE3\u7801\u5206\u79BB",s:"3",p:ru}},20:{10:{v:"\u5317\u4EAC\u9A6C\u62C9\u677E\u7EC4\u59D4\u4F1A\u529E\u516C\u5BA4\u4E00\u4F4D\u63A5\u7535\u8BDD\u7684\u5973\u58EB\u8BC1\u5B9E\uFF0C\u7684\u786E\u6709\u8FD9\u9879\u89C4\u5B9A\uFF0C\u5979\u8FD8\u79F02014\u5E74\u9A6C\u62C9\u677E\u7684\u9884\u767B\u8BB0\u5DE5\u4F5C\u5C06\u5728\u672C\u5468\u542F\u52A8\u3002\u5317\u4EAC\u9A6C\u62C9\u677E\u6BD4\u8D5B\u5C06\u572810\u670819\u65E5\u4E3E\u884C\u3002",s:"3"},12:{s:"4"}},29:{13:{p:W.deepClone(ru),s:"4"}},32:{3:{p:WA,s:"5"}}},name:"sheet1",tabColor:"red",hidden:te.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10},{startRow:32,endRow:53,startColumn:3,endColumn:5}],rowData:{3:{h:50,hd:te.FALSE},4:{h:60,hd:te.FALSE},29:{h:200,hd:te.FALSE}},columnData:{5:{w:100,hd:te.FALSE},6:{w:200,hd:te.FALSE},13:{w:300,hd:te.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-02":{type:Dt.GRID,id:"sheet-02",name:"sheet2",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},20:{0:{v:"sheet2",m:"sheet2"},1:{v:"sheet2 - 2",m:"sheet2 - 2"}}}},"sheet-03":{type:Dt.GRID,id:"sheet-03",name:"sheet3"},"sheet-04":{type:Dt.GRID,id:"sheet-04",name:"sheet4"},"sheet-05":{type:Dt.GRID,id:"sheet-05",name:"sheet5"},"sheet-06":{type:Dt.GRID,id:"sheet-06",name:"sheet6"}},namedRanges:[{namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}},{namedRangeId:"named-range-02",name:"namedRange02",range:{sheetId:"sheet-01",rangeData:{startRow:4,startColumn:2,endRow:5,endColumn:3}}}]},$A={id:"workbook-02",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{cl:{rgb:"green"},fs:16,bd:{t:{s:C.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:C.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:C.THICK,cl:{rgb:"black"}},b:{s:C.THIN,cl:{rgb:"blue"}}},ht:3},2:{bg:{rgb:"rgb(2, 200, 0)"},fs:24},3:{ht:ut.RIGHT,vt:tn.TOP,tb:kt.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:te.FALSE},bd:{t:{s:C.THIN,cl:{rgb:"black"}},l:{s:C.THIN,cl:{rgb:"black"}},r:{s:C.THIN,cl:{rgb:"black"}},b:{s:C.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Dt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",v:2,m:"2"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:22,m:"22"},1:{v:22,m:"22"},2:{v:80,m:"80",s:"3"},3:{v:"\u5BCC\u6587\u672C\u7F16\u8F91",m:"\u5BCC\u6587\u672C\u7F16\u8F91",s:"2"}},2:{0:{v:2222,m:"2222"},1:{v:2222,m:"2222"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:"\u505A\u79FB\u52A8\u7AEF\u5F00\u53D1\u548C\u524D\u7AEF\u5F00\u53D1\u7684\u4EBA\u5458\uFF0C\u5BF9 MVC\u3001MVP\u3001MVVM \u8FD9\u51E0\u4E2A\u540D\u8BCD\u5E94\u8BE5\u90FD\u4E0D\u964C\u751F\uFF0C\u8FD9\u662F\u4E09\u4E2A\u6700\u5E38\u7528\u7684\u5E94\u7528\u67B6\u6784\u6A21\u5F0F\uFF0C\u76EE\u7684\u90FD\u662F\u4E3A\u4E86\u5C06\u4E1A\u52A1\u548C\u89C6\u56FE\u7684\u5B9E\u73B0\u4EE3\u7801\u5206\u79BB",s:"3",p:ru}},20:{10:{v:"\u5317\u4EAC\u9A6C\u62C9\u677E\u7EC4\u59D4\u4F1A\u529E\u516C\u5BA4\u4E00\u4F4D\u63A5\u7535\u8BDD\u7684\u5973\u58EB\u8BC1\u5B9E\uFF0C\u7684\u786E\u6709\u8FD9\u9879\u89C4\u5B9A\uFF0C\u5979\u8FD8\u79F02014\u5E74\u9A6C\u62C9\u677E\u7684\u9884\u767B\u8BB0\u5DE5\u4F5C\u5C06\u5728\u672C\u5468\u542F\u52A8\u3002\u5317\u4EAC\u9A6C\u62C9\u677E\u6BD4\u8D5B\u5C06\u572810\u670819\u65E5\u4E3E\u884C\u3002",s:"3"},12:{s:"4"}},29:{13:{p:W.deepClone(ru),s:"4"}}},name:"sheet0001",tabColor:"green",hidden:te.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10}],rowData:{3:{h:50,hd:te.FALSE},4:{h:60,hd:te.FALSE},29:{h:200,hd:te.FALSE}},columnData:{5:{w:100,hd:te.FALSE},6:{w:200,hd:te.FALSE},13:{w:300,hd:te.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0002":{type:Dt.GRID,id:"sheet-0002",name:"sheet0003"}},namedRanges:[{namedRangeId:"named-range-0001",name:"namedRange0001",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},GA={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement",paragraphElementType:K.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:K.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:K.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:K.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:K.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},XA={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},YA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"UniverSheet Demo",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:Dt.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:XA,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)         \u4E07        \u4EDF        \u4F70        \u62FE        \u5143        \u89D2        \u5206",s:"49"},7:{m:"(Lower) \xA5",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:te.FALSE,freezeColumn:1,rowCount:10,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0003":{type:Dt.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:te.FALSE,freezeColumn:1,rowCount:27,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:30}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0002":{type:Dt.GRID,id:"sheet-0002",name:"sheet0003",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"\xB7",s:"123"}}},tabColor:"yellow",hidden:te.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0001":{type:Dt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1\u3001Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2\u3001Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3\u3001Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:GA}}},name:"sheet0001",tabColor:"red",hidden:te.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:0,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},jA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0003":{type:Dt.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:te.FALSE,freezeColumn:1,rowCount:27,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:30}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0003",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},KA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0002":{type:Dt.GRID,id:"sheet-0002",name:"sheet0003",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"\xB7",s:"123"}}},tabColor:"yellow",hidden:te.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},ZA={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement",paragraphElementType:K.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:K.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:K.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:K.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:K.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:K.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},qA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Dt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1\u3001Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2\u3001Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3\u3001Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:ZA}}},name:"sheet0001",tabColor:"red",hidden:te.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},JA={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Fe.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},QA={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:Dt.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:JA,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)         \u4E07        \u4EDF        \u4F70        \u62FE        \u5143        \u89D2        \u5206",s:"49"},7:{m:"(Lower) \xA5",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:te.FALSE,freezeColumn:1,rowCount:10,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},jo={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:vt.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:vt.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:vt.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:vt.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:21},{bulletAlignment:vt.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:42},{bulletAlignment:vt.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Wt.ROMAN,hanging:21,indentStart:63}]}},eR={id:"d",lists:jo,body:{blockElements:{p1:{blockId:"p1",st:0,ed:66,blockType:Fe.PARAGRAPH,paragraph:{elements:{e1:{eId:"e1",st:0,ed:66,et:K.TEXT_RUN,tr:{ct:"What\u2019s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:te.TRUE,fs:16,cl:{rgb:"rgb(255,255,255)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p2:{blockId:"p2",st:67,ed:251,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:67,ed:251,et:K.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:12,cl:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p3:{blockId:"p3",st:252,ed:401,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:252,ed:401,et:K.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p4:{blockId:"p4",st:402,ed:429,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:402,ed:429,et:K.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p13:{blockId:"p13",st:2020+28,ed:2250+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2020+28,ed:2042+28,et:K.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:12,bl:te.TRUE}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p14:{blockId:"p14",st:2251+28,ed:2393+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2251+28,ed:2265+28,et:K.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:12,bl:te.TRUE}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p5:{blockId:"p5",st:430,ed:479,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:430,ed:479,et:K.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p15:{blockId:"p15",st:2394+28,ed:2582+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2394+28,ed:2422+28,et:K.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:12,cl:{rgb:"rgb(0, 0, 0)"},bl:te.TRUE}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p6:{blockId:"p6",st:480,ed:510,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:480,ed:510,et:K.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["p1","p3","p4","p13","p14","p5","p15","p6"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},su={id:"workbook-01",theme:"default",locale:bn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},6:{ht:1,vt:2,tb:3,bg:{rgb:"rgba(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Dt.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:te.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"},9:{p:eR,s:"6"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1},{startRow:1,endRow:10,startColumn:9,endColumn:10}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},tR={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:lt.COLUMN,posOffset:100},positionV:{relativeFrom:ct.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:rn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Hn.BOTH_SIDES}},lists:jo,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:16,ed:17,et:K.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:cn.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:18,ed:59,et:K.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:K.DRAWING},{elementId:"smallSub",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:60,ed:88,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:60,ed:74,et:K.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:75,ed:88,et:K.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:89,ed:230,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:89,ed:138,et:K.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:139,ed:230,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:231,ed:322,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:231,ed:286,et:K.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:287,ed:322,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:323,ed:400,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:323,ed:360,et:K.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:361,ed:400,et:K.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN},{elementId:"twoElement",paragraphElementType:K.TEXT_RUN}]}},oneSectionBreak:{blockId:"oneSectionBreak",st:0,ed:0,blockType:Fe.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:20}],columnSeparatorType:Pn.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph","oneSectionBreak"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},J_={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:1484*.15,height:864*.15},positionH:{relativeFrom:lt.COLUMN,posOffset:130},positionV:{relativeFrom:ct.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/gartner-tech-2022.png"}},layoutType:rn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Hn.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:2548*.1,height:2343*.1},positionH:{relativeFrom:lt.COLUMN,posOffset:130},positionV:{relativeFrom:ct.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:rn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Hn.BOTH_SIDES}},lists:jo,body:{blockElements:{p1:{blockId:"p1",st:0,ed:66,blockType:Fe.PARAGRAPH,paragraph:{elements:{e1:{eId:"e1",st:0,ed:66,et:K.TEXT_RUN,tr:{ct:"What\u2019s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:te.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p2:{blockId:"p2",st:67,ed:251,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:67,ed:251,et:K.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p3:{blockId:"p3",st:252,ed:401,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:252,ed:401,et:K.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p4:{blockId:"p4",st:402,ed:429,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:402,ed:429,et:K.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p5:{blockId:"p5",st:430,ed:479,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:430,ed:479,et:K.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p6:{blockId:"p6",st:480,ed:510,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:480,ed:510,et:K.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p7:{blockId:"p7",st:511,ed:705,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:511,ed:672,et:K.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},e2:{eId:"e2",st:673,ed:705,et:K.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN},{elementId:"e2",paragraphElementType:K.TEXT_RUN}]}},p8:{blockId:"p8",st:706,ed:762,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:{e1:{eId:"e1",st:706,ed:762,et:K.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p9:{blockId:"p9",st:763,ed:1233,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:763,ed:1233,et:K.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:K.DRAWING}]}},oneSectionBreak:{blockId:"oneSectionBreak",st:0,ed:0,blockType:Fe.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:Pn.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED}},p10:{blockId:"p10",st:1206+28,ed:1548+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1206+28,ed:1548+28,et:K.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p11:{blockId:"p11",st:1549+28,ed:1944+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1549+28,ed:1944+28,et:K.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p12:{blockId:"p12",st:1945+28,ed:2019+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1945+28,ed:2019+28,et:K.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN}]}},p13:{blockId:"p13",st:2020+28,ed:2250+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2020+28,ed:2042+28,et:K.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}},e2:{eId:"e2",st:2043+28,ed:2250+28,et:K.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN},{elementId:"e2",paragraphElementType:K.TEXT_RUN}]}},p14:{blockId:"p14",st:2251+28,ed:2393+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2251+28,ed:2265+28,et:K.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}},e2:{eId:"e2",st:2266+28,ed:2393+28,et:K.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN},{elementId:"e2",paragraphElementType:K.TEXT_RUN}]}},p15:{blockId:"p15",st:2394+28,ed:2582+28,blockType:Fe.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2394+28,ed:2422+28,et:K.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:te.TRUE}}},e2:{eId:"e2",st:2423+28,ed:2582+28,et:K.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:K.TEXT_RUN},{elementId:"e2",paragraphElementType:K.TEXT_RUN}]}},twoSectionBreak:{blockId:"twoSectionBreak",st:0,ed:0,blockType:Fe.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:Pn.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED}}},blockElementOrder:["p1","p2","p3","p4","p5","p6","p7","p8","p9","oneSectionBreak","p10","p11","p12","p13","p14","p15","twoSectionBreak"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},nR={id:"cover_1",pageType:br.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:Ie.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:Ie.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},rR={id:"catalog_1",pageType:br.SLIDE,zIndex:2,title:"catalog",description:"this is second page, catalog",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:3,left:180,top:240,width:200,height:40,title:"Catalog",description:"",type:Ie.TEXT,richText:{text:"Catalog",fs:42,cl:{rgb:"rgb(255,255,255)"}}},centerRect1:{id:"centerRect1",zIndex:2,left:140,top:168,width:203,height:203,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},firstRect1:{id:"firstRect1",zIndex:2,left:547,top:115,width:44,height:44,title:"index1",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},secondRect1:{id:"secondRect1",zIndex:2,left:547,top:210,width:44,height:44,title:"index2",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},thirdRect1:{id:"thirdRect1",zIndex:2,left:547,top:304,width:44,height:44,title:"index2",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},forth1:{id:"forth1",zIndex:2,left:547,top:397,width:44,height:44,title:"index2",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},first_index1:{id:"first_index1",zIndex:3,left:557,top:120,width:44,height:44,title:"mask",description:"",type:Ie.TEXT,richText:{text:"01",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},first_title1:{id:"first_title1",zIndex:3,left:610,top:115,width:248,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Strategic technology trends",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},first_detail1:{id:"first_detail1",zIndex:3,left:610,top:140,width:300,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"How they impact business goals.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},second_index1:{id:"second_index1",zIndex:3,left:557,top:215,width:44,height:44,title:"mask",description:"",type:Ie.TEXT,richText:{text:"02",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},second_title1:{id:"second_title1",zIndex:3,left:610,top:210,width:248,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Technical profile",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},second_detail1:{id:"second_detail1",zIndex:3,left:610,top:235,width:300,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"What the technologies are and do.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},third_index1:{id:"third_index1",zIndex:3,left:557,top:310,width:44,height:44,title:"mask",description:"",type:Ie.TEXT,richText:{text:"03",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},third_title1:{id:"third_title1",zIndex:3,left:610,top:305,width:248,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Opportunities",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},third_detail1:{id:"third_detail1",zIndex:3,left:610,top:330,width:300,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"What benefits and outcomes they drive.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},forth_index1:{id:"forth_index1",zIndex:3,left:557,top:405,width:44,height:44,title:"mask",description:"",type:Ie.TEXT,richText:{text:"04",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},forth_title1:{id:"forth_title1",zIndex:3,left:610,top:400,width:248,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Implementation steps",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},forth_detail1:{id:"forth_detail1",zIndex:3,left:610,top:425,width:300,height:39,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Action plans for implementation.",fs:14,cl:{rgb:"rgb(255,255,255)"}}}}},sR={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:Ie.TEXT,richText:{rich:{id:"d",lists:jo,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},oR={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:Ie.TEXT,richText:{rich:{id:"d",lists:jo,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},iR={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:Ie.TEXT,richText:{rich:{id:"d",lists:jo,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:Fe.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:K.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:K.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},aR={id:"strategic_1",pageType:br.SLIDE,zIndex:1,title:"cover",description:"this is third page, strategic",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:117*.3,height:16*.3,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Strategic technology trends",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Ie.TEXT,richText:{text:"We expect the 2023 trends to impact enterprise strategies in the coming three years by enabling organizations to address four key priorities:",fs:18,cl:{rgb:"rgb(127,127,127)"}}},chart1:{id:"chart1",zIndex:2,left:53,top:214,width:125,height:58,title:"chart1",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(105,126,146)"}}}},chartTitle1:{id:"chartTitle1",zIndex:3,left:53,top:186,width:84,height:28,title:"chartTitle1",description:"",type:Ie.TEXT,richText:{text:"Optimize",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber1:{id:"chartNumber1",zIndex:3,left:63,top:230,width:61,height:36,title:"chartNumber1",description:"",type:Ie.TEXT,richText:{text:"20%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart2:{id:"chart2",zIndex:2,left:178,top:214,width:428,height:58,title:"chart2",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(57,74,87)"}}}},chartTitle2:{id:"chartTitle2",zIndex:3,left:178,top:186,width:59,height:28,title:"chartTitle2",description:"",type:Ie.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber2:{id:"chartNumber2",zIndex:3,left:188,top:230,width:61,height:36,title:"chartNumber2",description:"",type:Ie.TEXT,richText:{text:"50%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart3:{id:"chart3",zIndex:2,left:605,top:214,width:302,height:58,title:"chart3",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},chartTitle3:{id:"chartTitle3",zIndex:3,left:605,top:186,width:74,height:28,title:"chartTitle3",description:"",type:Ie.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber3:{id:"chartNumber3",zIndex:3,left:615,top:230,width:61,height:36,title:"chartNumber3",description:"",type:Ie.TEXT,richText:{text:"30%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:53,top:326,width:152,height:28,title:"detailTitle1",description:"",type:Ie.TEXT,richText:{text:"Theme 1: Optimize",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:sR,detailTitle2:{id:"detailTitle2",zIndex:3,left:334,top:326,width:129,height:28,title:"detailTitle2",description:"",type:Ie.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent2:oR,detailTitle3:{id:"detailTitle3",zIndex:3,left:652,top:326,width:143,height:28,title:"detailTitle3",description:"",type:Ie.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent3:iR}},lR=su.sheets[su.sheetOrder[0]],uR=su.styles,cR={id:"business_1",pageType:br.SLIDE,zIndex:2,title:"business",description:"this is second page, business",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:117*.3,height:16*.3,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Ie.TEXT,richText:{text:"The Business Objectives",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Ie.TEXT,richText:{text:"What we hope to achieve in the short and long run",fs:18,cl:{rgb:"rgb(127,127,127)"}}},spreadSheet1:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:Ie.SPREADSHEET,spreadsheet:{worksheet:lR,styles:uR}}}},hR={id:"technology_1",pageType:br.SLIDE,zIndex:2,title:"technology",description:"this is second page, technology",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:117*.3,height:16*.3,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Ie.TEXT,richText:{text:"Sustainable Technology",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Ie.TEXT,richText:{text:"Delivering technology alone will not be enough in 2023",fs:18,cl:{rgb:"rgb(127,127,127)"}}},picture1:{id:"picture1",zIndex:2,left:53,top:151,width:258,height:156,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P1.png"}}},picture2:{id:"picture2",zIndex:2,left:315,top:151,width:241,height:156,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P2.png"}}},picture3:{id:"picture3",zIndex:2,left:53,top:310,width:258,height:156,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P3.png"}}},picture4:{id:"picture4",zIndex:2,left:310,top:315,width:241,height:156,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/P4.jpg"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"detailTitle1",description:"",type:Ie.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:{id:"detailContent1",zIndex:3,left:580,top:167,width:373,height:81,title:"detailContent1",description:"",type:Ie.TEXT,richText:{text:"Investments in sustainable technology also have the potential to create greater operational resiliency and financial performance, while providing new avenues for growth.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitle1:{id:"listTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"listTitle1",description:"",type:Ie.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},listTitlePicture1:{id:"listTitlePicture1",zIndex:2,left:572,top:261,width:53,height:53,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon1.png"}}},listContent1:{id:"listContent1",zIndex:3,left:637,top:265,width:309,height:61,title:"listContent1",description:"",type:Ie.TEXT,richText:{text:"Gartner\u2019s Top 10 Strategic Technology Trends will help fulfill your business needs to optimize, scale or pioneer.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture2:{id:"listTitlePicture2",zIndex:2,left:572,top:341,width:53,height:53,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon2.png"}}},listContent2:{id:"listContent2",zIndex:3,left:637,top:345,width:309,height:61,title:"listContent2",description:"",type:Ie.TEXT,richText:{text:"The trends allow you to align your technology innovation with the future strategic objectives of your enterprise.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture3:{id:"listTitlePicture3",zIndex:2,left:572,top:421,width:53,height:53,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/icon3.png"}}},listContent3:{id:"listContent3",zIndex:3,left:637,top:425,width:309,height:61,title:"listContent3",description:"",type:Ie.TEXT,richText:{text:"Investments in sustainable technology provide operational and financial benefits, and can create growth opportunities.",fs:12,cl:{rgb:"rgb(127,127,127)"}}}}},dR={id:"richText_1",pageType:br.SLIDE,zIndex:2,title:"business",description:"this is fix page, rich text",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Ie.SHAPE,shape:{shapeType:Ot.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:117*.3,height:16*.3,title:"title Icon",description:"",type:Ie.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Ie.TEXT,richText:{text:"The Work-like Editor",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Ie.TEXT,richText:{text:"Open source WYSIWYG editor built for the modern web",fs:18,cl:{rgb:"rgb(127,127,127)"}}},document:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:Ie.DOCUMENT,document:J_}}};var gR=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_WORKBOOK_DATA:VA,DEFAULT_WORKBOOK_DATA_DOWN:$A,DEFAULT_WORKBOOK_DATA_DEMO:YA,DEFAULT_WORKBOOK_DATA_DEMO1:jA,DEFAULT_WORKBOOK_DATA_DEMO2:KA,DEFAULT_WORKBOOK_DATA_DEMO3:qA,DEFAULT_WORKBOOK_DATA_DEMO4:QA,SLIDE_WORKBOOK_DATA:su,DEFAULT_DOCUMENT_DATA:tR,DEFAULT_DOCUMENT_DATA_EN:J_,DEFAULT_SLIDE_DATA:{id:"slide_test",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{cover_1:nR,catalog_1:rR,strategic_1:aR,technology_1:hR,richText_1:dR,business_1:cR},pageOrder:["cover_1","catalog_1","strategic_1","technology_1","richText_1","business_1"]}}},Symbol.toStringTag,{value:"Module"}));class fR{constructor(){}init(e={}){const t=wa.newInstance(e.coreConfig);return t.installPlugin(new Co),t.installPlugin(new dl),t.installPlugin(new xp(e.baseSheetsConfig)),t.installPlugin(new rl),t.installPlugin(new jl(e.numfmtConfig)),Ll.create(e.formulaConfig).installTo(t),t.installPlugin(new Kl),t.installPlugin(new nu),t.installPlugin(new xl(e.collaborationConfig)),t}}const mR=function(r){return new fR().init(r)};class pR{constructor(){}init(e={}){const t=Ea.newInstance(e.coreConfig);return t.installPlugin(new Co),t.installPlugin(new dl),t.installPlugin(new Rl(e.baseDocsConfig)),t}}const _R=function(r){return new pR().init(r)};class bR{constructor(){}init(e={}){const t=Ta.newInstance(e.coreConfig);return t.installPlugin(new Co),t.installPlugin(new dl),t.installPlugin(new Il(e.baseSlidesConfig)),t}}const vR=function(r){return new bR().init(r)};return Ut.BaseComponent=p5,Ut.BaseDocs=jT,Ut.BaseRender=AC,Ut.BaseSheets=yT,Ut.BaseSlides=CS,Ut.CommonPluginCollaboration=yS,Ut.CommonPluginData=gR,Ut.SheetsPluginClipboard=Q7,Ut.SheetsPluginFormula=Jy,Ut.SheetsPluginImportXlsx=zA,Ut.SheetsPluginNumfmt=W7,Ut.StyleUniver=Sw,Ut.UniverCore=E2,Ut.univerDocCustom=_R,Ut.univerSheetCustom=mR,Ut.univerSlideCustom=vR,Object.defineProperties(Ut,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Ut}({});
//# sourceMappingURL=univer-preact-ts.iife.js.map
