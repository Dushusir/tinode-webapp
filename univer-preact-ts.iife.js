var UniverPreactTs=function(jn){"use strict";var wt=(o=>(o[o.OBSERVER_ACTION=1]="OBSERVER_ACTION",o[o.SERVER_ACTION=2]="SERVER_ACTION",o[o.UNDO_ACTION=3]="UNDO_ACTION",o[o.EXTENSION_ACTION=4]="EXTENSION_ACTION",o[o.DEFAULT_ACTION=7]="DEFAULT_ACTION",o))(wt||{});class i6{constructor(e,t){this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class Re extends i6{constructor(e,t,n){super(e,n),this._workbook=t.WorkBookUnit}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class Pa{constructor(e=!1){this.isStopPropagation=!1,this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class ni{constructor(e){this.callback=e,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class ae{constructor(e){this._observers=new Array,this._eventState=new Pa,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const s=new ni(e);return s.unregisterOnNextCall=n,t?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),s}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return t!==-1?(this._observers.splice(t,1),!0):!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let s=0;s<this._observers.length;s++){const r=this._observers[s];if(!r._willBeUnregistered&&(t.lastReturnValue=r.callback(e,t),r.unregisterOnNextCall&&this._deferUnregister(r),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let s=0;s<this._observers.length;s++){const r=this._observers[s];n.skipNextObservers||r._willBeUnregistered||(t=t.then(()=>r.callback(e,n)),r.unregisterOnNextCall&&this._deferUnregister(r))}return t.then(()=>e)}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new ae;return e._observers=this._observers.slice(0),e}}class a6 extends ae{add(e){if(!e)return null;const t=new ni(e);return this._observers=[t],this._onObserverAdded&&this._onObserverAdded(t),t}makeObserverTopPriority(){}makeObserverBottomPriority(){}}class za{constructor(e,t){this.name=e,this.observableHooks=t}}class Ua{constructor(){this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new za(e,t))}getHooks(e){const t=this._observableHooksArray.find(n=>n.name===e);return t?t.observableHooks:null}}function Wa(o,e){let t=0,n=o.length-1;for(;t<=n;){let s=Math.floor((n+t)/2);if(e<o[s]&&(s===0||e>=o[s-1]))return s;if(e>=o[s])t=s+1;else if(e<o[s])n=s-1;else return-1}return-1}function Ha(o,e){let t=0,n=0,s=0,r=-1,i=o.length-1;for(;t<o.length&&i>=0&&i>=t;){if(n=o[i],i===0?s=0:s=o[i-1],e>=s&&e<n){r=i;break}if(n=o[t],t===0?s=0:s=o[t-1],e>=s&&e<n){r=t;break}t++,i--}return r}function jt(o,e){let t=o.length-1;return o.length<40||e<=o[20]||e>=o[t-20]?t=Ha(o,e):t=Wa(o,e),t}const an=o=>o!=null;class xe{static objectKeys(e){if(e){const t=Object.keys(e),n=t.indexOf("length");return n>-1&&t.splice(n,1),t}return[]}static getMaxLength(e){if(e){if(e.length)return e.length;const t=xe.objectKeys(e);if(t.length)return Math.max(...t)+1}return 0}constructor(...e){if(R.hasLength(e,1)){if(R.isObject(e[0])){this._array=e[0],this._length=xe.getMaxLength(this._array);return}if(R.isNumber(e[0])){this._array={},this._length=e[0];return}}if(R.hasLength(e,2)){const t=e[0],n=e[1];this._array=t,this._length=n;return}R.hasLength(e,0)&&(this._array={},this._length=0)}obtain(e,t){var n;return(n=this._array[e])!=null?n:t}getKeys(){return xe.objectKeys(this._array)}get(e){return this._array[e]}set(e,t){if(an(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,s=t[n];return n>0&&(delete t[n],this._length--),s}return null}push(e){if(an(e)){let t=this._length;const n=this._array;n[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let s;for(let r=0;r<n;r++)s=this._array[r+1],an(s)&&(this._array[r]=s);return this._length--,delete this._array[n],t}return null}unshift(e){if(an(e)){const t=this._length,n=this._array,s=t+1;let r=n[0];for(let i=1;i<s;i++){const a=this._array[i];an(r)&&(n[i]=r),r=a}n[0]=e,this._length=s}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return{...this._array,length:this._length}}toArray(){const e=new Array,t=this._array,n=Object.keys(t),s=n.length;for(let r=0;r<s;r++){const i=+n[r];e[i]=t[i]}return e}forEach(e){const t=this._array,n=Object.keys(t),s=n.length;for(let r=0;r<s;r++){const i=+n[r];if(e(i,t[i])===!1)return this}return this}clone(e){const t=new xe;return e?this.forEach((n,s)=>{t.set(n,e(s))}):this.forEach((n,s)=>{t.set(n,s)}),t}isEmpty(){const e=this._array;return Object.keys(e).length===0}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),s=n.length;for(let r=0;r<s;r++){const i=+n[r];if(t[i]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const r={};let i=0;for(let a=e;a<t;a++){const l=n[a];an(l)&&(r[i]=n[a],i++)}return new xe(r,i)}return new xe}concat(e){const t=this._array,n=Object.keys(t),s=n.length,r=e._array,i=Object.keys(r),a=i.length,l=new xe(s+a),c=l._array;let u=0;for(let h=0;h<s;h++,u++){const d=n[h];c[u]=t[d]}for(let h=0;h<a;h++,u++){const d=i[h];c[u]=r[d]}return l}find(e){const t=this._array,n=Object.keys(t),s=n.length;for(let r=0;r<s;r++){const i=+n[r],a=t[i];if(e(i,a)===!0)return a}return null}splice(e,t){const n=this._length;if(n>0){const s=e+t,r=this._array;let i=0;const a={};for(let u=e;u<s;u++){const h=r[u];an(h)&&(delete r[u],a[i]=h,i++)}const l=s-e,c=n;if(this._length-=l,this._length<=0)this._array={},this._length=0;else for(let u=s;u<c;u++){const h=r[u];an(h)&&(r[u-l]=r[u],delete r[u])}return new xe(a,i)}return new xe}findIndex(e){const t=this._array,n=Object.keys(t),s=n.length;for(let r=0;r<s;r++){const i=+n[r];if(e(i,t[i])===!0)return r}return-1}map(e){const t=this._array,n=Object.keys(t),s=n.length,r={};for(let i=0;i<s;i++){const a=+n[i],l=t[a];r[i]=e(l)}return new xe(r)}filter(e){const t=this._array,n=Object.keys(t),s=n.length,r={};let i=0;for(let a=0;a<s;a++){const l=+n[a],c=t[l];e(l,c)&&(r[i]=c,i++)}return new xe(r,i)}insert(e,t){const n=this._length,s=this._array;for(let r=n-1;r>=e;r--)s[r+1]=s[r];return s[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,s=t._length,r=this._array,a=this._length-1;for(let l=a;l>=e;l--){const c=r[l];an(c)&&(delete r[l],r[l+s]=c)}for(let l=0;l<s;l++){const c=n[l];an(c)&&(r[l+e]=n[l])}return this._length+=s,this}[Symbol.iterator](){return new Zs(this)}}class Zs{constructor(e){this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const s=t[n],r=e.get(+s);return this._cursor++,{value:r,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new Zs(this._array)}}class Q{constructor(e={}){if(R.isAssignableFrom(e,Q)){this._matrix=e._matrix;return}if(R.isAssignableFrom(e,xe)){this._matrix=e;return}R.isPlainObject(e)&&(this._matrix=new xe(e))}getMatrix(){return this._matrix}forEach(e){const n=this._matrix.getKeys(),s=n.length;for(let r=0;r<s;r++){const i=+n[r],a=this.getRow(i);if(e(i,a)===!1)return this}return this}forValue(e){const n=this._matrix.getKeys(),s=n.length;for(let r=0;r<s;r++){const i=+n[r],a=this.getRow(i),l=a.getKeys(),c=l.length;for(let u=0;u<c;u++){const h=+l[u],d=a.get(h);if(e(i,h,d)===!1)return this}}return this}swapRow(e,t){const n=this._matrix.get(e),s=this._matrix.get(t);this._matrix.set(t,n),this._matrix.set(e,s)}getRow(e){const{_matrix:t}=this;let n=t.get(e);if(R.isAssignableFrom(n,xe))return n;if(R.isPlainObject(n))return n=new xe(n),t.set(e,n),n}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const n=new xe;return this._matrix.set(e,n),n}reset(){this._matrix=new xe({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._matrix.splice(e,t);return new Q(n)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const n=new Q;return this._matrix.forEach((s,r)=>{var i;for(let a=e;a<e+t;a++)n.setValue(s,a-e,this.getValue(s,a));(i=this._matrix.get(s))==null||i.splice(e,t)}),n}insertColumns(e,t){const n=t.getRow(0).getLength();this.forEach((s,r)=>{var i,a;for(let l=e;l<e+n;l++)(i=t.getRow(s))==null||i.get(l-e),r.insert(l,(a=t.getRow(s))==null?void 0:a.get(l-e))})}getFragments(e,t,n,s){const r=new Q;for(let i=e;i<=t;i++){const a=new xe;for(let l=n;l<=s;l++){const c=this.getValue(i,l);a.push(c)}r.pushRow(a)}return r}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const n=this.getSizeOf();let s=0;const r=this.getLength();for(let i=0;i<r;i++){const a=this.getRow(i);if(a){const l=a.getSizeOf();a.getSizeOf()>s&&(s=l-1)}}return{startRow:0,startColumn:0,endRow:n,endColumn:s}}toArray(){return this._matrix.toArray().map(e=>e.toArray())}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,s=!1;const r=new Q;return this.forEach((i,a)=>{n||(n=!0,e=i),a.forEach((l,c)=>{s?l<t&&(t=l):(s=!0,t=l);const u=this.getValue(i,l);r.setValue(i-e,l-t,u)})}),r.getData()}getDataRange(){let e=0,t=0,n=0,s=!1,r=!1;this.forEach((a,l)=>{s||(s=!0,e=a);const c=l.getLength()-1;c>n&&(n=c),l.forEach((u,h)=>{r?u<t&&(t=u):(r=!0,t=u)})});const i=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:i,endColumn:n}}}const l6=/^-ms-/,c6=/-([a-z])/g,In=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class R{static stringAt(e){let t="",n=e;for(;n>=In.length;)n/=In.length,n-=1,t+=In[n%In.length];const s=e%In.length;return t+=In[s],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const s=e.charCodeAt(n)-65,r=e.length-1-n;t+=In.length**r+In.length*s}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return R.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t=navigator.platform==="Win32"||navigator.platform==="Windows",n=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(n)return"Mac";if(navigator.platform==="X11"&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,s=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,r=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const u=parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return i?"FF":t?"Opera":a?"Safari":l?"Chrome":r?"Edge":s?"IE11":"Unknown browser"}static generateRandomId(){function e(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){t.forEach(i=>i&&r(i));function n(i,a){i.forEach((l,c)=>{var u,h;if(R.isArray(l)){const d=(u=a[c])!=null?u:[];a[c]=d,n(l,d);return}if(R.isObject(l)){const d=(h=a[c])!=null?h:{};a[c]=d,s(l,d);return}a[c]=l})}function s(i,a){Object.keys(i).forEach(l=>{var u,h;const c=i[l];if(R.isObject(c)){const d=(u=a[l])!=null?u:{};a[l]=d,s(c,d);return}if(R.isArray(c)){const d=(h=a[l])!=null?h:[];a[l]=d,n(c,d);return}a[l]=c})}function r(i){Object.keys(i).forEach(a=>{var c,u;const l=i[a];if(R.isArray(l)){const h=(c=e[a])!=null?c:[];e[a]=h,n(l,h);return}if(R.isObject(l)){const h=(u=e[a])!=null?u:{};e[a]=h,s(l,h);return}e[a]=l})}return e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(i,a){const l=R.getValueType(i),c=R.getValueType(a);return l!==c?!1:R.isArray(i)?s(i,a):R.isObject(i)?r(i,a):R.isDate(i)?i.getTime()===a.getTime():R.isRegExp(i)?i.toString()===a.toString():i===a}function s(i,a){if(e.length!==t.length)return!1;for(let l=0,c=i.length;l<c;l++){const u=i[l],h=a[l];if(!n(u,h))return!1}return!0}function r(i,a){const l=Object.keys(i),c=Object.keys(a);if(l.length!==c.length)return!1;for(const u of l){if(!c.includes(u))return!1;const h=i[u],d=a[u];if(!n(h,d))return!1}return!0}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach((n,s)=>{t[s]=R.deepClone(n)}),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=R.deepClone(s)}),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return R.isDefine(e)?R.isDefine(t)?e.length===t:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(l6,"ms-").replace(c6,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];s==null?delete e[n]:R.removeNull(s)}),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map(s=>new Array(t).fill(n))}static fillObjectMatrix(e,t,n){const s=new Q;for(let r=0;r<e;r++)for(let i=0;i<t;i++)s.setValue(r,i,n);return s.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=n===0?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return NaN;const t=e.toLowerCase().split(""),n=t.length;let s=0,r=0;for(let i=0;i<n;i++)r=t[i].charCodeAt(0)-96,s+=r*26**(n-i-1);return s===0?NaN:s-1}static chatAtABC(e){const t="a".charCodeAt(0),s="z".charCodeAt(0)-t+1;let r="";for(;e>=0;)r=String.fromCharCode(e%s+t)+r,e=Math.floor(e/s)-1;return r.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const s=parseInt((Math.random()*n).toString()),r=e[s];e[s]=e[t],e[t]=r}return e}static commonExtend(e,t){let n={};for(let s in e)n[s]=e[s];for(let s in t)t[s]!=null&&(n[s]=t[s]);return n}}var Js=(o=>(o[o.DEFAULT_SERIES=0]="DEFAULT_SERIES",o[o.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",o))(Js||{}),$a=(o=>(o.CELL_EMPTY="CELL_EMPTY",o.CELL_NOT_EMPTY="CELL_NOT_EMPTY",o.DATE_AFTER="DATE_AFTER",o.DATE_BEFORE="DATE_BEFORE",o.DATE_EQUAL_TO="DATE_EQUAL_TO",o.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",o.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",o.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",o.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",o.NUMBER_BETWEEN="NUMBER_BETWEEN",o.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",o.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",o.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",o.NUMBER_LESS_THAN="NUMBER_LESS_THAN",o.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",o.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",o.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",o.TEXT_CONTAINS="TEXT_CONTAINS",o.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",o.TEXT_EQUAL_TO="TEXT_EQUAL_TO",o.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",o.TEXT_STARTS_WITH="TEXT_STARTS_WITH",o.TEXT_ENDS_WITH="TEXT_ENDS_WITH",o.CUSTOM_FORMULA="CUSTOM_FORMULA",o))($a||{}),ye=(o=>(o[o.NONE=0]="NONE",o[o.THIN=1]="THIN",o[o.HAIR=2]="HAIR",o[o.DOTTED=3]="DOTTED",o[o.DASHED=4]="DASHED",o[o.DASH_DOT=5]="DASH_DOT",o[o.DASH_DOT_DOT=6]="DASH_DOT_DOT",o[o.DOUBLE=7]="DOUBLE",o[o.MEDIUM=8]="MEDIUM",o[o.MEDIUM_DASHED=9]="MEDIUM_DASHED",o[o.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",o[o.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",o[o.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",o[o.THICK=13]="THICK",o))(ye||{}),Xt=(o=>(o.TOP="top",o.BOTTOM="bottom",o.LEFT="left",o.RIGHT="right",o.NONE="none",o.ALL="all",o.OUTSIDE="outside",o.INSIDE="inside",o.HORIZONTAL="horizontal",o.VERTICAL="vertical",o))(Xt||{}),Yt=(o=>(o[o.UNSUPPORTED=0]="UNSUPPORTED",o[o.RGB=1]="RGB",o[o.HEX=2]="HEX",o[o.THEME=3]="THEME",o))(Yt||{}),Va=(o=>(o[o.ON=0]="ON",o[o.OFF=1]="OFF",o))(Va||{}),Xa=(o=>(o[o.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",o[o.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",o[o.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",o[o.NUMBER_LESS=3]="NUMBER_LESS",o[o.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",o[o.NUMBER_EQ=5]="NUMBER_EQ",o[o.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",o[o.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",o[o.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",o[o.TEXT_CONTAINS=9]="TEXT_CONTAINS",o[o.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",o[o.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",o[o.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",o[o.TEXT_EQ=13]="TEXT_EQ",o[o.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",o[o.TEXT_IS_URL=15]="TEXT_IS_URL",o[o.DATE_EQ=16]="DATE_EQ",o[o.DATE_BEFORE=17]="DATE_BEFORE",o[o.DATE_AFTER=18]="DATE_AFTER",o[o.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",o[o.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",o[o.DATE_BETWEEN=21]="DATE_BETWEEN",o[o.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",o[o.DATE_IS_VALID=23]="DATE_IS_VALID",o[o.ONE_OF_RANGE=24]="ONE_OF_RANGE",o[o.ONE_OF_LIST=25]="ONE_OF_LIST",o[o.BLANK=26]="BLANK",o[o.NOT_BLANK=27]="NOT_BLANK",o[o.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",o[o.BOOLEAN=29]="BOOLEAN",o[o.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",o[o.DATE_NOT_EQ=31]="DATE_NOT_EQ",o))(Xa||{}),_o=(o=>(o[o.PASTE_NORMAL=0]="PASTE_NORMAL",o[o.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",o[o.PASTE_FORMAT=2]="PASTE_FORMAT",o[o.PASTE_FORMULA=3]="PASTE_FORMULA",o[o.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",o[o.PASTE_VALUES=5]="PASTE_VALUES",o[o.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",o[o.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",o))(_o||{}),Ya=(o=>(o[o.DOCUMENT=0]="DOCUMENT",o[o.PROJECT=1]="PROJECT",o))(Ya||{}),Dn=(o=>(o[o.COLUMNS=0]="COLUMNS",o[o.ROWS=1]="ROWS",o))(Dn||{}),B=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o[o.TOP=2]="TOP",o[o.BOTTOM=3]="BOTTOM",o))(B||{}),Qs=(o=>(o[o.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",o[o.TEXT=1]="TEXT",o[o.NUMBER=2]="NUMBER",o[o.PERCENT=3]="PERCENT",o[o.CURRENCY=4]="CURRENCY",o[o.DATE=5]="DATE",o[o.TIME=6]="TIME",o[o.DATE_TIME=7]="DATE_TIME",o[o.SCIENTIFIC=8]="SCIENTIFIC",o))(Qs||{}),Ga=(o=>(o[o.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",o[o.MIN=1]="MIN",o[o.MAX=2]="MAX",o[o.NUMBER=3]="NUMBER",o[o.PERCENT=4]="PERCENT",o[o.PERCENTILE=5]="PERCENTILE",o))(Ga||{}),ja=(o=>(o[o.BACKSPACE=8]="BACKSPACE",o[o.TAB=9]="TAB",o[o.ENTER=13]="ENTER",o[o.SHIFT=16]="SHIFT",o[o.CTRL=17]="CTRL",o[o.PAUSE=19]="PAUSE",o[o.CAPS_LOCK=20]="CAPS_LOCK",o[o.ESC=27]="ESC",o[o.SPACE=33]="SPACE",o[o.PAGE_UP=33]="PAGE_UP",o[o.PAGE_DOWN=34]="PAGE_DOWN",o[o.END=35]="END",o[o.HOME=36]="HOME",o[o.LEFT=37]="LEFT",o[o.UP=38]="UP",o[o.RIGHT=39]="RIGHT",o[o.DOWN=40]="DOWN",o[o.INSERT=45]="INSERT",o[o.DELETE=46]="DELETE",o[o.WIN=91]="WIN",o[o.WIN_R=92]="WIN_R",o[o.MENU=93]="MENU",o[o.F1=112]="F1",o[o.F2=113]="F2",o[o.F3=114]="F3",o[o.F4=115]="F4",o[o.F5=116]="F5",o[o.F6=117]="F6",o[o.F7=118]="F7",o[o.F8=119]="F8",o[o.F9=120]="F9",o[o.F10=121]="F10",o[o.F11=122]="F11",o[o.F12=123]="F12",o[o.NUM_LOCK=144]="NUM_LOCK",o[o.SCROLL_LOCK=145]="SCROLL_LOCK",o))(ja||{}),Kn=(o=>(o.EN="en",o.ZH="zh",o))(Kn||{}),Ka=(o=>(o[o.RANGE=0]="RANGE",o[o.SHEET=1]="SHEET",o))(Ka||{}),qa=(o=>(o[o.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",o[o.PAST_YEAR=1]="PAST_YEAR",o[o.PAST_MONTH=2]="PAST_MONTH",o[o.PAST_WEEK=3]="PAST_WEEK",o[o.YESTERDAY=4]="YESTERDAY",o[o.TODAY=5]="TODAY",o[o.TOMORROW=6]="TOMORROW",o))(qa||{}),Kt=(o=>(o[o.GRID=0]="GRID",o[o.KANBAN=1]="KANBAN",o[o.GANTT=2]="GANTT",o))(Kt||{}),po=(o=>(o[o.UNSPECIFIED=0]="UNSPECIFIED",o[o.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",o[o.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",o))(po||{}),qe=(o=>(o[o.DASH=0]="DASH",o[o.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",o[o.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",o[o.DASHED_HEAVY=3]="DASHED_HEAVY",o[o.DASH_LONG=4]="DASH_LONG",o[o.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",o[o.DOT_DASH=6]="DOT_DASH",o[o.DOT_DOT_DASH=7]="DOT_DOT_DASH",o[o.DOTTED=8]="DOTTED",o[o.DOTTED_HEAVY=9]="DOTTED_HEAVY",o[o.DOUBLE=10]="DOUBLE",o[o.NONE=11]="NONE",o[o.SINGLE=12]="SINGLE",o[o.THICK=13]="THICK",o[o.WAVE=14]="WAVE",o[o.WAVY_DOUBLE=15]="WAVY_DOUBLE",o[o.WAVY_HEAVY=16]="WAVY_HEAVY",o[o.WORDS=17]="WORDS",o))(qe||{}),ze=(o=>(o[o.UNSPECIFIED=0]="UNSPECIFIED",o[o.LEFT=1]="LEFT",o[o.CENTER=2]="CENTER",o[o.RIGHT=3]="RIGHT",o[o.JUSTIFIED=4]="JUSTIFIED",o))(ze||{}),St=(o=>(o[o.UNSPECIFIED=0]="UNSPECIFIED",o[o.TOP=1]="TOP",o[o.MIDDLE=2]="MIDDLE",o[o.BOTTOM=3]="BOTTOM",o))(St||{}),at=(o=>(o[o.UNSPECIFIED=0]="UNSPECIFIED",o[o.OVERFLOW=1]="OVERFLOW",o[o.CLIP=2]="CLIP",o[o.WRAP=3]="WRAP",o))(at||{}),Za=(o=>(o[o.NORMAL=0]="NORMAL",o[o.ITALIC=1]="ITALIC",o))(Za||{}),Ja=(o=>(o[o.NORMAL=0]="NORMAL",o[o.BOLD=1]="BOLD",o))(Ja||{}),yt=(o=>(o[o.NORMAL=0]="NORMAL",o[o.SUBSCRIPT=1]="SUBSCRIPT",o[o.SUPERSCRIPT=2]="SUPERSCRIPT",o))(yt||{}),Y=(o=>(o[o.FALSE=0]="FALSE",o[o.TRUE=1]="TRUE",o))(Y||{}),ns=(o=>(o[o.STRING=0]="STRING",o[o.NUMBER=1]="NUMBER",o[o.BOOLEAN=2]="BOOLEAN",o[o.FORCE_STRING=3]="FORCE_STRING",o))(ns||{}),xt=(o=>(o[o.DARK1=0]="DARK1",o[o.LIGHT1=1]="LIGHT1",o[o.DARK2=2]="DARK2",o[o.LIGHT2=3]="LIGHT2",o[o.ACCENT1=4]="ACCENT1",o[o.ACCENT2=5]="ACCENT2",o[o.ACCENT3=6]="ACCENT3",o[o.ACCENT4=7]="ACCENT4",o[o.ACCENT5=8]="ACCENT5",o[o.ACCENT6=9]="ACCENT6",o[o.HYPERLINK=10]="HYPERLINK",o[o.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",o))(xt||{}),er=(o=>(o.OFFICE="Office",o.OFFICE_2007_2010="Office 2007-2010",o.GRAYSCALE="Grayscale",o.BLUE_WARM="Blue Warm",o.BLUE="Blue",o.BLUE_II="Blue II",o.BLUE_GREEN="Blue Green",o.GREEN="Green",o.GREEN_YELLOW="Green Yellow",o.YELLOW="Yellow",o.YELLOW_ORANGE="Yellow Orange",o.ORANGE="Orange",o.ORANGE_RED="Orange Red",o.RED_ORANGE="Red Orange",o.RED="Red",o.RED_VIOLET="Red Violet",o.VIOLET="Violet",o.VIOLET_II="Violet II",o.MEDIAN="Median",o.PAPER="Paper",o.MARQUEE="Marquee",o.SLIPSTREAM="Slipstream",o.Aspect="Aspect",o))(er||{});class qn{constructor(){this._colorType=Yt.UNSUPPORTED,this._themeColors=er.OFFICE,this._themeTint=0}asRgbColor(){return new os(this._rgbValue,this)}asThemeColor(){return new oi(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Yt.THEME:return this.asThemeColor();case Yt.RGB:return this.asRgbColor();case Yt.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=Yt.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Yt.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Yt.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Yt.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const Qa={[er.OFFICE]:{[xt.ACCENT1]:"#4472C4",[xt.ACCENT2]:"#ED7D31",[xt.ACCENT3]:"#A5A5A5",[xt.ACCENT4]:"#70AD47",[xt.ACCENT5]:"#5B9BD5",[xt.ACCENT6]:"#70AD47",[xt.DARK1]:"#000000",[xt.DARK2]:"#44546A",[xt.LIGHT1]:"#FFFFFF",[xt.LIGHT2]:"#E7E6E6",[xt.HYPERLINK]:"#0563C1",[xt.FOLLOWED_HYPERLINK]:"#954F72"}};class ln{static rgbColorToHexValue(e){return`#${(16777216+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,s=+`0x${e[4]}${e[5]}`;return new qn().setRgbColor(`rgb(${t},${n},${s})`).asRgbColor()}static hexToRgbString(e){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(r,i,a,l)=>i+i+a+a+l+l);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s=null;if(n){const r=parseInt(n[1],16),i=parseInt(n[2],16),a=parseInt(n[3],16);s=`rgba(${r},${i},${a})`}return s}constructor(e){this._builder=e}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new ln(this._builder)}equals(e){return!1}}class el{constructor(e){const t=e.getRed()/255,n=e.getGreen()/255,s=e.getBlue()/255,r=e.getAlpha()/255,i=Math.min(t,Math.min(n,s)),a=Math.max(t,Math.max(n,s)),l=a-i;if(a===i){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(i+a)/2,this._lightness<.5?this._saturation=l/(a+i):this._saturation=l/(2-a-i),t===a&&(this._hue=(n-s)/l),n===a&&(this._hue=2+(s-t)/l),s===a&&(this._hue=4+(t-n)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=r}asRgbColor(){const e=new qn;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let t;this._lightness<.5?t=this._lightness*(1+this._saturation):t=this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,s=this._hue/360,r=s+1/3,i=this.setColor(t,n,r),a=this.setColor(t,n,s),l=s-1/3,c=this.setColor(t,n,l);return e.setRgbColor(`rgba(${Math.round(i*255)},${Math.round(a*255)},${Math.round(c*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){n<0&&(n+=1),n>1&&(n-=1);let s;return 6*n<1?s=t+(e-t)*6*n:2*n<1?s=e:3*n<2?s=t+(e-t)*(.6666666666666666-n)*6:s=t,s}setLightness(e){this._lightness=e}}const On=class extends ln{constructor(o,e){super(e);let t=o.match(On.RGBA_EXTRACT);if(t){const n=+t[1],s=+t[2],r=+t[3],i=+t[4];this._cssString=o,this._red=n,this._green=s,this._blue=r,this._alpha=i;return}if(t=o.match(On.RGB_EXTRACT),t){const n=+t[1],s=+t[2],r=+t[3];this._cssString=o,this._red=n,this._green=s,this._blue=r,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return ln.rgbColorToHexValue(this)}getRed(){let o=this._red+On.RGB_COLOR_AMT;return o>255?o=255:o<0&&(o=0),o}getGreen(){let o=this._green+On.RGB_COLOR_AMT;return o>255?o=255:o<0&&(o=0),o}getBlue(){let o=this._blue+On.RGB_COLOR_AMT;return o>255?o=255:o<0&&(o=0),o}getAlpha(){return this._alpha}getColorType(){return Yt.RGB}clone(){return new On(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(o){return o instanceof On?o._red===this._red&&o._blue===this._blue&&o._green===this._green&&o._alpha===this._alpha:!1}getCssString(){return this._cssString}};let os=On;os.RGB_COLOR_AMT=0,os.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),os.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const vo=class extends ln{constructor(o,e,t,n){super(n),this._themeColorType=o,this._themeTint=e,this._themeColors=t}lumValue(o,e){if(o==null)return e;let t;return o<0?t=e*(1+o):t=e*(1-o)+(255-255*(1-o)),t}asRgbColor(){const o=Qa[this._themeColors];if(o==null)throw new Error("not find themeColors type");const e=o.get(this._themeColorType);if(e==null)throw new Error("not find themeColors value");let t;if(vo._cacheThemeColor.has(this._themeColors)){if(t=vo._cacheThemeColor.get(this._themeColors),t.has(this._themeColorType))return t.get(this._themeColorType)}else t=new Map,vo._cacheThemeColor.set(this._themeColors,t);const n=new el(ln.hexValueToRgbColor(e));n.setLightness(this.lumValue(this._themeTint,n.getLightness()*255)/255);const s=n.asRgbColor();return t.set(this._themeColorType,s),s}clone(){return new vo(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(o){return o instanceof vo?o._themeColorType===this._themeColorType:!1}getColorType(){return Yt.THEME}getThemeColorType(){return this._themeColorType}};let oi=vo;oi._cacheThemeColor=new Map;var A=(o=>(o.INSERT_ROW_DATA_ACTION="InsertRowDataAction",o.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",o.INSERT_ROW_ACTION="InsertRowAction",o.REMOVE_ROW_ACTION="RemoveRowAction",o.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",o.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",o.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",o.SET_SELECTION_ACTION="SetSelectionActivateAction",o.SET_RANGE_DATA_ACTION="SetRangeDataAction",o.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",o.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",o.DELETE_RANGE_ACTION="DeleteRangeAction",o.INSERT_SHEET_ACTION="InsertSheetAction",o.REMOVE_SHEET_ACTION="RemoveSheetAction",o.CLEAR_RANGE_ACTION="ClearRangeAction",o.INSERT_RANGE_ACTION="InsertRangeAction",o.SET_TAB_COLOR_ACTION="SetTabColorAction",o.HIDE_SHEET_ACTION="SetWorkSheetHideAction",o.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",o.INSERT_COLUMN_ACTION="InsertColumnAction",o.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",o.REMOVE_COLUMN_ACTION="RemoveColumnAction",o.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",o.SET_HIDE_ROW_ACTION="SetRowHideAction",o.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",o.SET_SHOW_ROW_ACTION="SetRowShowAction",o.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",o.ADD_MERGE_ACTION="AddMergeAction",o.REMOVE_MERGE_ACTION="RemoveMergeAction",o.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",o.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",o.SET_BORDER_ACTION="SetBorderAction",o.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",o.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",o.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",o.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",o.DELETE_BANDING_ACTION="DeleteBandingAction",o.SET_BANDING_ACTION="SetBandingAction",o.ADD_BANDING_ACTION="AddBandingAction",o.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",o.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",o.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",o.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",o.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",o.SET_FROZEN_COLUMNS_ACTION="",o.SET_FROZEN_ROWS_ACTION="",o))(A||{});const ss={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},tl={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},bo={startRow:0,startColumn:0,endRow:0,endColumn:0},nl={extensions:[],id:"",sheetOrder:[],socketEnable:Y.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:Kn.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},xn={type:Kt.GRID,name:"",id:"sheet-01",tabColor:"",hidden:Y.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:Y.FALSE,showGridlines:Y.TRUE,rowTitle:{width:46,hidden:Y.FALSE},columnTitle:{height:20,hidden:Y.FALSE},selections:["A1"],rightToLeft:Y.FALSE,pluginMeta:{}},Zn={ff:"Times New Roman",fs:14,it:Y.FALSE,bl:Y.FALSE,ul:{s:Y.FALSE},st:{s:Y.FALSE},ol:{s:Y.FALSE},tr:{a:0,v:Y.FALSE},td:po.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:ze.UNSPECIFIED,vt:St.UNSPECIFIED,tb:at.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},tt={SET:"set",INSERT:"insert",REMOVE:"remove",CHANGE:"change"};var ol=(o=>(o.ARRAY_CONVERTOR="ARRAY_CONVERTOR",o.MATRIX_CONVERTOR="MATRIX_CONVERTOR",o))(ol||{});const si={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var Me=(o=>(o.BASE_COMPONENT="baseComponent",o.BASE_RENDER="renderEngine",o.SPREADSHEET="spreadsheet",o.DOCUMENT="document",o.SLIDE="slide",o))(Me||{});class sl{constructor(e,t){this._workSheet=e,this._columnData=new xe(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new xe;for(let s=e;s<e+t;s++){const r=this.getColumnOrCreate(s);n.push(r)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig();let r=0;if(e.length===1)r=n.obtain(e[0],{hd:Y.FALSE,w:s.defaultColumnWidth}).w;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)r+=n.obtain(i,{hd:Y.FALSE,w:s.defaultColumnWidth}).w;return r}setColumnWidth(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),r={sheetId:this._workSheet.getSheetId(),actionName:A.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},i=new V({WorkBookUnit:n.getWorkBook()},r);s.invoke(i)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig(),r=n.get(e);if(r)return r;const i={w:s.defaultColumnWidth,hd:Y.FALSE};return this._columnData.set(e,i),i}}function rl(o,e){let t=[];for(let n=0;n<e.length;n++)o.add(e[n]);return t}function il(o,e){let t=[];for(let n=0;n<e.length;n++)t=t.concat(o.remove(e[n]));return t}class ri{constructor(e,t,n,s,r){this.operation=e,this.type=t,this.attribute=n,this.key=s,this.value=r}getData(){return this.toJSON()}toJSON(){return{operation:this.operation,key:this.key,value:this.value,type:this.type,attribute:this.attribute}}}class u6 extends ri{constructor(e,t,n,s){super(e,"workbook",t,n,s)}}class nt extends ri{constructor(e,t="",n="",s=""){super(e,"worksheet",t,n,s)}}class al extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.INSERT)]},this._oldActionData={...e,rectangles:this.do(),convertor:[new nt(tt.REMOVE)]},this.validate()}do(){const e=this.getWorkSheet();return rl(e.getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){const e=this.getWorkSheet();il(e.getMerges(),this._doActionData.rectangles)}validate(){return!1}}function ll(o,e){o.push(e)}function cl(o,e){return o.find((t,n)=>t.namedRangeId===e?(o.splice(n,1),t):null)}class ul extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this.do(),this._oldActionData={actionName:A.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),ll(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:A.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:cl(n,e)}}validate(){return!1}}function h6(o,e,t){const{startRow:n,endRow:s,startColumn:r,endColumn:i}=t,a=new Q;for(let l=n;l<=s;l++)for(let c=r;c<=i;c++){const u=o.getValue(l,c);a.setValue(l,c,R.deepClone(u)),u&&(e.formatOnly&&delete u.s,e.contentsOnly&&(u.v="",u.m=""),o.setValue(l,c,R.deepClone(u)))}return a.getData()}function hl(o,e,t,n){const{startRow:s,endRow:r,startColumn:i,endColumn:a}=n,l=r-s+1,c=a-i+1,u=o.rowCount,h=o.columnCount,d=new Q;if(t===Dn.ROWS)for(let g=s;g<=u;g++)for(let m=i;m<=a;m++){if(g<=r){const p=e.getValue(g,m);d.setValue(g,m,p)}const _=e.getValue(g+l,m);_?e.setValue(g,m,R.deepClone(_)):e.getValue(g,m)&&(e.deleteValue(g,m),m--)}else if(t===Dn.COLUMNS)for(let g=s;g<=r;g++)for(let m=i;m<=h;m++){if(m<=a){const p=e.getValue(g,m);d.setValue(g,m,p)}else for(let p=0;p<=a;p++){const v=e.getValue(g,m);d.setValue(g,m+p,v)}const _=e.getValue(g,m+c);if(_)e.setValue(g,m,R.deepClone(_));else if(e.getValue(g,m)){for(let v=0;v<=a;v++)e.deleteValue(g,m);break}}return d.getData()}function dl(o,e){const t=o.getConfig(),n=t.hidden;return t.hidden=e,n}function gl(o=0,e=1,t){new xe(t).inserts(o,new xe(e))}function fl(o,e,t){new Q(t).insertColumns(o,new Q(e))}function ml(o,e,t){new Q(t).insertRows(o,new Q(e))}function _l(o,e,t,n,s){const{startRow:r,endRow:i,startColumn:a,endColumn:l}=n,c=i-r+1,u=l-a+1,h=o.rowCount,d=o.columnCount;if(t===Dn.ROWS){for(let g=h;g>=r;g--)for(let m=a;m<=l;m++){const _=e.getValue(g,m);e.setValue(g+c,m,_)}for(let g=i;g>=r;g--)for(let m=a;m<=l;m++)e.setValue(g,m,s[g-r][m-a])}else if(t===Dn.COLUMNS){for(let g=r;g<=i;g++)for(let m=d;m>=a;m--){const _=e.getValue(g,m);e.setValue(g,m+u,_)}for(let g=r;g<=i;g++)for(let m=l;m>=a;m--)e.setValue(g,m,s[g-r][m-a])}}function pl(o=0,e=1,t){new xe(t).inserts(o,new xe(e))}function vl(o,e,t){const n=o.getWorksheets(),s=o.getConfig(),{sheets:r,sheetOrder:i}=s;if(r[t.id])throw new Error(`Insert Sheet fail ${t.id} is already exist`);return r[t.id]=t,i.splice(e,0,t.id),n.set(t.id,new Lt(o.getContext(),t)),t.id}function bl(o,e,t){const n=new xe(t),s=new xe,r=o,i=o+e;for(let a=r;a<i;a++){const l=n.splice(o,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function Cl(o,e,t){return new Q(t).spliceColumns(o,e).toJSON()}function El(o,e,t){const n=new xe(t),s=new xe,r=o,i=o+e;for(let a=r;a<i;a++){const l=n.splice(o,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function wl(o,e,t){return new Q(t).spliceRows(o,e).toJSON()}function Sl(o,e){const t=o.getWorksheets(),n=o.getConfig(),{sheets:s}=n;if(s[e]==null)throw new Error(`Remove Sheet fail ${e} is not exist`);const r=s[e],i=n.sheetOrder.findIndex(a=>a===e);return delete s[e],n.sheetOrder.splice(i,1),t.delete(e),{index:i,sheet:r}}function yl(o,e,t){const n=new Q(t),s=new Q;return n.forEach((r,i)=>{i.forEach((a,l)=>{const c=o.getValue(r,a);if(c){const u=e.get(c.s);u&&s.setValue(r,a,u),c.s=e.setValue(l)}})}),s.toJSON()}function Tl(o=0,e,t){for(let n=o;n<o+e;n++){const s=t.getColumnOrCreate(n);s.hd=1}}function Rl(o=0,e,t){for(let n=o;n<o+e;n++){const s=t.getColumn(n);s&&(s.hd=0)}}function Al(o=0,e,t){const n=[];for(let s=o;s<o+e.length;s++){const r=t.getColumnOrCreate(s);n[s-o]=r.w,r.w=e[s-o]}return n}function Il(o,e){const t=o.getConfig(),n=t.showGridlines===0;return e?t.showGridlines=0:t.showGridlines=1,n}function Dl(o=0,e,t){for(let n=o;n<o+e;n++){const s=t.getRowOrCreate(n);s&&(s.hd=1)}}function Ol(o,e){return o.find((t,n)=>t.namedRangeId===e.namedRangeId?(o[n]=e,t):null)}function xl(o,e,t,n){const{startRow:s,endRow:r,startColumn:i,endColumn:a}=t,l=new Q;for(let c=s;c<=r;c++)for(let u=i;u<=a;u++){const h=o.getValue(c,u)||{},d=h.s?n.get(h.s):null;d==null&&delete h.s;const g=ii(d,e[c-s][u-i]);g&&R.removeNull(g),R.isEmptyObject(g)?delete h.s:h.s=n.setValue(g),h.p&&f6(h.p,e[c-s][u-i]),o.setValue(c,u,h),l.setValue(c-s,u-i,Ml(d,e[c-s][u-i]))}return l.getData()}function Ml(o,e){return d6(o,e)}function d6(o,e){if(!e||!Object.keys(e).length)return o;const t=R.deepClone(o)||{};for(const n in e)n==="bd"?t[n]=g6(t[n]||{},e[n]):n in t||(t[n]=null);return t}function g6(o,e){if(!e||!Object.keys(e).length)return o;for(const t in e)t in o||(o[t]=null);return o}function ii(o,e,t=!1){if(!e)return e;const n=R.deepClone(o)||{};for(const s in e)t&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in n&&s==="bd"?n[s]=Object.assign(n[s],e[s]):(n[s]=e[s],"cl"in n&&["ul","ol","st"].includes(s)&&(n[s].cl=n.cl)));return n}function f6(o,e){var t;(t=o.body)==null||t.blockElementOrder.forEach(n=>{var s,r;if(((s=o.body)==null?void 0:s.blockElements[n].blockType)===0){const i=(r=o.body)==null?void 0:r.blockElements[n].paragraph;i==null||i.elementOrder.forEach(({elementId:a,paragraphElementType:l})=>{i.elements[a].tr||(i.elements[a].tr={});const c=i.elements[a].tr;c.ts||(c.ts={});const u=c.ts,h=ii(u,e,!0);h&&R.removeNull(h),R.isEmptyObject(h)?delete c.ts:c.ts=h})}})}function ai(o,e,t,n,s){let r;isNaN(parseInt(Object.keys(e)[0]))||(r=new Q(e));const i=new Q,{startRow:a,endRow:l,startColumn:c,endColumn:u}=t;if(s){for(let h=a;h<=l;h++)for(let d=c;d<=u;d++){const g=r?r.getValue(h,d):e,m=o.getValue(h,d),_={};s.contentsOnly&&(_.m=m==null?void 0:m.m,_.v=m==null?void 0:m.v),s.formatOnly&&(_.v=m==null?void 0:m.v,_.m=m==null?void 0:m.m),i.setValue(h,d,_||{}),o.setValue(h,d,g||{})}return i.getData()}for(let h=a;h<=l;h++)for(let d=c;d<=u;d++){const g=r?r.getValue(h,d):e,m=o.getValue(h,d)||{};if(!g){o.setValue(h,d,g),i.setValue(h,d,m);continue}const _=m.s?n.get(m.s):null,p=Ml(_,g==null?void 0:g.s),v=R.deepClone(m);v.s=p,i.setValue(h,d,v),_==null&&delete m.s;const b=ii(_,g==null?void 0:g.s);b&&R.removeNull(b),R.isEmptyObject(b)?delete m.s:m.s=n.setValue(b),g.v!=null&&(m.v=g.v),g.m!=null?m.m=g.m:m.m=String(m.v),g.t!=null&&(m.t=g.t),o.setValue(h,d,m)}return i.getData()}function kl(o,e,t){const n=new Q(e),s=new Q;for(let r=t.startRow;r<=t.endRow;r++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(r,i);if(a){JSON.parse(a);const l=o.getValue(r,i),c=R.deepClone(l||{});o.setValue(r,i,c||{})}else{const l=o.getValue(r,i),c=R.deepClone(l||{});o.setValue(r,i,c||{})}}return s.getData()}function Bl(o,e,t){const n=new Q(e),s=new Q;for(let r=t.startRow;r<=t.endRow;r++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(r,i),l=o.getValue(r,i),c=R.deepClone(l||{});c.f=a,o.setValue(r,i,c||{})}return s.getData()}function Fl(o,e,t){const n=new Q(e),s=new Q;for(let r=t.startRow;r<=t.endRow;r++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(r,i),l=o.getValue(r,i),c=R.deepClone(l||{});c.n=a,o.setValue(r,i,c||{})}return s.getData()}function Nl(o,e,t){const n=new Q(e),s=new Q;for(let r=t.startRow;r<=t.endRow;r++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=n.getValue(r,i),l=o.getValue(r,i);s.setValue(r,i,l&&l.v||"");const c=R.deepClone(l||{});c.v=a,c.m=`${a}`,o.setValue(r,i,c||{})}return s.getData()}function Ll(o,e){const t=o.getConfig(),n=t.rightToLeft;return t.rightToLeft=e,n}function Pl(o=0,e,t){const n=[];for(let s=o;s<o+e.length;s++){const r=t.getRowOrCreate(s);n[s-o]=r.h,r.h=e[s-o]}return n}function zl(o,e,t,n){var l,c,u;const s=o.getSelection(),r=(l=s.getActiveRangeList())==null?void 0:l.getRangeList(),i=(c=s.getActiveRange())==null?void 0:c.getRangeData(),a=(u=s.getCurrentCell())==null?void 0:u.getRangeData();return s.setRanges(e,t,n),{activeRangeList:r,activeRange:i,currentCell:a}}function Ul(o,e,t){const n=o.getConfig(),s=n.sheetOrder.findIndex(i=>i===e),r=n.sheetOrder.filter(i=>i!==e);return r.splice(t,0,e),n.sheetOrder=r,s}function Wl(o=0,e,t){for(let n=o;n<o+e;n++){const s=t.getRow(n);s&&(s.hd=0)}}function Hl(o,e){const t=o.getConfig(),n=t.tabColor;return t.tabColor=e,n}function $l(o,e){const t=o.getContext().getWorkBook().getActiveSheet();let n="";const s=Y.FALSE;t&&(n=t.getSheetId());const r=o.getContext().getWorkBook().getSheets(),i=o.getSheetId();return r.forEach(a=>{a.getSheetId()===i?a.getConfig().status=Y.TRUE:a.getConfig().status=Y.FALSE}),{oldSheetId:n,status:s}}function Vl(o,e){const t=o.getConfig(),n=t.name;return t.name=e,n}function Xl(o,e){const t=o.getConfig(),n=t.status;return t.status=e,n}function Yl(o,e,t){const n=o.getSheetBySheetId(e);if(n){const s=n.getConfig().zoomRatio;return n.getConfig().zoomRatio=t,s}return 1}class Gl extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellValue:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=h6(e.getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:t,cellValue:this.do(),convertor:[new nt(tt.INSERT)]}}undo(){const e=this.getWorkSheet(),{rangeData:t,cellValue:n}=this._oldActionData,s=this._workbook.getStyles();e&&(ai(e.getCellMatrix(),n,t,s),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class jl extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={actionName:A.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),cl(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.ADD_BANDING_ACTION,namedRange:this.do(),convertor:[new nt(tt.INSERT)]}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),ll(t,e)}validate(){return!1}}class li extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={...e,cellValue:this.do(),convertor:[new nt(tt.INSERT)]},this.validate()}do(){const e=this.getWorkSheet(),t=hl({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.INSERT_RANGE_ACTION,shiftDimension:n,rangeData:t,cellValue:this.do(),convertor:[new nt(tt.INSERT)]}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:n,cellValue:s}=this._oldActionData;e&&(_l({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,n,s),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class ci extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const t=this.getWorkSheet().getColumnManager();gl(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),bl(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON())}validate(){return!1}}class Kl extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,columnCount:xe.getMaxLength(e.columnData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();fl(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Cl(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class ql extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();e&&(_l({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:hl({rowCount:s.getLastRow(),columnCount:s.getLastColumn()},s.getCellMatrix(),n,e),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class ui extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const t=this.getWorkSheet().getRowManager();pl(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),El(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON())}validate(){return!1}}class Zl extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,rowCount:xe.getMaxLength(e.rowData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();ml(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();wl(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Jl extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetId:this.do(),convertor:[]}}do(){const e=this.getWorkBook(),t=vl(e,this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){const e=this.getWorkBook();Sl(e,this._oldActionData.sheetId),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}class hi extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnCount:this.do(),convertor:[]},this.validate()}do(){const t=this.getWorkSheet().getColumnManager(),n=bl(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();gl(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ql extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.REMOVE)]},this._oldActionData={...e,columnData:this.do(),convertor:[new nt(tt.INSERT)]},this.validate()}do(){const e=this.getWorkSheet(),t=Cl(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();fl(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class ec extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rectangles:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=il(e.getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();rl(e.getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class di extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.REMOVE)]},this._oldActionData={...e,rowCount:this.do(),convertor:[new nt(tt.REMOVE)]},this.validate()}do(){const t=this.getWorkSheet().getRowManager(),n=El(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();pl(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class tc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowData:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=wl(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();ml(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class nc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,...this.do(),convertor:[]}}do(){return this.redo()}redo(){const e=this.getWorkBook(),t=Sl(e,this._doActionData.sheetId);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),vl(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}class oc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,styles:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=e.getCellMatrix(),r=e.getContext().getWorkBook().getStyles(),i=yl(t,r,this._doActionData.styles);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),i}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=e.getCellMatrix(),r=e.getContext().getWorkBook().getStyles();yl(t,r,this._oldActionData.styles),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class sc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Tl(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Rl(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class rc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Rl(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Tl(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class ic extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnWidth:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Al(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=Al(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class ac extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hideGridlines:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Il(e,this._doActionData.hideGridlines);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();Il(e,this._oldActionData.hideGridlines),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class lc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={actionName:A.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),Ol(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:A.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:A.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:Ol(n,e)}}validate(){return!1}}class cc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),n=ai(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData,t,this._doActionData.options);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e,rangeData:t,options:n}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t,options:n}}undo(){const{rangeData:e,sheetId:t,cellValue:n,options:s}=this._oldActionData,r=this.getWorkSheet(),i=this._workbook.getStyles();r&&(this._doActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:ai(r.getCellMatrix(),n,e,i),rangeData:e,options:s},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class uc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=kl(e.getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:A.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:kl(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class hc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellFormula:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Bl(e.getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:A.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:Bl(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class dc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellNote:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Fl(e.getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:A.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:Fl(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class gc extends Re{constructor(e,t,n){super(e,t,n),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix(),r=xl(s,e,t,n);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,s=this._workbook.getStyles(),r=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:A.SET_RANGE_STYLE_ACTION,sheetId:n,value:xl(r,e,t,s),rangeData:t},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class fc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Nl(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:A.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Nl(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class mc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rightToLeft:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Ll(e,this._doActionData.rightToLeft);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();Ll(e,this._oldActionData.rightToLeft),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class _c extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowHeight:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Pl(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=Pl(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class pc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Dl(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Wl(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class vc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Wl(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Dl(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class bc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]};const{activeRangeList:s,activeRange:r,currentCell:i}=this.do();this._oldActionData={...e,activeRangeList:s,activeRange:r,currentCell:i},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,s=this.getWorkSheet(),r=zl(s,e,t,n);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:s}=this.do();this._oldActionData={actionName:A.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:n,currentCell:s}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:s}=this._oldActionData,r=this.getWorkSheet(),i=zl(r,e,t,n);this._doActionData={actionName:A.SET_SELECTION_ACTION,sheetId:s,activeRangeList:i.activeRangeList,activeRange:i.activeRange,currentCell:i.currentCell},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class gi extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,order:this.do(),convertor:[]},this.validate()}do(){const n=this.getWorkSheet().getContext().getWorkBook(),s=Ul(n,this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),s}redo(){this.do()}undo(){const n=this.getWorkSheet().getContext().getWorkBook();Ul(n,this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Cc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new nt(tt.SET)]},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Hl(e,this._doActionData.color);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:A.SET_TAB_COLOR_ACTION,sheetId:t,color:Hl(n,e)},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ec extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]};const{oldSheetId:s,status:r}=this.do();this._oldActionData={...e,sheetId:s,status:r,convertor:[]},this.validate(),this.removeOperation(wt.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=this._workbook.getSheetBySheetId(e),s=$l(n);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),s}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:A.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:n,status:s}=$l(t);this._doActionData={actionName:A.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:n,status:s},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}class wc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hidden:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=dl(e,this._doActionData.hidden);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:A.HIDE_SHEET_ACTION,sheetId:t,hidden:dl(n,e)},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Sc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetName:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Vl(e,this._doActionData.sheetName);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:A.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:Vl(n,e)},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class yc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetStatus:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Xl(e,this._doActionData.sheetStatus);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:A.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:A.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:Xl(n,e)},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Tc extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,zoom:this.do(),convertor:[]},this.validate()}redo(){const e=Yl(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){Yl(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:Z.REDO,data:this._oldActionData,action:this})}validate(){return!1}}class Mt{constructor(...e){if(R.hasLength(e,0)){this.startRow=0,this.startColumn=0,this.endRow=0,this.endColumn=0;return}if(R.hasLength(e,1)){const t=e[0];this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,this.endColumn=t.endColumn;return}if(R.hasLength(e,4)){const t=e[0],n=e[1],s=e[2],r=e[3];this.startRow=t,this.startColumn=n,this.endRow=s,this.endColumn=r}}intersects(e){const t=this.startRow,n=this.endRow,s=this.startColumn,r=this.endColumn,i=e.startRow,a=e.endRow,l=e.startColumn,c=e.endColumn,u=Math.abs(s+r-l-c),h=Math.abs(s-r)+Math.abs(l-c),d=Math.abs(t+n-i-a),g=Math.abs(t-n)+Math.abs(i-a);return u<=h&&d<=g}union(e){const{startRow:t,startColumn:n,endRow:s,endColumn:r}=this;return new Mt(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>s?e.endRow:s,e.endColumn>r?e.endColumn:r)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const Co=class{static checkup(o,...e){if(o.length!==e.length)return!1;const t=o.length;for(let n=0;n<t;n++){const s=o[n],r=e[n];switch(r){case Co.BOOLEAN_TYPE:{if(!R.isBoolean(s))return!1;break}case Co.NUMBER_TYPE:{if(!R.isNumber(s))return!1;break}case Co.STRING_TYPE:{if(!R.isString(s))return!1;break}case Co.FUNCTION_TYPE:{if(!R.isFunction(s))return!1;break}case Co.OBJECT_TYPE:{if(!R.isPlainObject(s))return!1;break}default:{if(!R.isAssignableFrom(s,r))return!1;break}}}return!0}};let Be=Co;Be.STRING_TYPE=1,Be.NUMBER_TYPE=2,Be.BOOLEAN_TYPE=3,Be.FUNCTION_TYPE=4,Be.OBJECT_TYPE=5;class Rc{constructor(e,t){this._worksheet=e,this._rectangleList=t,fe.getCommandInjectorObservers().add(n=>{let s=n.include(ui),r=n.include(ci),i=n.include(di),a=n.include(hi),l=n.include(li);if(s){const c=s.getDoActionData();if(c.sheetId===this._worksheet.getSheetId()){const u=R.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],g=c.rowCount;c.rowIndex>d.endRow||(c.rowIndex>=d.startRow&&c.rowIndex<=d.endRow||(d.startRow+=g),d.endRow+=g)}this.modifyMerge(this._rectangleList,u)}}if(r){const c=r.getDoActionData();if(c.sheetId===this._worksheet.getSheetId()){const u=R.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],g=c.columnCount;c.columnIndex>d.endColumn||(c.columnIndex>=d.startColumn&&c.columnIndex<=d.endColumn||(d.startColumn+=g),d.endColumn+=g)}this.modifyMerge(this._rectangleList,u)}}if(i){const c=i.getDoActionData();if(c.sheetId===this._worksheet.getSheetId()&&c.sheetId===this._worksheet.getSheetId()){const u=R.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],g=c.rowCount;c.rowIndex>d.endRow||(c.rowIndex>=d.startRow&&c.rowIndex<=d.endRow||(d.startRow-=g),d.endRow-=g)}this.modifyMerge(this._rectangleList,u)}}if(a){const c=a.getDoActionData();if(c.sheetId===this._worksheet.getSheetId()&&c.sheetId===this._worksheet.getSheetId()){const u=R.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],g=c.columnCount;c.columnIndex>d.endColumn||(c.columnIndex>=d.startColumn&&c.columnIndex<=d.endColumn||(d.startColumn-=g),d.endColumn-=g)}this.modifyMerge(this._rectangleList,u)}}if(l){const c=l.getDoActionData();if(c.sheetId===this._worksheet.getSheetId()){const u=R.deepClone(this._rectangleList),h=this.getByRowColumn(c.rangeData.startRow,c.rangeData.endRow,c.rangeData.startColumn,c.rangeData.endColumn);if(h&&h.forEach(d=>{const g=new Mt(d);for(let m=0;m<u.length;m++){const _=u[m];g.intersects(new Mt(_))&&u.splice(m,1)}}),c.shiftDimension)for(let d=0;d<u.length;d++){const g=u[d];if(g.endRow>=c.rangeData.startRow){if(g.endColumn<c.rangeData.startColumn)continue;if(g.startColumn>c.rangeData.endColumn)continue;if(g.startColumn>=c.rangeData.startColumn&&g.endColumn<=c.rangeData.endColumn){const m=c.rangeData.endRow-c.rangeData.startRow;g.startRow-=m,g.endRow-=m}else return}}else for(let d=0;d<u.length;d++){const g=u[d];if(g.startColumn>c.rangeData.endColumn){if(g.endRow<c.rangeData.startRow)continue;if(g.startRow>c.rangeData.endRow)continue;if(g.startRow>=c.rangeData.startRow&&g.endRow<=c.rangeData.endRow){const m=c.rangeData.endColumn-c.rangeData.startColumn;g.startColumn-=m,g.endColumn-=m}else return}}this.modifyMerge(this._rectangleList,u)}}})}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;Be.checkup(e,Be.NUMBER_TYPE,Be.NUMBER_TYPE,Be.NUMBER_TYPE,Be.NUMBER_TYPE)?n=new Mt(e[0],e[2],e[1],e[3]):Be.checkup(e,Be.NUMBER_TYPE,Be.NUMBER_TYPE)&&(n=new Mt(e[0],e[1],e[0],e[1]));const s=[];for(let r=0;r<t.length;r++){const i=t[r];n.intersects(new Mt(i))&&s.push(i)}return s.length?s:null}remove(e){const{_rectangleList:t}=this,{length:n}=t,s=new Mt(e),r=[],i=[];for(let a=0;a<n;a++){const l=t[a];if(s.intersects(new Mt(l))){i.push(l);continue}r.push(l)}return this._rectangleList=r,i}size(){return this._rectangleList.length}add(e){const t=this.remove(e);return this._rectangleList.push(e),t}union(e){const{_rectangleList:t}=this,{length:n}=t;let s=new Mt(e);for(let r=0;r<n;r++){const i=t[r];s=s.union(new Mt(i))}return s.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,s=[];for(let r=0;r<n;r++){const i=t[r];new Mt(e).intersects(new Mt(i))&&s.push(i)}return s}modifyMerge(e,t){const n=this._worksheet.getCommandManager(),s=this._worksheet.getContext(),r={actionName:A.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},i={actionName:A.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},a=new V({WorkBookUnit:s.getWorkBook()},r,i);n.invoke(a)}}var tr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ac={exports:{}};(function(o,e){(function(t,n){o.exports=n()})(tr,function(){var t=1e3,n=6e4,s=36e5,r="millisecond",i="second",a="minute",l="hour",c="day",u="week",h="month",d="quarter",g="year",m="date",_="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(y){var k=["th","st","nd","rd"],M=y%100;return"["+y+(k[(M-20)%10]||k[M]||k[0])+"]"}},C=function(y,k,M){var U=String(y);return!U||U.length>=k?y:""+Array(k+1-U.length).join(M)+y},D={s:C,z:function(y){var k=-y.utcOffset(),M=Math.abs(k),U=Math.floor(M/60),z=M%60;return(k<=0?"+":"-")+C(U,2,"0")+":"+C(z,2,"0")},m:function y(k,M){if(k.date()<M.date())return-y(M,k);var U=12*(M.year()-k.year())+(M.month()-k.month()),z=k.clone().add(U,h),K=M-z<0,j=k.clone().add(U+(K?-1:1),h);return+(-(U+(M-z)/(K?z-j:j-z))||0)},a:function(y){return y<0?Math.ceil(y)||0:Math.floor(y)},p:function(y){return{M:h,y:g,w:u,d:c,D:m,h:l,m:a,s:i,ms:r,Q:d}[y]||String(y||"").toLowerCase().replace(/s$/,"")},u:function(y){return y===void 0}},O="en",F={};F[O]=b;var S=function(y){return y instanceof P},E=function y(k,M,U){var z;if(!k)return O;if(typeof k=="string"){var K=k.toLowerCase();F[K]&&(z=K),M&&(F[K]=M,z=K);var j=k.split("-");if(!z&&j.length>1)return y(j[0])}else{var q=k.name;F[q]=k,z=q}return!U&&z&&(O=z),z||!U&&O},w=function(y,k){if(S(y))return y.clone();var M=typeof k=="object"?k:{};return M.date=y,M.args=arguments,new P(M)},I=D;I.l=E,I.i=S,I.w=function(y,k){return w(y,{locale:k.$L,utc:k.$u,x:k.$x,$offset:k.$offset})};var P=function(){function y(M){this.$L=E(M.locale,null,!0),this.parse(M)}var k=y.prototype;return k.parse=function(M){this.$d=function(U){var z=U.date,K=U.utc;if(z===null)return new Date(NaN);if(I.u(z))return new Date;if(z instanceof Date)return new Date(z);if(typeof z=="string"&&!/Z$/i.test(z)){var j=z.match(p);if(j){var q=j[2]-1||0,se=(j[7]||"0").substring(0,3);return K?new Date(Date.UTC(j[1],q,j[3]||1,j[4]||0,j[5]||0,j[6]||0,se)):new Date(j[1],q,j[3]||1,j[4]||0,j[5]||0,j[6]||0,se)}}return new Date(z)}(M),this.$x=M.x||{},this.init()},k.init=function(){var M=this.$d;this.$y=M.getFullYear(),this.$M=M.getMonth(),this.$D=M.getDate(),this.$W=M.getDay(),this.$H=M.getHours(),this.$m=M.getMinutes(),this.$s=M.getSeconds(),this.$ms=M.getMilliseconds()},k.$utils=function(){return I},k.isValid=function(){return this.$d.toString()!==_},k.isSame=function(M,U){var z=w(M);return this.startOf(U)<=z&&z<=this.endOf(U)},k.isAfter=function(M,U){return w(M)<this.startOf(U)},k.isBefore=function(M,U){return this.endOf(U)<w(M)},k.$g=function(M,U,z){return I.u(M)?this[U]:this.set(z,M)},k.unix=function(){return Math.floor(this.valueOf()/1e3)},k.valueOf=function(){return this.$d.getTime()},k.startOf=function(M,U){var z=this,K=!!I.u(U)||U,j=I.p(M),q=function(Ne,Ce){var Ie=I.w(z.$u?Date.UTC(z.$y,Ce,Ne):new Date(z.$y,Ce,Ne),z);return K?Ie:Ie.endOf(c)},se=function(Ne,Ce){return I.w(z.toDate()[Ne].apply(z.toDate("s"),(K?[0,0,0,0]:[23,59,59,999]).slice(Ce)),z)},le=this.$W,Te=this.$M,pe=this.$D,oe="set"+(this.$u?"UTC":"");switch(j){case g:return K?q(1,0):q(31,11);case h:return K?q(1,Te):q(0,Te+1);case u:var ie=this.$locale().weekStart||0,de=(le<ie?le+7:le)-ie;return q(K?pe-de:pe+(6-de),Te);case c:case m:return se(oe+"Hours",0);case l:return se(oe+"Minutes",1);case a:return se(oe+"Seconds",2);case i:return se(oe+"Milliseconds",3);default:return this.clone()}},k.endOf=function(M){return this.startOf(M,!1)},k.$set=function(M,U){var z,K=I.p(M),j="set"+(this.$u?"UTC":""),q=(z={},z[c]=j+"Date",z[m]=j+"Date",z[h]=j+"Month",z[g]=j+"FullYear",z[l]=j+"Hours",z[a]=j+"Minutes",z[i]=j+"Seconds",z[r]=j+"Milliseconds",z)[K],se=K===c?this.$D+(U-this.$W):U;if(K===h||K===g){var le=this.clone().set(m,1);le.$d[q](se),le.init(),this.$d=le.set(m,Math.min(this.$D,le.daysInMonth())).$d}else q&&this.$d[q](se);return this.init(),this},k.set=function(M,U){return this.clone().$set(M,U)},k.get=function(M){return this[I.p(M)]()},k.add=function(M,U){var z,K=this;M=Number(M);var j=I.p(U),q=function(Te){var pe=w(K);return I.w(pe.date(pe.date()+Math.round(Te*M)),K)};if(j===h)return this.set(h,this.$M+M);if(j===g)return this.set(g,this.$y+M);if(j===c)return q(1);if(j===u)return q(7);var se=(z={},z[a]=n,z[l]=s,z[i]=t,z)[j]||1,le=this.$d.getTime()+M*se;return I.w(le,this)},k.subtract=function(M,U){return this.add(-1*M,U)},k.format=function(M){var U=this,z=this.$locale();if(!this.isValid())return z.invalidDate||_;var K=M||"YYYY-MM-DDTHH:mm:ssZ",j=I.z(this),q=this.$H,se=this.$m,le=this.$M,Te=z.weekdays,pe=z.months,oe=function(Ce,Ie,Le,Ve){return Ce&&(Ce[Ie]||Ce(U,K))||Le[Ie].slice(0,Ve)},ie=function(Ce){return I.s(q%12||12,Ce,"0")},de=z.meridiem||function(Ce,Ie,Le){var Ve=Ce<12?"AM":"PM";return Le?Ve.toLowerCase():Ve},Ne={YY:String(this.$y).slice(-2),YYYY:this.$y,M:le+1,MM:I.s(le+1,2,"0"),MMM:oe(z.monthsShort,le,pe,3),MMMM:oe(pe,le),D:this.$D,DD:I.s(this.$D,2,"0"),d:String(this.$W),dd:oe(z.weekdaysMin,this.$W,Te,2),ddd:oe(z.weekdaysShort,this.$W,Te,3),dddd:Te[this.$W],H:String(q),HH:I.s(q,2,"0"),h:ie(1),hh:ie(2),a:de(q,se,!0),A:de(q,se,!1),m:String(se),mm:I.s(se,2,"0"),s:String(this.$s),ss:I.s(this.$s,2,"0"),SSS:I.s(this.$ms,3,"0"),Z:j};return K.replace(v,function(Ce,Ie){return Ie||Ne[Ce]||j.replace(":","")})},k.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},k.diff=function(M,U,z){var K,j=I.p(U),q=w(M),se=(q.utcOffset()-this.utcOffset())*n,le=this-q,Te=I.m(this,q);return Te=(K={},K[g]=Te/12,K[h]=Te,K[d]=Te/3,K[u]=(le-se)/6048e5,K[c]=(le-se)/864e5,K[l]=le/s,K[a]=le/n,K[i]=le/t,K)[j]||le,z?Te:I.a(Te)},k.daysInMonth=function(){return this.endOf(h).$D},k.$locale=function(){return F[this.$L]},k.locale=function(M,U){if(!M)return this.$L;var z=this.clone(),K=E(M,U,!0);return K&&(z.$L=K),z},k.clone=function(){return I.w(this.$d,this)},k.toDate=function(){return new Date(this.valueOf())},k.toJSON=function(){return this.isValid()?this.toISOString():null},k.toISOString=function(){return this.$d.toISOString()},k.toString=function(){return this.$d.toUTCString()},y}(),L=P.prototype;return w.prototype=L,[["$ms",r],["$s",i],["$m",a],["$H",l],["$W",c],["$M",h],["$y",g],["$D",m]].forEach(function(y){L[y[1]]=function(k){return this.$g(k,y[0],y[1])}}),w.extend=function(y,k){return y.$i||(y(k,P,w),y.$i=!0),w},w.locale=E,w.isDayjs=S,w.unix=function(y){return w(1e3*y)},w.en=F[O],w.Ls=F,w.p={},w})})(Ac);var G=Ac.exports,Ic={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(o){(function(e,t){o.exports?o.exports=t():e.numeral=t()})(tr,function(){var e,t,n="2.0.6",s={},r={},i={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:i.currentLocale,zeroFormat:i.zeroFormat,nullFormat:i.nullFormat,defaultFormat:i.defaultFormat,scalePercentBy100:i.scalePercentBy100};function l(c,u){this._input=c,this._value=u}return e=function(c){var u,h,d,g;if(e.isNumeral(c))u=c.value();else if(c===0||typeof c=="undefined")u=0;else if(c===null||t.isNaN(c))u=null;else if(typeof c=="string")if(a.zeroFormat&&c===a.zeroFormat)u=0;else if(a.nullFormat&&c===a.nullFormat||!c.replace(/[^0-9]+/g,"").length)u=null;else{for(h in s)if(g=typeof s[h].regexps.unformat=="function"?s[h].regexps.unformat():s[h].regexps.unformat,g&&c.match(g)){d=s[h].unformat;break}d=d||e._.stringToNumber,u=d(c)}else u=Number(c)||null;return new l(c,u)},e.version=n,e.isNumeral=function(c){return c instanceof l},e._=t={numberToFormat:function(c,u,h){var d=r[e.options.currentLocale],g=!1,m=!1,_=0,p="",v=1e12,b=1e9,C=1e6,D=1e3,O="",F=!1,S,E,w,I,P,L,y;if(c=c||0,E=Math.abs(c),e._.includes(u,"(")?(g=!0,u=u.replace(/[\(|\)]/g,"")):(e._.includes(u,"+")||e._.includes(u,"-"))&&(P=e._.includes(u,"+")?u.indexOf("+"):c<0?u.indexOf("-"):-1,u=u.replace(/[\+|\-]/g,"")),e._.includes(u,"a")&&(S=u.match(/a(k|m|b|t)?/),S=S?S[1]:!1,e._.includes(u," a")&&(p=" "),u=u.replace(new RegExp(p+"a[kmbt]?"),""),E>=v&&!S||S==="t"?(p+=d.abbreviations.trillion,c=c/v):E<v&&E>=b&&!S||S==="b"?(p+=d.abbreviations.billion,c=c/b):E<b&&E>=C&&!S||S==="m"?(p+=d.abbreviations.million,c=c/C):(E<C&&E>=D&&!S||S==="k")&&(p+=d.abbreviations.thousand,c=c/D)),e._.includes(u,"[.]")&&(m=!0,u=u.replace("[.]",".")),w=c.toString().split(".")[0],I=u.split(".")[1],L=u.indexOf(","),_=(u.split(".")[0].split(",")[0].match(/0/g)||[]).length,I?(e._.includes(I,"[")?(I=I.replace("]",""),I=I.split("["),O=e._.toFixed(c,I[0].length+I[1].length,h,I[1].length)):O=e._.toFixed(c,I.length,h),w=O.split(".")[0],e._.includes(O,".")?O=d.delimiters.decimal+O.split(".")[1]:O="",m&&Number(O.slice(1))===0&&(O="")):w=e._.toFixed(c,0,h),p&&!S&&Number(w)>=1e3&&p!==d.abbreviations.trillion)switch(w=String(Number(w)/1e3),p){case d.abbreviations.thousand:p=d.abbreviations.million;break;case d.abbreviations.million:p=d.abbreviations.billion;break;case d.abbreviations.billion:p=d.abbreviations.trillion;break}if(e._.includes(w,"-")&&(w=w.slice(1),F=!0),w.length<_)for(var k=_-w.length;k>0;k--)w="0"+w;return L>-1&&(w=w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),u.indexOf(".")===0&&(w=""),y=w+O+(p||""),g?y=(g&&F?"(":"")+y+(g&&F?")":""):P>=0?y=P===0?(F?"-":"+")+y:y+(F?"-":"+"):F&&(y="-"+y),y},stringToNumber:function(c){var u=r[a.currentLocale],h=c,d={thousand:3,million:6,billion:9,trillion:12},g,m,_;if(a.zeroFormat&&c===a.zeroFormat)m=0;else if(a.nullFormat&&c===a.nullFormat||!c.replace(/[^0-9]+/g,"").length)m=null;else{m=1,u.delimiters.decimal!=="."&&(c=c.replace(/\./g,"").replace(u.delimiters.decimal,"."));for(g in d)if(_=new RegExp("[^a-zA-Z]"+u.abbreviations[g]+"(?:\\)|(\\"+u.currency.symbol+")?(?:\\))?)?$"),h.match(_)){m*=Math.pow(10,d[g]);break}m*=(c.split("-").length+Math.min(c.split("(").length-1,c.split(")").length-1))%2?1:-1,c=c.replace(/[^0-9\.]+/g,""),m*=Number(c)}return m},isNaN:function(c){return typeof c=="number"&&isNaN(c)},includes:function(c,u){return c.indexOf(u)!==-1},insert:function(c,u,h){return c.slice(0,h)+u+c.slice(h)},reduce:function(c,u){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof u!="function")throw new TypeError(u+" is not a function");var h=Object(c),d=h.length>>>0,g=0,m;if(arguments.length===3)m=arguments[2];else{for(;g<d&&!(g in h);)g++;if(g>=d)throw new TypeError("Reduce of empty array with no initial value");m=h[g++]}for(;g<d;g++)g in h&&(m=u(m,h[g],g,h));return m},multiplier:function(c){var u=c.toString().split(".");return u.length<2?1:Math.pow(10,u[1].length)},correctionFactor:function(){var c=Array.prototype.slice.call(arguments);return c.reduce(function(u,h){var d=t.multiplier(h);return u>d?u:d},1)},toFixed:function(c,u,h,d){var g=c.toString().split("."),m=u-(d||0),_,p,v,b;return g.length===2?_=Math.min(Math.max(g[1].length,m),u):_=m,v=Math.pow(10,_),b=(h(c+"e+"+_)/v).toFixed(_),d>u-_&&(p=new RegExp("\\.?0{1,"+(d-(u-_))+"}$"),b=b.replace(p,"")),b}},e.options=a,e.formats=s,e.locales=r,e.locale=function(c){return c&&(a.currentLocale=c.toLowerCase()),a.currentLocale},e.localeData=function(c){if(!c)return r[a.currentLocale];if(c=c.toLowerCase(),!r[c])throw new Error("Unknown locale : "+c);return r[c]},e.reset=function(){for(var c in i)a[c]=i[c]},e.zeroFormat=function(c){a.zeroFormat=typeof c=="string"?c:null},e.nullFormat=function(c){a.nullFormat=typeof c=="string"?c:null},e.defaultFormat=function(c){a.defaultFormat=typeof c=="string"?c:"0.0"},e.register=function(c,u,h){if(u=u.toLowerCase(),this[c+"s"][u])throw new TypeError(u+" "+c+" already registered.");return this[c+"s"][u]=h,h},e.validate=function(c,u){var h,d,g,m,_,p,v,b;if(typeof c!="string"&&(c+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",c)),c=c.trim(),c.match(/^\d+$/))return!0;if(c==="")return!1;try{v=e.localeData(u)}catch{v=e.localeData(e.locale())}return g=v.currency.symbol,_=v.abbreviations,h=v.delimiters.decimal,v.delimiters.thousands==="."?d="\\.":d=v.delimiters.thousands,b=c.match(/^[^\d]+/),b!==null&&(c=c.substr(1),b[0]!==g)||(b=c.match(/[^\d]+$/),b!==null&&(c=c.slice(0,-1),b[0]!==_.thousand&&b[0]!==_.million&&b[0]!==_.billion&&b[0]!==_.trillion))?!1:(p=new RegExp(d+"{2}"),c.match(/[^\d.,]/g)?!1:(m=c.split(h),m.length>2?!1:m.length<2?!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p):m[0].length===1?!!m[0].match(/^\d+$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/):!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/)))},e.fn=l.prototype={clone:function(){return e(this)},format:function(c,u){var h=this._value,d=c||a.defaultFormat,g,m,_;if(u=u||Math.round,h===0&&a.zeroFormat!==null)m=a.zeroFormat;else if(h===null&&a.nullFormat!==null)m=a.nullFormat;else{for(g in s)if(d.match(s[g].regexps.format)){_=s[g].format;break}_=_||e._.numberToFormat,m=_(h,d,u)}return m},value:function(){return this._value},input:function(){return this._input},set:function(c){return this._value=Number(c),this},add:function(c){var u=t.correctionFactor.call(null,this._value,c);function h(d,g,m,_){return d+Math.round(u*g)}return this._value=t.reduce([this._value,c],h,0)/u,this},subtract:function(c){var u=t.correctionFactor.call(null,this._value,c);function h(d,g,m,_){return d-Math.round(u*g)}return this._value=t.reduce([c],h,Math.round(this._value*u))/u,this},multiply:function(c){function u(h,d,g,m){var _=t.correctionFactor(h,d);return Math.round(h*_)*Math.round(d*_)/Math.round(_*_)}return this._value=t.reduce([this._value,c],u,1),this},divide:function(c){function u(h,d,g,m){var _=t.correctionFactor(h,d);return Math.round(h*_)/Math.round(d*_)}return this._value=t.reduce([this._value,c],u),this},difference:function(c){return Math.abs(e(this._value).subtract(c).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(c){var u=c%10;return~~(c%100/10)===1?"th":u===1?"st":u===2?"nd":u===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(c,u,h){var d=e._.includes(u," BPS")?" ":"",g;return c=c*1e4,u=u.replace(/\s?BPS/,""),g=e._.numberToFormat(c,u,h),e._.includes(g,")")?(g=g.split(""),g.splice(-1,0,d+"BPS"),g=g.join("")):g=g+d+"BPS",g},unformat:function(c){return+(e._.stringToNumber(c)*1e-4).toFixed(15)}})}(),function(){var c={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},u={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},h=c.suffixes.concat(u.suffixes.filter(function(g){return c.suffixes.indexOf(g)<0})),d=h.join("|");d="("+d.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(d)},format:function(g,m,_){var p,v=e._.includes(m,"ib")?u:c,b=e._.includes(m," b")||e._.includes(m," ib")?" ":"",C,D,O;for(m=m.replace(/\s?i?b/,""),C=0;C<=v.suffixes.length;C++)if(D=Math.pow(v.base,C),O=Math.pow(v.base,C+1),g===null||g===0||g>=D&&g<O){b+=v.suffixes[C],D>0&&(g=g/D);break}return p=e._.numberToFormat(g,m,_),p+b},unformat:function(g){var m=e._.stringToNumber(g),_,p;if(m){for(_=c.suffixes.length-1;_>=0;_--){if(e._.includes(g,c.suffixes[_])){p=Math.pow(c.base,_);break}if(e._.includes(g,u.suffixes[_])){p=Math.pow(u.base,_);break}}m*=p||1}return m}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(c,u,h){var d=e.locales[e.options.currentLocale],g={before:u.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:u.match(/([\+|\-|\)|\s|\$]*)$/)[0]},m,_,p;for(u=u.replace(/\s?\$\s?/,""),m=e._.numberToFormat(c,u,h),c>=0?(g.before=g.before.replace(/[\-\(]/,""),g.after=g.after.replace(/[\-\)]/,"")):c<0&&!e._.includes(g.before,"-")&&!e._.includes(g.before,"(")&&(g.before="-"+g.before),p=0;p<g.before.length;p++)switch(_=g.before[p],_){case"$":m=e._.insert(m,d.currency.symbol,p);break;case" ":m=e._.insert(m," ",p+d.currency.symbol.length-1);break}for(p=g.after.length-1;p>=0;p--)switch(_=g.after[p],_){case"$":m=p===g.after.length-1?m+d.currency.symbol:e._.insert(m,d.currency.symbol,-(g.after.length-(1+p)));break;case" ":m=p===g.after.length-1?m+" ":e._.insert(m," ",-(g.after.length-(1+p)+d.currency.symbol.length-1));break}return m}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(c,u,h){var d,g=typeof c=="number"&&!e._.isNaN(c)?c.toExponential():"0e+0",m=g.split("e");return u=u.replace(/e[\+|\-]{1}0/,""),d=e._.numberToFormat(Number(m[0]),u,h),d+"e"+m[1]},unformat:function(c){var u=e._.includes(c,"e+")?c.split("e+"):c.split("e-"),h=Number(u[0]),d=Number(u[1]);d=e._.includes(c,"e-")?d*=-1:d;function g(m,_,p,v){var b=e._.correctionFactor(m,_),C=m*b*(_*b)/(b*b);return C}return e._.reduce([h,Math.pow(10,d)],g,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(c,u,h){var d=e.locales[e.options.currentLocale],g,m=e._.includes(u," o")?" ":"";return u=u.replace(/\s?o/,""),m+=d.ordinal(c),g=e._.numberToFormat(c,u,h),g+m}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(c,u,h){var d=e._.includes(u," %")?" ":"",g;return e.options.scalePercentBy100&&(c=c*100),u=u.replace(/\s?\%/,""),g=e._.numberToFormat(c,u,h),e._.includes(g,")")?(g=g.split(""),g.splice(-1,0,d+"%"),g=g.join("")):g=g+d+"%",g},unformat:function(c){var u=e._.stringToNumber(c);return e.options.scalePercentBy100?u*.01:u}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(c,u,h){var d=Math.floor(c/60/60),g=Math.floor((c-d*60*60)/60),m=Math.round(c-d*60*60-g*60);return d+":"+(g<10?"0"+g:g)+":"+(m<10?"0"+m:m)},unformat:function(c){var u=c.split(":"),h=0;return u.length===3?(h=h+Number(u[0])*60*60,h=h+Number(u[1])*60,h=h+Number(u[2])):u.length===2&&(h=h+Number(u[0])*60,h=h+Number(u[1])),Number(h)}})}(),e})})(Ic);var Jn=Ic.exports;const fi={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function m6(o){let e=!1;for(const t in fi)if(o===fi[t]){e=!0;break}return e}function Eo(o){return o===null||o.toString().replace(/\s/g,"")===""||typeof o=="boolean"?!1:!Number.isNaN(o)}function _6(o){if(o===null||o.toString().length<5)return!1;if(e(o))return!0;return!1;function e(t){const n=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,s=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!n.test(t)&&!s.test(t))return!1;const r=RegExp.$1,i=RegExp.$2,a=RegExp.$3;return!(r<1900||i>12||a>31||i===2&&(new Date(r,1,29).getDate()===29&&a>29||new Date(r,1,29).getDate()!==29&&a>28))}}let nr=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(nr.getFullYear())&&(nr=new Date("2/19/17"));const p6=nr.getFullYear()===2017;function v6(o,e){const t=new Date(o);if(p6)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(o instanceof Date)return o;if(nr.getFullYear()===1917&&!Number.isNaN(t.getFullYear())){const r=t.getFullYear();return o.indexOf(`${r}`)>-1||t.setFullYear(t.getFullYear()+100),t}const n=o.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return o.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}const b6=new Date(1900,2,1,0,0,0);function Dc(o,e){let t=Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds());const n=Date.UTC(1899,11,31,0,0,0);return e?t-=1262304e5:o>=b6&&(t+=864e5),(t-n)/864e5}function Tt(o){let e=null,t={},n=o;if(o===null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(o)){e=o,n=Number(o.split(".")[0].replace(",",""));let s="#,##0";if(o.split(".")[1]){s="#,##0.";for(let r=0;r<o.split(".")[1].length;r++)s+=0}t={fa:s,t:"n"}}else if(o.toString().substr(0,1)==="'")e=o.toString().substr(1),t={fa:"@",t:"s"};else if(o.toString().toUpperCase()==="TRUE")e="TRUE",t={fa:"General",t:"b"},n=!0;else if(o.toString().toUpperCase()==="FALSE")e="FALSE",t={fa:"General",t:"b"},n=!1;else if(m6(o))e=o.toString(),t={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(o))e=o.toString(),t={fa:"@",t:"s"};else if(Eo(o)&&Math.abs(parseFloat(o))>0&&(Math.abs(parseFloat(o))>=1e11||Math.abs(parseFloat(o))<1e-9)){n=Jn(o).value();const s=n.toExponential();if(s.indexOf(".")>-1){let r=s.split(".")[1].split("e")[0].length;r>5&&(r=5),t={fa:`#0.${new Array(r+1).join("0")}E+00`,t:"n"}}else t={fa:"#0.E+00",t:"n"};e=Mn.format(t.fa,n)}else if(o.toString().indexOf("%")>-1){const s=o.toString().indexOf("%");let r=o.toString().substr(0,s);const i=r.replace(/,/g,"");if(s===o.toString().length-1&&Eo(i))if(r.indexOf(".")>-1)if(r.indexOf(".")===r.lastIndexOf(".")){const a=r.split(".")[0];let c=r.split(".")[1].length;if(c>9&&(c=9),a.indexOf(",")>-1){let u=!0,h=a.split(",");for(let d=1;d<h.length;d++)if(h[d].length<3){u=!1;break}u?(t={fa:`#,##0.${new Array(c+1).join("0")}%`,t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n)):(e=o.toString(),t={fa:"@",t:"s"})}else t={fa:`0.${new Array(c+1).join("0")}%`,t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n)}else e=o.toString(),t={fa:"@",t:"s"};else if(r.indexOf(",")>-1){let a=!0,l=r.split(",");for(let c=1;c<l.length;c++)if(l[c].length<3){a=!1;break}a?(t={fa:"#,##0%",t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n)):(e=o.toString(),t={fa:"@",t:"s"})}else t={fa:"0%",t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n);else e=o.toString(),t={fa:"@",t:"s"}}else if(o.toString().indexOf(".")>-1)if(o.toString().indexOf(".")===o.toString().lastIndexOf(".")){const s=o.toString().split(".")[0];let r=o.toString().split(".")[1],i=r.length;if(i>9&&(i=9),s.indexOf(",")>-1){let a=!0,l=s.split(",");for(let c=1;c<l.length;c++)if(!Eo(l[c])||l[c].length<3){a=!1;break}a?(t={fa:`#,##0.${new Array(i+1).join("0")}`,t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n)):(e=o.toString(),t={fa:"@",t:"s"})}else Eo(s)&&Eo(r)?(t={fa:`0.${new Array(i+1).join("0")}`,t:"n"},n=Jn(o).value(),e=Mn.format(t.fa,n)):(e=o.toString(),t={fa:"@",t:"s"})}else e=o.toString(),t={fa:"@",t:"s"};else Eo(o)?(e=o.toString(),t={fa:"General",t:"n"},n=parseFloat(o)):_6(o)&&(o.toString().indexOf(".")>-1||o.toString().indexOf(":")>-1||o.toString().length<16)?(n=Dc(v6(o.toString().replace(/-/g,"/"))),n.toString().indexOf(".")>-1?o.toString().length>18?t.fa="yyyy-MM-dd hh:mm:ss":o.toString().length>11?t.fa="yyyy-MM-dd hh:mm":t.fa="yyyy-MM-dd":t.fa="yyyy-MM-dd",t.t="d",e=Mn.format(t.fa,n)):(e=o,t.fa="General",t.t="g");return[e,t,n]}const Mn={format(o,e){}},Qn=(o,e)=>{};class rs{static getApplyData(e,t,n,s,r){const i=this,a=[];i.applyType=s,i.direction=r;const l=Math.floor(n/t),c=n%t,u=e.number,h=[];if(u)for(let E=0;E<u.length;E++){const w=i.getLenS(u[E].index,c),I=u[E].index.length*l+w;let P;s===1?P=i.getDataByType(u[E].data,I,r,s,"number"):s==="2"?P=i.getDataByType(u[E].data,I,r,s):P=i.getDataByType(u[E].data,I,r,"0");const L=i.getDataIndex(t,n,u[E].index);h.push({data:P,index:L})}const d=e.extendNumber,g=[];if(d)for(let E=0;E<d.length;E++){const w=i.getLenS(d[E].index,c),I=d[E].index.length*l+w;let P;s==="1"||s==="3"?P=i.getDataByType(d[E].data,I,r,s,"extendNumber"):s==="2"?P=i.getDataByType(d[E].data,I,r,s):P=i.getDataByType(d[E].data,I,r,"0");const L=i.getDataIndex(t,n,d[E].index);g.push({data:P,index:L})}const m=e.date,_=[];if(m)for(let E=0;E<m.length;E++){const w=i.getLenS(m[E].index,c),I=m[E].index.length*l+w;let P;s==="1"||s==="3"?P=i.getDataByType(m[E].data,I,r,s,"date"):s==="8"?P=i.getDataByType(m[E].data,I,r,"0"):P=i.getDataByType(m[E].data,I,r,s);const L=i.getDataIndex(t,n,m[E].index);_.push({data:P,index:L})}const p=e.chnNumber,v=[];if(p)for(let E=0;E<p.length;E++){const w=i.getLenS(p[E].index,c),I=p[E].index.length*l+w;let P;s==="1"||s==="3"?P=i.getDataByType(p[E].data,I,r,s,"chnNumber"):s==="2"||s==="8"?P=i.getDataByType(p[E].data,I,r,s):P=i.getDataByType(p[E].data,I,r,"0");const L=i.getDataIndex(t,n,p[E].index);v.push({data:P,index:L})}const b=e.chnWeek2,C=[];if(b)for(let E=0;E<b.length;E++){const w=i.getLenS(b[E].index,c),I=b[E].index.length*l+w;let P;s==="1"||s==="3"?P=i.getDataByType(b[E].data,I,r,s,"chnWeek2"):s==="2"?P=i.getDataByType(b[E].data,I,r,s):P=i.getDataByType(b[E].data,I,r,"0");const L=i.getDataIndex(t,n,b[E].index);C.push({data:P,index:L})}const D=e.chnWeek3,O=[];if(D)for(let E=0;E<D.length;E++){const w=i.getLenS(D[E].index,c),I=D[E].index.length*l+w;let P;s==="1"||s==="3"?P=i.getDataByType(D[E].data,I,r,s,"chnWeek3"):s==="2"?P=i.getDataByType(D[E].data,I,r,s):P=i.getDataByType(D[E].data,I,r,"0");const L=i.getDataIndex(t,n,D[E].index);O.push({data:P,index:L})}const F=e.other,S=[];if(F)for(let E=0;E<F.length;E++){const w=i.getLenS(F[E].index,c),I=F[E].index.length*l+w;let P;s==="2"||s==="3"?P=i.getDataByType(F[E].data,I,r,s):P=i.getDataByType(F[E].data,I,r,"0");const L=i.getDataIndex(t,n,F[E].index);S.push({data:P,index:L})}for(let E=1;E<=n;E++){if(h.length>0)for(let w=0;w<h.length;w++)E in h[w].index&&a.push(h[w].data[h[w].index[E]]);if(g.length>0)for(let w=0;w<g.length;w++)E in g[w].index&&a.push(g[w].data[g[w].index[E]]);if(_.length>0)for(let w=0;w<_.length;w++)E in _[w].index&&a.push(_[w].data[_[w].index[E]]);if(v.length>0)for(let w=0;w<v.length;w++)E in v[w].index&&a.push(v[w].data[v[w].index[E]]);if(C.length>0)for(let w=0;w<C.length;w++)E in C[w].index&&a.push(C[w].data[C[w].index[E]]);if(O.length>0)for(let w=0;w<O.length;w++)E in O[w].index&&a.push(O[w].data[O[w].index[E]]);if(S.length>0)for(let w=0;w<S.length;w++)E in S[w].index&&a.push(S[w].data[S[w].index[E]])}return a}static getCopyData(e,t,n,s,r,i){const a=this,l=[];let c=0,u=0,h=0,d=0;i===B.BOTTOM||i===B.TOP?(c=s,u=r,h=t,d=n):(i===B.RIGHT||i===B.LEFT)&&(c=t,u=n,h=s,d=r);for(let g=c;g<=u;g++){const m={};let _=[],p=[],v="",b=null,C=null,D=!0;for(let O=h,F=0;O<=d;O++,F++){const S=e[F];let E;if(!!S&&!!S.v&&!S.f)if(!!S.fm&&S.fm.t===Qs.NUMBER)E="number",b=null,C=null;else if(!!S.fm&&S.fm.t===Qs.DATE)E="date",b=null,C=null;else if(a.isExtendNumber(S.m)[0]){E="extendNumber";const w=a.isExtendNumber(S.m);b===null||C===null?(D=!0,b=w[2],C=w[3]):w[2]!==b||w[3]!==C?(D=!1,b=w[2],C=w[3]):D=!0}else a.isChnNumber(S.m)?(E="chnNumber",b=null,C=null):a.isChnWeek2(S.m)?(E="chnWeek2",b=null,C=null):a.isChnWeek3(S.m)?(E="chnWeek3",b=null,C=null):(E="other",b=null,C=null);else E="other",b=null,C=null;E==="extendNumber"?O===h?h===d?(v=E,_.push(S),p.push(O-h+1),m[v]=[],m[v].push({data:_,index:p})):(v=E,_.push(S),p.push(O-h+1)):O===d?v===E&&D?(_.push(S),p.push(O-h+1),v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p}))):(v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p})),v=E,_=[],_.push(S),p=[],p.push(O-h+1),v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p}))):v===E&&D?(_.push(S),p.push(O-h+1)):(v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p})),v=E,_=[],_.push(S),p=[],p.push(O-h+1)):O===h?h===d?(v=E,_.push(S),p.push(O-h+1),m[v]=[],m[v].push({data:_,index:p})):(v=E,_.push(S),p.push(O-h+1)):O===d?v===E?(_.push(S),p.push(O-h+1),v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p}))):(v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p})),v=E,_=[],_.push(S),p=[],p.push(O-h+1),v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p}))):v===E?(_.push(S),p.push(O-h+1)):(v in m?m[v].push({data:_,index:p}):(m[v]=[],m[v].push({data:_,index:p})),v=E,_=[],_.push(S),p=[],p.push(O-h+1))}l.push(m)}return l}static ChineseToNumber(e){const t=this;let n=0,s=0,r=0,i=!1;const a=e.split("");for(let l=0;l<a.length;l++){const c=t.chnNumChar[a[l]];if(typeof c!="undefined")r=c,l===a.length-1&&(s+=r);else{const u=t.chnNameValue[a[l]].value;i=t.chnNameValue[a[l]].secUnit,i?(s=(s+r)*u,n+=s,s=0):s+=r*u,r=0}}return n+s}static NumberToChinese(e){const t=this;let n=0,s="",r="",i=!1;if(e===0)return t.chnNumChar2[0];for(;e>0;){const a=e%1e4;i&&(r=t.chnNumChar2[0]+r),s=t.SectionToChinese(a),s+=a!==0?t.chnUnitSection[n]:t.chnUnitSection[0],r=s+r,i=a<1e3&&a>0,e=Math.floor(e/1e4),n++}return r}static SectionToChinese(e){const t=this;let n="",s="",r=0,i=!0;for(;e>0;){const a=e%10;a===0?i||(i=!0,s=t.chnNumChar2[a]+s):(i=!1,n=t.chnNumChar2[a],n+=t.chnUnitChar[r],s=n+s),r++,e=Math.floor(e/10)}return s}static getLenS(e,t){let n=0;for(let s=0;s<e.length&&e[s]<=t;s++)n++;return n}static getDataByType(e,t,n,s,r){const i=this;let a=[];if(s===Js.ALTERNATE_SERIES)(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(s===Js.DEFAULT_SERIES)if(r==="number")a=i.FillSeries(e,t,n);else if(r==="extendNumber")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillExtendNumber(e,t,l)}else{const l=[];for(let c=0;c<e.length;c++){const u=e[c].m;l.push(Number(i.isExtendNumber(u)[1]))}if((n===B.TOP||n===B.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const c=l[1]-l[0];a=i.FillExtendNumber(e,t,c)}else a=i.FillCopy(e,t)}else if(r==="date")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillDays(e,t,l)}else{(n===B.TOP||n===B.LEFT)&&e.reverse();const l=i.judgeDate(e);if(l[0]&&l[3]){const c=G(e[1].m).diff(G(e[0].m),"months");a=i.FillMonths(e,t,c)}else if(!l[0]&&l[2]){const c=G(e[1].m).diff(G(e[0].m),"days");a=i.FillDays(e,t,c)}else a=i.FillCopy(e,t)}else if(r==="chnNumber")if(e.length===1)if(e[0].m==="\u65E5"||i.ChineseToNumber(e[0].m)<7){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillChnWeek(e,t,l)}else{let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillChnNumber(e,t,l)}else{let l=!1;for(let h=0;h<e.length;h++)if(e[h].m==="\u65E5"){l=!0;break}const c=[];let u=0;for(let h=0;h<e.length;h++)e[h].m==="\u65E5"?h===0?c.push(0):(u++,c.push(u*7)):l&&i.ChineseToNumber(e[h].m)>0&&i.ChineseToNumber(e[h].m)<7?c.push(i.ChineseToNumber(e[h].m)+u*7):c.push(i.ChineseToNumber(e[h].m));if((n===B.TOP||n===B.LEFT)&&(e.reverse(),c.reverse()),i.isEqualDiff(c))if(l||c[c.length-1]<6&&c[0]>0||c[0]<6&&c[c.length-1]>0){const h=c[1]-c[0];a=i.FillChnWeek(e,t,h)}else{const h=c[1]-c[0];a=i.FillChnNumber(e,t,h)}else a=i.FillCopy(e,t)}else if(r==="chnWeek2")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillChnWeek2(e,t,l)}else{const l=[];let c=0;for(let u=0;u<e.length;u++){const h=e[u].m.substr(e[u].m.length-1,1);e[u].m==="\u5468\u65E5"?u===0?l.push(0):(c++,l.push(c*7)):l.push(i.ChineseToNumber(h)+c*7)}if((n===B.TOP||n===B.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const u=l[1]-l[0];a=i.FillChnWeek2(e,t,u)}else a=i.FillCopy(e,t)}else if(r==="chnWeek3")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillChnWeek3(e,t,l)}else{const l=[];let c=0;for(let u=0;u<e.length;u++){const h=e[u].m.substr(e[u].m.length-1,1);e[u].m==="\u661F\u671F\u65E5"?u===0?l.push(0):(c++,l.push(c*7)):l.push(i.ChineseToNumber(h)+c*7)}if((n===B.TOP||n===B.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const u=l[1]-l[0];a=i.FillChnWeek3(e,t,u)}else a=i.FillCopy(e,t)}else(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(s==="2")(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillOnlyFormat(e,t);else if(s==="3"){const l=i.getDataByType(e,t,n,"1",r);a=i.FillWithoutFormat(l)}else if(s==="4")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillDays(e,t,l)}else if(e.length===2){(n===B.TOP||n===B.LEFT)&&e.reverse();const l=G(e[1].m).diff(G(e[0].m),"days");a=i.FillDays(e,t,l)}else{(n===B.TOP||n===B.LEFT)&&e.reverse();const l=i.judgeDate(e);if(l[0]&&l[3]){const c=G(e[1].m).diff(G(e[0].m),"months");a=i.FillMonths(e,t,c)}else if(!l[0]&&l[2]){const c=G(e[1].m).diff(G(e[0].m),"days");a=i.FillDays(e,t,c)}else a=i.FillCopy(e,t)}else if(s==="5")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1);const c=Math.round(t*1.5);for(let u=1;u<=c;u++){const h={...e[u]},d=G(h.m).add(u,"days").day();if(d===0||d===6)continue;const g=G(h.m).add(l*u,"days").format("YYYY-MM-DD");if(h.m=g,h.v=Tt(g)[2],a.push(h),a.length===t)break}}else if(e.length===2)if(G(e[1].m).date()===G(e[0].m).date()&&G(e[1].m).diff(G(e[0].m),"months")!==0){(n===B.TOP||n===B.LEFT)&&e.reverse();const l=G(e[1].m).diff(G(e[0].m),"months");for(let c=1;c<=t;c++){const u=(c-1)%e.length,h={...e[u]},d=G(e[e.length-1]).add(l*c,"months").day();let g;d===0?g=G(e[e.length-1]).add(l*c,"months").subtract(2,"days").format("YYYY-MM-DD"):d===6?g=G(e[e.length-1]).add(l*c,"months").subtract(1,"days").format("YYYY-MM-DD"):g=G(e[e.length-1]).add(l*c,"months").format("YYYY-MM-DD"),h.m=g,h.v=Tt(g)[2],a.push(h)}}else if(Math.abs(G(e[1].m).diff(G(e[0].m)))>7){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1,e.reverse());let c=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},g=Math.ceil(u/e.length);h===0&&(c=G(d.m).add(l*g,"months").diff(G(d.m),"days"));const m=G(d.m).add(c,"days").day();let _;m===0?_=G(d.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?_=G(d.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):_=G(d.m).add(c,"days").format("YYYY-MM-DD"),d.m=_,d.v=Tt(_)[2],a.push(d)}}else{let l=0;n===B.BOTTOM||n===B.RIGHT?l=7:(n===B.TOP||n===B.LEFT)&&(l=-7,e.reverse());let c=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},g=Math.ceil(u/e.length);h===0&&(c=G(d.m).add(l*g,"days").diff(G(d.m),"days"));const m=G(d.m).add(c,"days").day();let _;m===0?_=G(d.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?_=G(d.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):_=G(d.m).add(c,"days").format("YYYY-MM-DD"),d.m=_,d.v=Tt(_)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[3]){(n===B.TOP||n===B.LEFT)&&e.reverse();const c=G(e[1].m).diff(G(e[0].m),"months");for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},g=G(e[e.length-1].m).add(c*u,"months").day();let m;g===0?m=G(e[e.length-1].m).add(c*u,"months").subtract(2,"days").format("YYYY-MM-DD"):g===6?m=G(e[e.length-1].m).add(c*u,"months").subtract(1,"days").format("YYYY-MM-DD"):m=G(e[e.length-1].m).add(c*u,"months").format("YYYY-MM-DD"),d.m=m,d.v=Tt(m)[2],a.push(d)}}else if(!l[0]&&l[2])if(Math.abs(G(e[1].m).diff(G(e[0].m)))>7){let c=0;n===B.BOTTOM||n===B.RIGHT?c=1:(n===B.TOP||n===B.LEFT)&&(c=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(u=G(g.m).add(c*m,"months").diff(G(g.m),"days"));const _=G(g.m).add(u,"days").day();let p;_===0?p=G(g.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):_===6?p=G(g.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):p=G(g.m).add(u,"days").format("YYYY-MM-DD"),g.m=p,g.v=Tt(p)[2],a.push(g)}}else{let c=0;n===B.BOTTOM||n===B.RIGHT?c=7:(n===B.TOP||n===B.LEFT)&&(c=-7,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(u=G(g.m).add(c*m,"days").diff(G(g.m),"days"));const _=G(g.m).add(u,"days").day();let p;_===0?p=G(g.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):_===6?p=G(g.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):p=G(g.m).add(u,"days").format("YYYY-MM-DD"),g.m=p,g.v=Tt(p)[2],a.push(g)}}else(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="6")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillMonths(e,t,l)}else if(e.length===2)if(G(e[1].m).date()===G(e[0].m).date()&&G(e[1].m).diff(G(e[0].m),"months")!==0){(n===B.TOP||n===B.LEFT)&&e.reverse();const l=G(e[1].m).diff(G(e[0].m),"months");a=i.FillMonths(e,t,l)}else{let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1,e.reverse());let c=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},g=Math.ceil(u/e.length);h===0&&(c=G(d.m).add(l*g,"months").diff(G(d.m),"days"));const m=G(d.m).add(c,"days").format("YYYY-MM-DD");d.m=m,d.v=Tt(m)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[3]){(n===B.TOP||n===B.LEFT)&&e.reverse();const c=G(e[1].m).diff(G(e[0].m),"months");a=i.FillMonths(e,t,c)}else if(!l[0]&&l[2]){let c=0;n===B.BOTTOM||n===B.RIGHT?c=1:(n===B.TOP||n===B.LEFT)&&(c=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(u=G(g.m).add(c*m,"months").diff(G(g.m),"days"));const _=G(g.m).add(u,"days").format("YYYY-MM-DD");g.m=_,g.v=Tt(_)[2],a.push(g)}}else(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="7")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillYears(e,t,l)}else if(e.length===2)if(G(e[1].m).date()===G(e[0].m).date()&&G(e[1].m).month()===G(e[0].m).month()&&G(e[1].m).diff(G(e[0].m),"years")!==0){(n===B.TOP||n===B.LEFT)&&e.reverse();const l=G(e[1].m).diff(G(e[0].m),"years");a=i.FillYears(e,t,l)}else{let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1,e.reverse());let c=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},g=Math.ceil(u/e.length);h===0&&(c=G(d.m).add(l*g,"years").diff(G(d.m),"days"));const m=G(d.m).add(c,"days").format("YYYY-MM-DD");d.m=m,d.v=Tt(m)[2],a.push(d)}}else{const l=i.judgeDate(e);if(l[0]&&l[1]&&l[4]){(n===B.TOP||n===B.LEFT)&&e.reverse();const c=G(e[1].m).diff(G(e[0].m),"years");a=i.FillYears(e,t,c)}else if(l[0]&&l[3]||l[2]){let c=0;n===B.BOTTOM||n===B.RIGHT?c=1:(n===B.TOP||n===B.LEFT)&&(c=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,g={...e[d]},m=Math.ceil(h/e.length);d===0&&(u=G(g.m).add(c*m,"years").diff(G(g.m),"days"));const _=G(g.m).add(u,"days").format("YYYY-MM-DD");g.m=_,g.v=Tt(_)[2],a.push(g)}}else(n===B.TOP||n===B.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(s==="8")if(e.length===1){let l=0;n===B.BOTTOM||n===B.RIGHT?l=1:(n===B.TOP||n===B.LEFT)&&(l=-1),a=i.FillChnNumber(e,t,l)}else{const l=[];for(let c=0;c<e.length;c++)l.push(i.ChineseToNumber(e[c].m));if((n===B.TOP||n===B.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l)){const c=l[1]-l[0];a=i.FillChnNumber(e,t,c)}else a=i.FillCopy(e,t)}return a}static getDataIndex(e,t,n){const s={},r=Math.floor(t/e),i=t%e;let a=0;if(r>0){for(let l=1;l<=r;l++)for(let c=0;c<n.length;c++)s[n[c]+(l-1)*e]=a,a++;for(let l=0;l<n.length&&n[l]<=i;l++)s[n[l]+e*r]=a,a++}else for(let l=0;l<n.length&&n[l]<=i;l++)s[n[l]]=a,a++;return s}static FillCopy(e,t){const n=[];for(let s=1;s<=t;s++){const r=(s-1)%e.length,i={...e[r]};n.push(i)}return n}static FillSeries(e,t,n){const s=this,r=[],i=[];for(let a=0;a<e.length;a++)i.push(Number(e[a].v));if(e.length>2&&s.isEqualRatio(i))for(let a=1;a<=t;a++){const l=(a-1)%e.length,c={...e[l]};let u;n===B.BOTTOM||n===B.RIGHT?u=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**a:(n===B.TOP||n===B.LEFT)&&(u=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**a),c.v=u,c.m=u,r.push(c)}else{const a=s.getXArr(e.length);for(let l=1;l<=t;l++){const c=(l-1)%e.length,u={...e[c]};let h;n===B.BOTTOM||n===B.RIGHT?h=s.forecast(e.length+l,i,a):(n===B.TOP||n===B.LEFT)&&(h=s.forecast(1-l,i,a)),u.v=h,u.m=h,r.push(u)}}return r}static FillExtendNumber(e,t,n){const s=[],r=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]},c=e[e.length-1].m,u=c.match(r),h=u[u.length-1],d=Math.abs(Number(h)+n*i),g=c.lastIndexOf(h),m=c.substr(0,g)+d.toString()+c.substr(g+h.length);l.v=m,l.m=m,s.push(l)}return s}static FillOnlyFormat(e,t){const n=[];for(let s=1;s<=t;s++){const r=(s-1)%e.length,i={...e[r]};delete i.f,delete i.m,delete i.v,n.push(i)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const s={...e[n]};let r;s.f===null?r={m:s.v.toString(),v:s.v}:r={f:s.f,m:s.v.toString(),v:s.v},t.push(r)}return t}static FillDays(e,t,n){const s=[];for(let r=1;r<=t;r++){const i=(r-1)%e.length,a={...e[i]};let l=Qn("yyyy-MM-dd",a.v);l=G(l).add(n*r,"days").format("YYYY-MM-DD"),a.v=Tt(l)[2],a.m=Qn(a.fm.f,a.v),s.push(a)}return s}static FillMonths(e,t,n){const s=[];for(let r=1;r<=t;r++){const i=(r-1)%e.length,a={...e[i]};let l=Qn("yyyy-MM-dd",a.v);l=G(l).add(n*r,"months").format("YYYY-MM-DD"),a.v=Tt(l)[2],a.m=Qn(a.fm.f,a.v),s.push(a)}return s}static FillYears(e,t,n){const s=[];for(let r=1;r<=t;r++){const i=(r-1)%e.length,a={...e[i]};let l=Qn("yyyy-MM-dd",a.v);l=G(l).add(n*r,"years").format("YYYY-MM-DD"),a.v=Tt(l)[2],a.m=Qn(a.fm.t,a.v),s.push(a)}return s}static FillChnWeek(e,t,n){const s=this,r=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let c;e[e.length-1].m==="\u65E5"?c=7+n*i:c=s.ChineseToNumber(e[e.length-1].m)+n*i,c<0&&(c=Math.ceil(Math.abs(c)/7)*7+c);const u=c%7;u===0?(l.m="\u65E5",l.v="\u65E5"):u===1?(l.m="\u4E00",l.v="\u4E00"):u===2?(l.m="\u4E8C",l.v="\u4E8C"):u===3?(l.m="\u4E09",l.v="\u4E09"):u===4?(l.m="\u56DB",l.v="\u56DB"):u===5?(l.m="\u4E94",l.v="\u4E94"):u===6&&(l.m="\u516D",l.v="\u516D"),r.push(l)}return r}static FillChnWeek2(e,t,n){const s=this,r=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let c;if(e[e.length-1].m==="\u5468\u65E5")c=7+n*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);c=s.ChineseToNumber(d)+n*i}c<0&&(c=Math.ceil(Math.abs(c)/7)*7+c);const u=c%7;u===0?(l.m="\u5468\u65E5",l.v="\u5468\u65E5"):u===1?(l.m="\u5468\u4E00",l.v="\u5468\u4E00"):u===2?(l.m="\u5468\u4E8C",l.v="\u5468\u4E8C"):u===3?(l.m="\u5468\u4E09",l.v="\u5468\u4E09"):u===4?(l.m="\u5468\u56DB",l.v="\u5468\u56DB"):u===5?(l.m="\u5468\u4E94",l.v="\u5468\u4E94"):u===6&&(l.m="\u5468\u516D",l.v="\u5468\u516D"),r.push(l)}return r}static FillChnWeek3(e,t,n){const s=this,r=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]};let c;if(e[e.length-1].m==="\u661F\u671F\u65E5")c=7+n*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);c=s.ChineseToNumber(d)+n*i}c<0&&(c=Math.ceil(Math.abs(c)/7)*7+c);const u=c%7;u===0?(l.m="\u661F\u671F\u65E5",l.v="\u661F\u671F\u65E5"):u===1?(l.m="\u661F\u671F\u4E00",l.v="\u661F\u671F\u4E00"):u===2?(l.m="\u661F\u671F\u4E8C",l.v="\u661F\u671F\u4E8C"):u===3?(l.m="\u661F\u671F\u4E09",l.v="\u661F\u671F\u4E09"):u===4?(l.m="\u661F\u671F\u56DB",l.v="\u661F\u671F\u56DB"):u===5?(l.m="\u661F\u671F\u4E94",l.v="\u661F\u671F\u4E94"):u===6&&(l.m="\u661F\u671F\u516D",l.v="\u661F\u671F\u516D"),r.push(l)}return r}static FillChnNumber(e,t,n){const s=this,r=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,l={...e[a]},c=s.ChineseToNumber(e[e.length-1].m)+n*i;let u;c<=0?u="\u96F6":u=s.NumberToChinese(c),l.v=u,l.m=u.toString(),r.push(l)}return r}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let s=1;s<e.length;s++)if(e[s]-e[s-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(e.length===1)e==="\u65E5"||e in t.chnNumChar?n=!0:n=!1;else{const s=e.split("");for(let r=0;r<s.length;r++)if(!(s[r]in t.chnNumChar||s[r]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const s=e.match(t),r=s[s.length-1],i=e.lastIndexOf(r),a=e.substr(0,i),l=e.substr(i+r.length);return[n,Number(r),a,l]}return[n]}static isChnWeek1(e){const t=this;let n;return e.length===1&&(e==="\u65E5"||t.ChineseToNumber(e)<7)?n=!0:n=!1,n}static isChnWeek2(e){let t;return e.length===2&&(e==="\u5468\u4E00"||e==="\u5468\u4E8C"||e==="\u5468\u4E09"||e==="\u5468\u56DB"||e==="\u5468\u4E94"||e==="\u5468\u516D"||e==="\u5468\u65E5")?t=!0:t=!1,t}static isChnWeek3(e){let t;return e.length===3&&(e==="\u661F\u671F\u4E00"||e==="\u661F\u671F\u4E8C"||e==="\u661F\u671F\u4E09"||e==="\u661F\u671F\u56DB"||e==="\u661F\u671F\u4E94"||e==="\u661F\u671F\u516D"||e==="\u661F\u671F\u65E5")?t=!0:t=!1,t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let s=1;s<e.length;s++)if(e[s]/e[s-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function s(h){let d=0;for(let g=0;g<h.length;g++)d+=h[g];return d/h.length}const r=s(n),i=s(t);let a=0,l=0;for(let h=0;h<n.length;h++)a+=(n[h]-r)*(t[h]-i),l+=(n[h]-r)*(n[h]-r);let c;l===0?c=1:c=a/l;const u=i-c*r;return Math.round((u+c*e)*1e5)/1e5}static judgeDate(e){let t=!0,n=!0,s=!0,r=!0,i=!0;const a=G(e[0].m).date(),l=G(e[0].m).month(),c=G(e[1].m).diff(G(e[0].m),"days"),u=G(e[1].m).diff(G(e[0].m),"months"),h=G(e[1].m).diff(G(e[0].m),"years");for(let d=1;d<e.length;d++)G(e[d].m).date()!==a&&(t=!1),G(e[d].m).month()!==l&&(n=!1),G(e[d].m).diff(G(e[d-1].m),"days")!==c&&(s=!1),G(e[d].m).diff(G(e[d-1].m),"months")!==u&&(r=!1),G(e[d].m).diff(G(e[d-1].m),"years")!==h&&(i=!1);return c===0&&(s=!1),u===0&&(r=!1),h===0&&(i=!1),[t,n,s,r,i]}}let mt=(o=21)=>crypto.getRandomValues(new Uint8Array(o)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");class Oc{constructor(e,t){this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach(n=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(n).rangeData)}),this._rangeList[0].startRow===-1&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return this._rangeList[0].startRow===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l,g=new Q;for(let _=c;_<=h;_++)for(let p=u;p<=d;p++)g.setValue(c,u,{m:`${e}`,v:e});return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:g.getData(),rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeList:r}=this;let i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};Be.checkup(e,Be.OBJECT_TYPE)&&(i=e[0]);const a=r.map(c=>({sheetId:n.getSheetId(),actionName:A.CLEAR_RANGE_ACTION,options:i,rangeData:c}));let l=new V({WorkBookUnit:t.getWorkBook()},...a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:n,_context:s,_commandManager:r,_worksheet:i}=this;const a=n.map(c=>{let{startRow:u,startColumn:h,endRow:d,endColumn:g}=c;const m={[t]:e},_=R.fillObjectMatrix(d-u+1,g-h+1,m);return{sheetId:i.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:_,rangeData:c}});let l=new V({WorkBookUnit:s.getWorkBook()},...a);return r.invoke(l),this}setBackground(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l;const g={bg:{rgb:e}},m=R.fillObjectMatrix(h-c+1,d-u+1,g);return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setBackgroundRGB(e,t,n){const s=`RGB(${e},${t},${n})`;let{_rangeList:r,_context:i,_commandManager:a,_worksheet:l}=this;const c=r.map(h=>{let{startRow:d,startColumn:g,endRow:m,endColumn:_}=h;const p={bg:{rgb:s}},v=R.fillObjectMatrix(m-d+1,_-g+1,p);return{sheetId:l.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:v,rangeData:h}});let u=new V({WorkBookUnit:i.getWorkBook()},...c);return a.invoke(u),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l;const g={cl:{rgb:e}},m=R.fillObjectMatrix(h-c+1,d-u+1,g);return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?Y.TRUE:Y.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?Y.TRUE:Y.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?Y.TRUE:Y.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?Y.TRUE:Y.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?Y.TRUE:Y.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l,g=new Q;for(let _=c;_<=h;_++)for(let p=u;p<=d;p++)g.setValue(_,p,e);return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMULA_ACTION,cellFormula:g.getData(),rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l;const g={tr:{v:0,a:Number(e)}},m=R.fillObjectMatrix(h-c+1,d-u+1,g);return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:r}=this;const i=t.map(l=>{let{startRow:c,startColumn:u,endRow:h,endColumn:d}=l;const g={tr:{v:e,a:0}},m=R.fillObjectMatrix(h-c+1,d-u+1,g);return{sheetId:r.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new V({WorkBookUnit:n.getWorkBook()},...i);return s.invoke(a),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:s}=this;const r=e.map(a=>{let{startRow:l,startColumn:c,endRow:u,endColumn:h}=a;const d=this._worksheet.getCellMatrix(),g=/\s+/g;let m=new Q;for(let p=l;p<u+1;p++)for(let v=c;v<h+1;v++){const C=d.getValue(p,v).m.replace(g,"");m.setValue(p,v,C||"")}return{sheetId:s.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:m.getData(),rangeData:a}});let i=new V({WorkBookUnit:t.getWorkBook()},...r);return n.invoke(i),this}}class xc{constructor(e,t){this._workSheet=e,this._rowData=new xe(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new xe;for(let s=e;s<e+t;s++){const r=this.getRowOrCreate(s);n.push(r)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,s=t.getConfig();let r=0;if(e.length===1)r=n.obtain(e[0],{hd:Y.FALSE,h:s.defaultRowHeight}).h;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)r+=n.obtain(i,{hd:Y.FALSE,h:s.defaultRowHeight}).h;return r}setRowHeight(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),r={sheetId:this._workSheet.getSheetId(),actionName:A.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},i=new V({WorkBookUnit:n.getWorkBook()},r);s.invoke(i)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,s=n.get(e);if(s)return s;const r=t.getConfig(),i={hd:Y.FALSE,h:r.defaultRowHeight};return n.set(e,i),i}}class Lt{_initialize(){this._merges=new Rc(this,this._config.mergeData)}constructor(...e){var t;if(R.hasLength(e,1)){const n=e[0],s=R.commonExtend({},xn);e=[n,s]}if(R.hasLength(e,2)){this._context=e[0],this._config=R.commonExtend(xn,e[1]);const{columnData:n,rowData:s,cellData:r}=this._config;this._sheetId=(t=this._config.id)!=null?t:mt(6),this._initialized=!1,this._cellData=new Q(r),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._rowManager=new xc(this,s),this._columnManager=new sl(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===Y.TRUE)return this;const{_context:e,_commandManager:t}=this,n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),s=e.getContextObserver("onAfterChangeActiveSheetObservable"),r={sheetId:this._sheetId,actionName:A.SET_WORKSHEET_ACTIVATE_ACTION,status:Y.TRUE},i=new V({WorkBookUnit:e.getWorkBook()},r);return n.notifyObservers({sheet:this}),t.invoke(i),s.notifyObservers({sheet:this}),this}setConfig(e){return this._config=R.commonExtend(xn,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r=t.getContextObserver("onBeforeChangeSheetNameObservable"),i=t.getContextObserver("onAfterChangeSheetNameObservable"),a={actionName:A.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:s},c=t.getWorkBook().getSheets();for(let h=0;h<c.length;h++){const d=c[h];if(d!==this&&d.getName()===e)return console.warn("Duplicate name"),this}r.notifyObservers();const u=new V({WorkBookUnit:t.getWorkBook()},a);return n.invoke(u),i.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=R.deepClone(e);return new Lt(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){if(R.hasLength(e,1))return new We(this,e[0]);if(R.hasLength(e,2))return new We(this,{row:[e[0],e[0]],column:[e[1],e[1]]});if(R.hasLength(e,3))return new We(this,{row:[e[0],e[2]],column:[e[1],e[1]]});if(R.hasLength(e,4))return new We(this,{row:[e[0],e[2]],column:[e[1],e[3]]})}getRangeList(e){return new Oc(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r={actionName:A.SET_WORKSHEET_STATUS_ACTION,sheetId:s,sheetStatus:e},i=new V({WorkBookUnit:t.getWorkBook()},r);return n.invoke(i),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n,_commandManager:s}=this,r={actionName:A.SET_ZOOM_RATIO_ACTION,sheetId:n,zoom:e},i=new V({WorkBookUnit:t.getWorkBook()},r);s.invoke(i),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,s=R.deepClone(t);return s.name=e,s.status=Y.FALSE,s.id=mt(),new Lt(n,s)}getConfig(){return this._config.mergeData=this._merges.getMergeData(),this._config}insertRows(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]),R.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new Q(new xe(n)).toJSON()},l={actionName:A.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},c=new V({WorkBookUnit:s.getWorkBook()},a,l);return r.invoke(c),this}insertRowAfter(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]+1),R.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new Q(new xe(n)).toJSON()},l={actionName:A.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},c=new V({WorkBookUnit:s.getWorkBook()},a,l);return r.invoke(c),this}insertRowBefore(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]-1),R.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new Q(new xe(n)).toJSON()},l={actionName:A.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},c=new V({WorkBookUnit:s.getWorkBook()},a,l);return r.invoke(c),this}insertColumns(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]),R.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a=new Q;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:A.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},c={actionName:A.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},u=new V({WorkBookUnit:s.getWorkBook()},c,l);return r.invoke(u),this}insertColumnBefore(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]-1),R.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:r,_sheetId:i}=this,a=new Q;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:A.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},c={actionName:A.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},u=new V({WorkBookUnit:s.getWorkBook()},c,l);return r.invoke(u),this}insertColumnAfter(...e){let t=0,n=1;R.hasLength(e,1)&&(t=e[0]+1),R.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a=new Q;this._cellData.forEach(h=>{for(let d=t;d<t+n;d++)a.setValue(h,d-t,{})});const l={actionName:A.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},c={actionName:A.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},u=new V({WorkBookUnit:s.getWorkBook()},l,c);return r.invoke(u),this}clear(...e){const{_context:t,_commandManager:n}=this,s={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let r={formatOnly:!0,contentsOnly:!0};Be.checkup(e,Be.OBJECT_TYPE)&&(r=e[0]);const i={sheetId:this._sheetId,actionName:A.CLEAR_RANGE_ACTION,options:r,rangeData:s},a=new V({WorkBookUnit:t.getWorkBook()},i);return n.invoke(a),this}setTabColor(e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onSheetTabColorChangeObservable"),r={sheetId:this._sheetId,actionName:A.SET_TAB_COLOR_ACTION,color:e},i=new V({WorkBookUnit:t.getWorkBook()},r);return n.invoke(i),s.notifyObservers(),this}hideSheet(){const{_context:e,_workbook:t,_commandManager:n}=this;if(!this._config.hidden){const s=e.getContextObserver("onHideSheetObservable"),r={sheetId:this._sheetId,actionName:A.HIDE_SHEET_ACTION,hidden:Y.TRUE},i=new V({WorkBookUnit:e.getWorkBook()},r);if(n.invoke(i),this.getStatus()===Y.TRUE){const l=t.getSheetIndex(this),c=t.nextSheet(l);c&&c.activate()}s.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,n={sheetId:this._sheetId,actionName:A.HIDE_SHEET_ACTION,hidden:Y.FALSE},s=new V({WorkBookUnit:e.getWorkBook()},n);return t.invoke(s),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r={actionName:A.REMOVE_COLUMN_DATA_ACTION,sheetId:s,columnCount:1,columnIndex:e},i={actionName:A.REMOVE_COLUMN_ACTION,sheetId:s,columnCount:1,columnIndex:e},a=new V({WorkBookUnit:t.getWorkBook()},r,i);return n.invoke(a),this}deleteColumns(e,t){const{_context:n,_commandManager:s,_sheetId:r}=this,i={actionName:A.REMOVE_COLUMN_DATA_ACTION,sheetId:r,columnCount:t,columnIndex:e},a={actionName:A.REMOVE_COLUMN_ACTION,sheetId:r,columnCount:t,columnIndex:e},l=new V({WorkBookUnit:n.getWorkBook()},i,a);return s.invoke(l),this}deleteRow(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r={actionName:A.REMOVE_ROW_DATA_ACTION,sheetId:s,rowCount:1,rowIndex:e},i={actionName:A.REMOVE_ROW_ACTION,sheetId:s,rowCount:1,rowIndex:e},a=new V({WorkBookUnit:t.getWorkBook()},r,i);return n.invoke(a),this}deleteRows(e,t){const{_context:n,_commandManager:s,_sheetId:r}=this,i={actionName:A.REMOVE_ROW_DATA_ACTION,sheetId:r,rowCount:t,rowIndex:e},a={actionName:A.REMOVE_ROW_ACTION,sheetId:r,rowCount:t,rowIndex:e},l=new V({WorkBookUnit:n.getWorkBook()},i,a);return s.invoke(l),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_commandManager:s,_sheetId:r}=this,i=this.getContext(),a=this.getCellMatrix(),l=i.getWorkBook(),c=l.getStyles(),u=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),h=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),d=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),g=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),m=this.getRange(e),_=new Q,p=new Q,v=new Q,b=new Q,C=new Q;u.forEach((S,E)=>{const w=a.getValue(S,E);if(w){const I=c.get(w.s);if(I){const P=R.deepClone(I);P.bd&&delete P.bd.b,_.setValue(S,E,P)}}}),d.forEach((S,E)=>{const w=a.getValue(S,E);if(w){const I=c.get(w.s);if(I){const P=R.deepClone(I);P.bd&&delete P.bd.t,v.setValue(S,E,P)}}}),h.forEach((S,E)=>{const w=a.getValue(S,E);if(w){const I=c.get(w.s);if(I){const P=R.deepClone(I);P.bd&&delete P.bd.r,p.setValue(S,E,P)}}}),g.forEach((S,E)=>{const w=a.getValue(S,E);if(w){const I=c.get(w.s);if(I){const P=R.deepClone(I);P.bd&&delete P.bd.l,b.setValue(S,E,P)}}}),m.forEach((S,E)=>{C.setValue(S,E,t)});const D=[];if(n.includes(B.TOP)){const S={sheetId:r,actionName:A.SET_BORDER_ACTION,styles:v.toJSON()};D.push(S)}if(n.includes(B.BOTTOM)){const S={sheetId:r,actionName:A.SET_BORDER_ACTION,styles:_.toJSON()};D.push(S)}if(n.includes(B.LEFT)){const S={sheetId:r,actionName:A.SET_BORDER_ACTION,styles:b.toJSON()};D.push(S)}if(n.includes(B.RIGHT)){const S={sheetId:r,actionName:A.SET_BORDER_ACTION,styles:p.toJSON()};D.push(S)}const O={sheetId:r,actionName:A.SET_BORDER_ACTION,styles:C.toJSON()};D.push(O);const F=new V({WorkBookUnit:l},...D);return s.invoke(F),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex(n=>n&&n.getSheetId()===this._sheetId);return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:r,_commandManager:i,_sheetId:a}=this,l={actionName:A.SET_HIDE_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},c=new V({WorkBookUnit:r.getWorkBook()},l);return i.invoke(c),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.SET_HIDE_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},l=new V({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:r,_commandManager:i,_sheetId:a}=this,l={actionName:A.SET_HIDE_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},c=new V({WorkBookUnit:r.getWorkBook()},l);return i.invoke(c),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.SET_HIDE_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},l=new V({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:r,_commandManager:i,_sheetId:a}=this,l={actionName:A.SET_SHOW_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},c=new V({WorkBookUnit:r.getWorkBook()},l);return i.invoke(c),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:r,_commandManager:i,_sheetId:a}=this,l={actionName:A.SET_SHOW_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},c=new V({WorkBookUnit:r.getWorkBook()},l);return i.invoke(c),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.SET_SHOW_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},l=new V({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:r,_sheetId:i}=this,a={actionName:A.SET_SHOW_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},l=new V({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return t===0}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(R.hasLength(e,2)&&(t=e[0],n=[e[1]]),R.hasLength(e,3)){t=e[0];for(let s=0;s<e[1];s++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const s=[];for(let r=0;r<t;r++)s.push(n);return this.getRowManager().setRowHeight(e,s),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r={actionName:A.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:s},i=new V({WorkBookUnit:t.getWorkBook()},r);return n.invoke(i),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:n,_sheetId:s}=this,r={actionName:A.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:s},i=new V({WorkBookUnit:t.getWorkBook()},r);return n.invoke(i),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=R.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,s){return new We(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+s-1}).getValues()}getDataRange(){return new We(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:s}=e.getRangeData(),r=this._cellData.spliceRows(n,s-n+1);return this._cellData.insertRows(t,r),this}moveColumns(e,t){const n=e.getRangeData().startColumn,s=e.getRangeData().endColumn,r=this._cellData.spliceColumns(n,s-n+1);return this._cellData.insertColumns(t,r),this}}class We{static foreach(e,t){const{startRow:n,startColumn:s,endRow:r,endColumn:i}=e;for(let a=n;a<=r;a++)for(let l=s;l<=i;l++)t(a,l)}constructor(e,t){this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,r=[];for(let i=e;i<=t;i++){const a=[];for(let l=n;l<=s;l++)a.push(this.getMatrix().getValue(i,l)||null);r.push(a)}return r}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,r=this._worksheet.getCellMatrix(),i=new Q;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)i.setValue(a,l,r.getValue(a,l)||null);return i}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,r=this._worksheet.getCellMatrix(),i=new Q;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)i.setValue(a-e,l-n,r.getValue(a,l)||{});return i}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map(e=>e.map(t=>t&&t.p?t.p:t&&t.m?t.m:""))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;let r,i;return n<s?(r=R.numToWord(n+1)+(e+1),i=R.numToWord(s+1)+(t+1)):(r=R.numToWord(s+1)+(t+1),i=R.numToWord(n+1)+(e+1)),r===i?`${r}`:`${r}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map(e=>e.map(t=>{var r,i,a;const n=this._context.getWorkBook().getStyles();let s=(r=Zn.bg)==null?void 0:r.rgb;return t!=null&&t.s&&(s=(a=(i=n.get(t==null?void 0:t.s))==null?void 0:i.bg)==null?void 0:a.rgb),s}))}getCell(e,t){const{startRow:n,endRow:s,startColumn:r,endColumn:i}=this._rangeData,a={startRow:n+e,endRow:n+e,startColumn:r+t,endColumn:r+t};return new We(this._worksheet,a)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:s,endColumn:r}=this._rangeData,i=this._worksheet.getCellMatrix().getFragments(t,n,s,r).getData();if(e.isIncludeStyle){const a=this._context.getWorkBook().getStyles();for(let l=0;l<=n-t;l++)for(let c=0;c<=r-s;c++){if(!i[l][c])continue;const u=i[l][c].s;u&&(i[l][c].s=a.get(u))}}return i}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map(e=>e.map(t=>{var s,r,i;const n=this._context.getWorkBook().getStyles();return(t==null?void 0:t.s)&&((r=(s=n.get(t.s))==null?void 0:s.cl)==null?void 0:r.rgb)||((i=Zn.cl)==null?void 0:i.rgb)}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map(t=>t.map(n=>{const s=this._context.getWorkBook().getStyles();return vi(s,n)[e]}))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:s}=e;let r=0;for(let i=0;i<=s-n;i++)r+=t.getRowHeight(i);return r}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:s}).map(r=>new We(this._worksheet,r))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:s,startColumn:r,endColumn:i}=this._rangeData,a=t.getMaxRows(),l=t.getMaxColumns();if(e===B.BOTTOM){for(let c=0;c<a-r;c++)this._worksheet.getCellMatrix().getValue(n+c,r)&&t.getRange(n+c,r,n+c,r);return t.getRange(a,r,a,r)}if(e===B.TOP){for(let c=0;c<n;c++)this._worksheet.getCellMatrix().getValue(n-c,r)&&t.getRange(n-c,r,n-c,n);return t.getRange(0,r,0,r)}if(e===B.RIGHT){for(let c=0;c<l-r;c++)this._worksheet.getCellMatrix().getValue(n,r+c)&&t.getRange(n,r+c,n,r+c);return t.getRange(n,l,n,l)}if(e===B.LEFT){for(let c=0;c<a-r;c++)this._worksheet.getCellMatrix().getValue(n,r-c)&&t.getRange(n,r-c,n,r-c);return t.getRange(n,0,n,0)}return t.getRange(tl)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(t=>(t==null?void 0:t.p)||""))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map(e=>e.map(t=>{const n=this._context.getWorkBook().getStyles();return t&&t.s?n.get(t.s):null}))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:s}=e;let r=0;for(let i=0;i<=s-n;i++)r+=t.getColumnWidth(i);return r}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some(t=>t.some(n=>(n==null?void 0:n.m)===""))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,s)}_setStyle(e,t){const{_context:n,_worksheet:s,_commandManager:r}=this,{startRow:i,endRow:a,startColumn:l,endColumn:c}=this._rangeData,u={[t]:e},h=R.fillObjectMatrix(a-i+1,c-l+1,u),d={sheetId:s.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},g=new V({WorkBookUnit:n.getWorkBook()},d);return r.invoke(g),this}_setStyles(e,t){const{_context:n,_worksheet:s,_commandManager:r}=this,{startRow:i,endRow:a,startColumn:l,endColumn:c}=this._rangeData,u=new Q;for(let g=0;g<a-i+1;g++)for(let m=0;m<c-l+1;m++)u.setValue(g,m,{[t]:e[g][m]});const h={sheetId:s.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},d=new V({WorkBookUnit:n.getWorkBook()},h);return r.invoke(d),this}setBackground(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={bg:{rgb:e}},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=new Q;for(let d=0;d<i-r+1;d++)for(let g=0;g<l-a+1;g++)c.setValue(d,g,{bg:{rgb:e[d][g]}});const u={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new V({WorkBookUnit:t.getWorkBook()},u);return s.invoke(h),this}setBackgroundRGB(e,t,n){const{_context:s,_worksheet:r,_commandManager:i}=this,{startRow:a,endRow:l,startColumn:c,endColumn:u}=this._rangeData,d={bg:{rgb:`RGB(${e},${t},${n})`}},g=R.fillObjectMatrix(l-a+1,u-c+1,d),m={sheetId:r.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:g,rangeData:this._rangeData},_=new V({WorkBookUnit:s.getWorkBook()},m);return i.invoke(_),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=new Q;for(let d=0;d<i-r+1;d++)for(let g=0;g<l-a+1;g++)c.setValue(d,g,{cl:{rgb:e[d][g]}});const u={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new V({WorkBookUnit:t.getWorkBook()},u);return s.invoke(h),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,{startRow:i,startColumn:a,endRow:l,endColumn:c}=t,u=new Q;for(let g=i;g<=l;g++)for(let m=a;m<=c;m++)u.setValue(g,m,e);const h={sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMULA_ACTION,cellFormula:u.getData(),rangeData:this._rangeData},d=new V({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setFormulas(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,{startRow:i,startColumn:a,endRow:l,endColumn:c}=t,u=new Q;for(let g=0;g<=l-i;g++)for(let m=0;m<=c-a;m++)u.setValue(g+i,m+a,e[g][m]);const h={sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMULA_ACTION,cellFormula:u.getData(),rangeData:this._rangeData},d=new V({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={tr:{v:0,a:Number(e)}},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=new Q;for(let d=0;d<i-r+1;d++)for(let g=0;g<l-a+1;g++)c.setValue(d,g,{tr:{v:0,a:e[d][g]}});c.getData();const u={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new V({WorkBookUnit:t.getWorkBook()},u);return s.invoke(h),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={...e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=new Q;for(let d=0;d<i-r+1;d++)for(let g=0;g<l-a+1;g++)c.setValue(d,g,{...e[d][g]});const u={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new V({WorkBookUnit:t.getWorkBook()},u);return s.invoke(h),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={tr:{v:e,a:90}},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:s,_commandManager:r}=this,{startRow:i,endRow:a,startColumn:l,endColumn:c}=this._rangeData,{startRow:u,endRow:h,startColumn:d,endColumn:g}=e._rangeData;let m=B.BOTTOM,_=0,p=0;const v=i,b=a,C=l,D=c,O=u,F=h,S=d,E=g,w=new Q;if(S===C&&E===D?F>b?m=B.BOTTOM:m=B.TOP:E>D?m=B.RIGHT:m=B.LEFT,m===B.BOTTOM||m===B.TOP){_=b-v+1,p=F-O+1;for(let L=0;L<=c-l;L++){const y=this.getColumnMatrix(L).toArray();rs.getCopyData(y,v,b,C,D,m).forEach(M=>{rs.getApplyData(M,_,p,t,m).forEach((z,K)=>{w.setValue(K,L,z)})})}}else if(m===B.RIGHT||m===B.LEFT){p=E-S,_=D-C;for(let L=0;L<=a-i;L++){const y=this.getRowMatrix(L).toArray();rs.getCopyData(y,v,b,C,D,m).forEach(M=>{rs.getApplyData(M,_,p,t,m)})}}const I={sheetId:n.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:w.getData(),rangeData:e._rangeData},P=new V({WorkBookUnit:s.getWorkBook()},I);return r.invoke(P),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:r}=this._rangeData;let i,a;const l=this._worksheet.getCellMatrix();if(R.isNumber(e[0])){const c=e[0];if(c===Dn.COLUMNS){let u=t,h=t;const d=this._worksheet.getRowCount();for(let m=1;m<t;m++)if(!l.getValue(t-m,s)){u=t-m+1;break}const g=0;for(;g<d-t;)if(!l.getValue(t+g,s)){h=t-g-1;break}return a=u-h,i=0,this._worksheet.getRange(t,u,i,a)}if(c===Dn.ROWS){let u=t,h=t;const d=this._worksheet.getColumnCount();for(let m=1;m<t;m++)if(!l.getValue(t,s-m)){u=t-m+1;break}const g=0;for(;g<d-s;)if(!l.getValue(t,s+g)){h=t-g-1;break}return a=0,i=u-h,this._worksheet.getRange(u,s,i,a)}}else{let c=t,u=t;const h=this._worksheet.getRowCount();for(let v=1;v<t;v++)if(!l.getValue(t-v,s)){c=t-v+1;break}const d=0;for(;d<h-t;)if(!l.getValue(t+d,s)){u=t-d-1;break}let g=t,m=t;const _=this._worksheet.getColumnCount();for(let v=1;v<t;v++)if(!l.getValue(t,s-v)){g=t-v+1;break}const p=0;for(;p<_-s;)if(!l.getValue(t,s+p)){m=t-p-1;break}return a=g-m,a=c-u,i=t,this._worksheet.getRange(c,g,i,a)}return this}trimWhitespace(){var g;const{_context:e,_worksheet:t,_commandManager:n}=this,{startRow:s,endRow:r,startColumn:i,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),c=/\s+/g,u=new Q;for(let m=0;m<=r-s;m++)for(let _=0;_<=a-i;_++){const p=(g=l.getValue(m,_).m)==null?void 0:g.replace(c,"");u.setValue(m+s,_+i,p||"")}const h={sheetId:t.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new V({WorkBookUnit:e.getWorkBook()},h);return n.invoke(d),this}activate(){var e;return((e=this._rangeData)==null?void 0:e.startRow)===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,s=this._rangeData.startColumn,r=this._rangeData.endColumn,i=e.getRangeData().startRow,a=e.getRangeData().endRow,l=e.getRangeData().startColumn,c=e.getRangeData().endColumn,u=Math.abs(s+r-l-c),h=Math.abs(s-r)+Math.abs(l-c),d=Math.abs(t+n-i-a),g=Math.abs(t-n)+Math.abs(i-a);return u<=h&&d<=g}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={cl:{rgb:e}},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:s}=this,r=e[0],[i,a]=this._handleCopyRange(this,r),{startRow:l,startColumn:c,endRow:u,endColumn:h}=a;if(Be.checkup(e,We,Be.BOOLEAN_TYPE)){const d=e[1];if(e[2],d===_o.PASTE_NORMAL){const g=new Q;i.forEach((p,v)=>p.forEach((b,C)=>{b=b,g.setValue(v+l,C+c,b||{})}));const m={sheetId:n.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:g.getData(),rangeData:a},_=new V({WorkBookUnit:t.getWorkBook()},m);s.invoke(_)}else if(d===_o.PASTE_FORMAT){const g=t.getWorkBook().getStyles(),m=new Q;i.map((v,b)=>v.forEach((C,D)=>{C=C,m.setValue(b,D,C.s?g.get(C.s):{})}));const _={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:m.getData(),rangeData:a},p=new V({WorkBookUnit:t.getWorkBook()},_);s.invoke(p)}else if(d===_o.PASTE_VALUES){const g=new Q;i.forEach((p,v)=>p.forEach((b,C)=>{b=b,g.setValue(v+l,C+c,(b==null?void 0:b.v)||"")}));const m={sheetId:n.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:g.getData(),rangeData:a},_=new V({WorkBookUnit:t.getWorkBook()},m);s.invoke(_)}else if(d===_o.PASTE_COLUMN_WIDTHS){const g=this._rangeData.startColumn;for(let m=0;m<h-g;m++){const _=n.getColumnWidth(g+m);n.setColumnWidth(g+m,_)}}}else if(Be.checkup(e,We,Be.OBJECT_TYPE)){const d=e[1],g=new Q;i.forEach((p,v)=>p.forEach((b,C)=>{b=b,g.setValue(v+l,C+c,b||{})}));const m={sheetId:n.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:g.getData(),rangeData:a,options:d},_=new V({WorkBookUnit:t.getWorkBook()},m);s.invoke(_)}else if(Be.checkup(e,We)){const d=new Q;i.forEach((_,p)=>_.forEach((v,b)=>{v=v,d.setValue(p+l,b+c,v||{})}));const g={sheetId:n.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:d.getData(),rangeData:a},m=new V({WorkBookUnit:t.getWorkBook()},g);s.invoke(m)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],r=e[2],i=e[3],a=e[4],l=R.isAssignableFrom(e[0],Lt)?e[0].getSheetId():e[0],[c,u]=this._handleCopyRange(this,{startRow:s,endRow:r,startColumn:i,endColumn:a}),h=t.getWorkBook().getStyles(),d=new Q;c.map((_,p)=>_.map((v,b)=>(v=v,d.setValue(p,b,v.s?h.get(v.s):{}),v.s?h.get(v.s):{})));const g={sheetId:l,actionName:A.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:u},m=new V({WorkBookUnit:t.getWorkBook()},g);n.invoke(m)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],r=e[2],i=e[3],a=e[4],l=R.isAssignableFrom(e[0],Lt)?e[0].getSheetId():e[0],[c,u]=this._handleCopyRange(this,{startRow:s,endRow:r,startColumn:i,endColumn:a}),h=new Q;c.forEach((m,_)=>m.forEach((p,v)=>{p=p,h.setValue(_+u.startRow,v+u.startColumn,(p==null?void 0:p.v)||"")}));const d={sheetId:l,actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:u},g=new V({WorkBookUnit:t.getWorkBook()},d);n.invoke(g)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:r}=this,i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},a={sheetId:n.getSheetId(),actionName:A.CLEAR_RANGE_ACTION,options:i,rangeData:r},l=this.getMatrix(),{startRow:c,endRow:u,startColumn:h,endColumn:d}=this._rangeData,{startRow:g,startColumn:m}=e.getRangeData(),_=new Q;for(let b=c;b<=u;b++)for(let C=h;C<=d;C++)_.setValue(g+(b-c),m+(C-h),l.getValue(b,C)||{});const p={sheetId:n.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:_.getData(),rangeData:{startRow:g,endRow:g+(u-c),startColumn:m,endColumn:m+(d-h)}},v=new V({WorkBookUnit:t.getWorkBook()},a,p);s.invoke(v)}offset(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:r}=this._rangeData,i=e[0],a=e[1],l=e[2],c=e[3],u={startRow:t+i,endRow:n+i,startColumn:s+a,endColumn:r+a};return R.isNumber(l)&&(u.endRow=u.startRow+l-1),R.isNumber(c)&&(u.endColumn=u.endColumn+c-1),new We(this._worksheet,u)}setBorder(...e){const t=e[0],n=e[1],s=e[2],r=e[3],i=e[4],a=e[5],l=e[6]?e[6]:"black",c=e[7]?e[7]:ye.DASH_DOT,{_context:u,_worksheet:h,_commandManager:d}=this,g=u.getWorkBook(),m=this._rangeData,_=h.getSheetId(),p={startRow:m.startRow-1,startColumn:m.startColumn,endRow:m.startRow-1,endColumn:m.endColumn},v={startRow:m.startRow,startColumn:m.startColumn-1,endRow:m.endRow,endColumn:m.startColumn-1},b={startRow:m.endRow+1,startColumn:m.startColumn,endRow:m.endRow+1,endColumn:m.endColumn},C={startRow:m.startRow,startColumn:m.endColumn+1,endRow:m.endRow,endColumn:m.endColumn+1},D={startRow:m.startRow,startColumn:m.startColumn,endRow:m.startRow,endColumn:m.endColumn},O={startRow:m.startRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.startColumn},F={startRow:m.endRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.endColumn},S={startRow:m.startRow,startColumn:m.endColumn,endRow:m.endRow,endColumn:m.endColumn},E=new We(h,p),w=new We(h,v),I=new We(h,b),P=new We(h,C),L=new We(h,D),y=new We(h,O),k=new We(h,F),M=new We(h,S),U=new Q,z=new Q,K=new Q,j=new Q,q=new Q,se=[],le={s:c,cl:{rgb:l}};if(t===!0||t===!1){if(E.isValid()){E.forEach((ie,de)=>{U.setValue(ie,de,{bd:{b:null}})});const oe={sheetId:_,actionName:A.SET_RANGE_STYLE_ACTION,value:U.getArrayData(),rangeData:p};se.push(oe)}L.forEach((oe,ie)=>{if(t===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{t:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(t===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{t:null}});q.setValue(oe,ie,de)}})}if(s===!0||s===!1){if(I.isValid()){I.forEach((ie,de)=>{K.setValue(ie,de,{bd:{t:null}})});const oe={sheetId:_,actionName:A.SET_RANGE_STYLE_ACTION,value:K.getArrayData(),rangeData:b};se.push(oe)}k.forEach((oe,ie)=>{if(s===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{b:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(s===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{b:null}});q.setValue(oe,ie,de)}})}if(n===!0||n===!1){if(w.isValid()){w.forEach((ie,de)=>{z.setValue(ie,de,{bd:{r:null}})});const oe={sheetId:_,actionName:A.SET_RANGE_STYLE_ACTION,value:z.getArrayData(),rangeData:v};se.push(oe)}y.forEach((oe,ie)=>{if(n===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{l:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(n===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{l:null}});q.setValue(oe,ie,de)}})}if(r===!0||r===!1){if(P.isValid()){P.forEach((ie,de)=>{j.setValue(ie,de,{bd:{l:null}})});const oe={sheetId:_,actionName:A.SET_RANGE_STYLE_ACTION,value:j.getArrayData(),rangeData:C};se.push(oe)}M.forEach((oe,ie)=>{if(r===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{r:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(r===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{r:null}});q.setValue(oe,ie,de)}})}(i===!0||i===!1)&&this.forEach((oe,ie)=>{if(ie!==m.endColumn){if(i===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{r:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(i===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{r:null}});q.setValue(oe,ie,de)}}if(ie!==m.startColumn){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{l:null}});q.setValue(oe,ie,de)}}),(a===!0||a===!1)&&this.forEach((oe,ie)=>{if(oe!==m.endRow){if(a===!0){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{b:R.deepClone(le)}});q.setValue(oe,ie,de)}else if(a===!1){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{b:null}});q.setValue(oe,ie,de)}}if(oe!==m.startRow){const de=R.deepMerge(q.getValue(oe,ie)||{},{bd:{t:null}});q.setValue(oe,ie,de)}});const Te={sheetId:_,actionName:A.SET_RANGE_STYLE_ACTION,value:q.getArrayData(),rangeData:q.getDataRange()};se.push(Te);const pe=new V({WorkBookUnit:g},...se);return d.invoke(pe),this}setBorderByType(e,t,n){let s=null,r=null,i=null,a=null,l=null,c=null;switch(e){case Xt.TOP:s=!0;break;case Xt.BOTTOM:i=!0;break;case Xt.LEFT:r=!0;break;case Xt.RIGHT:a=!0;break;case Xt.NONE:s=!1,r=!1,i=!1,a=!1,l=!1,c=!1;break;case Xt.ALL:s=!0,r=!0,i=!0,a=!0,l=!0,c=!0;break;case Xt.OUTSIDE:s=!0,r=!0,i=!0,a=!0;break;case Xt.INSIDE:l=!0,c=!0;break;case Xt.HORIZONTAL:c=!0;break;case Xt.VERTICAL:l=!0;break}this.setBorder(s,r,i,a,l,c,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={ff:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={fs:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={ht:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={vt:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={td:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c={tb:e},u=R.fillObjectMatrix(i-r+1,l-a+1,c),h={sheetId:n.getSheetId(),actionName:A.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new V({WorkBookUnit:t.getWorkBook()},h);return s.invoke(d),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,{startRow:i,startColumn:a,endRow:l,endColumn:c}=t,u=new Q;for(let g=i;g<=l;g++)for(let m=a;m<=c;m++)u.setValue(g,m,e);const h={sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new V({WorkBookUnit:n.getWorkBook()},h);return s.invoke(d),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,i=e[0];if(Be.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:c,endColumn:u}=t,h=new Q;for(let m=0;m<=c-a;m++)for(let _=0;_<=u-l;_++)h.setValue(m+a,_+l,i[m][_]);const d={sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},g=new V({WorkBookUnit:n.getWorkBook()},d);s.invoke(g)}else if(Be.checkup(e,Q)){const a={sheetId:r.getSheetId(),actionName:A.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:i,rangeData:this._rangeData},l=new V({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,i={sheetId:r.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:e,rangeData:t},a=new V({WorkBookUnit:n.getWorkBook()},i);return s.invoke(a),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,i=e[0];if(Be.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:c,endColumn:u}=t,h=new Q;for(let m=0;m<=c-a;m++)for(let _=0;_<=u-l;_++)h.setValue(m+a,_+l,i[m][_]);const d={sheetId:r.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:h.getData(),rangeData:this._rangeData},g=new V({WorkBookUnit:n.getWorkBook()},d);s.invoke(g)}else if(Be.checkup(e,Q)){const a={sheetId:r.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:i,rangeData:this._rangeData},l=new V({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:r}=this;let i={formatOnly:!0,contentsOnly:!0};Be.checkup(e,Be.OBJECT_TYPE)&&(i=e[0]);const a={sheetId:n.getSheetId(),actionName:A.CLEAR_RANGE_ACTION,options:i,rangeData:r},l=new V({WorkBookUnit:t.getWorkBook()},a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this,i={sheetId:r.getSheetId(),actionName:A.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},a=new V({WorkBookUnit:n.getWorkBook()},i);s.invoke(a)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:s,_context:r,_commandManager:i,_worksheet:a}=this,{startRow:l,endRow:c,startColumn:u,endColumn:h}=this._rangeData;let d=this._rangeData,g=new Q;if(n){g=n.getMatrixObject();const p=n.getRangeData();d={startRow:l,endRow:l+p.endRow-p.startRow,startColumn:u,endColumn:l+p.endColumn-p.startColumn}}else for(let p=l;p<=c;p++)for(let v=u;v<=h;v++)g.setValue(p,v,{m:"",v:""});const m={sheetId:a.getSheetId(),actionName:A.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:d,cellValue:g.getData()},_=new V({WorkBookUnit:r.getWorkBook()},m);return i.invoke(_),this}merge(){const{_worksheet:e}=this,t=e.getContext(),n=e.getSheetId(),s=e.getCommandManager(),r={actionName:A.ADD_MERGE_ACTION,sheetId:n,rectangles:[this._rangeData]},i=new V({WorkBookUnit:t.getWorkBook()},r);return s.invoke(i),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=[];for(let d=r;d<=i;d++){const g={startRow:d,endRow:d,startColumn:a,endColumn:l};c.push(g)}const u={actionName:A.ADD_MERGE_ACTION,sheetId:s,rectangles:c},h=new V({WorkBookUnit:n.getWorkBook()},u);return t.invoke(h),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:r,endRow:i,startColumn:a,endColumn:l}=this._rangeData,c=[];for(let d=a;d<=l;d++){const g={startRow:r,endRow:i,startColumn:d,endColumn:d};c.push(g)}const u={actionName:A.ADD_MERGE_ACTION,sheetId:s,rectangles:c},h=new V({WorkBookUnit:n.getWorkBook()},u);return t.invoke(h),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),r=this._worksheet.getMerges().getMergedRanges(this._rangeData),i={actionName:A.REMOVE_MERGE_ACTION,sheetId:s,rectangles:r},a=new V({WorkBookUnit:n.getWorkBook()},i);return t.invoke(a),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:r}=this;Array.isArray(e[0])&&e[0];const i=this.getMatrix().getData(),a=[];for(let d=0;d<=t.endColumn-t.startColumn;d++){const g=[],m={},_=this.getColumnMatrix(d).getData();for(const p in _){const v=_[p][d].m;m.hasOwnProperty(v)||(m[v]=1,g.push(d))}a.push(g)}const l=Array.from(new Set(a.flat())),c={};l.forEach((d,g)=>{c[g]=i[d]});const u=[{sheetId:r.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:c,rangeData:t}],h=new V({WorkBookUnit:n.getWorkBook()},...u);return s.invoke(h),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,s=this._worksheet.getCellMatrix(),r=new Q;for(let i=e;i<=e;i++)for(let a=t;a<=n;a++)r.setValue(i,a,s.getValue(i,a)||{});return r}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,s=this._worksheet.getCellMatrix(),r=new Q;for(let i=t;i<=n;i++)for(let a=e;a<=e;a++)r.setValue(i,a,s.getValue(i,a)||{});return r}_handleCopyRange(...e){const t=e[0];let n=e[1];n=Be.checkup(e,We,We)?n.getRangeData():n;const s=t._worksheet.getCellMatrix(),{startRow:r,endRow:i,startColumn:a,endColumn:l}=t.getRangeData();let{startRow:c,endRow:u,startColumn:h,endColumn:d}=n;const g=i-r+1,m=l-a+1,_=u-c+1,p=d-h+1;let v=[],b;if(_%g===0&&p%m===0){for(let C=0;C<_;C++){const D=[];for(let O=0;O<p;O++){const F=s.getValue((C+r)%g,(O+a)%m)||{};D.push(F)}v.push(D)}b=n}else v=s.getFragments(r,i,a,l).getData(),u+=g-_,d+=m-p,b={startRow:c,endRow:u,startColumn:h,endColumn:d};return[v,b]}forEach(e){We.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:s}=this,{startRow:r,startColumn:i}=s,a=new Q;R.randSort(this.getMatrix().toArray()).forEach((h,d)=>h.forEach((g,m)=>{g=g,a.setValue(d+r,m+i,g||{})}));const c={sheetId:t.getSheetId(),actionName:A.SET_RANGE_DATA_ACTION,cellValue:a.getData(),rangeData:s},u=new V({WorkBookUnit:e.getWorkBook()},c);n.invoke(u)}isValid(){return!Object.values(this._rangeData).includes(-1)}}class Mc{constructor(e={}){this._styles=e}each(e){return Object.entries(this._styles).forEach(e),this}search(e){const{_styles:t}=this;for(const n in t)if(R.diffValue(t[n],e))return n;return"-1"}get(e){return e=String(e),typeof e!="string"?e:this._styles[e]}add(e){const t=mt(6);return this._styles[t]=e,t}setValue(e){if(e==null)return;const t=this.search(e);return t!=="-1"?t:this.add(e)}toJSON(){return this._styles}}class C6{constructor(e){this._workbook=e,this._commandManager=this._workbook.getCommandManager(),this._context=this._workbook.getContext()}addNamedRange(e){const{_workbook:t,_context:n,_commandManager:s}=this,r={actionName:A.ADD_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},i=new V({WorkBookUnit:t},r);s.invoke(i)}setNamedRange(e){const{_workbook:t,_commandManager:n}=this,s={actionName:A.SET_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},r=new V({WorkBookUnit:t},s);n.invoke(r)}remove(e){const{_context:t,_workbook:n,_commandManager:s}=this,r={actionName:A.DELETE_NAMED_RANGE_ACTION,namedRangeId:e,sheetId:n.getActiveSheet().getSheetId()},i=new V({WorkBookUnit:n},r);s.invoke(i)}}class mi{constructor(e={},t){var s;this._config=R.commonExtend(nl,e),this._context=t;const{styles:n}=this._config;this._unitId=(s=this._config.id)!=null?s:mt(6),this._styles=new Mc(n),this._worksheets=new Map,this._commandManager=t.getCommandManager(),this._getDefaultWorkSheet(),this._namedRange=new C6(this)}_getDefaultWorkSheet(){const{_context:e,_config:t,_worksheets:n}=this,{sheets:s,sheetOrder:r}=t;R.isEmptyObject(s)&&(s[xn.id]=xn);let i=null;for(let a in s){let l=s[a];l.name=bn.getSheetName(l.name);const c=new Lt(e,l);n.set(c.getSheetId(),c),r.push(c.getSheetId()),i==null&&(i=c)}i&&i.activate()}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach(e=>{e.setStatus(Y.FALSE)}),this._worksheets[0].setStatus(Y.TRUE))}_getCellRange(e){var c,u,h,d,g;let t="",n="";if(e.indexOf("!")>-1){const m=e.split("!");t=m[0],n=m[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substring(0,1)==="'"&&t.substring(t.length-1,1)==="'"&&(t=t.substring(1,t.length-1))}else n=e;if(n.indexOf(":")===-1){const m=parseInt(n.replace(/[^0-9]/g,""),10)-1,_=R.ABCatNum(n.replace(/[^A-Za-z]/g,""));return!Number.isNaN(m)&&!Number.isNaN(_)?{sheetId:t,rangeData:{startRow:m,endRow:m,startColumn:_,endColumn:_}}:ss}n=n.split(":");const s=[0,0],r=[0,0],i=((c=this.getSheetBySheetName(t))==null?void 0:c.getMaxRows())||((u=this.getActiveSheet())==null?void 0:u.getMaxRows()),a=((h=this.getSheetBySheetName(t))==null?void 0:h.getMaxColumns())||((d=this.getActiveSheet())==null?void 0:d.getMaxColumns());return s[0]=parseInt(n[0].replace(/[^0-9]/g,""),10)-1,s[1]=parseInt(n[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(s[0])&&(s[0]=0),Number.isNaN(s[1])&&(s[1]=i),s[0]>s[1]||(r[0]=R.ABCatNum(n[0].replace(/[^A-Za-z]/g,"")),r[1]=R.ABCatNum(n[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(r[0])&&(r[0]=0),Number.isNaN(r[1])&&(r[1]=a),r[0]>r[1])?ss:{sheetId:((g=this.getSheetBySheetName(t))==null?void 0:g.getSheetId())||"",rangeData:{startRow:s[0],endRow:s[1],startColumn:r[0],endColumn:r[1]}}}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}getNamedRang(){return this._namedRange}nextSheet(e){if(e>=0){const{sheetOrder:t}=this._config;for(let n=e;n<t.length;n++){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}if(e<t.length)for(let n=e-1;n>=0;n--){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}return this._worksheets.get(t[t.length-1])}}setContext(e){this._context=e}setCommandManager(e){this._commandManager=e}insertSheet(...e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onBeforeInsertSheetObservable"),r=t.getContextObserver("onAfterInsertSheetObservable");if(R.hasLength(e,0)){const i={name:bn.getSheetName(),status:0,id:mt(6)},a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:i.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:i.id,index:a,sheet:i})),r.notifyObservers({index:a,sheetId:i.id}),i.id}if(R.hasLength(e,1)){if(R.isAssignableFrom(e[0],Lt)){const i=e[0],a=this.getSheetSize(),l=i.getConfig();return l.id=mt(6),s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),r.notifyObservers({index:a,sheetId:l.id}),l.id}if(R.isNumber(e[0])){const i=e[0],a={name:bn.getSheetName(),status:0,id:mt(6)};return s.notifyObservers({index:i,sheetId:a.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:a.id,index:i,sheet:a})),r.notifyObservers({index:i,sheetId:a.id}),a.id}if(R.isString(e[0])){const i=e[0],a=this.getSheetSize(),l={status:0,name:i,id:mt(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),r.notifyObservers({index:a,sheetId:l.id}),l.id}if(R.isPlainObject(e[0])){const i=e[0],a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:i.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:i.id,index:a,sheet:i})),r.notifyObservers({index:a,sheetId:i.id}),i.id}}if(R.hasLength(e,2)){if(R.isString(e[0])){const i=e[0],a=e[1],l={status:0,name:i,id:mt(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),r.notifyObservers({index:a,sheetId:l.id}),l.id}if(R.isNumber(e[0])){if(R.isAssignableFrom(e[1],Lt)){const i=e[0],l=e[1].getConfig();return l.id=mt(6),s.notifyObservers({index:i,sheetId:l.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:l.id,index:i,sheet:l})),r.notifyObservers({index:i,sheetId:l.id}),l.id}if(R.isPlainObject(e[1])){const i=e[0],a=e[1];return s.notifyObservers({index:i,sheetId:a.id}),n.invoke(new V({WorkBookUnit:t.getWorkBook()},{actionName:A.INSERT_SHEET_ACTION,sheetId:a.id,index:i,sheet:a})),r.notifyObservers({index:i,sheetId:a.id}),a.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...e){if(R.hasLength(e,1)){const{_context:t}=this,n=e[0],s={...xn,name:n},r=new Lt(t,s);return this.insertSheet(r),r}if(R.hasLength(e,3)){const{_context:t}=this,n=e[0],s=e[1],r=e[2],i={...xn,name:n,rowCount:s,columnCount:r},a=new Lt(t,i);return this.insertSheet(a),a}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>n===e)}getActiveSheet(){const{sheetOrder:e}=this._config,t=e.find(n=>this._worksheets.get(n).getStatus()===Y.TRUE);return t?this._worksheets.get(t):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:e}=this._config;return e.findIndex(t=>this._worksheets.get(t).getStatus()===1)}getActiveRange(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRange():null}setActiveRange(e){const t=this.getActiveSheet();return t?t.setActiveSelection(e):null}setActiveRangeList(e){const t=this.getActiveSheet();if(t){const n=t.getRangeList(e);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRangeList():null}getSelection(){const e=this.getActiveSheet();if(e)return e.getSelection()}getCurrentCell(){const e=this.getSelection();if(e)return e.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(e){return e.activateAsCurrentCell()}flush(){}setSheetOrder(e,t){const{_context:n,_commandManager:s}=this,r=n.getContextObserver("onSheetOrderObservable"),i={actionName:A.SET_SHEET_ORDER_ACTION,sheetId:e,order:t},a=new V({WorkBookUnit:n.getWorkBook()},i);s.invoke(a),r.notifyObservers()}getSheets(){const{sheetOrder:e}=this._config;return e.map(t=>this._worksheets.get(t))}getSheetIndex(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>e.getSheetId()===n)}removeSheetBySheetId(e){const{_commandManager:t,_config:n}=this,{sheetOrder:s}=n,r=this.getSheetBySheetId(e);if(s.length>1&&r!=null){const i=this.getSheetIndex(r),a=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),l=this.getContext().getContextObserver("onAfterRemoveSheetObservable");if(a.notifyObservers({index:i}),t.invoke(new V({WorkBookUnit:this},{actionName:A.REMOVE_SHEET_ACTION,sheetId:e})),r.getStatus()===Y.TRUE){const u=this.nextSheet(i);u&&u.activate()}l.notifyObservers({index:i,sheetId:e})}}getSheetBySheetName(e){const{sheetOrder:t}=this._config,n=t.find(s=>this._worksheets.get(s).getName()===e);return this._worksheets.get(n)}getSheetBySheetId(e){return this._worksheets.get(e)}setActiveSheet(...e){let t=!1;const n=e[0];return Be.checkup(e,Lt,Be.BOOLEAN_TYPE)&&(t=e[1]),n.activate(),t&&n.setActiveSelection(),n}getCommandManager(){return this._commandManager}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[e]=t}static isIRangeType(e){return typeof e=="string"||"startRow"in e||"row"in e}transformRangeType(e){return typeof e=="string"?this._getCellRange(e):typeof e!="string"&&"row"in e?{sheetId:"",rangeData:{startRow:e.row[0],startColumn:e.column[0],endRow:e.row[1],endColumn:e.column[1]}}:typeof e!="string"&&"startRow"in e?{sheetId:"",rangeData:e}:ss}static rangeDataToRangeStringData(e){const{startRow:t,endRow:n,startColumn:s,endColumn:r}=e;return`${R.chatAtABC(s)+(t+1)}:${R.chatAtABC(r)}${n+1}`}load(e){this._config=e}save(){return this._config}}class _i{constructor(e){this._workSheet=e,this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._workbook=e.getContext().getWorkBook(),this._activeRangeList=this._workSheet.getRangeList([bo]),this._activeRange=this._workSheet.getRange(bo),this._currentCell=this._workSheet.getRange(bo)}setWorkSheet(e){this._workSheet=e}setSelection({selection:e,cell:t}={}){var d;let n,s,r;e instanceof We?(s=e.getRangeData(),s.startRow===-1&&console.error("Invalid selection, default set startRow -1"),n=[s],r={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e&&mi.isIRangeType(e)?(s=this._workbook.transformRangeType(e).rangeData,s.startRow===-1&&console.error("Invalid selection, default set startRow -1"),n=[s],r={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e instanceof Array?(n=e.map(g=>{const m=this._workbook.transformRangeType(g).rangeData;return m.startRow===-1&&console.error("Invalid selection, default set startRow -1"),m}),s=n[n.length-1],r={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):(n=this._activeRangeList.getRangeList(),s=this._activeRange.getRangeData(),r=this._currentCell.getRangeData()),t&&(r=this._workbook.transformRangeType(t).rangeData,_i.cellInRange(n,r)||(s=r,n=[s]));const{_context:i,_workSheet:a,_commandManager:l}=this,c={sheetId:a.getSheetId(),actionName:A.SET_SELECTION_ACTION,activeRangeList:n,activeRange:s,currentCell:r},u=new V({WorkBookUnit:i.getWorkBook()},c);l.invoke(u);const h=`${R.chatAtABC(s.startColumn)+(s.startRow+1)}:${R.chatAtABC(s.endColumn)}${s.endRow+1}`;return(d=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable"))==null||d.notifyObservers(h),this._activeRange}getSelection(){return R.deepClone(this._activeRange.getRangeData())}getActiveRange(){return this._activeRange}getActiveRangeList(){return this._activeRangeList}getActiveSheet(){return this._workbook.getActiveSheet()}getCurrentCell(){return this._currentCell}setCurrentCell(e){if(R.isAssignableFrom(e,We)&&(e=e.getRangeData()),(e==null?void 0:e.startRow)===-1)return console.error("Invalid range,default set startRow -1"),this;if(!(e.startRow===e.endRow&&e.startColumn===e.endColumn))return console.error("Exception: Range must have a single cell."),this;const t=this._activeRangeList.getRangeList(),{_context:n,_workSheet:s,_commandManager:r}=this,i={sheetId:s.getSheetId(),actionName:A.SET_SELECTION_ACTION,activeRangeList:t,activeRange:e,currentCell:e},a=new V({WorkBookUnit:n.getWorkBook()},i);return r.invoke(a),this}setRanges(e,t,n){this._activeRangeList=this._workSheet.getRangeList(e),this._activeRange=this._workSheet.getRange(t),this._currentCell=this._workSheet.getRange(n)}getNextDataRange(e){const t=this._expandRange(e);return this.setSelection({selection:t}),this.getActiveRange()}_expandRange(e){const t=this._workSheet.getColumnCount(),n=this._workSheet.getRowCount(),s=this._activeRange.getRangeData();let r=bo;const i=this.getCurrentCell().getRangeData();if(e===B.RIGHT)if(i.startColumn===s.startColumn){const a=this._workSheet.getCellMatrix().getValue(i.startRow,s.endColumn);let l;if(a&&a.v===void 0)for(let c=s.endColumn+1;c<=t;c++){if(c===t){l=t;break}const u=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(u&&u.v!==void 0){l=c;break}}else for(let c=s.endColumn+1;c<=t;c++){if(c===t){l=t;break}const u=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(u&&u.v===void 0){const h=this._workSheet.getCellMatrix().getValue(i.startRow,c-1);if(h&&h.v!==void 0){l=c-1;break}}}r={startRow:s.startRow,endRow:s.endRow,startColumn:s.startColumn,endColumn:l!==void 0?l:s.endColumn}}else{const a=this._workSheet.getCellMatrix().getValue(i.startRow,s.startColumn);let l;if(a&&a.v===void 0)for(let c=s.startColumn+1;c<=i.startColumn;c++){if(c===i.startColumn){l=i.startColumn;break}const u=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(u&&u.v!==void 0){l=c;break}}else for(let c=s.startColumn+1;c<=i.startColumn;c++){if(c===i.startColumn){l=i.startColumn;break}const u=this._workSheet.getCellMatrix().getValue(i.startRow,c);if(u&&u.v===void 0){const h=this._workSheet.getCellMatrix().getValue(i.startRow,c-1);if(h&&h.v!==void 0){l=c-1;break}}}r={startRow:s.startRow,endRow:s.endRow,startColumn:l||i.startColumn,endColumn:s.endColumn}}if(e===B.LEFT){let a,l;if(i.endColumn===s.endColumn){const c=this._workSheet.getCellMatrix().getValue(i.startRow,s.startColumn);if(c&&c.v===void 0)for(let u=s.startColumn-1;u>=0;u--){if(u===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(h&&h.v!==void 0){a=u;break}}else for(let u=s.startColumn-1;u>=0;u--){if(u===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(i.startRow,u-1);if(d&&d.v!==void 0){a=u-1;break}}}}else{const c=this._workSheet.getCellMatrix().getValue(i.startRow,s.endColumn);if(c&&c.v===void 0)for(let u=s.endColumn-1;u>=i.startColumn;u--){if(u===i.startColumn){l=u;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(h&&h.v!==void 0){l=u;break}}else for(let u=s.endColumn-1;u>=i.startColumn;u--){if(u===i.startColumn){l=u;break}const h=this._workSheet.getCellMatrix().getValue(i.startRow,u);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(i.startRow,u-1);if(d&&d.v!==void 0){l=u-1;break}}}}r={startRow:s.startRow,endRow:s.endRow,startColumn:a!==void 0?a:s.startColumn,endColumn:l!==void 0?l:s.endColumn}}if(e===B.TOP){let a,l;if(i.endRow===s.endRow){const c=this._workSheet.getCellMatrix().getValue(s.startRow,i.startColumn);if(c&&c.v===void 0)for(let u=s.endRow-1;u>=0;u--){const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v!==void 0||u===0){a=u;break}}else for(let u=s.startRow-1;u>=0;u--){if(u===0){a=0;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(u-1,i.startColumn);if(d&&d.v!==void 0){a=u-1;break}}}}else{const c=this._workSheet.getCellMatrix().getValue(s.endRow,i.startColumn);if(c&&c.v===void 0)for(let u=s.endRow-1;u>=i.startRow;u--){if(u===i.startRow){l=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v!==void 0){l=u;break}}else for(let u=s.endRow-1;u>=i.startRow;u--){const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(u===i.startRow){l=i.startRow;break}else if(h&&h.v===void 0&&u!==s.endRow-1){const d=this._workSheet.getCellMatrix().getValue(u+1,i.startColumn);if(d&&d.v!==void 0){l=u+1;break}}}}r={startRow:a!==void 0?a:s.startRow,endRow:l!==void 0?l:s.endRow,startColumn:s.startColumn,endColumn:s.endColumn}}if(e===B.BOTTOM){let a,l;if(i.startRow===s.startRow){const c=this._workSheet.getCellMatrix().getValue(s.endRow,i.startColumn);if(c&&c.v===void 0)for(let u=s.endRow+1;u<=n;u++){if(u===n){l=n;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v!==void 0){l=u;break}}else for(let u=s.endRow+1;u<=n;u++){if(u===n){l=n;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v===void 0){const d=this._workSheet.getCellMatrix().getValue(u+1,i.startColumn);if(d&&d.v!==void 0){l=u+1;break}}}}else{const c=this._workSheet.getCellMatrix().getValue(s.startRow+1,i.startColumn);if(c&&c.v===void 0)for(let u=s.startRow+1;u<=i.startRow;u++){if(u===i.startRow){a=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v!==void 0){a=u;break}}else for(let u=s.startRow+1;u<=i.startRow;u++){if(u===i.startRow){a=i.startRow;break}const h=this._workSheet.getCellMatrix().getValue(u,i.startColumn);if(h&&h.v===void 0&&u!==s.startRow+1){const d=this._workSheet.getCellMatrix().getValue(u-1,i.startColumn);if(d&&d.v!==void 0){a=u-1;break}}}}r={startRow:a!==void 0?a:s.startRow,endRow:l!==void 0?l:s.endRow,startColumn:s.startColumn,endColumn:s.endColumn}}return r}static cellInRange(e,t){for(const n of e)if(n.startRow<=t.startRow&&t.endRow<=n.endRow&&n.startColumn<=t.startColumn&&t.endColumn<=n.endColumn)return n;return null}}function wo(o){if(!o)return;let{row:e,column:t,startY:n,endY:s,startX:r,endX:i,isMerged:a,mergeInfo:l}=o,c=e,u=t,h=e,d=t;if(a&&l){const{startRow:g,startColumn:m,endRow:_,endColumn:p,startY:v,endY:b,startX:C,endX:D}=l;c=g,u=m,h=_,d=p,n=v,s=b,r=C,i=D}return{startRow:c,startColumn:u,endRow:h,endColumn:d,startY:n,endY:s,startX:r,endX:i}}function pi(o){return!o||((o==null?void 0:o.m)||"").length===0&&!o.p}function _t(o){if(o){if(o.rgb)return o.rgb;if(o.th)return new qn().setThemeColor(o.th).asThemeColor().asRgbColor().getCssString()}return null}function E6(o){return R.isString(o)&&o.indexOf("=")===0&&o.length>1}function vi(o,e){let t;return e&&R.isObject(e.s)?t=e.s:t=e&&e.s&&o.get(e.s),t||Zn}class w6{}class S6{}function y6(o,...e){for(const t of e)if(t)for(const n in t)t.hasOwnProperty(n)&&R6(t[n])&&(o[n]=t[n]);return o}function T6(o){if(A6(o))return"";let e="";for(const t in o)o.hasOwnProperty(t)&&o[t]!==void 0&&o[t]!==null&&(e+=`${t}=${o[t]}&`);return e=e.substring(0,e.length-1),e?`?${encodeURI(e)}`:""}function R6(o){return o!=null}function A6(o){return o==null}function I6(o){return Object.prototype.toString.apply(o)==="[object String]"}function D6(o){return o?Object.getPrototypeOf(o)===Object.getPrototypeOf({}):!1}function O6(o){return Object.prototype.toString.apply(o)==="[object Array]"}function kc(o){return o instanceof FormData}const is=()=>{},Bc=o=>o;var Fc=(o=>(o.POST="POST",o.GET="GET",o.PUT="PUT",o.DELETE="DELETE",o))(Fc||{}),Nc=(o=>(o[o.UNSENT=0]="UNSENT",o[o.OPENED=1]="OPENED",o[o.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",o[o.LOADING=3]="LOADING",o[o.DONE=4]="DONE",o))(Nc||{}),Lc=(o=>(o.ARRAY_BUFFER="arraybuffer",o.BLOB="blob",o.TEXT="text",o.DOCUMENT="document",o.JSON="json",o.STREAM="stream",o))(Lc||{});const x6={type:"POST",url:"",async:!0,header:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:is,beforeSend:Bc,dataFilter:Bc,success:is,complete:is};function vn(o){return new Promise((e,t)=>{const n=y6({},x6,o),s=new XMLHttpRequest;switch(n.beforeSend(n),s.responseType=n.dataType,s.timeout=n.timeout,s.addEventListener("readystatechange",r=>{if(s.readyState===4)if(s.status===200){const i=n.dataFilter(s.response);n.success(i),n.complete(),e(i)}else n.error(r),t(r)}),s.addEventListener("timeout",r=>{n.error(r)}),s.open(n.type,n.url,n.async,n.username,n.password),Object.keys(n.header).forEach(r=>{const i=n.header[r];s.setRequestHeader(r,i)}),kc(n.data)?s.setRequestHeader("Content-Type","multipart/form-data"):n.contentType&&s.setRequestHeader("Content-Type",n.contentType),n.type){case"DELETE":case"GET":{s.send();break}case"POST":case"PUT":{if(D6(n.data)){s.send(JSON.stringify(n.data));return}if(I6(n.data)){s.send(n.data);return}if(O6(n.data)){s.send(JSON.stringify(n.data));return}kc(n.data)&&s.send(n.data);break}}})}function M6(o,e={},t=is){return vn({url:o,type:"POST",data:e,success:t})}function k6(o,e={},t=is){return o+=T6(e),vn({url:o,type:"GET",success:t})}function B6(o){return o!=null}function F6(o){return o==null}function N6(o){return F6(o)||o.toString()===""}function L6(o,...e){for(const t of e)if(t)for(const n in t)t.hasOwnProperty(n)&&B6(t[n])&&(o[n]=t[n]);return o}var kn=(o=>(o.MESSAGE="message",o.OPEN="open",o.CLOSE="close",o.ERROR="error",o.RETRY="retry",o.DESTROY="destroy",o))(kn||{});const P6={url:"",heartbeatTime:1e3*6};class Pc{constructor(e){const t=L6({},P6,e);if(N6(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=e}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message),this._socket.addEventListener("open",this._open),this._socket.addEventListener("close",this._close),this._socket.addEventListener("error",this._error)}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message),this._socket.removeEventListener("open",this._open),this._socket.removeEventListener("close",this._close),this._socket.removeEventListener("error",this._error),this._socket.close()}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;function s(){e.send("heartbea_message")}this._timer=setInterval(s,n)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens[e]=t}}const z6=Object.keys(si).reduce((o,e)=>[...o,...si[e]],[]);function zc(o){return z6.indexOf(o)===-1}const U6={},W6={};class as{initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(R.getLanguage())?Kn.ZH:Kn.EN,locales:{zh:U6,en:W6}}}get(e){if(e){const{locales:t,currentLocale:n}=this.options;return as.getValue(t[n],e)||""}return String()}getObject(e){const{locales:t,currentLocale:n}=this.options;return as.getValue(t[n],e)}load(e){R.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce((n,s)=>n[s],e)}catch{console.error("Key %s not found",t)}}}class So{static info(...e){console&&console.log(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){So.info(`
`)}static capsule(e,t,n="",s=""){console&&console.log(`%c${n}%c${e}%c${t}%c${s}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class ls{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}}const He=Symbol("newer"),ut=Symbol("older");class Uc{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[He],{done:!1,value:e.key}):{done:!0,value:void 0}}}class Wc{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[He],{done:!1,value:e.value}):{done:!0,value:void 0}}}class Hc{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[He],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class bi{constructor(e,t){this.key=e,this.value=t,this[He]=void 0,this[ut]=void 0}toJSON(){return{key:this.key,value:this.value}}}class H6{_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[He]&&(e===this.oldest&&(this.oldest=e[He]),e[He][ut]=e[ut]),e[ut]&&(e[ut][He]=e[He]),e[He]=void 0,e[ut]=this.newest,this.newest&&(this.newest[He]=e),this.newest=e)}constructor(...e){if(ls.hasLength(e,1)){if(ls.isNumber(e[0])){const t=e[0];this._initialize(t,void 0);return}if(ls.isIterable(e[0])){const t=e[0];this._initialize(0,t);return}return}if(ls.hasLength(e,2)){const t=e[0],n=e[1];this._initialize(t,n)}}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let s=e[Symbol.iterator]();for(let r=s.next();!r.done;r=s.next()){let i=new bi(r.value[0],r.value[1]);if(this._keymap.set(i.key,i),t?(t[He]=i,i[ut]=t):this.oldest=i,t=i,n--===0)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,n=new bi(e,t)),this.newest?(this.newest[He]=n,n[ut]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[He]?(this.oldest=this.oldest[He],this.oldest[ut]=void 0):(this.oldest=void 0,this.newest=void 0),e[He]=e[ut]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}get(e){const t=this._keymap.get(e);if(!!t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(!!t)return this._keymap.delete(t.key),t[He]&&t[ut]?(t[ut][He]=t[He],t[He][ut]=t[ut]):t[He]?(t[He][ut]=void 0,this.oldest=t[He]):t[ut]?(t[ut][He]=void 0,this.newest=t[ut]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new Uc(this.oldest)}values(){return new Wc(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new Hc(this.oldest)}forEach(e,t){typeof t!="object"&&(t=this);let n=this.oldest;for(;n;)e.call(t,n.value,n.key,this),n=n[He]}toJSON(){let e=new Array(this.size),t=0,n=this.oldest;for(;n;)e[t++]={key:n.key,value:n.value},n=n[He];return e}toString(){let e=String(),t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[He],t&&(e+=" < ");return e}}function $6(o,e){var t,n,s,r,i,a,l,c,u,h,d,g,m,_,p,v,b,C,D,O,F,S,E,w,I,P,L,y,k,M,U,z,K,j,q,se,le,Te,pe,oe,ie,de,Ne,Ce,Ie,Le,Ve,it,Ze,Dt,sn,et,Nt,$t,pn,Ot,rn,Vt,N,W,X,J,ue,Xe,Ee,we;o.cellData={};for(let $ of e.config.borderInfo)if($.rangeType==="cell"){const he=$.value.row_index,te=$.value.col_index;o.cellData[String(he)]||(o.cellData[String(he)]={}),o.cellData[String(he)][String(te)]||(o.cellData[String(he)][String(te)]={}),o.cellData[String(he)][String(te)].s||(o.cellData[String(he)][String(te)].s={});const be={};$.value.l&&(be.l={s:$.value.l.style,cl:{rgb:$.value.l.color}},o.cellData[String(he)]&&((s=(n=(t=o.cellData[String(he)][String(te-1)])==null?void 0:t.s)==null?void 0:n.bd)==null?void 0:s.r)&&delete o.cellData[String(he)][String(te-1)].s.bd.r),$.value.r&&(be.r={s:$.value.r.style,cl:{rgb:$.value.r.color}},o.cellData[String(he)]&&((a=(i=(r=o.cellData[String(he)][String(Number(te)+1)])==null?void 0:r.s)==null?void 0:i.bd)==null?void 0:a.l)&&delete o.cellData[String(he)][String(te-1)].s.bd.l),$.value.t&&(be.t={s:$.value.t.style,cl:{rgb:$.value.t.color}},o.cellData[String(he-1)]&&((u=(c=(l=o.cellData[String(he)][String(te)])==null?void 0:l.s)==null?void 0:c.bd)==null?void 0:u.b)&&delete o.cellData[String(he)][String(te-1)].s.bd.b),$.value.b&&(be.b={s:$.value.b.style,cl:{rgb:$.value.b.color}},o.cellData[String(Number(he)+1)]&&((g=(d=(h=o.cellData[String(he)][String(te)])==null?void 0:h.s)==null?void 0:d.bd)==null?void 0:g.t)&&delete o.cellData[String(he)][String(te-1)].s.bd.t),o.cellData[String(he)][String(te)].s.bd=Object.assign(o.cellData[String(he)][String(te)].s.bd||{},be)}else if($.rangeType==="range")for(const he of $.range){const te=he.row[0],be=he.row[1],De=he.column[0],Oe=he.column[1];switch($.borderType){case"border-left":for(let T=te;T<=be;T++)for(let x=De;x<De+1;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.l={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te;T<=be;T++)for(let x=De-1;x<De;x++)o.cellData[String(T)]&&((p=(_=(m=o.cellData[String(T)][String(x)])==null?void 0:m.s)==null?void 0:_.bd)==null?void 0:p.r)&&delete o.cellData[String(T)][String(x)].s.bd.r;break;case"border-right":for(let T=te;T<=be;T++)for(let x=Oe;x<Oe+1;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.r={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te;T<=be;T++)for(let x=Oe+1;x<Oe+2;x++)o.cellData[String(T)]&&((C=(b=(v=o.cellData[String(T)][String(x)])==null?void 0:v.s)==null?void 0:b.bd)==null?void 0:C.l)&&delete o.cellData[String(T)][String(x)].s.bd.l;break;case"border-top":for(let T=te;T<te+1;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.t={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te-1;T<te;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((F=(O=(D=o.cellData[String(T)][String(x)])==null?void 0:D.s)==null?void 0:O.bd)==null?void 0:F.b)&&delete o.cellData[String(T)][String(x)].s.bd.b;break;case"border-bottom":for(let T=be;T<be+1;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.b={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=be+1;T<be+2;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((w=(E=(S=o.cellData[String(T)][String(x)])==null?void 0:S.s)==null?void 0:E.bd)==null?void 0:w.t)&&delete o.cellData[String(T)][String(x)].s.bd.t;break;case"border-all":for(let T=te;T<=be;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.l={s:$.style,cl:{rgb:$.color}},Ae.t={s:$.style,cl:{rgb:$.color}},x===Oe&&(Ae.r={s:$.style,cl:{rgb:$.color}}),T===be&&(Ae.b={s:$.style,cl:{rgb:$.color}}),o.cellData[String(T)][String(x)].s.bd=Ae}for(let T=te;T<=be;T++)for(let x=De-1;x<De;x++)o.cellData[String(T)]&&((L=(P=(I=o.cellData[String(T)][String(x)])==null?void 0:I.s)==null?void 0:P.bd)==null?void 0:L.r)&&delete o.cellData[String(T)][String(x)].s.bd.r;for(let T=te;T<=be;T++)for(let x=Oe+1;x<Oe+2;x++)o.cellData[String(T)]&&((M=(k=(y=o.cellData[String(T)][String(x)])==null?void 0:y.s)==null?void 0:k.bd)==null?void 0:M.l)&&delete o.cellData[String(T)][String(x)].s.bd.l;for(let T=te-1;T<te;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((K=(z=(U=o.cellData[String(T)][String(x)])==null?void 0:U.s)==null?void 0:z.bd)==null?void 0:K.b)&&delete o.cellData[String(T)][String(x)].s.bd.b;for(let T=be+1;T<be+2;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((se=(q=(j=o.cellData[String(T)][String(x)])==null?void 0:j.s)==null?void 0:q.bd)==null?void 0:se.t)&&delete o.cellData[String(T)][String(x)].s.bd.t;break;case"border-outside":for(let T=te;T<=be;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};T===te&&(Ae.t={s:$.style,cl:{rgb:$.color}}),T===be&&(Ae.b={s:$.style,cl:{rgb:$.color}}),x===De&&(Ae.l={s:$.style,cl:{rgb:$.color}}),x===Oe&&(Ae.r={s:$.style,cl:{rgb:$.color}}),o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te;T<=be;T++)for(let x=De-1;x<De;x++)o.cellData[String(T)]&&((pe=(Te=(le=o.cellData[String(T)][String(x)])==null?void 0:le.s)==null?void 0:Te.bd)==null?void 0:pe.r)&&delete o.cellData[String(T)][String(x)].s.bd.r;for(let T=te;T<=be;T++)for(let x=Oe+1;x<Oe+2;x++)o.cellData[String(T)]&&((de=(ie=(oe=o.cellData[String(T)][String(x)])==null?void 0:oe.s)==null?void 0:ie.bd)==null?void 0:de.l)&&delete o.cellData[String(T)][String(x)].s.bd.l;for(let T=te-1;T<te;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((Ie=(Ce=(Ne=o.cellData[String(T)][String(x)])==null?void 0:Ne.s)==null?void 0:Ce.bd)==null?void 0:Ie.b)&&delete o.cellData[String(T)][String(x)].s.bd.b;for(let T=be+1;T<be+2;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((it=(Ve=(Le=o.cellData[String(T)][String(x)])==null?void 0:Le.s)==null?void 0:Ve.bd)==null?void 0:it.t)&&delete o.cellData[String(T)][String(x)].s.bd.t;break;case"border-inside":for(let T=te;T<=be;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};T===te&&x===De||(T===te?Ae.l={s:$.style,cl:{rgb:$.color}}:x===De?Ae.t={s:$.style,cl:{rgb:$.color}}:(Ae.l={s:$.style,cl:{rgb:$.color}},Ae.t={s:$.style,cl:{rgb:$.color}}),o.cellData[String(T)][String(x)].s.bd=Ae)}break;case"border-horizontal":for(let T=te;T<be;T++)for(let x=De;x<=Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.b={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te+1;T<=be;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((sn=(Dt=(Ze=o.cellData[String(T)][String(x)])==null?void 0:Ze.s)==null?void 0:Dt.bd)==null?void 0:sn.t)&&delete o.cellData[String(T)][String(x)].s.bd.t;break;case"border-vertical":for(let T=te;T<=be;T++)for(let x=De;x<Oe;x++){o.cellData[String(T)]||(o.cellData[String(T)]={}),o.cellData[String(T)][String(x)]||(o.cellData[String(T)][String(x)]={}),o.cellData[String(T)][String(x)].s||(o.cellData[String(T)][String(x)].s={});const Ae={};Ae.r={s:$.style,cl:{rgb:$.color}},o.cellData[String(T)][String(x)].s.bd=Object.assign(o.cellData[String(T)][String(x)].s.bd||{},Ae)}for(let T=te;T<=be;T++)for(let x=De+1;x<=Oe;x++)o.cellData[String(T)]&&(($t=(Nt=(et=o.cellData[String(T)][String(x)])==null?void 0:et.s)==null?void 0:Nt.bd)==null?void 0:$t.l)&&delete o.cellData[String(T)][String(x)].s.bd.l;break;case"border-none":for(let T=te;T<=be;T++)for(let x=De;x<=Oe;x++){if(!o.cellData[String(T)]||!o.cellData[String(T)][String(x)]||!o.cellData[String(T)][String(x)].s)continue;const Ae={};o.cellData[String(T)][String(x)].s.bd=Ae}for(let T=te;T<=be;T++)for(let x=De-1;x<De;x++)o.cellData[String(T)]&&((rn=(Ot=(pn=o.cellData[String(T)][String(x)])==null?void 0:pn.s)==null?void 0:Ot.bd)==null?void 0:rn.r)&&delete o.cellData[String(T)][String(x)].s.bd.r;for(let T=te;T<=be;T++)for(let x=Oe+1;x<Oe+2;x++)o.cellData[String(T)]&&((W=(N=(Vt=o.cellData[String(T)][String(x)])==null?void 0:Vt.s)==null?void 0:N.bd)==null?void 0:W.l)&&delete o.cellData[String(T)][String(x)].s.bd.l;for(let T=te-1;T<te;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((ue=(J=(X=o.cellData[String(T)][String(x)])==null?void 0:X.s)==null?void 0:J.bd)==null?void 0:ue.b)&&delete o.cellData[String(T)][String(x)].s.bd.b;for(let T=be+1;T<be+2;T++)for(let x=De;x<=Oe;x++)o.cellData[String(T)]&&((we=(Ee=(Xe=o.cellData[String(T)][String(x)])==null?void 0:Xe.s)==null?void 0:Ee.bd)==null?void 0:we.t)&&delete o.cellData[String(T)][String(x)].s.bd.t;break}}}function V6(o){var t;const e={};if(e.styles={},o.hasOwnProperty("lang")&&(e.locale=o.lang),o.hasOwnProperty("data")){e.sheets={};for(let n of o.data){const s={};if(n.hasOwnProperty("index")?s.id=n.index:s.id=mt(6),n.hasOwnProperty("zoomRatio")&&(s.zoomRatio=n.zoomRatio),n.hasOwnProperty("row")&&(s.rowCount=n.row),n.hasOwnProperty("column")&&(s.columnCount=n.column),n.hasOwnProperty("status")&&(s.status=n.status),n.hasOwnProperty("name")&&(s.name=n.name),n.hasOwnProperty("universheet_select_save")&&(s.selections=[],n.universheet_select_save.forEach(r=>{var i;(i=s.selections)==null||i.push({startRow:r.row[0],endRow:r.row[1],startColumn:r.column[0],endColumn:r.column[1]})})),n.hasOwnProperty("scrollLeft")&&(s.scrollLeft=n.scrollLeft),n.hasOwnProperty("scrollTop")&&(s.scrollTop=n.scrollTop),n.hasOwnProperty("config")){if(n.config.merge){s.mergeData=[];for(const r of Object.keys(n.config.merge)){const i=n.config.merge[r],a={startRow:i.r,endRow:i.r+i.rs-1,startColumn:i.c,endColumn:i.c+i.cs-1};s.mergeData.push(a)}}if(n.config.borderInfo&&$6(s,n),n.config.rowlen){s.rowData={};for(const[r,i]of Object.entries(n.config.rowlen))s.rowData[String(r)]={h:i,hd:0}}if(n.config.columnlen){s.columnData={};for(const[r,i]of Object.entries(n.config.columnlen))s.columnData[String(r)]={w:i,hd:0}}if(n.config.rowhidden){s.rowData||(s.rowData={});for(const[r,i]of Object.entries(n.config.rowhidden))s.rowData[String(r)]||(s.rowData[String(r)]={}),s.rowData[String(r)].hd=i}if(n.config.colhidden){s.columnData||(s.columnData={});for(const[r,i]of Object.entries(n.config.colhidden))s.columnData[String(r)]||(s.columnData[String(r)]={}),s.columnData[String(r)].hd=i}}if(n.hasOwnProperty("celldata")){s.cellData||(s.cellData={});for(const r of n.celldata){s.cellData[r.r]||(s.cellData[r.r]={}),s.cellData[r.r][r.c]||(s.cellData[r.r][r.c]={});const i=r.v,a=s.cellData[r.r][r.c];if(((t=i==null?void 0:i.ct)==null?void 0:t.t)==="inlineStr"){const l={},c=[];i.ct.s.forEach(u=>{const h={};u.hasOwnProperty("bg")&&(h.bg={rgb:u.fc}),u.hasOwnProperty("ff")&&(h.ff=u.ff),u.hasOwnProperty("fc")&&(h.cl={rgb:u.fc}),u.hasOwnProperty("fs")&&(h.fs=u.fs),u.hasOwnProperty("bl")&&(h.bl=u.bl),u.hasOwnProperty("it")&&(h.it=u.it),u.hasOwnProperty("cl")&&(h.st={s:1}),u.hasOwnProperty("un")&&(h.ul={s:u.un});const d=mt(6);l[d]={eId:d,st:0,ed:u.v.length-1,et:0,tr:{ct:u.v,ts:h}},c.push({elementId:d,paragraphElementType:0})}),a.p={documentId:mt(6),body:{blockElements:{p1:{blockId:"p1",st:0,ed:i.ct.s.length-1,blockType:0,paragraph:{elements:l,elementOrder:c}}},blockElementOrder:["p1"]},documentStyle:{}}}else{i.hasOwnProperty("v")&&(a.v=i.v),i.hasOwnProperty("m")&&(a.m=i.m);const l={};i.hasOwnProperty("bg")&&(l.bg={rgb:i.bg}),i.hasOwnProperty("ff")&&(l.ff=i.ff),i.hasOwnProperty("fc")&&(l.cl={rgb:i.fc}),i.hasOwnProperty("fs")&&(l.fs=i.fs),i.hasOwnProperty("bl")&&(l.bl=i.bl),i.hasOwnProperty("it")&&(l.it=i.it),i.hasOwnProperty("cl")&&(l.st={s:i.cl}),i.hasOwnProperty("un")&&(l.ul={s:i.un});const c={0:2,1:1,2:3};if(i.hasOwnProperty("vt")&&(l.vt=c[String(i.vt)]),i.hasOwnProperty("ht")&&(l.ht=c[String(i.ht)]),i.hasOwnProperty("tr"))switch(i.tr){case"0":l.tr={a:0,v:0};break;case"1":l.tr={a:45,v:0};break;case"2":l.tr={a:-45,v:0};break;case"3":l.tr={a:0,v:1};break;case"4":l.tr={a:90,v:0};break;case"5":l.tr={a:-90,v:0};break}i.hasOwnProperty("rt")&&(l.tr={a:i.tr,v:0}),i.hasOwnProperty("tb")&&(l.tb=c[String(i.tb)]),a.s=Object.assign(a.s||{},l)}}}e.sheets[s.id]=s}}return e}const $c=[];let X6=0;class bn{static _generateName(){return`sheet${++X6}`}static _checkedName(e){const t=$c.includes(e);return t||$c.push(e),t}static getSheetName(e){for(e===void 0&&(e=bn._generateName());bn._checkedName(e);)e=bn._generateName();return e}}const Y6=":",G6=/[^0-9]/g,j6=/[^A-Za-z]/g;function Ci(o){let e=parseInt(o.replace(G6,""))-1,t=R.ABCatNum(o.replace(j6,""));return{row:e,column:t}}function K6(o){const e=o.indexOf("!");let t="",n="";e>-1?(t=o.substring(0,e),n=o.substring(e)):n=o;let s=n.indexOf(Y6);if(s===-1){const m=Ci(n),_=m.row,p=m.column;return{sheetName:t,rangeData:{startRow:_,startColumn:p,endRow:_,endColumn:p}}}const r=n.substring(0,s),i=n.substring(s+1),a=Ci(r),l=Ci(i),c=a.row,u=a.column,h=l.row,d=l.column;return{sheetName:t,rangeData:{startRow:c,startColumn:u,endRow:h,endColumn:d}}}function q6(o){if(o==null||o.length===0)return NaN;let e=o.toLowerCase().split(""),t=e.length,n=i=>i.charCodeAt(0)-96,s=0,r=0;for(let i=0;i<t;i++)r=n(e[i]),s+=r*26**(t-i-1);return s===0?NaN:s-1}const or="A".charCodeAt(0),Vc="Z".charCodeAt(0),Z6="a".charCodeAt(0);function Xc(o){const e=Vc-or+1;let t="";for(;o>=0;)t=String.fromCharCode(o%e+or)+t,o=Math.floor(o/e)-1;return t}function Yc(o,e){let t="";for(;e>0;)t+=o,e--;return t}function Ei(o,e=!1){const t=Vc-or+1;let n=Z6;e&&(n=or);const s=String.fromCharCode(o%t+n);let r=Math.floor(o/t)+1;return Yc(s,r)}class J6{constructor(){this._storage=new Map}addSerializer(...e){if(R.hasLength(e,1)){const t=e[0];this._storage.set(t.name,t);return}if(R.hasLength(e,2)){const t=e[0],n=e[1];this._storage.set(n,t)}}fromSequence(e){if(R.isObject(e))return this._storage.get(e.className).fromSequence(e);if(R.isArray(e)){let t=new Array;for(let n of e)t.push(this.fromSequence(n));return t}return[]}toSequence(e){if(R.isObject(e))return e.toSequence();if(R.isArray(e)){let t=new Array;for(let n of e)t.push(this.toSequence(n));return t}return[]}fromStringifyParse(e){return this.fromSequence(JSON.parse(e))}}class yo{static fromSequence(e){if(R.isObject(e)&&yo.requiredNewInstance(this))return this.newInstance(e);if(R.isArray(e)&&yo.requiredNewInstance(this)){const t=this;return e.map(n=>t.newInstance(n))}return[]}toSequence(){return{className:R.getClassName(this)}}}(o=>{function e(t){if(R.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}o.requiredNewInstance=e})(yo||(yo={}));function ht(o,e){return o.zIndex>e.zIndex?1:o.zIndex===e.zIndex?0:-1}function wi(o,e){return o.zIndex>e.zIndex?-1:o.zIndex===e.zIndex?0:1}class Gc{static GetClass(e){return this.RegisteredTypes&&this.RegisteredTypes[e]?this.RegisteredTypes[e]:null}}Gc.RegisteredTypes={};function Q6(o){let e=0;for(let t=0;t<o.length;t++)e=o.charCodeAt(t)+(e<<6)+(e<<16)-e;return e>>>0}class Si{constructor(e,t,n){this.path=e,this.namespace=t,this.observable=n}}class jc{constructor(){this._observableArray=[]}hasObserver(e,t){return this.getObserver(e,t)!=null}getObserver(...e){if(e.length===1){const t=e[0],n=this._observableArray.find(s=>s.path===t);return n?n.observable:null}if(e.length===2){const t=e[0],n=e[1],s=this._observableArray.find(r=>r.path===t&&r.namespace===n);return s?s.observable:null}}requiredObserver(...e){if(R.hasLength(e,1)){const t=e[0],n=this.getObserver(t);if(n==null)throw new Error(`not found observable ${t}`);return n}if(R.hasLength(e,2)){const t=e[0],n=e[1],s=this.getObserver(t,n);if(s==null)throw new Error(`not found observable ${t}`);return s}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(R.hasLength(e,1)){const t=e[0],n=this._observableArray.findIndex(s=>s.path===t);n>-1&&this._observableArray.splice(n,1);return}if(R.hasLength(e,2)){const t=e[0],n=e[1],s=this._observableArray.findIndex(r=>r.path===t&&r.namespace===n);s>-1&&this._observableArray.splice(s,1)}}addObserver(...e){if(e.length===1){const t=e[0],n=e[1];this.hasObserver(t,t)&&this.removeObserver(t),this._observableArray.push(new Si(t,t,n));return}if(e.length===3){const t=e[0],n=e[1],s=e[2];this.hasObserver(t,t)&&this.removeObserver(t,n),this._observableArray.push(new Si(t,n,s))}}}var Z=(o=>(o[o.REDO=0]="REDO",o[o.UNDO=1]="UNDO",o))(Z||{});class Kc extends ae{}class yi{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new yi}}const eg=yi.create();class tg{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(ht)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...eg.getData().sort(ht))}}class qc{getRegister(){return this._register}constructor(){this._register=new tg,this._register.initialize()}handle(e){var n;const t=(n=this._register)==null?void 0:n.actionExtensionFactoryList;!t||(this._actionExtensionFactoryList=t,this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;e.forEach(t=>{this._actionExtensionFactoryList.forEach(n=>{const s=n.check(t,e);s!==!1&&s.execute()})})}}class ng extends ae{}class og extends ae{}class fe{getActionExtensionManager(){return this._actionExtensionManager}constructor(e){this._undoManager=e.getUndoManager(),this._actionExtensionManager=new qc}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new Kc,this._commandObservers=new ng,this._commandInjectorObservers=new og}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this,{_actionDataList:n,_unit:s,_actionList:r}=e;this._actionExtensionManager.handle(n),n.forEach(i=>{const a=fe.getAction(i.actionName),l=fe.getActionObservers(),c=new a(i,s,l);r.push(c)}),e.invoke(),t.push(e)}}fe.staticInitialize();class sg{}class V{constructor(e,...t){this._unit=e,this._actionDataList=t,this._actionList=[]}getDoData(){return this._actionList.map(e=>e.getDoActionData())}getOldData(){return this._actionList.map(e=>e.getOldActionDaa())}getInjector(){const e=this;return new class{injectAction(t){e._actionList.push(t)}getActions(){return e._actionList.concat([])}include(t){for(let n=0;n<e._actionList.length;n++)if(e._actionList[n]instanceof t)return e._actionList[n];return null}}}redo(){this._actionList.forEach(e=>e.redo()),fe.getCommandObservers().notifyObservers({type:Z.REDO,actions:this._actionList})}undo(){this._actionList.forEach(e=>e.undo()),fe.getCommandObservers().notifyObservers({type:Z.UNDO,actions:this._actionList})}invoke(){fe.getCommandInjectorObservers().notifyObservers(this.getInjector()),fe.getCommandObservers().notifyObservers({type:Z.REDO,actions:this._actionList})}}class Zc{constructor(){this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}class sr{static hasObserver(e){return e.operation?(e.operation&wt.OBSERVER_ACTION)===wt.OBSERVER_ACTION:!1}static hasUndo(e){return e.operation?(e.operation&wt.UNDO_ACTION)===wt.UNDO_ACTION:!1}static hasCollaboration(e){return e.operation?(e.operation&wt.SERVER_ACTION)===wt.SERVER_ACTION:!1}static hasExtension(e){return e.operation?(e.operation&wt.EXTENSION_ACTION)===wt.EXTENSION_ACTION:!1}static make(e){return e.operation=wt.DEFAULT_ACTION,new sr(e)}constructor(e){this._action=e}removeObserver(){return this._action.operation&&(this._action.operation&=~wt.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~wt.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~wt.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~wt.EXTENSION_ACTION),this}getAction(){return this._action}}class Ti{constructor(e,t,n){this.actionData=e,this.actionDataList=t,this._plugin=n}getActionData(){return this.actionData}getActionDataList(){return this.actionDataList}push(e){this.actionDataList.push(e)}setValue(){}execute(){}}class Jc{constructor(e){this._plugin=e}get zIndex(){return 0}get actionName(){return A.CLEAR_RANGE_ACTION}create(e,t){return new Ti(e,t,this._plugin)}check(e,t){return e.actionName!==this.actionName||e.operation!=null&&!sr.hasExtension(e)?!1:this.create(e,t)}}fe.register(A.INSERT_ROW_DATA_ACTION,Zl),fe.register(A.INSERT_ROW_ACTION,ui),fe.register(A.REMOVE_ROW_DATA_ACTION,tc),fe.register(A.REMOVE_ROW_ACTION,di),fe.register(A.SET_RANGE_STYLE_ACTION,gc),fe.register(A.SET_WORKSHEET_STATUS_ACTION,yc),fe.register(A.SET_SELECTION_ACTION,bc),fe.register(A.SET_RANGE_DATA_ACTION,cc),fe.register(A.SET_RANGE_FORMATTED_VALUE_ACTION,fc),fe.register(A.DELETE_RANGE_ACTION,li),fe.register(A.CLEAR_RANGE_ACTION,Gl),fe.register(A.INSERT_RANGE_ACTION,ql),fe.register(A.SET_TAB_COLOR_ACTION,Cc),fe.register(A.HIDE_SHEET_ACTION,wc),fe.register(A.SET_WORKSHEET_ACTIVATE_ACTION,Ec),fe.register(A.SET_HIDE_ROW_ACTION,pc),fe.register(A.SET_SHOW_ROW_ACTION,vc),fe.register(A.SET_HIDE_COLUMN_ACTION,sc),fe.register(A.SET_SHOW_COLUMN_ACTION,rc),fe.register(A.ADD_MERGE_ACTION,al),fe.register(A.REMOVE_MERGE_ACTION,ec),fe.register(A.SET_WORKSHEET_NAME_ACTION,Sc),fe.register(A.SET_HIDDEN_GRIDLINES_ACTION,ac),fe.register(A.SET_COLUMN_WIDTH_ACTION,ic),fe.register(A.SET_ROW_HEIGHT_ACTION,_c),fe.register(A.SET_BORDER_ACTION,oc),fe.register(A.SET_RIGHT_TO_LEFT_ACTION,mc),fe.register(A.INSERT_COLUMN_DATA_ACTION,Kl),fe.register(A.REMOVE_COLUMN_DATA_ACTION,Ql),fe.register(A.INSERT_COLUMN_ACTION,ci),fe.register(A.REMOVE_COLUMN_ACTION,hi),fe.register(A.DELETE_NAMED_RANGE_ACTION,jl),fe.register(A.SET_NAMED_RANGE_ACTION,lc),fe.register(A.ADD_NAMED_RANGE_ACTION,ul),fe.register(A.SET_RANGE_FORMAT_ACTION,uc),fe.register(A.SET_RANGE_FORMULA_ACTION,hc),fe.register(A.SET_RANGE_NOTE_ACTION,dc),fe.register(A.INSERT_SHEET_ACTION,Jl),fe.register(A.REMOVE_SHEET_ACTION,nc),fe.register(A.SET_SHEET_ORDER_ACTION,gi),fe.register(A.SET_SHEET_ORDER_ACTION,gi),fe.register(A.SET_ZOOM_RATIO_ACTION,Tc);class To{constructor(e){this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{this._observeNames.includes(n)||this._observeNames.push(n),t.addObserver(n,this._name,new ae)})}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{t.removeObserver(n,this._name)})}}class Qc{_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach(e=>{e.onCreate(this._context),e.onMounted(this._context)}))}constructor(e,t=[]){this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,n=t.findIndex(s=>s.getPluginName()===e);if(n>-1){const s=t.splice(n,1)[0];s&&s.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}}class eu{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class rr{constructor(){this._undoManager=new Zc,this._commandManager=new fe(this),this._environment=new eu,this._hooksManager=new Ua,this._locale=new as,this._pluginManager=new Qc(this),this._observerManager=new jc}getHook(e){return this._hooksManager.getHooks(e)}getLocale(){return this._locale}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}}class tu extends rr{constructor(e={}){super(),this._locale.initialize(e.locale)}_setObserver(){}}class cn{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new cn}}class Ri{constructor(){this._data=new Map}add(e,t){this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}static create(){return new Ri}}class nu{install(e){e.addObserver("onAfterSetSelectionObservable","core",new ae),e.addObserver("onBeforeChangeNameObservable","core",new ae),e.addObserver("onAfterChangeNameObservable","core",new ae),e.addObserver("onBeforeChangeActiveSheetObservable","core",new ae),e.addObserver("onAfterChangeActiveSheetObservable","core",new ae),e.addObserver("onBeforeChangeSheetNameObservable","core",new ae),e.addObserver("onAfterChangeSheetNameObservable","core",new ae),e.addObserver("onBeforeInsertSheetObservable","core",new ae),e.addObserver("onAfterInsertSheetObservable","core",new ae),e.addObserver("onBeforeRemoveSheetObservable","core",new ae),e.addObserver("onAfterRemoveSheetObservable","core",new ae),e.addObserver("onBeforeChangeSheetColorObservable","core",new ae),e.addObserver("onAfterChangeSheetColorObservable","core",new ae),e.addObserver("onBeforeChangeSheetDataObservable","core",new ae),e.addObserver("onAfterChangeSheetDataObservable","core",new ae),e.addObserver("onSheetBarDidMountObservable","core",new ae),e.addObserver("onInfoBarDidMountObservable","core",new ae),e.addObserver("onRightMenuDidMountObservable","core",new ae),e.addObserver("onAfterChangeSheetScrollObservable","core",new ae),e.addObserver("onAfterChangeUILocaleObservable","core",new ae),e.addObserver("onSheetRenderDidMountObservable","core",new ae),e.addObserver("onAfterChangeUISkinObservable","core",new ae),e.addObserver("onHideSheetObservable","core",new ae),e.addObserver("onShowSheetObservable","core",new ae),e.addObserver("onSheetTabColorChangeObservable","core",new ae),e.addObserver("onSheetOrderObservable","core",new ae),e.addObserver("onZoomRatioSheetObservable","core",new ae)}}class ou extends rr{constructor(e={}){super(),this._locale.initialize(e.locale),this._workbook=new mi(e,this),this._setObserver()}_setObserver(){const e=this.getObserverManager();new nu().install(e)}getWorkBook(){return this._workbook}getContextObserver(e){return this.getObserverManager().requiredObserver(e,"core")}}class su extends rr{constructor(e={}){super(),this._locale.initialize(e.locale)}_setObserver(){}}var rg={name:"@univer/core",version:"0.0.1",description:"",author:"",main:"./src/index.ts",module:"./src/index.ts",types:"./src/Types/index.d.ts",publishConfig:{main:"./lib/univer-core.js",module:"./lib/univer-core.mjs",types:"./lib/index.d.ts"},exports:{".":"./src/index.ts","./*":"./src/*"},files:["lib"],directories:{lib:"lib"},scripts:{test:"cross-env NODE_ENV=--experimental-vm-modules jest --config=jest.config.js",dev:"vite",build:"tsc && vite build",watch:"vite build",link:"pnpm link ./",api:"node ./api.js",tsc:"tsc",serve:"node test/Server/server.js"},license:"MIT",dependencies:{dayjs:"^1.11.5","es6-proxy-polyfill":"^2.1.1",nanoid:"4.0.0",numeral:"^2.0.6","reflect-metadata":"^0.1.13"},devDependencies:{"@types/jest":"^28.1.8","@types/node":"^18.7.12","@typescript-eslint/eslint-plugin":"^5.34.0","@typescript-eslint/parser":"^5.34.0","@vitejs/plugin-legacy":"^2.0.1",debug:"^4.3.4",jest:"29.0.0","jest-dev-server":"^6.1.1","jest-environment-jsdom":"^29.0.3",less:"^4.1.3","ts-jest":"29.0.1","ts-node":"^10.9.1",typescript:"^4.7.4",vite:"^3.0.9","vite-plugin-external":"1.2.3"}};const ir="dev",ar=rg.version;class lr{constructor(e={}){this.univerDocConfig=e,this._context=new tu(e)}static newInstance(e={}){return So.capsule(ir,ar,"powered by :: UniverDoc :: "),new lr(e)}static get(e){return vn({...e,type:"GET"})}static post(e){return vn({...e,type:"POST"})}static newColor(){return new qn}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}class cr{constructor(e={}){this.univerSheetConfig=e,this._context=new ou(e)}static newInstance(e={}){return So.capsule(ir,ar,"powered by :: universheet :: "),new cr(e)}static get(e){return vn({...e,type:"GET"})}static post(e){return vn({...e,type:"POST"})}static load(e,t){e.getWorkBook().load(t.workbookConfig),e.context.getPluginManager().getPlugins().forEach(n=>{n.load(t[`${n.getPluginName()}Config`])})}static newColor(){return new qn}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}getWorkBook(){return this._context.getWorkBook()}static toJson(e){const t=e.getWorkBook().save(),n={};return e.context.getPluginManager().getPlugins().forEach(s=>{n[`${s.getPluginName()}Config`]=s.save()}),{workbookConfig:t,...n}}}class ur{constructor(e={}){this.UniverSlideConfig=e,this._context=new su(e)}static newInstance(e={}){return So.capsule(ir,ar,"powered by :: UniverSlide :: "),new ur(e)}static get(e){return vn({...e,type:"GET"})}static post(e){return vn({...e,type:"POST"})}static newColor(){return new qn}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}var ru=(o=>(o[o.TAB=0]="TAB",o[o.SPACE=1]="SPACE",o[o.NOTHING=2]="NOTHING",o))(ru||{}),Je=(o=>(o[o.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",o[o.NONE=1]="NONE",o[o.DECIMAL=2]="DECIMAL",o[o.ZERO_DECIMAL=3]="ZERO_DECIMAL",o[o.UPPER_ALPHA=4]="UPPER_ALPHA",o[o.ALPHA=5]="ALPHA",o[o.UPPER_ROMAN=6]="UPPER_ROMAN",o[o.ROMAN=7]="ROMAN",o))(Je||{}),Pe=(o=>(o[o.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",o[o.START=1]="START",o[o.CENTER=2]="CENTER",o[o.END=3]="END",o))(Pe||{}),ke=(o=>(o[o.PARAGRAPH=0]="PARAGRAPH",o[o.TABLE=1]="TABLE",o[o.SECTION_BREAK=2]="SECTION_BREAK",o[o.CUSTOM=3]="CUSTOM",o))(ke||{}),kt=(o=>(o[o.DEFAULT=0]="DEFAULT",o[o.LINES=1]="LINES",o[o.LINES_AND_CHARS=2]="LINES_AND_CHARS",o[o.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",o))(kt||{}),cs=(o=>(o[o.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",o[o.CONTINUOUS=1]="CONTINUOUS",o[o.NEXT_PAGE=2]="NEXT_PAGE",o[o.EVEN_PAGE=3]="EVEN_PAGE",o[o.ODD_PAGE=4]="ODD_PAGE",o))(cs||{}),eo=(o=>(o[o.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",o[o.NONE=1]="NONE",o[o.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",o))(eo||{}),hr=(o=>(o[o.NORMAL=0]="NORMAL",o[o.TBRL=1]="TBRL",o[o.LRTBV=2]="LRTBV",o))(hr||{}),H=(o=>(o[o.TEXT_RUN=0]="TEXT_RUN",o[o.AUTO_TEXT=1]="AUTO_TEXT",o[o.PAGE_BREAK=2]="PAGE_BREAK",o[o.COLUMN_BREAK=3]="COLUMN_BREAK",o[o.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",o[o.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",o[o.EQUATION=6]="EQUATION",o[o.DRAWING=7]="DRAWING",o[o.PERSON=8]="PERSON",o[o.RICH_LINK=9]="RICH_LINK",o))(H||{}),un=(o=>(o[o.BOTH_SIDES=0]="BOTH_SIDES",o[o.LEFT=1]="LEFT",o[o.RIGHT=2]="RIGHT",o[o.LARGEST=3]="LARGEST",o))(un||{}),Bt=(o=>(o[o.INLINE=0]="INLINE",o[o.WRAP_NONE=1]="WRAP_NONE",o[o.WRAP_POLYGON=2]="WRAP_POLYGON",o[o.WRAP_SQUARE=3]="WRAP_SQUARE",o[o.WRAP_THROUGH=4]="WRAP_THROUGH",o[o.WRAP_TIGHT=5]="WRAP_TIGHT",o[o.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",o))(Bt||{}),dr=(o=>(o[o.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",o[o.NORMAL_TEXT=1]="NORMAL_TEXT",o[o.TITLE=2]="TITLE",o[o.SUBTITLE=3]="SUBTITLE",o[o.HEADING_1=4]="HEADING_1",o[o.HEADING_2=5]="HEADING_2",o[o.HEADING_3=6]="HEADING_3",o[o.HEADING_4=7]="HEADING_4",o[o.HEADING_5=8]="HEADING_5",o[o.HEADING_6=9]="HEADING_6",o))(dr||{}),Ro=(o=>(o[o.AUTO=0]="AUTO",o[o.AT_LEAST=1]="AT_LEAST",o[o.EXACT=2]="EXACT",o))(Ro||{}),iu=(o=>(o[o.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",o[o.SOLID=1]="SOLID",o[o.DOT=2]="DOT",o[o.DASH=3]="DASH",o))(iu||{}),au=(o=>(o[o.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",o[o.START=1]="START",o[o.CENTER=2]="CENTER",o[o.END=3]="END",o))(au||{}),lu=(o=>(o.EVENLY_DISTRIBUTED="0",o.FIXED_WIDTH="1",o))(lu||{}),cu=(o=>(o[o.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",o[o.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",o[o.TOP=2]="TOP",o[o.MIDDLE=3]="MIDDLE",o[o.BOTTOM=4]="BOTTOM",o))(cu||{}),Ao=(o=>(o.NORMAL="normal",o.BOLD="bold",o.ITALIC="italic",o))(Ao||{}),Ue=(o=>(o[o.CHARACTER=0]="CHARACTER",o[o.COLUMN=1]="COLUMN",o[o.INSIDE_MARGIN=2]="INSIDE_MARGIN",o[o.LEFT_MARGIN=3]="LEFT_MARGIN",o[o.MARGIN=4]="MARGIN",o[o.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",o[o.PAGE=6]="PAGE",o[o.RIGHT_MARGIN=7]="RIGHT_MARGIN",o))(Ue||{}),$e=(o=>(o[o.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",o[o.INSIDE_MARGIN=1]="INSIDE_MARGIN",o[o.LINE=2]="LINE",o[o.MARGIN=3]="MARGIN",o[o.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",o[o.PAGE=5]="PAGE",o[o.PARAGRAPH=6]="PARAGRAPH",o[o.TOP_MARGIN=7]="TOP_MARGIN",o))($e||{}),Ai=(o=>(o[o.POINT=0]="POINT",o[o.LINE=1]="LINE",o[o.CHARACTER=2]="CHARACTER",o))(Ai||{}),Cn=(o=>(o[o.CENTER=0]="CENTER",o[o.INSIDE=1]="INSIDE",o[o.LEFT=2]="LEFT",o[o.OUTSIDE=3]="OUTSIDE",o[o.RIGHT=4]="RIGHT",o))(Cn||{}),to=(o=>(o[o.BOTTOM=0]="BOTTOM",o[o.CENTER=1]="CENTER",o[o.INSIDE=2]="INSIDE",o[o.OUTSIDE=3]="OUTSIDE",o[o.TOP=4]="TOP",o))(to||{}),uu=(o=>(o[o.compressPunctuation=0]="compressPunctuation",o[o.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",o[o.doNotCompress=2]="doNotCompress",o))(uu||{}),us=(o=>(o[o.PORTRAIT=0]="PORTRAIT",o[o.LANDSCAPE=1]="LANDSCAPE",o))(us||{});const ig={namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:bo}};/*! *****************************************************************************
    Copyright (C) Microsoft. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var hu;(function(o){(function(e){var t=typeof tr=="object"?tr:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=s(o);typeof t.Reflect=="undefined"?t.Reflect=o:n=s(t.Reflect,n),e(n);function s(r,i){return function(a,l){typeof r[a]!="function"&&Object.defineProperty(r,a,{configurable:!0,writable:!0,value:l}),i&&i(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",r=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",i=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!i&&!a,c={create:i?function(){return Vt(Object.create(null))}:a?function(){return Vt({__proto__:null})}:function(){return Vt({})},has:l?function(N,W){return t.call(N,W)}:function(N,W){return W in N},get:l?function(N,W){return t.call(N,W)?N[W]:void 0}:function(N,W){return N[W]}},u=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",d=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:pn(),g=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ot(),m=!h&&typeof WeakMap=="function"?WeakMap:rn(),_=new m;function p(N,W,X,J){if(se(X)){if(!Ie(N))throw new TypeError;if(!Ve(W))throw new TypeError;return I(N,W)}else{if(!Ie(N))throw new TypeError;if(!pe(W))throw new TypeError;if(!pe(J)&&!se(J)&&!le(J))throw new TypeError;return le(J)&&(J=void 0),X=Ce(X),P(N,W,X,J)}}e("decorate",p);function v(N,W){function X(J,ue){if(!pe(J))throw new TypeError;if(!se(ue)&&!it(ue))throw new TypeError;z(N,W,J,ue)}return X}e("metadata",v);function b(N,W,X,J){if(!pe(X))throw new TypeError;return se(J)||(J=Ce(J)),z(N,W,X,J)}e("defineMetadata",b);function C(N,W,X){if(!pe(W))throw new TypeError;return se(X)||(X=Ce(X)),y(N,W,X)}e("hasMetadata",C);function D(N,W,X){if(!pe(W))throw new TypeError;return se(X)||(X=Ce(X)),k(N,W,X)}e("hasOwnMetadata",D);function O(N,W,X){if(!pe(W))throw new TypeError;return se(X)||(X=Ce(X)),M(N,W,X)}e("getMetadata",O);function F(N,W,X){if(!pe(W))throw new TypeError;return se(X)||(X=Ce(X)),U(N,W,X)}e("getOwnMetadata",F);function S(N,W){if(!pe(N))throw new TypeError;return se(W)||(W=Ce(W)),K(N,W)}e("getMetadataKeys",S);function E(N,W){if(!pe(N))throw new TypeError;return se(W)||(W=Ce(W)),j(N,W)}e("getOwnMetadataKeys",E);function w(N,W,X){if(!pe(W))throw new TypeError;se(X)||(X=Ce(X));var J=L(W,X,!1);if(se(J)||!J.delete(N))return!1;if(J.size>0)return!0;var ue=_.get(W);return ue.delete(X),ue.size>0||_.delete(W),!0}e("deleteMetadata",w);function I(N,W){for(var X=N.length-1;X>=0;--X){var J=N[X],ue=J(W);if(!se(ue)&&!le(ue)){if(!Ve(ue))throw new TypeError;W=ue}}return W}function P(N,W,X,J){for(var ue=N.length-1;ue>=0;--ue){var Xe=N[ue],Ee=Xe(W,X,J);if(!se(Ee)&&!le(Ee)){if(!pe(Ee))throw new TypeError;J=Ee}}return J}function L(N,W,X){var J=_.get(N);if(se(J)){if(!X)return;J=new d,_.set(N,J)}var ue=J.get(W);if(se(ue)){if(!X)return;ue=new d,J.set(W,ue)}return ue}function y(N,W,X){var J=k(N,W,X);if(J)return!0;var ue=$t(W);return le(ue)?!1:y(N,ue,X)}function k(N,W,X){var J=L(W,X,!1);return se(J)?!1:de(J.has(N))}function M(N,W,X){var J=k(N,W,X);if(J)return U(N,W,X);var ue=$t(W);if(!le(ue))return M(N,ue,X)}function U(N,W,X){var J=L(W,X,!1);if(!se(J))return J.get(N)}function z(N,W,X,J){var ue=L(X,J,!0);ue.set(N,W)}function K(N,W){var X=j(N,W),J=$t(N);if(J===null)return X;var ue=K(J,W);if(ue.length<=0)return X;if(X.length<=0)return ue;for(var Xe=new g,Ee=[],we=0,$=X;we<$.length;we++){var he=$[we],te=Xe.has(he);te||(Xe.add(he),Ee.push(he))}for(var be=0,De=ue;be<De.length;be++){var he=De[be],te=Xe.has(he);te||(Xe.add(he),Ee.push(he))}return Ee}function j(N,W){var X=[],J=L(N,W,!1);if(se(J))return X;for(var ue=J.keys(),Xe=Dt(ue),Ee=0;;){var we=et(Xe);if(!we)return X.length=Ee,X;var $=sn(we);try{X[Ee]=$}catch(he){try{Nt(Xe)}finally{throw he}}Ee++}}function q(N){if(N===null)return 1;switch(typeof N){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return N===null?1:6;default:return 6}}function se(N){return N===void 0}function le(N){return N===null}function Te(N){return typeof N=="symbol"}function pe(N){return typeof N=="object"?N!==null:typeof N=="function"}function oe(N,W){switch(q(N)){case 0:return N;case 1:return N;case 2:return N;case 3:return N;case 4:return N;case 5:return N}var X=W===3?"string":W===5?"number":"default",J=Ze(N,s);if(J!==void 0){var ue=J.call(N,X);if(pe(ue))throw new TypeError;return ue}return ie(N,X==="default"?"number":X)}function ie(N,W){if(W==="string"){var X=N.toString;if(Le(X)){var J=X.call(N);if(!pe(J))return J}var ue=N.valueOf;if(Le(ue)){var J=ue.call(N);if(!pe(J))return J}}else{var ue=N.valueOf;if(Le(ue)){var J=ue.call(N);if(!pe(J))return J}var Xe=N.toString;if(Le(Xe)){var J=Xe.call(N);if(!pe(J))return J}}throw new TypeError}function de(N){return!!N}function Ne(N){return""+N}function Ce(N){var W=oe(N,3);return Te(W)?W:Ne(W)}function Ie(N){return Array.isArray?Array.isArray(N):N instanceof Object?N instanceof Array:Object.prototype.toString.call(N)==="[object Array]"}function Le(N){return typeof N=="function"}function Ve(N){return typeof N=="function"}function it(N){switch(q(N)){case 3:return!0;case 4:return!0;default:return!1}}function Ze(N,W){var X=N[W];if(X!=null){if(!Le(X))throw new TypeError;return X}}function Dt(N){var W=Ze(N,r);if(!Le(W))throw new TypeError;var X=W.call(N);if(!pe(X))throw new TypeError;return X}function sn(N){return N.value}function et(N){var W=N.next();return W.done?!1:W}function Nt(N){var W=N.return;W&&W.call(N)}function $t(N){var W=Object.getPrototypeOf(N);if(typeof N!="function"||N===u||W!==u)return W;var X=N.prototype,J=X&&Object.getPrototypeOf(X);if(J==null||J===Object.prototype)return W;var ue=J.constructor;return typeof ue!="function"||ue===N?W:ue}function pn(){var N={},W=[],X=function(){function Ee(we,$,he){this._index=0,this._keys=we,this._values=$,this._selector=he}return Ee.prototype["@@iterator"]=function(){return this},Ee.prototype[r]=function(){return this},Ee.prototype.next=function(){var we=this._index;if(we>=0&&we<this._keys.length){var $=this._selector(this._keys[we],this._values[we]);return we+1>=this._keys.length?(this._index=-1,this._keys=W,this._values=W):this._index++,{value:$,done:!1}}return{value:void 0,done:!0}},Ee.prototype.throw=function(we){throw this._index>=0&&(this._index=-1,this._keys=W,this._values=W),we},Ee.prototype.return=function(we){return this._index>=0&&(this._index=-1,this._keys=W,this._values=W),{value:we,done:!0}},Ee}();return function(){function Ee(){this._keys=[],this._values=[],this._cacheKey=N,this._cacheIndex=-2}return Object.defineProperty(Ee.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ee.prototype.has=function(we){return this._find(we,!1)>=0},Ee.prototype.get=function(we){var $=this._find(we,!1);return $>=0?this._values[$]:void 0},Ee.prototype.set=function(we,$){var he=this._find(we,!0);return this._values[he]=$,this},Ee.prototype.delete=function(we){var $=this._find(we,!1);if($>=0){for(var he=this._keys.length,te=$+1;te<he;te++)this._keys[te-1]=this._keys[te],this._values[te-1]=this._values[te];return this._keys.length--,this._values.length--,we===this._cacheKey&&(this._cacheKey=N,this._cacheIndex=-2),!0}return!1},Ee.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=N,this._cacheIndex=-2},Ee.prototype.keys=function(){return new X(this._keys,this._values,J)},Ee.prototype.values=function(){return new X(this._keys,this._values,ue)},Ee.prototype.entries=function(){return new X(this._keys,this._values,Xe)},Ee.prototype["@@iterator"]=function(){return this.entries()},Ee.prototype[r]=function(){return this.entries()},Ee.prototype._find=function(we,$){return this._cacheKey!==we&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=we)),this._cacheIndex<0&&$&&(this._cacheIndex=this._keys.length,this._keys.push(we),this._values.push(void 0)),this._cacheIndex},Ee}();function J(Ee,we){return Ee}function ue(Ee,we){return we}function Xe(Ee,we){return[Ee,we]}}function Ot(){return function(){function N(){this._map=new d}return Object.defineProperty(N.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),N.prototype.has=function(W){return this._map.has(W)},N.prototype.add=function(W){return this._map.set(W,W),this},N.prototype.delete=function(W){return this._map.delete(W)},N.prototype.clear=function(){this._map.clear()},N.prototype.keys=function(){return this._map.keys()},N.prototype.values=function(){return this._map.values()},N.prototype.entries=function(){return this._map.entries()},N.prototype["@@iterator"]=function(){return this.keys()},N.prototype[r]=function(){return this.keys()},N}()}function rn(){var N=16,W=c.create(),X=J();return function(){function $(){this._key=J()}return $.prototype.has=function(he){var te=ue(he,!1);return te!==void 0?c.has(te,this._key):!1},$.prototype.get=function(he){var te=ue(he,!1);return te!==void 0?c.get(te,this._key):void 0},$.prototype.set=function(he,te){var be=ue(he,!0);return be[this._key]=te,this},$.prototype.delete=function(he){var te=ue(he,!1);return te!==void 0?delete te[this._key]:!1},$.prototype.clear=function(){this._key=J()},$}();function J(){var $;do $="@@WeakMap@@"+we();while(c.has(W,$));return W[$]=!0,$}function ue($,he){if(!t.call($,X)){if(!he)return;Object.defineProperty($,X,{value:c.create()})}return $[X]}function Xe($,he){for(var te=0;te<he;++te)$[te]=Math.random()*255|0;return $}function Ee($){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array($)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array($)):Xe(new Uint8Array($),$):Xe(new Array($),$)}function we(){var $=Ee(N);$[6]=$[6]&79|64,$[8]=$[8]&191|128;for(var he="",te=0;te<N;++te){var be=$[te];(te===4||te===6||te===8)&&(he+="-"),be<16&&(he+="0"),he+=be.toString(16).toLowerCase()}return he}}function Vt(N){return N.__=void 0,delete N.__,N}})})(hu||(hu={}));function du(o){return typeof o=="function"}function Bn(o){return o!=null}function gu(o){return o==null}function ag(o){return typeof o=="object"}function lg(o){return typeof o=="string"}function cg(o){return o instanceof Ii}const gr=class{static register(o,e){let t=gr.sMap.get(o);t?t.push(e):(t=new Array,t.push(e),gr.sMap.set(o,t))}static getTable(o){var n;let e=new Array,t=o;for(;t!=null;){const s=(n=gr.sMap.get(t))!=null?n:[];e=e.concat(s),t=Object.getPrototypeOf(t)}return e}};let En=gr;En.sMap=new Map;class Ii{constructor(e={}){this._config=e,this._value=e.value}getValue(){return this._value}setValue(e){this._value=e}}class no{static postDestroy(e){if(e){const t=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t);for(const s of n){const r=Reflect.getMetadata("PreDestroy",t,s);if(Bn(r)){const i=t[s];du(i)&&i.apply(e)}}}}static postConstruct(e,t){if(e){const n=Object.getPrototypeOf(e),s=Object.getOwnPropertyNames(n);for(const r of s){const i=Reflect.getMetadata("PostConstruct",n,r);if(Bn(i)){const a=n[r];du(a)&&a.apply(e,t)}}}}_printCirculate(){let e="The dependencies of some of the instance in the application context form a cycle\uFF1A";return e+=`
`,this._circulate.reverse().forEach(t=>{const{baseClass:n}=t,s=this._mappings.get(n),{name:r}=s;e+=`
`,e+=`Class: ${r} Field: ${n}`}),e}_clearCirculate(){this._circulate=[]}_addCirculate(e,t){this._circulate.forEach(n=>{if(n.baseClass===e&&n.scope===t&&t===qt.prototype)throw this._circulate.push({baseClass:e,scope:t}),new Error(this._printCirculate())}),this._circulate.push({baseClass:e,scope:t})}_popCirculate(){this._circulate.pop()}_inject(e,t){const n=Object.getPrototypeOf(e),s=En.getTable(n);for(const r of s){const i=Reflect.getMetadata("Container",n,r),a=Reflect.getMetadata("Inject",n,r),l=Reflect.getMetadata("Attribute",n,r),c=Reflect.getMetadata("AttributeValue",n,r);switch(typeof a){case"string":{const u=e;u[r]=this._getInstance(a,t,qt.nothing,[]);break}case"object":{const u=a,{mapping:h}=u,{scope:d}=u,{argument:g}=u,m=e;m[r]=this._getInstance(h,t,d,g)}}if(i){const u=e;u[r]=this}if(l){const u=e;u[r]=this._attribute}if(c){const u=e;u[r]=this._attribute.getValue()}}}_getInstance(e,t,n,s){const r=this._mappings.get(e);if(r){if(n===qt.nothing){const i=this._configure.get(e);i?n=i.scope:n=qt.prototype}switch(n){case qt.singleton:{const i=this._instance.get(e);if(Bn(i))return i;const a=Bn(s)?new r(...s):new r;return this._instance.set(e,a),this._addCirculate(e,n),this._inject(a,t),this._popCirculate(),t.push([a,s]),a}case qt.prototype:{const i=Bn(s)?new r(...s):new r;return this._addCirculate(e,n),this._inject(i,t),this._popCirculate(),t.push([i,s]),i}}}}constructor(e={}){this._mappings=new Map,this._instance=new Map,this._configure=new Map,this._attribute=cg(e)?e:new Ii(e),this._circulate=[]}inject(e){if(e){const t=[[e,[]]];this._inject(e,t),this._clearCirculate();for(const n of t.reverse())no.postConstruct(n[0],n[1])}}getAttribute(){return this._attribute}getInstance(e,...t){const n=[],s=this._getInstance(e,n,qt.prototype,t);this._clearCirculate();for(const r of n.reverse())no.postConstruct(r[0],r[1]);return s}getSingleton(e,...t){const n=[],s=this._getInstance(e,n,qt.singleton,t);this._clearCirculate();for(const r of n.reverse())no.postConstruct(r[0],r[1]);return s}getBaseClassByInstance(e){if(ag(e)){const{constructor:t}=e,n=this._mappings.entries();for(const[s,r]of n)if(t===r)return s}}removeMapping(e){this._mappings.delete(e);const t=this._instance.get(e),n=s=>{const r=Object.keys(s);for(const i of r){const a=s[i];this.getBaseClassByInstance(a)&&(n(a),no.postDestroy(s))}no.postDestroy(s)};Bn(t)&&n(t),this._instance.delete(e)}addMapping(e,t,n){this._mappings.set(e,t),Bn(n)&&this._configure.set(e,n)}addSingletonMapping(e,t){return this.addMapping(e,t,{scope:qt.singleton})}addClass(e,t){this.addMapping(e.name,e,t)}removeClass(e){this.removeMapping(e.name)}addSingletonClass(e){this.addSingletonMapping(e.name,e)}}var qt=(o=>(o[o.singleton=0]="singleton",o[o.prototype=1]="prototype",o[o.nothing=2]="nothing",o))(qt||{});function fu(){return(o,e,t)=>{En.register(o,e),Reflect.defineMetadata("PostConstruct",t,o,e)}}function ug(){return(o,e,t)=>{En.register(o,e),Reflect.defineMetadata("PreDestroy",t,o,e)}}function hg(o){return(e,t)=>{if(En.register(e,t),lg(o)){Reflect.defineMetadata("Inject",o,e,t);return}Bn(o)&&(gu(o.argument)&&(o.argument=[]),gu(o.scope)&&(o.scope=1),Reflect.defineMetadata("Inject",o,e,t))}}function dg(){return(o,e)=>{En.register(o,e),Reflect.defineMetadata("Attribute",{},o,e)}}function gg(){return(o,e)=>{En.register(o,e),Reflect.defineMetadata("Container",{},o,e)}}function mu(){return(o,e)=>{En.register(o,e),Reflect.defineMetadata("AttributeValue",{},o,e)}}const _u="MessageQueue";class pu{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(_u,e)}load(){const e=localStorage.getItem(_u);e&&(this._messages=JSON.parse(e))}}var vu=(o=>(o.MESSAGE_RESPONSE="message_response",o))(vu||{});class Di{static isMessageResponseReceive(e){return e.type==="message_response"}packMessage(e){return{changed:e,version:R.generateRandomId()}}}class fg extends Di{pushMessageQueue(e){throw new Error("Method not implemented.")}}var mg=Object.defineProperty,_g=Object.getOwnPropertyDescriptor,bu=(o,e,t,n)=>{for(var s=n>1?void 0:n?_g(e,t):e,r=o.length-1,i;r>=0;r--)(i=o[r])&&(s=(n?i(e,t,s):i(s))||s);return n&&s&&mg(e,t,s),s},Cu=(o=>(o.WAIT="wait",o.WORK="work",o))(Cu||{});const Eu=class extends Di{initialize(){this.messageQueue=new pu,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Pc({url:this.config.socketUrl}),this.socket.on(kn.MESSAGE,o=>{this.checkupReceiveMessage(o.data)}),this.socket.on(kn.ERROR,()=>{}),this.socket.on(kn.OPEN,()=>{}),this.socket.on(kn.CLOSE,()=>{}),this.socket.on(kn.RETRY,()=>{}),this.socket.on(kn.DESTROY,()=>{}),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const o=this.getTopMessage();return(e=JSON.stringify(o))!=null?e:""}checkupReceiveMessage(o){Eu.isMessageResponseReceive(o)&&this.getTopMessage().version===o.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(o){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(o)),this.sendMessageQueue())}async sendTopMessage(){const o=this.serializeTopMessage();return this.socket.send(o),new Promise(e=>this.globalSendResolve=e)}async sendMessageQueue(){const{messageQueue:o,status:e}=this;if(e==="wait"){for(this.status="work";o.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let Oi=Eu;bu([mu()],Oi.prototype,"config",2),bu([fu()],Oi.prototype,"initialize",1);var pg=Object.freeze(Object.defineProperty({__proto__:null,ContextBase:rr,DocContext:tu,Environment:eu,Registry:cn,RegistryAsMap:Ri,SheetContext:ou,SlideContext:su,UniverDoc:lr,UniverSheet:cr,UniverSlide:ur,VersionEnv:ir,VersionCode:ar,WorkBookObserverImpl:nu,SheetActionBase:Re,ActionType:Z,ActionObservers:Kc,CommandUnit:sg,Command:V,CommandManager:fe,UndoManager:Zc,ActionExtensionManager:qc,BaseActionExtension:Ti,BaseActionExtensionFactory:Jc,AddMergeAction:al,AddNamedRangeAction:ul,ClearRangeAction:Gl,DeleteNamedRangeAction:jl,DeleteRangeAction:li,InsertColumnAction:ci,InsertColumnDataAction:Kl,InsertRangeAction:ql,InsertRowAction:ui,InsertRowDataAction:Zl,InsertSheetAction:Jl,RemoveColumnAction:hi,RemoveColumnDataAction:Ql,RemoveMergeAction:ec,RemoveRowAction:di,RemoveRowDataAction:tc,RemoveSheetAction:nc,SetBorderAction:oc,SetColumnHideAction:sc,SetColumnShowAction:rc,SetColumnWidthAction:ic,SetHiddenGridlinesAction:ac,SetNamedRangeAction:lc,SetRangeDataAction:cc,SetRangeFormatAction:uc,SetRangeFormulaAction:hc,SetRangeNoteAction:dc,SetRangeStyleAction:gc,SetRangeFormattedValueAction:fc,SetRightToLeftAction:mc,SetRowHeightAction:_c,SetRowHideAction:pc,SetRowShowAction:vc,SetSelectionActivateAction:bc,SetSheetOrderAction:gi,SetTabColorAction:Cc,SetWorkSheetActivateAction:Ec,SetWorkSheetHideAction:wc,SetWorkSheetNameAction:Sc,SetWorkSheetStatusAction:yc,SetZoomRatioAction:Tc,ActionOperation:sr,ACTION_NAMES:A,DEFAULT_RANGE_ARRAY:ss,DEFAULT_RANGE:tl,DEFAULT_SELECTION:bo,DEFAULT_WORKBOOK:nl,DEFAULT_WORKSHEET:xn,DEFAULT_STYLES:Zn,CONVERTOR_OPERATION:tt,EXTENSION_NAMES:ol,KEYBOARD_KEYS:si,PLUGIN_NAMES:Me,THEME_COLORS:Qa,ConvertorBase:ri,WorkBookConvertor:u6,WorkSheetConvertor:nt,Color:ln,HLSColor:el,RgbColor:os,ThemeColor:oi,ColorBuilder:qn,ColumnManager:sl,Merges:Rc,Range:We,RangeList:Oc,RowManager:xc,Selection:_i,Styles:Mc,Workbook:mi,Worksheet:Lt,AutoFillSeries:Js,BooleanCriteria:$a,BorderStyleTypes:ye,BorderType:Xt,ColorType:Yt,CommonHideTypes:Va,ConditionType:Xa,CopyPasteType:_o,DeveloperMetadataVisibility:Ya,Dimension:Dn,Direction:B,FormatType:Qs,InterpolationPointType:Ga,KeyCode:ja,LocaleType:Kn,ProtectionType:Ka,RelativeDate:qa,SheetTypes:Kt,TextDirection:po,TextDecoration:qe,HorizontalAlign:ze,VerticalAlign:St,WrapStrategy:at,FontItalic:Za,FontWeight:Ja,BaselineOffset:yt,BooleanNumber:Y,CellValueType:ns,ThemeColorType:xt,ThemeColors:er,FollowNumberWithType:ru,GlyphType:Je,BulletAlignment:Pe,BlockType:ke,GridType:kt,SectionType:cs,ColumnSeparatorType:eo,TextDirectionType:hr,ParagraphElementType:H,WrapTextType:un,PositionedObjectLayoutType:Bt,NamedStyleType:dr,SpacingRule:Ro,DashStyleType:iu,TabStopAlignment:au,WidthType:lu,ContentAlignment:cu,FontStyleType:Ao,ObjectRelativeFromH:Ue,ObjectRelativeFromV:$e,NumberUnitType:Ai,AlignTypeH:Cn,AlignTypeV:to,characterSpacingControlType:uu,PageOrientType:us,DEFAULT_NAMED_RANGE:ig,AttributeMap:En,IOCAttribute:Ii,IOCContainer:no,IOCScope:qt,PostConstruct:fu,PreDestroy:ug,Inject:hg,Attribute:dg,Container:gg,AttributeValue:mu,EventState:Pa,Observer:ni,Observable:ae,ObservableHooks:a6,PathObservableHooks:za,HooksManager:Ua,PathObservable:Si,ObserverManager:jc,Plugin:To,PluginManager:Qc,MessageQueue:pu,ServerReceiveType:vu,ServerBase:Di,ServerHttp:fg,MessageQueueStatus:Cu,ServerSocket:Oi,binarySearchArray:Wa,orderSearchArray:Ha,searchArray:jt,makeCellToSelection:wo,isEmptyCell:pi,getColorStyle:_t,isFormulaString:E6,getStyle:vi,DateTime:w6,DropCell:rs,ExcelDateTime:S6,error:fi,datenum_local:Dc,generate:Tt,update:Qn,IOHttpRequestType:Fc,IOHttpReadyState:Nc,IOHttpResponseType:Lc,IOHttp:vn,Post:M6,Get:k6,IOSocketListenType:kn,IOSocket:Pc,isKeyPrintable:zc,Locale:as,Logger:So,LRUHelper:ls,KeyIterator:Uc,ValueIterator:Wc,EntryIterator:Hc,Entry:bi,LRUMap:H6,migrate:V6,NameGen:bn,ObjectArray:xe,ObjectArrayIterableIterator:Zs,ObjectMatrix:Q,Rectangle:Mt,referenceToGrid:K6,ABCToNumber:q6,numberToABC:Xc,repeatStringNumTimes:Yc,numberToListABC:Ei,SerializeManager:J6,get Serializer(){return yo},sortRules:ht,sortRulesByDesc:wi,Tools:R,Tuples:Be,TypeStoreBase:Gc,hashAlgorithm:Q6},Symbol.toStringTag,{value:"Module"})),vg={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],defaultFontSize:14,unit:"pt"}},bg={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const Io={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var bt=(o=>(o.PointerMove="PointerMove",o.PointerDown="PointerDown",o.PointerUp="PointerUp",o.PointerOut="PointerOut",o.PointerLeave="PointerLeave",o.PointerOver="PointerOver",o.PointerEnter="PointerEnter",o.wheel="MouseWheel",o.KeyDown="KeyDown",o.KeyUp="KeyUp",o))(bt||{});const wu=1,Cg='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',Eg="0",Su=1,wg=14;var Ye=(o=>(o.DEFAULT="default",o.AUTO="auto",o.CROSSHAIR="crosshair",o.POINTER="pointer",o.MOVE="move",o.EAST_RESIZE="e-resize",o.NORTH_EAST_RESIZE="ne-resize",o.NORTH_WEST_RESIZE="nw-resize",o.NORTH_RESIZE="n-resize",o.SOUTH_EAST_RESIZE="se-resize",o.SOUTH_WEST_RESIZE="sw-resize",o.SOUTH_RESIZE="s-resize",o.WEST_RESIZE="w-resize",o.TEXT="text",o.WAIT="wait",o.HELP="help",o.CELL="cell",o.NONE="none",o.VERTICAL_TEXT="vertical-text",o.NO_DROP="no-drop",o.GRAB="grab",o.GRABBING="grabbing",o.ALL_SCROLL="all-scroll",o.COLUMN_RESIZE="col-resize",o.ROW_RESIZE="row-resize",o.PROGRESS="progress",o.NOT_ALLOWED="not-allowed",o.ZOOM_IN="zoom-in",o.ZOOM_OUT="zoom-out",o))(Ye||{});const Fn="rgb(0,0,0)";var pt=(o=>(o.TOP="t",o.BOTTOM="b",o.LEFT="l",o.RIGHT="r",o))(pt||{}),Do=(o=>(o[o.UP=0]="UP",o[o.DOWN=1]="DOWN",o))(Do||{}),ve=(o=>(o.ENGINE="Engine",o.SCENE="Scene",o.BASE_OBJECT="BaseObject",o.SCENE_VIEWER="SceneViewer",o.CANVAS="Canvas",o.VIEWPORT="Viewport",o.LAYER="Layer",o.GROUP="Group",o))(ve||{});const yu=o=>({sbr:.5,sbo:o,spr:.5,spo:o});class Oo{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,n){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=n}static clearFontMeasureCache(e){var n;const t=e.split("/");if(t.length===1){const s=t[0];this._globalFontMeasureCache.delete(s)}else if(t.length===2){const s=t[0],r=t[1];(n=this._globalFontMeasureCache.get(s))==null||n.delete(r)}else return!1;return!0}static getFontMeasureCache(e,t){var n;return(n=this._globalFontMeasureCache[e])==null?void 0:n[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,n=!1;for(let s of this._globalFontMeasureCache){const[,r]=s;if(t+=r.size,t>e){n=!0;break}}if(n){let s=0;for(let r of this._globalFontMeasureCache){const[i,a]=r;if(s+=a.size,s>e/2){const l=s-e/2;this._clearMeasureCache(l,a);break}this._globalFontMeasureCache.delete(i)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(this._fontDataMap.size===0)return yu(t);const n=e.split(",");for(let s of n){s=s.replace(/'/g,"");const r=this._fontDataMap.get(s);if(!r)continue;const{subscriptSizeRatio:i,subscriptOffset:a,superscriptSizeRatio:l,superscriptOffset:c}=r;return{sbr:i,sbo:a*t,spr:l,spo:c*t}}return yu(t)}static _clearMeasureCache(e,t){let n=0;for(let s of t){const[r]=s;if(n>e)break;t.delete(r),n++}return!0}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let n=document.getElementById("universheetTextSizeTest");const s="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`${s};${t}`,n.innerText=e;const r=n.getBoundingClientRect(),i={width:r.width,height:r.height};return this._getTextHeightCache[t]=i,i}static _getBoundingBoxByFont(e,t=28,n=""){const s=this._fontDataMap.get(e);if(!s)return;const{notDefWidth:r,ascender:i,descender:a,typoAscender:l,typoDescender:c,strikeoutPosition:u,subscriptSizeRatio:h,subscriptOffset:d,superscriptSizeRatio:g,superscriptOffset:m,hdmxData:_,glyphHorizonMap:p}=s,v=_==null?void 0:_.indexOf(Math.floor(t)),b=p.get(n.charCodeAt(0));let C=r;if(b){const{width:D,pixelsPerEm:O=[]}=b;v?C=O[v]:C=D}return{width:C*t,ba:i*t,bd:a*t,aba:l*t,abd:c*t,sp:u*t,sbr:h,sbo:d*t,spr:g,spo:m*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:n,fontBoundingBoxAscent:s,fontBoundingBoxDescent:r,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a}=e;return{width:n,ba:s,bd:r,aba:i,abd:a,sp:(s+r)/2,sbr:.5,sbo:t,spr:.5,spo:t}}static getTextSize(e,t){const{fontString:n,fontSize:s,fontFamily:r}=t;let i=this._getBoundingBoxByFont(r,s);if(!i){const a=this.getMeasureText(e,n);i=this._calculateBoundingBoxByMeasureText(a,s)}return i}static getMeasureText(e,t){if(!this._context){const d=document.createElement("canvas");this._context=d.getContext("2d")}const n=this._context,s=this.getFontMeasureCache(t,e);if(s!=null)return s;n.font=t;const r=n.measureText(e),{width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:c,actualBoundingBoxDescent:u}=r,h={width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:c,actualBoundingBoxDescent:u};if(a==null||l==null||Number.isNaN(a)||Number.isNaN(l)){let d=this.getTextSizeByDom(Eg,t)[1];n.textBaseline==="top"?(h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d,h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0):n.textBaseline==="middle"?(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=d/2,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d/2):(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d)}return this.setFontMeasureCache(t,e,h),h}}Oo._globalFontMeasureCache=new Map,Oo._getTextHeightCache={},Oo._fontDataMap=new Map;var hs=(o=>(o[o.SECTION=0]="SECTION",o[o.PAGE=1]="PAGE",o[o.COLUMN=2]="COLUMN",o))(hs||{}),fr=(o=>(o[o.PARAGRAPH=0]="PARAGRAPH",o[o.BLOCK=1]="BLOCK",o))(fr||{}),Zt=(o=>(o[o.LETTER=0]="LETTER",o[o.WORD=1]="WORD",o[o.LIST=2]="LIST",o[o.TAB=3]="TAB",o[o.IMAGE=4]="IMAGE",o[o.AT=5]="AT",o[o.MATH=6]="MATH",o[o.MULTI_LINE=7]="MULTI_LINE",o[o.CUSTOM=8]="CUSTOM",o))(Zt||{}),wn=(o=>(o[o.VERTICAL=0]="VERTICAL",o[o.HORIZONTAL=1]="HORIZONTAL",o[o.AUTO=2]="AUTO",o))(wn||{}),ot=(o=>(o[o.Generic=0]="Generic",o[o.Keyboard=1]="Keyboard",o[o.Mouse=2]="Mouse",o[o.Touch=3]="Touch",o))(ot||{}),ce=(o=>(o[o.Horizontal=0]="Horizontal",o[o.Vertical=1]="Vertical",o[o.LeftClick=2]="LeftClick",o[o.MiddleClick=3]="MiddleClick",o[o.RightClick=4]="RightClick",o[o.BrowserBack=5]="BrowserBack",o[o.BrowserForward=6]="BrowserForward",o[o.MouseWheelX=7]="MouseWheelX",o[o.MouseWheelY=8]="MouseWheelY",o[o.MouseWheelZ=9]="MouseWheelZ",o[o.DeltaHorizontal=10]="DeltaHorizontal",o[o.DeltaVertical=11]="DeltaVertical",o[o.FakeMove=12]="FakeMove",o))(ce||{}),st=(o=>(o[o.translate=0]="translate",o[o.resize=1]="resize",o[o.scale=2]="scale",o[o.skew=3]="skew",o[o.flip=4]="flip",o[o.all=5]="all",o))(st||{});class Sg{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new yg(e)}sampleFrame(e=this.Now()){if(!!this._enabled){if(this._lastFrameTimeMs!=null){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class yg{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let n=this._samples[this._pos];t=n-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(n-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}class re{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return re.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new re(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new re(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new re(this.x-e.x,this.y-e.y)}subtractByPoint(e,t){return new re(this.x-e,this.y-t)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new re(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new re(this.x*e,this.y*t)}divide(e){return new re(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new re(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new re(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new re(Math.floor(this.x),Math.floor(this.y))}fract(){return new re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=t*this.x-n*this.y,r=n*this.x+t*this.y;return this.x=s,this.y=r,this}rotateToRef(e,t){const n=Math.cos(e),s=Math.sin(e);return t.x=n*this.x-s*this.y,t.y=s*this.x+n*this.y,this}rotateByPoint(e,t=re.create(0,0)){const n=Math.cos(e),s=Math.sin(e),r=t.x+(this.x-t.x)*n-(this.y-t.y)*s,i=t.y+(this.x-t.x)*s+(this.y-t.y)*n;return this.x=r,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=Math.atan2(this.y,this.x),s=-e+n;return this.x=t*Math.cos(s),this.y=t*Math.sin(s),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return re.NormalizeToRef(this,this),this}clone(){return new re(this.x,this.y)}static Zero(){return new re(0,0)}static One(){return new re(1,1)}static FromArray(e,t=0){return new re(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,s,r){let i=r*r,a=r*i,l=.5*(2*t.x+(-e.x+n.x)*r+(2*e.x-5*t.x+4*n.x-s.x)*i+(-e.x+3*t.x-3*n.x+s.x)*a),c=.5*(2*t.y+(-e.y+n.y)*r+(2*e.y-5*t.y+4*n.y-s.y)*i+(-e.y+3*t.y-3*n.y+s.y)*a);return new re(l,c)}static Clamp(e,t,n){let s=e.x;s=s>n.x?n.x:s,s=s<t.x?t.x:s;let r=e.y;return r=r>n.y?n.y:r,r=r<t.y?t.y:r,new re(s,r)}static Hermite(e,t,n,s,r){let i=r*r,a=r*i,l=2*a-3*i+1,c=-2*a+3*i,u=a-2*i+r,h=a-i,d=e.x*l+n.x*c+t.x*u+s.x*h,g=e.y*l+n.y*c+t.y*u+s.y*h;return new re(d,g)}static Hermite1stDerivative(e,t,n,s,r){let i=re.Zero();return this.Hermite1stDerivativeToRef(e,t,n,s,r,i),i}static Hermite1stDerivativeToRef(e,t,n,s,r,i){const a=r*r;i.x=(a-r)*6*e.x+(3*a-4*r+1)*t.x+(-a+r)*6*n.x+(3*a-2*r)*s.x,i.y=(a-r)*6*e.y+(3*a-4*r+1)*t.y+(-a+r)*6*n.y+(3*a-2*r)*s.y}static Lerp(e,t,n){let s=e.x+(t.x-e.x)*n,r=e.y+(t.y-e.y)*n;return new re(s,r)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=re.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();n!==0&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,s=e.y<t.y?e.y:t.y;return new re(n,s)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,s=e.y>t.y?e.y:t.y;return new re(n,s)}static Transform(e,t,n=!1){const s=t,r=e;return n?new re(s[0]*r.x+s[2]*r.y,s[1]*r.x+s[3]*r.y):new re(s[0]*r.x+s[2]*r.y+s[4],s[1]*r.x+s[3]*r.y+s[5])}static PointInTriangle(e,t,n,s){let r=.5*(-n.y*s.x+t.y*(-n.x+s.x)+t.x*(n.y-s.y)+n.x*s.y),i=r<0?-1:1,a=(t.y*s.x-t.x*s.y+(s.y-t.y)*e.x+(t.x-s.x)*e.y)*i,l=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return a>0&&l>0&&a+l<2*r*i}static Distance(e,t){return Math.sqrt(re.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,s=e.y-t.y;return n*n+s*s}static Center(e,t){return re.CenterToRef(e,t,re.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let s=re.DistanceSquared(t,n);if(s===0)return re.Distance(e,t);let r=n.subtract(t),i=Math.max(0,Math.min(1,re.Dot(e.subtract(t),r)/s)),a=t.add(r.multiplyByFloats(i,i));return re.Distance(e,a)}static create(e,t){return new re(e,t)}}const xi=[1,0,0,1,0,0];class dt{constructor(e=xi){this.dirty=!1,this._m=e&&e.slice()||xi}static create(e=xi){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new dt(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const n=this._m;let s=n[0]*e.x+n[2]*e.y,r=n[1]*e.x+n[3]*e.y;return t?new re(s,r):new re(s+n[4],r+n[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=ds(e);let n=Math.cos(t),s=Math.sin(t),r=this._m[0]*n+this._m[2]*s,i=this._m[1]*n+this._m[3]*s,a=this._m[0]*-s+this._m[2]*n,l=this._m[1]*-s+this._m[3]*n;return this._m[0]=r,this._m[1]=i,this._m[2]=a,this._m[3]=l,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let n=this._m[0]+this._m[2]*t,s=this._m[1]+this._m[3]*t,r=this._m[2]+this._m[0]*e,i=this._m[3]+this._m[1]*e;return this._m[0]=n,this._m[1]=s,this._m[2]=r,this._m[3]=i,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],n=this._m[1]*e._m[0]+this._m[3]*e._m[1],s=this._m[0]*e._m[2]+this._m[2]*e._m[3],r=this._m[1]*e._m[2]+this._m[3]*e._m[3],i=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],a=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=r,this._m[4]=i,this._m[5]=a,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,n=-this._m[1]*e,s=-this._m[2]*e,r=this._m[0]*e,i=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),a=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=r,this._m[4]=i,this._m[5]=a,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(t=>Mi(t,e))}setAbsolutePosition(e){let t=this._m[0],n=this._m[1],s=this._m[2],r=this._m[3],i=this._m[4],a=this._m[5],l=(t*(e.y-a)-n*(e.x-i))/(t*r-n*s),c=(e.x-i-s*l)/t;return this.translate(c,l)}decompose(){let e=this._m[0],t=this._m[1],n=this._m[2],s=this._m[3],r=this._m[4],i=this._m[5],a=e*s-t*n,l={x:r,y:i,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||t!==0){let c=Math.sqrt(e*e+t*t);l.angle=t>0?Math.acos(e/c):-Math.acos(e/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(e*n+t*s)/a,l.skewY=0}else if(n!==0||s!==0){let c=Math.sqrt(n*n+s*s);l.angle=Math.PI/2-(s>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(e*n+t*s)/a}return l.angle=xg(l.angle),l}makeBoundingBoxFromPoints(e){if(this)for(let u=0;u<e.length;u++)e[u]=this.applyPoint(e[u]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],n=Math.min(...t),r=Math.max(...t)-n,i=[e[0].y,e[1].y,e[2].y,e[3].y],a=Math.min(...i),c=Math.max(...i)-a;return{left:n,top:a,width:r,height:c,points:e}}composeMatrix(e){const t=new dt([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}_calcDimensionsMatrix(e){var r,i;const t=(r=e.scaleX)!=null?r:1,n=(i=e.scaleY)!=null?i:1,s=new dt([e.flipX?-t:t,0,0,e.flipY?-n:n,0,0]);return e.skewX&&s.multiply(new dt([1,0,Math.tan(ds(e.skewX)),1,0,0])),e.skewY&&s.multiply(new dt([1,Math.tan(ds(e.skewY)),0,1,0,0])),s}clone(){return new dt([...this._m])}}function Tu(o,e,t){let n=0,s=0,r=0,i=0;const{startX:a,startY:l,endX:c,endY:u}=t;e===pt.TOP?(n=a,s=l,r=c,i=l):e===pt.BOTTOM?(n=a,s=u,r=c,i=u):e===pt.LEFT?(n=a,s=l,r=a,i=u):e===pt.RIGHT&&(n=c,s=l,r=c,i=u),o.beginPath(),o.moveTo(n,s),o.lineTo(r,i),o.stroke()}function Ru(o,e){e===ye.HAIR?o.setLineDash([1,2]):e===ye.DASH_DOT_DOT||e===ye.MEDIUM_DASH_DOT_DOT?o.setLineDash([2,2,5,2,2]):e===ye.DASH_DOT||e===ye.MEDIUM_DASH_DOT||e===ye.SLANT_DASH_DOT?o.setLineDash([2,5,2]):e===ye.DOTTED?o.setLineDash([2]):e===ye.DASHED||e===ye.MEDIUM_DASHED?o.setLineDash([3]):o.setLineDash([0])}function Au(o){let e=1;return o===ye.MEDIUM||o===ye.MEDIUM_DASH_DOT||o===ye.MEDIUM_DASHED||o===ye.MEDIUM_DASH_DOT_DOT?e=2:o===ye.THICK&&(e=3),e}function Nn(o,e,t,n,s=re.create(0,0)){const r=o.add(e).rotateByPoint(n),i=r.subtract(e),a=n-t;return i.rotateByPoint(a,r).add(s).transformCoordinateOnRotate(a)}function Iu(o){return o>0?Do.DOWN:Do.UP}function Du(o,e,t){const n=[];let s=0,r=0,i=0,a=0,l=0;const c=Iu(t),u=o.length;t=Math.abs(t);const h=Math.tan(t),d=Math.sin(t),g=Math.cos(t);if(c===Do.UP){let m=0;for(let _=0;_<u;_++){const p=o[_],{lineHeight:v=0}=p;m+=_===0?0:v;const b=(v/h+e)*d;n.push(m/h),b>r&&(r=b),_===0&&(i+=v*d,l+=v*g)}i+=m/d+e*g,l-=r}else{let m=0,_=-1;const p=[];for(let C=u-1;C>=0;C--){const D=o[C],{lineHeight:O=0}=D,F=O/h,S=(e+F)*d;p.unshift(O/h),S>r&&(r=S,m=F,_=C),C===0?i+=O*d:C===u-1?i+=e*g+O/d:i+=O/d}let v=o[_].lineHeight||0,b=0;for(let C=_+1;C<=u-1;C++){const D=o[C],{lineHeight:O=0}=D;v+=O,b+=p[C]||0,n[C]=-b}b=0;for(let C=_-1;C>=0;C--){const D=o[C],{lineHeight:O=0}=D;b+=p[C+1]||0,n[C]=b,s+=O}n[_]=0,u===1&&(i+=e*g),a=v/d-m*g}return{rotateTranslateXList:n,rotatedHeight:r,rotatedWidth:i,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:s}}const Tg=[new re(0,0),new re(1,1)];class Rg{constructor(e=Tg){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let n=1;n<this._lines.length;n++){const s=this._lines[n-1],r=this._lines[n];for(let i=1;i<e.length;i++){const a=this._lines[n-1],l=this._lines[n],c=this._intersection({from:s,to:r},{from:a,to:l});c&&t.push(c)}}return t}_intersection(e,t){const n=e.from,s=e.to,r=t.from,i=t.to;let a=(n.x-r.x)*(s.y-r.y)-(n.y-r.y)*(s.x-r.x),l=(n.x-i.x)*(s.y-i.y)-(n.y-i.y)*(s.x-i.x);if(a*l>=0)return!1;let c=(r.x-n.x)*(i.y-n.y)-(r.y-n.y)*(i.x-n.x),u=c+a-l;if(c*u>=0)return!1;let h=c/(l-a),d=h*(s.x-n.x),g=h*(s.y-n.y);return new re(n.x+d,n.y+g)}}const Ag=Math.PI/180,Ig=180/Math.PI,Ou="rgb(",Dg="rgba(",lt=(o,e)=>o?e?`${Dg+o.join(",")},${e})`:`${Ou+o.join(",")})`:`${Ou}0,0,0)`,Ln=(o,e)=>{if(R.isNumber(o))return o;if(e&&o&&R.isString(o)&&o.substr(o.length-1,1)==="%"){const t=parseFloat(o)/100;return e*t}return 0},mr=(o,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(o):e.requestAnimationFrame?e.requestAnimationFrame(o):e.msRequestAnimationFrame?e.msRequestAnimationFrame(o):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(o):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(o):e.oRequestAnimationFrame?e.oRequestAnimationFrame(o):window.setTimeout(o,16)),Og=(o,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(o):e.requestAnimationFrame?e.cancelAnimationFrame(o):e.msRequestAnimationFrame?e.msCancelAnimationFrame(o):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(o):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(o):e.oRequestAnimationFrame?e.oCancelAnimationFrame(o):window.clearTimeout(o)),xu=()=>{let o=document.createElement("canvas");try{o.style=o.style||{}}catch(e){console.error(e)}return o},xg=o=>o*Ig,ds=o=>o*Ag,Mg=()=>{let o="pointer";return typeof window!="undefined"&&!window.PointerEvent&&typeof navigator!="undefined"&&!navigator.pointerEnabled&&(o="mouse"),R.isTablet()&&!R.isIPhone()&&!(document&&"ontouchend"in document)&&(o="mouse"),o},kg=()=>R.getBrowserType()==="safari",Bg=(o="obj",e=4)=>{let t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),n="";for(let r=0;r<e;r++)n+=t[Math.round(Math.random()*(t.length-1))];let s=new Date().getTime();return`${o}_${n}_${s}`};function Mu(o){return Object.prototype.toString.apply(o)}function ku(o){return Mu(o)==="[object Function]"}function Bu(o){return Mu(o)==="[object String]"}function Mi(o,e){return e=10**e,Math.round(o*e)/e}function ge(o,e){return Math.round(o*e)/e}function ki(o,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:t,defaultFontSize:n}=e;if(!o)return{fontString:`${n}px  ${t[0]}`,fontSize:n,fontFamily:t[0]};let s=Ao.ITALIC;(o.it===0||o.it===void 0)&&(s=Ao.NORMAL);let r=Ao.BOLD;(o.bl===0||o.bl===void 0)&&(r=Ao.NORMAL);let i=n;o.fs&&(i=Math.ceil(o.fs));let a=t[0];if(o.ff){let u=o.ff;u=u.replace(/"/g,"").replace(/'/g,""),u.indexOf(" ")>-1&&(u=`"${u}"`),u==null&&(u=t[0]),a=u}const{va:l}=o;if(l===yt.SUBSCRIPT||l===yt.SUPERSCRIPT){const u=Oo.getBaselineOffsetInfo(a,i),{sbr:h,spr:d}=u;i*=l===yt.SUBSCRIPT?h:d}return{fontString:`${s} ${r} ${i}px ${a}, ${Cg} `,fontSize:i,fontFamily:a}}function Fu(o){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(o)}function Nu(o){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(o)}function Lu(o){return!!/[\u0180-\u024F]/gi.exec(o)}let _r;function Fg(){if(_r)return _r;let o=56;for(;o<2e3;o++)if(matchMedia(`(max-resolution: ${o}dpi)`).matches===!0)return o;return _r=o,setTimeout(()=>{_r=null},1e3),o}const Ng=72;function Lg(o){return o*(Ng/Fg())}function xo(o){const{scaleX:e=1,scaleY:t=1}=o;return Math.max(e,t)}function pr(o,e,t,n){const s=o-1,r=e-1;let i=t[s]||0,a=t[o],l=n[r]||0,c=n[e];return{startY:i,endY:a,startX:l,endX:c}}function gs(o,e,t,n,s){let{startY:r,endY:i,startX:a,endX:l}=pr(o,e,t,n);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:g,mergeColumn:m}=Pg(o,e,s);let _={startRow:g,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&g!==-1&&m!==-1){let p=t[g-1]||0,v=t[h],b=n[m-1]||0,C=n[d];_={..._,startY:p,endY:v,startX:b,endX:C}}else!c&&h!==-1&&d!==-1&&(i=t[h]||0,l=n[d]||0);return{isMerged:c,isMergedMainCell:u,row:o,column:e,startY:r,endY:i,startX:a,endX:l,mergeInfo:_}}function Pg(o,e,t){let n=!1,s=!1,r=-1,i=-1,a=-1,l=-1;return t==null||t.forEach((c,u)=>{let h=!1;if(u==null||u.forEach((d,g)=>{const{startRow:m,endRow:_,startColumn:p,endColumn:v}=g;if(o===m&&e===p)return r=_,i=v,a=m,l=p,h=!0,s=!0,!1;if(o>=m&&o<=_&&e>=p&&e<=v)return r=_,i=v,a=m,l=p,h=!0,n=!0,!1}),h)return!1}),{isMergedMainCell:s,isMerged:n,newEndRow:r,newEndColumn:i,mergeRow:a,mergeColumn:l}}function Pu(o,e,t,n,s){const{startY:r,endY:i,startX:a,endX:l}=o;return o.startY=ge(r+t,s),o.endY=ge(i+t,s),o.startX=ge(a+e,n),o.endX=ge(l+e,n),{...o}}function zg(o,e){return!(o.left>e.right||o.top>e.bottom||e.left>o.right||e.top>o.bottom)}function Ug(o){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet;for(let n of o)t==null||t.insertRule(n,t.cssRules.length)}const Wg="documentCustomBlock",Hg="documentCustomBullet";function $g(o,e,t,n,s,r){if(!r)return[];const i=r.getPluginManager().getPluginByName(Wg);return i?i.dealWidthCustomBlock(o,e,t,n,s):[]}function Vg(o,e,t,n){if(!n)return"";const s=n.getPluginManager().getPluginByName(Hg);return s?s.dealWidthCustomBulletOrderedSymbol(o,e,t):""}const Bi=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class fs{constructor(e){this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new dt,this._dirty=!0,this._cursor=Ye.DEFAULT,this._isTransformer=!1,this.isInGroup=!1,this.onTransformChangeObservable=new ae,this.onPointerDownObserver=new ae,this.onPointerMoveObserver=new ae,this.onPointerUpObserver=new ae,this.onDblclickObserver=new ae,this.onMouseWheelObserver=new ae,this.onPointerOutObserver=new ae,this.onPointerLeaveObserver=new ae,this.onPointerOverObserver=new ae,this.onPointerEnterObserver=new ae,this.onIsAddedToParentObserver=new ae,this.onDisposeObserver=new ae,e?this._oKey=e:this._oKey=Bg()}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout(()=>{var t;(t=this.parent)==null||t.makeDirty(e)},0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&((t=this.parent)==null||t.makeDirty(e)),this}isDirty(){return this._dirty}get transform(){return this._transform}set transform(e){this._transform=e}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return ve.BASE_OBJECT}translate(e,t){const n=this.top;t!==void 0&&(this.top=t);const s=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:s}}),this}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:s}}),this}skew(e,t){const n=e;e!==void 0&&(this.skewX=e);const s=t;return t!==void 0&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:s}}),this}flip(e,t){const n=e;e!==void 0&&(this.flipX=e);const s=t;return t!==void 0&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:s}}),this}transformByState(e){const t=Object.keys(e),n={};if(t.length!==0)return t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.all,value:e,preValue:n}),this}_setTransForm(){const e=dt.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}get top(){return this._top}set top(e){var t;this._topOrigin=e,this._top=Ln(e,(t=this._parent)==null?void 0:t.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Ln(e,(t=this._parent)==null?void 0:t.width)}get width(){return this._width}set width(e){var t;this._widthOrigin=e,this._width=Ln(e,(t=this._parent)==null?void 0:t.width)}get height(){return this._height}set height(e){var t;this._heightOrigin=e,this._height=Ln(e,(t=this._parent)==null?void 0:t.height)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e}get angle(){return this._angle}set angle(e){this._angle=e}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}get ancestorScaleX(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}set skewX(e){this._skewX=e}get skewY(){return this._skewY}set skewY(e){this._skewY=e}get flipX(){return this._flipX}set flipX(e){this._flipX=e}get flipY(){return this._flipY}set flipY(e){this._flipY=e}get parent(){return this._parent}set parent(e){this._parent=e}getParent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}get evented(){return this._evented}set evented(e){this._evented=e}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}set debounceParentDirty(e){this._debounceParentDirty=e}get isTransformer(){return this._isTransformer}set isTransformer(e){this._isTransformer=e}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1}show(){this._visible=!0}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,n;return(t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerMove(e),!1)}triggerPointerDown(e){var t,n;return(t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerDown(e),!1)}triggerPointerUp(e){var t,n;return(t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerUp(e),!1)}triggerDblclick(e){var t,n;return(t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerDblclick(e),!1)}triggerMouseWheel(e){var t,n;return(t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerMouseWheel(e),!1)}triggerPointerOut(e){var t,n;return(t=this.onPointerOutObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t,n;return(t=this.onPointerLeaveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return this.onPointerOverObserver.notifyObservers(e)?!0:((t=this._parent)==null||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t,n;return(t=this.onPointerEnterObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return Bi.forEach(t=>{this[t]&&(e[t]=this[t])}),e}getScene(){let e=this.parent;if(e.classType===ve.SCENE)return e;for(;e;){if(e.classType===ve.SCENE)return e;e=e.getParent()}}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(Ye.DEFAULT)}setCursor(e){var t;this._cursor=e,(t=this.getScene())==null||t.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===ve.ENGINE)return e;e=e.getParent()}return null}}function zu(){let o=1,t=xu().getContext("2d");return o=(()=>{let n=window.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/s})(),o<1?1:Math.ceil(o*10)/10}class Mo{constructor(e){this._pixelRatio=1,this._width=0,this._height=0,this.isCache=!1,e=e||{},this._canvasEle=xu(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,n){this._pixelRatio=n||zu(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch{try{return this._canvasEle.toDataURL()}catch(s){const{message:r}=s;return console.error(`Unable to get data URL. ${r} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class Xg{constructor(e=100,t=100){this._canvas=new Mo,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onInputChangedObservable=new ae,this.renderEvenInBackground=!0,this._usingSafari=kg(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Sg,this.onBeginFrameObservable=new ae,this.onEndFrameObservable=new ae,this.onTransformChangeObservable=new ae,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=navigator.userAgent.indexOf("Firefox")!==-1,this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return ve.ENGINE}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return!!this._activeScene}get activeScene(){return this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{offsetWidth:e,offsetHeight:t}=this._container;this.resizeBySize(e,t)}resizeBySize(e,t){const n=this.width,s=this.height;this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:st.resize,value:{width:e,height:t},preValue:{width:n,height:s}})}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=mr(this._renderFunction)))}get requestNewFrameHandler(){return this._requestNewFrameHandler}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=mr(this._renderFunction):this._renderingQueueLaunched=!1}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}get frameId(){return this._frameId}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){let t=this._activeRenderLoops[e];t()}}_handleKeyboardAction(){const e=n=>{let s=n;s.deviceType=ot.Keyboard,s.inputIndex=n.keyCode,s.previousState=0,s.currentState=1,this.onInputChangedObservable.notifyObservers(s)},t=n=>{let s=n;s.deviceType=ot.Keyboard,s.inputIndex=n.keyCode,s.previousState=1,s.currentState=0,this.onInputChangedObservable.notifyObservers(s)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",t)}_handlePointerAction(){const e=Mg(),t=a=>{const l=this.__getPointerType(a),c=this.__pointer[ce.Horizontal],u=this.__pointer[ce.Vertical],h=this.__pointer[ce.DeltaHorizontal],d=this.__pointer[ce.DeltaVertical];this.__pointer[ce.Horizontal]=a.clientX,this.__pointer[ce.Vertical]=a.clientY,this.__pointer[ce.DeltaHorizontal]=a.movementX,this.__pointer[ce.DeltaVertical]=a.movementY;let g=a;g.deviceType=l,c!==a.clientX&&(g.inputIndex=ce.Horizontal,g.previousState=c,g.currentState=this.__pointer[ce.Horizontal],this.onInputChangedObservable.notifyObservers(g)),u!==a.clientY&&(g.inputIndex=ce.Vertical,g.previousState=u,g.currentState=this.__pointer[ce.Vertical],this.onInputChangedObservable.notifyObservers(g)),this.__pointer[ce.DeltaHorizontal]!==0&&(g.inputIndex=ce.DeltaHorizontal,g.previousState=h,g.currentState=this.__pointer[ce.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(g)),this.__pointer[ce.DeltaVertical]!==0&&(g.inputIndex=ce.DeltaVertical,g.previousState=d,g.currentState=this.__pointer[ce.DeltaVertical],this.onInputChangedObservable.notifyObservers(g)),!this._usingSafari&&a.button!==-1&&(g.inputIndex=a.button+2,g.previousState=this.__pointer[a.button+2],this.__pointer[a.button+2]=this.__pointer[a.button+2]?0:1,g.currentState=this.__pointer[a.button+2],this.onInputChangedObservable.notifyObservers(g))},n=a=>{const l=this.__getPointerType(a),c=this.__pointer[ce.Horizontal],u=this.__pointer[ce.Vertical],h=this.__pointer[a.button+2];l===ot.Mouse?(this.__mouseId===-1&&(a.pointerId===void 0?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=a.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):a.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(a.pointerId),this.__pointer[ce.Horizontal]=a.clientX,this.__pointer[ce.Vertical]=a.clientY,this.__pointer[a.button+2]=1;let d=a;d.deviceType=l,c!==a.clientX&&(d.inputIndex=ce.Horizontal,d.previousState=c,d.currentState=this.__pointer[ce.Horizontal],this.onInputChangedObservable.notifyObservers(d)),u!==a.clientY&&(d.inputIndex=ce.Vertical,d.previousState=u,d.currentState=this.__pointer[ce.Vertical],this.onInputChangedObservable.notifyObservers(d)),d.inputIndex=a.button+2,d.previousState=h,d.currentState=this.__pointer[a.button+2],this.onInputChangedObservable.notifyObservers(d)},s=a=>{const l=this.__getPointerType(a),c=this.__pointer[ce.Horizontal],u=this.__pointer[ce.Vertical],h=this.__pointer[a.button+2];this.__pointer[ce.Horizontal]=a.clientX,this.__pointer[ce.Vertical]=a.clientY,this.__pointer[a.button+2]=0;let d=a;d.deviceType=l,c!==a.clientX&&(d.inputIndex=ce.Horizontal,d.previousState=c,d.currentState=this.__pointer[ce.Horizontal],this.onInputChangedObservable.notifyObservers(d)),u!==a.clientY&&(d.inputIndex=ce.Vertical,d.previousState=u,d.currentState=this.__pointer[ce.Vertical],this.onInputChangedObservable.notifyObservers(d)),d.inputIndex=a.button+2,d.previousState=h,d.currentState=this.__pointer[a.button+2],l===ot.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):a.pointerId&&this._canvasEle.hasPointerCapture(a.pointerId)&&this._canvasEle.releasePointerCapture(a.pointerId),this.onInputChangedObservable.notifyObservers(d),l!==ot.Mouse&&(this.__pointer={})},r=a=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},i=a=>{const l=ot.Mouse;let c=this.__pointer[ce.MouseWheelX],u=this.__pointer[ce.MouseWheelY],h=this.__pointer[ce.MouseWheelZ];this.__pointer[ce.MouseWheelX]=a.deltaX||0,this.__pointer[ce.MouseWheelY]=a.deltaY||a.wheelDelta||0,this.__pointer[ce.MouseWheelZ]=a.deltaZ||0;let d=a;d.deviceType=l,this.__pointer[ce.MouseWheelX]!==0&&(d.inputIndex=ce.MouseWheelX,d.previousState=c,d.currentState=this.__pointer[ce.MouseWheelX],this.onInputChangedObservable.notifyObservers(d)),this.__pointer[ce.MouseWheelY]!==0&&(d.inputIndex=ce.MouseWheelY,d.previousState=u,d.currentState=this.__pointer[ce.MouseWheelY],this.onInputChangedObservable.notifyObservers(d)),this.__pointer[ce.MouseWheelZ]!==0&&(d.inputIndex=ce.MouseWheelZ,d.previousState=h,d.currentState=this.__pointer[ce.MouseWheelZ],this.onInputChangedObservable.notifyObservers(d))};this._canvasEle.addEventListener(`${e}move`,t),this._canvasEle.addEventListener(`${e}down`,n),this._canvasEle.addEventListener(`${e}up`,s),this._canvasEle.addEventListener("blur",r),this._canvasEle.addEventListener(this._getWheelEventName(),i,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const n={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,n),this._canvasEle.removeEventListener("test",t,n)}catch{}return e}__getPointerType(e){let t=ot.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(t=ot.Touch),t}}class oo{constructor(e,t=[],n=1){this._scene=e,this._objects=t,this._zIndex=n,this.addObjects(this._objects)}static create(e,t=[],n=1e3){return new this(e,t,n)}get scene(){return this._scene}get zIndex(){return this._zIndex}getObjectsByOrder(){const e=[];this._objects.sort(ht);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(ht);for(let t of this._objects)t.classType!==ve.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===ve.GROUP){const t=e.getObjects();for(let n of t)this.scene.getObject(n.oKey)||(this._objects.push(n),this.scene.setObjectBehavior(n))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),this}removeObject(e){const t=this.getObjects(),n=t.length;if(e instanceof fs){for(let s=0;s<n;s++)if(t[s]===e){t.splice(s,1);return}}else for(let s=0;s<n;s++)if(t[s].oKey===e){t.splice(s,1);return}}addObjects(e){return e.forEach(t=>{this.addObject(t)}),this}}const vr=class{constructor(o){this._alreadyAttached=!1,this._startingPosition=new re(1/0,1/0),this._doubleClickOccurred=0,this._scene=o}_getCurrentObject(o,e){var t;return(t=this._scene)==null?void 0:t.pick(re.FromArray([o,e]))}_checkDirectSceneEventTrigger(o,e){return!this._scene.evented&&o||e}mouseLeaveEnterHandler(o,e){var t;if(o==null)(t=this._currentMouseEnterPicked)==null||t.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(o!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=o,n==null||n.triggerPointerLeave(e),o==null||o.triggerPointerEnter(e)}}attachControl(o=!0,e=!0,t=!0,n=!0){const s=this._scene.getEngine();!s||(this._onPointerMove=r=>{r.pointerId===void 0&&(r.pointerId=0);const i=this._getCurrentObject(r.offsetX,r.offsetY),a=i==null?void 0:i.triggerPointerMove(r);this.mouseLeaveEnterHandler(i,r),this._checkDirectSceneEventTrigger(!a,!i)&&(this._scene.onPointerMove&&this._scene.onPointerMove(r),this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(r))},this._onPointerDown=r=>{r.pointerId===void 0&&(r.pointerId=0);const i=this._getCurrentObject(r.offsetX,r.offsetY),a=i==null?void 0:i.triggerPointerDown(r);this._checkDirectSceneEventTrigger(!a,!i)&&(this._scene.onPointerDown&&this._scene.onPointerDown(r),this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(r))},this._onPointerUp=r=>{r.pointerId===void 0&&(r.pointerId=0);const i=this._getCurrentObject(r.offsetX,r.offsetY),a=i==null?void 0:i.triggerPointerUp(r);this._checkDirectSceneEventTrigger(!a,!i)&&(this._scene.onPointerUp&&this._scene.onPointerUp(r),this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(r)),this._prePointerDoubleClick(r)},this._onMouseWheel=r=>{const i=this._getCurrentObject(r.offsetX,r.offsetY),a=i==null?void 0:i.triggerMouseWheel(r);this._scene.getViewports().forEach(l=>{l.onMouseWheelObserver.hasObservers()&&l.onMouseWheelObserver.notifyObservers(r)}),this._checkDirectSceneEventTrigger(!a,!i)&&(this._scene.onMouseWheel&&this._scene.onMouseWheel(r),this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(r))},this._onKeyDown=r=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(r)},this._onKeyUp=r=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(r)},this._onInputObserver=s.onInputChangedObservable.add(r=>{const i=r;r.deviceType===ot.Keyboard&&(r.currentState===1&&this._onKeyDown(i),r.currentState===0&&this._onKeyUp(i)),(r.deviceType===ot.Mouse||r.deviceType===ot.Touch)&&(o&&r.inputIndex>=ce.LeftClick&&r.inputIndex<=ce.RightClick&&r.currentState===1&&this._onPointerDown(i),e&&r.inputIndex>=ce.LeftClick&&r.inputIndex<=ce.RightClick&&r.currentState===0&&this._onPointerUp(i),t&&(r.inputIndex===ce.Horizontal||r.inputIndex===ce.Vertical||r.inputIndex===ce.DeltaHorizontal||r.inputIndex===ce.DeltaVertical)?this._onPointerMove(i):n&&(r.inputIndex===ce.MouseWheelX||r.inputIndex===ce.MouseWheelY||r.inputIndex===ce.MouseWheelZ)&&this._onMouseWheel(i))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const o=this._scene.getEngine();!o||(o.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_isPointerSwiping(o,e){return Math.abs(this._startingPosition.x-o)>vr.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>vr.DragMovementThreshold}_prePointerDoubleClick(o){var s,r;const{clientX:e,clientY:t}=o;if(this._doubleClickOccurred===0&&(this._startingPosition.x=e,this._startingPosition.y=t),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout(()=>{this._resetDoubleClickParam()},vr.DoubleClickDelay),this._doubleClickOccurred<2)return;if(this._isPointerSwiping(e,t)){this._resetDoubleClickParam();return}(r=(s=this._scene)==null?void 0:s.pick(re.FromArray([o.offsetX,o.offsetY])))==null||r.triggerDblclick(o),this._scene.onDblclick&&this._scene.onDblclick(o),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(o),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",o)}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let ms=vr;ms.DragMovementThreshold=10,ms.LongPressDelay=500,ms.DoubleClickDelay=300,ms.ExclusiveDoubleClickMode=!1;function ko(o){const e=o.getScene(),t=o.getViewportByCoord(e);let n=0,s=0;if(!t)return{scrollX:n,scrollY:s};const r=t.getActualScroll(t.scrollX,t.scrollY);return{scrollX:r.x,scrollY:r.y}}class Fi extends fs{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}set cursor(e){this.setCursor(e)}get classType(){return ve.GROUP}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(Bu(e)){const n=this.getScene();if(t=n==null?void 0:n.getObject(e),!t){console.info("No object be added");return}t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),n=t.length;if(Bu(e))for(let s=0;s<n;s++){const r=t[s];if(r.oKey===e){t.splice(s,1),this.parent.removeObject(r);return}}else for(let s=0;s<n;s++){const r=t[s];if(r===e){t.splice(s,1),this.parent.removeObject(r);return}}}getObjectsByOrder(){const e=[];this._objects.sort(ht);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const n=this.transform.getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(ht);for(let s of this._objects)s.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}_transformBounds(e){return e}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}}class so{constructor(e,t,n=.05,s=.05){this._scene=e,this._padding=t,this._smoothRatioX=n,this._smoothRatioY=s,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:20})}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(e==null?void 0:e.top)||0,n=t+((e==null?void 0:e.height)||0),s=(e==null?void 0:e.left)||0,r=s+((e==null?void 0:e.width)||0),{t:i=0,b:a=0,r:l=0,l:c=0}=this._padding;let u=0,h=0;this._moveX<s+c&&(u=(this._moveX-s-c)*this._smoothRatioX),this._moveX>r-l&&(u=(this._moveX-r+l)*this._smoothRatioX),this._moveY<t+i&&(h=(this._moveY-t-i)*this._smoothRatioY),this._moveY>n-a&&(h=(this._moveY-n+a)*this._smoothRatioY);const d=e==null?void 0:e.scrollBy({x:u,y:h}),g=e==null?void 0:e.getActualScroll(u,h);if(this._scrollX=(g==null?void 0:g.x)||0,this._scrollY=(g==null?void 0:g.y)||0,d){const m=this._findAncestorScene(e==null?void 0:e.scene),_=this.getViewportByCoord(m);_&&this._scroll(_)}}scrolling(e,t,n){this._moveX=e,this._moveY=t,this._scrollFunction=n}stopScroll(){Og(this._requestNewFrameNumber)}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=mr(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=e==null?void 0:e.getParent();for(;t;){if(t.classType===ve.SCENE)return t;t=(t==null?void 0:t.getParent)&&(t==null?void 0:t.getParent())}}getViewportByCoord(e){const t=e==null?void 0:e.getViewports();return t==null?void 0:t.find(n=>n.isHit(re.FromArray([this._offsetX,this._offsetY])))}getScene(){return this._scene}static create(e,t){return new so(e,t)}}const Yg=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class _s extends fs{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new Mo,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const s=this.transform.clone().invert().applyPoint(t.tl),r=this.transform.clone().invert().applyPoint(t.tr),i=this.transform.clone().invert().applyPoint(t.bl),a=this.transform.clone().invert().applyPoint(t.br),l=[s.x,r.x,i.x,a.x],c=[s.y,r.y,i.y,a.y],u=Math.max(...l),h=Math.min(...l),d=Math.max(...c),g=Math.min(...c);if(this.width+this.strokeWidth<h||u<0||this.height+this.strokeWidth<g||d<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const s=this._cacheCanvas.getContext();this._cacheCanvas.clear(),s.save(),s.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(s),s.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const n={};let s=!1;t.forEach(r=>{if(e[r]===void 0)return!0;Bi.indexOf(r)>-1?(n[r]=e[r],s=!0):this[`_${r}`]=e[r]}),s&&this.transformByState(n),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(n=>{if(e[n]===void 0)return!0;Bi.indexOf(n)===-1&&(this[`_${n}`]=e[n])}),this.makeDirty(!0),this}resizeCacheCanvas(){var e;(e=this._cacheCanvas)==null||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var n,s,r;let e=((n=this.getParent())==null?void 0:n.ancestorScaleX)||1,t=((s=this.getParent())==null?void 0:s.ancestorScaleX)||1;(r=this._cacheCanvas)==null||r.setPixelRatio(Math.max(e,t)*zu()),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}static _renderPaintInOrder(e,t){t.paintFirst==="stroke"?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){!t.fill||(e.save(),this.__setFillStyles(e,t),t.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:n,strokeWidth:s,shadowEnabled:r,shadowForStrokeEnabled:i,strokeScaleEnabled:a,scaleX:l,scaleY:c,parent:u}=t;if(!(!n||s===0)){if(r&&!i&&this.__removeShadow(e),e.save(),a&&u){let h=this.__getObjectScaling();e.scale(1/h.scaleX,1/h.scaleY)}else a&&(l=l!=null?l:1,c=c!=null?c:1,e.scale(1/l,1/c));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:n,strokeLineCap:s,strokeDashOffset:r,strokeLineJoin:i,strokeMiterLimit:a,stroke:l}=t;e.lineWidth=n,e.lineCap=s,e.lineDashOffset=r,e.lineJoin=i,e.miterLimit=a,e.strokeStyle=l}static __setLineDash(e){}static drawWith(e,t){}toJson(){const e={};return Yg.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const Gg=["radius"];class Fe extends _s{constructor(e,t){super(e,t),t!=null&&t.radius&&(this._radius=t==null?void 0:t.radius)}get radius(){return this._radius}_draw(e){Fe.drawWith(e,this)}static drawWith(e,t){let{radius:n,width:s,height:r}=t;if(n=n!=null?n:0,s=s!=null?s:30,r=r!=null?r:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),!n)e.rect(0,0,s,r);else{let i=0,a=0,l=0,c=0;i=a=l=c=Math.min(n,s/2,r/2),e.moveTo(i,0),e.lineTo(s-a,0),e.arc(s-a,a,a,Math.PI*3/2,0,!1),e.lineTo(s,r-c),e.arc(s-c,r-c,c,0,Math.PI/2,!1),e.lineTo(l,r),e.arc(l,r-l,l,Math.PI/2,Math.PI,!1),e.lineTo(0,i),e.arc(i,i,i,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return Gg.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const jg=["pointsGroup"];class br extends _s{constructor(e,t){super(e,t),this._pointsGroup=(t==null?void 0:t.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:r,preValue:i}=n;(s===st.resize||s===st.all)&&this.resizePolygon(i)})}get pointsGroup(){return this._pointsGroup}_draw(e){br.drawWith(e,this)}static drawWith(e,t){let{pointsGroup:n}=t;n=n!=null?n:[[]],t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath();for(let s of n){e.moveTo(s[0].x,s[0].y);for(let r=1;r<s.length;r++){const i=s[r];e.lineTo(i.x,i.y)}}e.closePath(),this._renderPaintInOrder(e,t)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:t,top:n,width:s,height:r}=this._getSelfRect(),{width:i,height:a}=e;let l,c;i?l=this.width-i:l=0,a?c=this.height-a:c=0;const u=l/s,h=c/r;this.scaleX+=u,this.scaleY+=h,this.left=this.left-t*u,this.top=this.top-n*h,this._setTransForm()}toJson(){const e={};return jg.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:n,height:s}=this.getRect();return{left:e,top:t,width:n,height:s,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:s}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:s*this.scaleY}}_setFixBoundingBox(){const{width:e,height:t,left:n,top:s}=this._getSelfRect();this.left=this.left+n,this.top=this.top+s,this.width=e,this.height=t;const r=this.pointsGroup;for(let i of r)for(let a of i)a.x-=n,a.y-=s;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let t=e[0][0].x,n=e[0][0].x,s=e[0][0].y,r=e[0][0].y;for(let i of e)for(let a of i)t=Math.min(t,a.x),n=Math.max(n,a.x),s=Math.min(s,a.y),r=Math.max(r,a.y);return{left:t,top:s,width:n-t,height:r-s}}}const Bo=17;class Ni{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=lt(Io.black,.2),this._thumbHoverBackgroundColor=lt(Io.black,.35),this._thumbActiveBackgroundColor=lt(Io.black,.4),this._barSize=14,this._barBackgroundColor=lt(Io.white),this._barBorder=1,this._barBorderColor=lt([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}setProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{e[n]!==void 0&&(this[`_${n}`]=e[n])})}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Fe("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Fe("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Fe("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Fe("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Fe("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(n,s)=>(r,i)=>{if(this._isHorizonMove||this._isVerticalMove)return;s.setProps({fill:n}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(bt.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(bt.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(bt.PointerDown,(n,s)=>{const r=n;this._view.scrollTo({x:r.offsetX-this._view.left-this._horizontalThumbWidth/2}),s.stopPropagation()}),this._horizonThumbRect.on(bt.PointerDown,(n,s)=>{const r=n;this._isHorizonMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),e.disableEvent(),s.stopPropagation()}),e.on(bt.PointerMove,(n,s)=>{const r=n;!this._isHorizonMove||(this._view.scrollBy({x:r.offsetX-this._lastX}),this._lastX=r.offsetX)}),e.on(bt.PointerUp,(n,s)=>{const r=this._horizonThumbRect;this._isHorizonMove=!1,e.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})),this._enableVertical&&(this._verticalThumbRect.on(bt.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(bt.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(bt.PointerDown,(n,s)=>{const r=n;this._view.scrollTo({y:r.offsetY-this._view.top-this._verticalThumbHeight/2}),s.stopPropagation()}),this._verticalThumbRect.on(bt.PointerDown,(n,s)=>{const r=n,i=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,i.setProps({fill:this._thumbActiveBackgroundColor}),e.disableEvent(),this.makeViewDirty(!0),s.stopPropagation()}),e.on(bt.PointerMove,(n,s)=>{const r=n;!this._isVerticalMove||(this._view.scrollBy({y:r.offsetY-this._lastY}),this._lastY=r.offsetY)}),e.on(bt.PointerUp,(n,s)=>{const r=this._verticalThumbRect;this._isVerticalMove=!1,e.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))}render(e,t=0,n=0){let{scrollX:s,scrollY:r}=this._view;e.save();const a=new dt([1,0,0,1,t,n]).getMatrix();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(s).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,r).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,n=0,s=0){var r,i,a,l,c,u,h,d,g,m,_;e===0&&e===0||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<Bo&&(this._horizontalMinusMiniThumb=Bo-this._horizontalThumbWidth,this._horizontalThumbWidth=Bo),(r=this._horizonBarRect)==null||r.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?(i=this._horizonThumbRect)==null||i.setProps({visible:!1}):((a=this._horizonThumbRect)!=null&&a.visible||(l=this._horizonThumbRect)==null||l.setProps({visible:!0}),(c=this._horizonThumbRect)==null||c.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-this._thumbMargin*2}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/s*this._thumbLengthRatio,this._verticalThumbHeight<Bo&&(this._verticalMinusMiniThumb=Bo-this._verticalThumbHeight,this._verticalThumbHeight=Bo),(u=this._verticalBarRect)==null||u.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?(h=this._verticalThumbRect)==null||h.setProps({visible:!1}):((d=this._verticalThumbRect)!=null&&d.visible||(g=this._verticalThumbRect)==null||g.setProps({visible:!0}),(m=this._verticalThumbRect)==null||m.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-this._thumbMargin*2,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&((_=this._placeholderBarRect)==null||_.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}get ratioScrollX(){return this._horizontalThumbWidth===void 0||this._horizontalBarWidth===void 0?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return this._verticalThumbHeight===void 0||this._verticalBarHeight===void 0?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}makeDirty(e){var t,n,s,r,i;(t=this._horizonBarRect)==null||t.makeDirty(e),(n=this._horizonThumbRect)==null||n.makeDirty(e),(s=this._verticalBarRect)==null||s.makeDirty(e),(r=this._verticalThumbRect)==null||r.makeDirty(e),(i=this._placeholderBarRect)==null||i.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===ve.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,n,s,r;return(t=this._horizonThumbRect)!=null&&t.isHit(e)?this._horizonThumbRect:(n=this._verticalThumbRect)!=null&&n.isHit(e)?this._verticalThumbRect:(s=this._horizonBarRect)!=null&&s.isHit(e)?this._horizonBarRect:(r=this._verticalBarRect)!=null&&r.isHit(e)?this._verticalBarRect:null}}class ps extends _s{constructor(e){super(void 0,e),this._props={autoWidth:!1,autoHeight:!1,...e},e.image?(this._native=e.image,this._init()):e.url&&(this._native=document.createElement("img"),this._native.src=e.url,this._native.onload=()=>{var t;(t=e.success)==null||t.call(e),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{e.fail?e.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(e,t){if(t._native.complete){const{width:n,height:s}=t;try{e.drawImage(t._native,0,0,n,s)}catch(r){console.error(r)}}}static fromURL(e,t){return new ps({url:e,success:t})}_draw(e){ps.drawWith(e,this)}_init(){this._props.autoWidth&&this.resize(this._native.width,void 0),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const Kg=["dataArray"];class Gt extends _s{constructor(e,t){super(e,t),this.pathLength=0,this._reCalculateCache=!0,t!=null&&t.data?this._dataArray=Gt.parsePathData(t.data):t!=null&&t.dataArray&&(this._dataArray=t.dataArray);for(let n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:r,preValue:i}=n;if(s===st.resize||s===st.all){this._reCalculateCache=!0;const{left:a,top:l,width:c,height:u}=this._getSelfRect(),{width:h,height:d}=i;let g,m;h?g=this.width-h:g=0,d?m=this.height-d:m=0;const _=g/c,p=m/u;this.scaleX+=_,this.scaleY+=p,this.left=this.left-a*_,this.top=this.top-l*p,this._setTransForm()}})}get dataArray(){return this._dataArray}_draw(e){Gt.drawWith(e,this)}static drawWith(e,t){const n=t.dataArray;if(!!n){e.beginPath();for(let s=0;s<n.length;s++){let r=n[s].command,i=n[s].points;switch(r){case"L":e.lineTo(i[0],i[1]);break;case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":{const a=i[0],l=i[1],c=i[2],u=i[3],h=i[4],d=i[5],g=i[6],m=i[7],_=c>u?c:u,p=c>u?1:c/u,v=c>u?u/c:1;e.translate(a,l),e.rotate(g),e.scale(p,v),e.arc(0,0,_,h,h+d,!!(1-m)),e.scale(1/p,1/v),e.rotate(-g),e.translate(-a,-l);break}case"z":e.closePath();break}}this._renderPaintInOrder(e,t)}}_setFixBoundingBox(){const{left:e,top:t,width:n,height:s}=this._getSelfRect(),r=this.width/n,i=this.height/s;this.left=this.left-e*r,this.top=this.top-t*i,this.scaleX=r,this.scaleY=i,this.width=n,this.height=s,this._setTransForm()}toJson(){const e={};return Kg.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:n,height:s}=this.getRect();return{left:e,top:t,width:n,height:s,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:s}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:s*this.scaleY}}_getSelfRect(){if(!this._reCalculateCache)return this._selfRectCache;let e=[];this.dataArray.forEach(c=>{if(c.command==="A"){let u=c.points[4],h=c.points[5],d=c.points[4]+h,g=Math.PI/180;if(Math.abs(u-d)<g&&(g=Math.abs(u-d)),h<0)for(let m=u-g;m>d;m-=g){const _=Gt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],m,0);e.push(_.x,_.y)}else for(let m=u+g;m<d;m+=g){const _=Gt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],m,0);e.push(_.x,_.y)}}else if(c.command==="C")for(let u=0;u<=1;u+=.01){const h=Gt.getPointOnCubicBezier(u,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(h.x,h.y)}else e=e.concat(c.points)});let t=e[0],n=e[0],s=e[1],r=e[1],i,a;for(let c=0;c<e.length/2;c++)i=e[c*2],a=e[c*2+1],isNaN(i)||(t=Math.min(t,i),n=Math.max(n,i)),isNaN(a)||(s=Math.min(s,a),r=Math.max(r,a));const l={left:t,top:s,width:n-t,height:r-s};return this._selfRectCache=l,l}getLength(){return this.pathLength}getPointAtLength(e){let t,n=0,s=this.dataArray.length;if(!s)return null;for(;n<s&&e>this.dataArray[n].pathLength;)e-=this.dataArray[n].pathLength,++n;if(n===s)return t=this.dataArray[n-1].points.slice(-2),{x:t[0],y:t[1]};if(e<.01)return t=this.dataArray[n].points.slice(0,2),{x:t[0],y:t[1]};let r=this.dataArray[n],i=r.points;switch(r.command){case"L":return Gt.getPointOnLine(e,r.start.x,r.start.y,i[0],i[1]);case"C":return Gt.getPointOnCubicBezier(e/r.pathLength,r.start.x,r.start.y,i[0],i[1],i[2],i[3],i[4],i[5]);case"Q":return Gt.getPointOnQuadraticBezier(e/r.pathLength,r.start.x,r.start.y,i[0],i[1],i[2],i[3]);case"A":{let a=i[0],l=i[1],c=i[2],u=i[3],h=i[4],d=i[5],g=i[6];return h+=d*e/r.pathLength,Gt.getPointOnEllipticalArc(a,l,c,u,h,g)}}return null}static getLineLength(e,t,n,s){return Math.sqrt((n-e)*(n-e)+(s-t)*(s-t))}static getPointOnLine(e,t,n,s,r,i,a){i===void 0&&(i=t),a===void 0&&(a=n);let l=(r-n)/(s-t+1e-8),c=Math.sqrt(e*e/(1+l*l));s<t&&(c*=-1);let u=l*c,h;if(s===t)h={x:i,y:a+u};else if((a-n)/(i-t+1e-8)===l)h={x:i+c,y:a+u};else{let d,g,m=this.getLineLength(t,n,s,r),_=(i-t)*(s-t)+(a-n)*(r-n);_/=m*m,d=t+_*(s-t),g=n+_*(r-n);let p=this.getLineLength(i,a,d,g),v=Math.sqrt(e*e-p*p);c=Math.sqrt(v*v/(1+l*l)),s<t&&(c*=-1),u=l*c,h={x:d+c,y:g+u}}return h}static getPointOnCubicBezier(e,t,n,s,r,i,a,l,c){function u(p){return p*p*p}function h(p){return 3*p*p*(1-p)}function d(p){return 3*p*(1-p)*(1-p)}function g(p){return(1-p)*(1-p)*(1-p)}let m=l*u(e)+i*h(e)+s*d(e)+t*g(e),_=c*u(e)+a*h(e)+r*d(e)+n*g(e);return{x:m,y:_}}static getPointOnQuadraticBezier(e,t,n,s,r,i,a){function l(g){return g*g}function c(g){return 2*g*(1-g)}function u(g){return(1-g)*(1-g)}let h=i*l(e)+s*c(e)+t*u(e),d=a*l(e)+r*c(e)+n*u(e);return{x:h,y:d}}static getPointOnEllipticalArc(e,t,n,s,r,i){let a=Math.cos(i),l=Math.sin(i),c={x:n*Math.cos(r),y:s*Math.sin(r)};return{x:e+(c.x*a-c.y*l),y:t+(c.x*l+c.y*a)}}static parsePathData(e){if(!e)return[];let t=e,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let h=0,d=n.length;h<d;h++)t=t.replace(new RegExp(n[h],"g"),`|${n[h]}`);let s=t.split("|"),r=[],i=[],a=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u;for(let h=1,d=s.length;h<d;h++){let g=s[h],m=g.charAt(0);for(g=g.slice(1),i.length=0;u=c.exec(g);)i.push(u[0]);let _=[];for(let p=0,v=i.length;p<v;p++){if(i[p]==="00"){_.push(0,0);continue}let b=parseFloat(i[p]);isNaN(b)?_.push(0):_.push(b)}for(;_.length>0&&!isNaN(_[0]);){let p,v=[],b=a,C=l,D,O,F,S,E,w,I,P,L,y;switch(m){case"l":a+=_.shift()||0,l+=_.shift()||0,p="L",v.push(a,l);break;case"L":a=_.shift()||0,l=_.shift()||0,v.push(a,l);break;case"m":{let k=_.shift()||0,M=_.shift()||0;if(a+=k,l+=M,p="M",r.length>2&&r[r.length-1].command==="z"){for(let U=r.length-2;U>=0;U--)if(r[U].command==="M"){a=r[U].points[0]+k,l=r[U].points[1]+M;break}}v.push(a,l),m="l";break}case"M":a=_.shift()||0,l=_.shift()||0,p="M",v.push(a,l),m="L";break;case"h":a+=_.shift()||0,p="L",v.push(a,l);break;case"H":a=_.shift()||0,p="L",v.push(a,l);break;case"v":l+=_.shift()||0,p="L",v.push(a,l);break;case"V":l=_.shift()||0,p="L",v.push(a,l);break;case"C":v.push(_.shift()||0,_.shift()||0,_.shift()||0,_.shift()||0),a=_.shift()||0,l=_.shift()||0,v.push(a,l);break;case"c":v.push(a+(_.shift()||0),l+(_.shift()||0),a+(_.shift()||0),l+(_.shift()||0)),a+=_.shift()||0,l+=_.shift()||0,p="C",v.push(a,l);break;case"S":O=a,F=l,D=r[r.length-1],D.command==="C"&&(O=a+(a-D.points[2]),F=l+(l-D.points[3])),v.push(O,F,_.shift()||0,_.shift()||0),a=_.shift()||0,l=_.shift()||0,p="C",v.push(a,l);break;case"s":O=a,F=l,D=r[r.length-1],D.command==="C"&&(O=a+(a-D.points[2]),F=l+(l-D.points[3])),v.push(O,F,a+(_.shift()||0),l+(_.shift()||0)),a+=_.shift()||0,l+=_.shift()||0,p="C",v.push(a,l);break;case"Q":v.push(_.shift()||0,_.shift()||0),a=_.shift()||0,l=_.shift()||0,v.push(a,l);break;case"q":v.push(a+(_.shift()||0),l+(_.shift()||0)),a+=_.shift()||0,l+=_.shift()||0,p="Q",v.push(a,l);break;case"T":O=a,F=l,D=r[r.length-1],D.command==="Q"&&(O=a+(a-D.points[0]),F=l+(l-D.points[1])),a=_.shift()||0,l=_.shift()||0,p="Q",v.push(O,F,a,l);break;case"t":O=a,F=l,D=r[r.length-1],D.command==="Q"&&(O=a+(a-D.points[0]),F=l+(l-D.points[1])),a+=_.shift()||0,l+=_.shift()||0,p="Q",v.push(O,F,a,l);break;case"A":S=_.shift()||0,E=_.shift()||0,w=_.shift()||0,I=_.shift()||0,P=_.shift()||0,L=a,y=l,a=_.shift()||0,l=_.shift()||0,p="A",v=this.convertEndpointToCenterParameterization(L,y,a,l,I,P,S,E,w);break;case"a":S=_.shift()||0,E=_.shift()||0,w=_.shift()||0,I=_.shift()||0,P=_.shift()||0,L=a,y=l,a+=_.shift()||0,l+=_.shift()||0,p="A",v=this.convertEndpointToCenterParameterization(L,y,a,l,I,P,S,E,w);break}r.push({command:p||m,points:v,start:{x:b,y:C},pathLength:this.calcLength(b,C,p||m,v)})}(m==="z"||m==="Z")&&r.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return r}static calcLength(e,t,n,s){let r,i,a,l,c=Gt;switch(n){case"L":return c.getLineLength(e,t,s[0],s[1]);case"C":for(r=0,i=c.getPointOnCubicBezier(0,e,t,s[0],s[1],s[2],s[3],s[4],s[5]),l=.01;l<=1;l+=.01)a=c.getPointOnCubicBezier(l,e,t,s[0],s[1],s[2],s[3],s[4],s[5]),r+=c.getLineLength(i.x,i.y,a.x,a.y),i=a;return r;case"Q":for(r=0,i=c.getPointOnQuadraticBezier(0,e,t,s[0],s[1],s[2],s[3]),l=.01;l<=1;l+=.01)a=c.getPointOnQuadraticBezier(l,e,t,s[0],s[1],s[2],s[3]),r+=c.getLineLength(i.x,i.y,a.x,a.y),i=a;return r;case"A":{r=0;let u=s[4],h=s[5],d=s[4]+h,g=Math.PI/180;if(Math.abs(u-d)<g&&(g=Math.abs(u-d)),i=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],u,0),h<0)for(l=u-g;l>d;l-=g)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(i.x,i.y,a.x,a.y),i=a;else for(l=u+g;l<d;l+=g)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(i.x,i.y,a.x,a.y),i=a;return a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],d,0),r+=c.getLineLength(i.x,i.y,a.x,a.y),r}}return 0}static convertEndpointToCenterParameterization(e,t,n,s,r,i,a,l,c){let u=c*(Math.PI/180),h=Math.cos(u)*(e-n)/2+Math.sin(u)*(t-s)/2,d=-1*Math.sin(u)*(e-n)/2+Math.cos(u)*(t-s)/2,g=h*h/(a*a)+d*d/(l*l);g>1&&(a*=Math.sqrt(g),l*=Math.sqrt(g));let m=Math.sqrt((a*a*(l*l)-a*a*(d*d)-l*l*(h*h))/(a*a*(d*d)+l*l*(h*h)));r===i&&(m*=-1),isNaN(m)&&(m=0);let _=m*a*d/l,p=m*-l*h/a,v=(e+n)/2+Math.cos(u)*_-Math.sin(u)*p,b=(t+s)/2+Math.sin(u)*_+Math.cos(u)*p,C=I=>Math.sqrt(I[0]*I[0]+I[1]*I[1]),D=(I,P)=>(I[0]*P[0]+I[1]*P[1])/(C(I)*C(P)),O=(I,P)=>(I[0]*P[1]<I[1]*P[0]?-1:1)*Math.acos(D(I,P)),F=O([1,0],[(h-_)/a,(d-p)/l]),S=[(h-_)/a,(d-p)/l],E=[(-1*h-_)/a,(-1*d-p)/l],w=O(S,E);return D(S,E)<=-1&&(w=Math.PI),D(S,E)>=1&&(w=0),i===0&&w>0&&(w-=2*Math.PI),i===1&&w<0&&(w+=2*Math.PI),[v,b,a,l,F,w,u,i]}}const qg=["radius"];class Li extends _s{constructor(e,t){super(e,t),this._radius=(t==null?void 0:t.radius)||10,this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:r,preValue:i}=n;if(s===st.resize||s===st.all){const a=Math.min(this.width,this.height);this._radius=a/2,this.width=a,this.height=a,this._setTransForm()}})}get radius(){return this._radius}_setFixBoundingBox(){this.transformByState({width:this._radius*2,height:this._radius*2})}_draw(e){Li.drawWith(e,this)}static drawWith(e,t){let{radius:n}=t;n=n!=null?n:10,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath(),e.arc(n,n,n||0,0,Math.PI*2,!1),e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return qg.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}class Uu{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}_localeInitial(){if(!this._context)return;const e=this._context.getLocale(),t=e.getObject("renderFont");t||e.load({en:bg,zh:vg}),this._fontLocale=t}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}}class Wu{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return xo(e)}}const vs=cn.create(),Hu=cn.create(),$u=cn.create(),bs=cn.create();class Vu extends fs{constructor(){super(...arguments),this._extensions=new Map}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(ht),e}getExtensionByKey(e){return this._extensions.get(e)}get extensions(){return this._extensions}draw(e,t){}}function Zg(o,e,t,n,s=0,r=0,i=!1,a,l,c){const{lineHeight:u=15.6,lineTop:h=0,contentHeight:d=0,paddingLeft:g=0,paddingRight:m=0,paddingTop:_=0,paddingBottom:p=0,marginTop:v=0,spaceBelowApply:b=0}=t,C=sf(e,o);C.lineIndex=s,C.paragraphStart=Ui(r,i),C.contentHeight=d,C.top=h,C.lineHeight=u,C.paddingTop=_,C.paddingBottom=p,C.marginTop=v,C.spaceBelowApply=b,C.divides=Qg(u,h,n,g,m,a,l,c);for(let D of C.divides)D.parent=C;return C}function Jg(o=15.6,e=0,t=0,n,s,r){let i=e;return s==null||s.forEach(a=>{const l=Pi(a,o,e);l&&(i=Math.max(i,l))}),r==null||r.forEach(a=>{const l=Pi(a,o,e);l&&(i=Math.max(i,l))}),n==null||n.forEach(a=>{const l=Pi(a,o,e);l&&(i=Math.max(i,l))}),i}function Pi(o,e,t,n){const{aTop:s,height:r,aLeft:i,width:a,angle:l=0,drawingOrigin:c}=o,{layoutType:u,distT:h=0,distB:d=0}=c;if(u!==Bt.WRAP_TOP_AND_BOTTOM)return;if(l===0){const _=s-h,p=r+d;return _+p<t||_>e+t?void 0:_+r}let{top:g=0,height:m=0}=Xu(l,i,a,s,r);if(g-=h,m+=d,!(g+m<t||g>e+t))return g+m}function Qg(o,e,t,n,s,r,i,a){const l=[];return l.push({left:0,width:n},{left:t-s,width:s}),i==null||i.forEach((c,u)=>{const h=zi(c,o,e,t);h&&l.push(h)}),a==null||a.forEach((c,u)=>{const h=zi(c,o,e,t);h&&l.push(h)}),r==null||r.forEach((c,u)=>{const h=zi(c,o,e,t);h&&l.push(h)}),of(t,l)}function ef(o,e){o.isFull=e}function zi(o,e,t,n){const{aTop:s,height:r,aLeft:i,width:a,angle:l=0,drawingOrigin:c}=o,{layoutType:u}=c;if(u===Bt.WRAP_NONE||u===Bt.WRAP_TOP_AND_BOTTOM)return;if(u===Bt.WRAP_POLYGON){const{start:d=[0,0],lineTo:g}=c;if(!g)return;let m=[];m.push(new re(d[0],d[1]));for(let _=0;_<g.length;_++){const p=g[_];m.push(new re(p[0],p[1]))}if(l!==0){const _=new dt().rotate(l);for(let p=0;p<m.length;p++){const v=m[p];m[p]=_.applyPoint(v)}}return Yu(m,t,e,n)}if(l===0)return Gu(s,r,i,a,t,e,n,c);const h=Xu(l,i,a,s,r);if(u===Bt.WRAP_SQUARE){const{left:d,width:g,top:m,height:_}=h;return Gu(m,_,d,g,t,e,n,c)}return Yu(h.points,t,e,n)}function Xu(o,e,t,n,s){const r=new dt().rotate(o),i=new re(e,n),a=new re(e,n+s),l=new re(e+t,n),c=new re(e+t,n+s);return r.makeBoundingBoxFromPoints([i,a,l,c])}function Yu(o,e,t,n){const s=new Rg(o),r=s.intersection([new re(0,e),new re(n,e)]),i=s.intersection([new re(0,e+t),new re(n,e+t)]);if(!r&&!i)return;const a=tf([...o,...r||[],...i||[]]);return{left:a.min,width:a.max}}function tf(o,e=0){const t=[];for(let n=0;n<o.length;n++){const s=o[n];e===0?t.push(s.x):t.push(s.y)}return{max:Math.max(...t),min:Math.min(...t)}}function Gu(o,e,t,n,s,r,i,a){const{layoutType:l,wrapText:c=un.BOTH_SIDES,distL:u=0,distR:h=0,distT:d=0,distB:g=0}=a,m=o-(l===Bt.WRAP_SQUARE?d:0),_=e+(l===Bt.WRAP_SQUARE?g:0);if(m+_<s||m>r+s)return;let p=t-u,v=n+h,b=nf(c,p,v,i);return b===1?v=i-p:b===2&&(p=0,v=t+n+h),{left:p,width:v}}function nf(o,e,t,n){let s=0;return o===un.LEFT?s=1:o===un.RIGHT?s=2:o===un.LARGEST&&(e>n-e-t?s=1:s=2),s}function of(o,e){e.sort((r,i)=>r.left>i.left?1:-1);const t=[];let n=0;const s=e.length;for(let r=0;r<s;r++){const i=e[r],{left:a,width:l}=i;if(a>n){let c=a-n;c=c<o?c:o-n;const u=ju(n,c);t.push(u)}if(n=Math.max(a+l,n),r===s-1&&a+l<o){const c=ju(a+l,o-a-l);t.push(c)}}return t}function ju(o,e){return{spanGroup:[],width:e,left:o,paddingLeft:0,isFull:!1,st:0,ed:0}}function sf(o,e){return{blockId:e,type:o,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function Ui(o,e){return o===0&&e===!0}function rf(o,e,t,n){if(!!n)if(n.has(o)){const s=n.get(o);s==null||s.elements.push(e)}else n.set(o,{elements:[e],blockId:o,top:t})}function Ku(o=[],e=eo.NONE,t=0,n=0,s=1/0,r=1/0){const i=[];let a=0,l=0;if(o.length===0)i.push(qu(n,s,0,eo.NONE));else for(let u=0;u<o.length;u++){const{width:h,paddingEnd:d}=o[u];u===o.length-1?(a=s!==1/0?s-a:h,l=0):(l=d,a=h),i.push(qu(n,a,l,e)),n+=a+l}const c={columns:i,colCount:(o==null?void 0:o.length)||1,height:r,top:t,st:0,ed:0};return i.forEach(u=>{u.parent=c}),c}function Cr(o,e){o.isFull=e}function qu(o,e,t,n){return{lines:[],left:o,width:e,height:0,spaceWidth:t,separator:n,st:0,ed:0,drawingLRIds:[],isFull:!1}}function af(o,e,t,n){return t in Je?lf(o,e,t):Vg(o,e,t,n)}function lf(o,e,t){return t===Je.DECIMAL?Zu(o,e):t===Je.ZERO_DECIMAL?cf(o,e):t===Je.UPPER_ALPHA?uf(o,e):t===Je.ALPHA?hf(o,e):t===Je.UPPER_ROMAN?df(o,e):t===Je.ROMAN?gf(o,e):Zu(o,e)}function Zu(o,e){return(o+e).toString()}function cf(o,e){const t=o+e;return t<10?`0${t}`:t.toString()}function uf(o,e){return Ei(o+e-1,!0)}function hf(o,e){return Ei(o+e-1,!1)}function df(o,e){return Ju(o+e,!0)}function gf(o,e){return Ju(o+e,!1)}function Ju(o,e=!1){const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let s={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(s=t);let r="";for(let i in s)for(;o>=s[i];)r+=i,o-=s[i];return r}function ff(o,e,t,n,s){var h,d;if(!o||!e)return;const{listId:r,nestingLevel:i=0,textStyle:a}=o,l=e[r];return!l||!l.nestingLevel?Qu(r,(h=t==null?void 0:t[i])==null?void 0:h.startIndexItem,n):l.nestingLevel[i]?mf(r,i,l.nestingLevel,t,a,n,s):Qu(r,(d=t==null?void 0:t[i])==null?void 0:d.startIndexItem,n)}function Qu(o,e=1,t){return{listId:o,symbol:"\u25CF",ts:{ff:(t==null?void 0:t.fontList[0])||"Arial",fs:(t==null?void 0:t.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function mf(o,e,t,n,s,r,i){var F,S;const a=t[e],{bulletAlignment:l,glyphFormat:c,textStyle:u,startNumber:h,glyphType:d,glyphSymbol:g,indentFirstLine:m,hanging:_,indentStart:p}=a,v={...s,...u},b=ki(v,r);let C;g?C=g:C=_f(c,e,t,n,i);const D=Oo.getTextSize(C,b),O=(S=(F=n==null?void 0:n[e])==null?void 0:F.startIndexItem)!=null?S:1;return{listId:o,symbol:C,ts:v,fontStyle:b,startIndexItem:O+1,bBox:D,nestingLevel:a,bulletAlign:l,bulletType:g?!1:!!d,indentFirstLine:m,hanging:_,indentStart:p}}function _f(o,e,t,n,s){var l;const r=o.split("%"),a=[r[0]];for(let c=1;c<r.length;c++){const u=r[c],{level:h,suffix:d}=vf(u);let g=((l=n==null?void 0:n[h])==null?void 0:l.startIndexItem)||1;h!==e&&(n==null?void 0:n[h])!==null&&(g-=1);const m=pf(g,t[h],s);a.push(m,d)}return a.join("")}function pf(o=1,e,t){const{startNumber:n,glyphType:s,glyphSymbol:r}=e;return r||(s?af(o,n,s,t):"\u25CF")}function vf(o){if(o==="")return{level:0,suffix:""};const e=o.split("");let t="",n="",s=!1;const r=/[0-9]/g;return e.forEach(i=>{!s&&r.test(`${t}${i}`)?t+=i:(s=!0,n+=i)}),{level:parseInt(t)-1,suffix:n}}function bf(o,e,t,n,s,r){return[]}function Cf(o,e,t,n){if(Nu(o))return wf(o,e,t,n);if(Lu(o))return Sf(o,e,t,n);if(!Fu(o))return Ef(o,e,t,n)}function Ef(o,e,t,n){const{pageWidth:s=1/0}=n,r=$i(o,n),i=[r];let a=r.width,l=e;for(let c=e+1;c<t.length;c++){const u=t[c];if(Fu(u))break;{const h=$i(u,n),d=h.width;if(a+d>s)break;i.push(h),a+=d,l=c}}return{charIndex:l,spanGroup:i}}function wf(o,e,t,n){const s=[o];let r=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(Nu(a))s.unshift(a),r=i;else break}return{charIndex:r,spanGroup:[$i(s.join(""),n)]}}function Sf(o,e,t,n){const s=[o];let r=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(Lu(a))s.push(a),r=i;else break}return{charIndex:r,spanGroup:[ih(s.join(""),n)]}}function eh(o,e,t,n,s=0,r=!1){if(Ui(s,r))if(n.bulletSkeleton){const{bulletSkeleton:i,paragraphStyle:a={}}=n,{gridType:l=kt.LINES,charSpace:c=0,defaultTabStop:u=1}=t,{snapToGrid:h=Y.TRUE}=a,d=Yi(c,u,l,h);Mf(a,i,d);const g=Yf(o[0],i,d);Fo([g,...o],e,t,n,s,r)}else Fo(o,e,t,n,s,r);else Cs(o,e,t,n,s,r);return[...e]}function Cs(o,e,t,n,s=0,r=!1,i){var c,u;const a=No(e),l=Qf(a);if(l){const h=Df(o),d=l.divide,g=(c=d==null?void 0:d.spanGroup)==null?void 0:c[d.spanGroup.length-1],m=(g==null?void 0:g.width)||0,_=(g==null?void 0:g.left)||0,p=Zf(a);if(m+_+h>d.width){ef(d,!0);const v=Jf(d);h>p?t3(a)?(d.spanGroup.push(...o),Rf((u=v==null?void 0:v.parent)==null?void 0:u.columns)):Hi(o,e,t,n,s,r,i):v&&h>v.width?(Cr(v,!0),ah(v)?d.spanGroup.push(...o):Wi(o,e,t,n,s,r,i)):l.isLast?Fo(o,e,t,n,s,r,i):Cs(o,e,t,n,s,r,i)}else{const v=d.parent,b=Of(o);if(v&&b){const{paragraphLineGapDefault:C,linePitch:D,lineSpacing:O,spacingRule:F,snapToGrid:S,gridType:E}=ch(t,n),{boundingBoxAscent:w,boundingBoxDescent:I}=b,P=w+I,{contentHeight:L}=th(P,C,D,E,O,F,S);if(v.contentHeight<L){const y=xf(v),k=y.length;let M=[],U=1;y[0].spanType===Zt.LIST&&k>2?(M=[y[0],y[1]],U=2):M=[y[0]];const z=v.parent;z==null||z.lines.pop(),Fo(M,e,t,n,s,r,w+I);for(let K=U;K<y.length;K++)Cs([y[K]],e,t,n,s,r);Cs(o,e,t,n,s,r);return}}Gf(o,m+_);for(let C of o)C.parent=d;d.spanGroup.push(...o)}}else Fo(o,e,t,n,s,r,i)}function Fo(o,e,t,n,s=0,r=!1,i){var De,Oe,T,x,Ae;let a=No(e),l=wr(a);(!l||!l.column)&&(Hi(o,e,t,n,s),a=No(e),l=wr(a));const c=l.column,u=qf(c),{ba:h,bd:d}=o[0].bBox,g=i||h+d,{paragraphStyle:m={},paragraphAffectSkeDrawings:_,skeHeaders:p,skeFooters:v,blockAnchor:b,blockId:C}=n,{namedStyleType:D=dr.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:O=ze.UNSPECIFIED,direction:F,spaceAbove:S=0,spaceBelow:E=0,borderBetween:w,borderTop:I,borderBottom:P,borderLeft:L,borderRight:y,indentFirstLine:k=0,hanging:M=0,indentStart:U=0,indentEnd:z=0,tabStops:K=[],keepLines:j=Y.FALSE,keepNext:q=Y.FALSE,wordWrap:se=Y.FALSE,widowControl:le=Y.FALSE,shading:Te}=m,{paragraphLineGapDefault:pe,linePitch:oe,lineSpacing:ie,spacingRule:de,snapToGrid:Ne,gridType:Ce}=ch(t,n),Ie=Ui(s,r),{paddingTop:Le,paddingBottom:Ve,contentHeight:it,lineSpacingApply:Ze}=th(g,pe,oe,Ce,ie,de,Ne),{marginTop:Dt,spaceBelowApply:sn}=Tf(Ze,S,E,Ie,u),et=Dt+Le+it+Ve;let Nt=c.parent;Nt||(Nt=Er(a));const $t=(u==null?void 0:u.lineHeight)||0,pn=(u==null?void 0:u.top)||0,Ot=$t+pn,{width:rn,headerId:Vt,footerId:N}=a,W=(Oe=(De=p==null?void 0:p.get(Vt))==null?void 0:De.get(rn))==null?void 0:Oe.skeDrawings,X=(x=(T=v==null?void 0:v.get(N))==null?void 0:T.get(rn))==null?void 0:x.skeDrawings;Af(Ot,et,c,(Ae=b==null?void 0:b.get(C))==null?void 0:Ae.top,_);const J=Jg(et,Ot,s,a.skeDrawings,W,X);if(et+J>Nt.height&&c.lines.length>0&&a.sections.length>1){Cr(c,!0),Wi(o,e,t,n,s,r,i);return}const ue=u?u.lineIndex+1:0,{charSpace:Xe,defaultTabStop:Ee}=o3(t,n),we=Yi(Xe,Ee,Ce,Ne),{paddingLeft:$,paddingRight:he,changeBulletWidth:te}=yf(o[0],k,M,U,z,we);te.state&&(o[0].width=te.hangingNumber);const be=Zg(C,fr.PARAGRAPH,{lineHeight:et,contentHeight:it,lineTop:J,paddingLeft:$,paddingRight:he,paddingTop:Le,paddingBottom:Ve,marginTop:Dt,spaceBelowApply:sn},c.width,ue,s,r,a.skeDrawings,W,X);c.lines.push(be),be.parent=c,rf(C,u,Ot,b),Cs(o,e,t,n,s,r,i)}function Wi(o,e,t,n,s=0,r=!1,i){const a=No(e);e3(a)===!0?Hi(o,e,t,n,s,r,i):Fo(o,e,t,n,s,r,i)}function Hi(o,e,t,n,s=0,r=!1,i){const a=No(e),{skeHeaders:l,skeFooters:c}=n;e.push(Es(t,{skeHeaders:l,skeFooters:c},a==null?void 0:a.pageNumber)),Wi(o,e,t,n,s,r,i)}function yf(o,e=0,t=0,n=0,s=0,r){const{spanType:i=Zt.LETTER,bBox:a}=o;let l=Pn(e,r),c=Pn(t,r),u=Pn(n,r),h=Pn(s,r),d=u,g=h,m={state:!1,hangingNumber:0};if(i===Zt.LIST){const{width:_}=a;l>0?d+=l:c>0&&c>_&&(m.state=!0,m.hangingNumber=c)}else d+=c;return{paddingLeft:d,paddingRight:g,changeBulletWidth:m}}function Tf(o=0,e=0,t=0,n,s){let r=0,i=0;if(!n)return{marginTop:r,spaceBelowApply:i};if(r=Pn(e,o),i=Pn(t,o),s){const{spaceBelowApply:a}=s;a>r&&(r=0,s.lineHeight+=a,s.marginBottom=a)}return{marginTop:r,spaceBelowApply:i}}function Rf(o=[]){for(let e=0;e<o.length;e++){const t=o[e];Cr(t,!0)}}function th(o,e,t,n,s,r,i){let a=e,l=e;if(n===kt.DEFAULT||i===Y.FALSE)return r===Ro.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:s*o,lineSpacingApply:o}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(s,o),lineSpacingApply:s};let c=0;return r===Ro.AUTO?c=s*t:c=s,o+e*2<c&&(a=l=(c-o)/2),{paddingTop:a,paddingBottom:l,contentHeight:o,lineSpacingApply:c}}function Af(o,e,t,n,s){var l;if(!s)return;const r=(l=t.parent)==null?void 0:l.parent;if(!r)return;const i=new Map,a=If(t);s.forEach(c=>{if(!c)return;const{initialState:u,drawingOrigin:h}=c;if(u||!h)return;const{objectProperties:d}=h,{positionH:g,positionV:m,size:_,angle:p}=d,{width:v=0,height:b=0}=_;c.aLeft=a3(g,t,r,v,a)||0,c.aTop=l3(m,r,o,e,b,n,a)||0,c.width=v,c.height=b,c.angle=p,c.initialState=!0,i.set(c.objectId,c)}),r.skeDrawings=new Map([...r.skeDrawings,...i])}function If(o){const e=o.parent;if(!e)return!1;const t=e==null?void 0:e.columns;if(!t)return!1;const n=t.length;for(let s=n-1;s>=0;s--){const i=t[s].lines,a=i.length;if(!(a<=0)){for(let l=a-1;l>=0;l--)if(i[l].paragraphStart)return!1}}return!0}function Df(o){const e=o.length;let t=0;for(let n=0;n<e;n++)t+=o[n].width;return t}function Of(o){const e=o.length;let t=-1/0,n;for(let s=0;s<e;s++){const r=o[s],{ba:i,bd:a}=r.bBox;t<i+a&&(n={boundingBoxAscent:i,boundingBoxDescent:a}),t=i+a}return n}function xf(o){const e=o.divides,t=e.length,n=[];for(let s=0;s<t;s++){const r=e[s];n.push(...r.spanGroup)}return n}function Mf(o,e,t){const{hanging:n,indentStart:s}=o,{hanging:r,indentStart:i}=e;n===void 0&&(o.hanging=r),s===void 0&&(o.indentStart=Pn(i||0,t)-Pn(r||0,t))}function kf(o,e,t,n,s,r){const{pageNumberStart:i,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:c=0,columnProperties:u=[],columnSeparatorType:h=eo.NONE,contentDirection:d,sectionType:g,sectionTypeNext:m,textDirection:_,lists:p,drawings:v={},fontLocale:b}=n,{elements:C,elementOrder:D,paragraphStyle:O={},bullet:F}=e,{skeHeaders:S,skeFooters:E,skeListLevel:w,blockAnchor:I}=s,P={blockId:o,paragraphStyle:O,skeHeaders:S,skeFooters:E,blockAnchor:I},L=[t];let y=t;const k=new Map,M=Bf(F,w),U=ff(F,p,M,b,r);return Ff(F,U,w),P.bulletSkeleton=U,D.forEach((z,K)=>{const{elementId:j,paragraphElementType:q}=z;let se=[];if(q===H.TEXT_RUN){const le=C[j],{tr:Te,st:pe,ed:oe}=le;if(!Te)return!1;se=Pf(Te,K,n,y,{...P,paragraphAffectSkeDrawings:k},b)}else if(q===H.DRAWING){const le=v[j];le.layoutType===Bt.INLINE?se=bf():k.set(j,Nf(le))}else if(q===H.PAGE_BREAK)se=[Es(n,s,nh(y),hs.PAGE)],k.clear();else if(q===H.COLUMN_BREAK){const le=wr(y);le&&!le.isLast?Cr(le.column,!0):se=[Es(n,s,nh(y),hs.COLUMN)]}y=Lf(L,se)}),L}function Bf(o,e){if(!o||!e)return;const{listId:t,nestingLevel:n}=o,s=e==null?void 0:e.get(t);let r=n;r<0&&(r=0);const i=[];for(let a=r;a>=0;a--){const l=s==null?void 0:s[a];i[a]=l||null}return i}function Ff(o,e,t){if(!o||!e)return;const{listId:n,nestingLevel:s}=o,r=[...(t==null?void 0:t.get(n))||[]];r[s]=e,r.splice(s+1),t==null||t.set(n,r)}function Nf(o){return{objectId:o.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:o}}function Lf(o,e){const t=o.slice(-1)[0],n=e[0];if(t===n){if(e.length===1)return t;e.unshift()}return o.push(...e),o.slice(-1)[0]}function nh(o){return o.pageNumber+1}function Pf(o,e=0,t,n,s,r){const{ct:i="",ts:a={},tab:l=!1}=o,c=ki(a,r),{paragraphStyle:u={}}=s,{gridType:h=kt.LINES,charSpace:d=0,documentTextStyle:g={},defaultTabStop:m=10.5,pageSize:_={width:1/0,height:1/0},marginLeft:p=0,marginRight:v=0}=t,{namedStyleType:b=dr.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:C=ze.UNSPECIFIED,lineSpacing:D=1,spacingRule:O=Ro.AUTO,snapToGrid:F=Y.TRUE,direction:S,spaceAbove:E=0,spaceBelow:w=0,borderBetween:I,borderTop:P,borderBottom:L,borderLeft:y,borderRight:k,indentFirstLine:M=0,hanging:U=0,indentStart:z=0,indentEnd:K=0,tabStops:j=[],keepLines:q=Y.FALSE,keepNext:se=Y.FALSE,wordWrap:le=Y.FALSE,widowControl:Te=Y.FALSE,shading:pe}=u;let oe=[n];const ie=_.width||1/0-p-v,de={...g,...a},Ne={fontStyle:c,textStyle:de,charSpace:d,gridType:h,snapToGrid:F,pageWidth:ie};if(l){const Ie=Yi(d,m,h,F),Le=Xf(Ne,Ie);return oe=eh([Le],oe,t,s,e,!0),oe}const Ce=i.split("");for(let Ie=0;Ie<Ce.length;Ie++){const Le=Ce[Ie],Ve=Cf(Le,Ie,Ce,Ne);let it=[];if(Ve){const{charIndex:Ze,spanGroup:Dt}=Ve;Ie=Ze,it=Dt}else{const Ze=ih(Le,Ne);it.push(Ze)}oe=eh(it,oe,t,s,e,Ie===0)}return r3(oe,Ie=>{zf(Ie,C)}),oe}function zf(o,e){if(e===ze.UNSPECIFIED||e===ze.LEFT)return;const{divides:t}=o,n=t.length;for(let s=0;s<n;s++){const r=t[s],{width:i,spanGroup:a}=r,l=c3(r);i!==1/0&&(e===ze.CENTER?r.paddingLeft=(i-l)/2:e===ze.RIGHT?r.paddingLeft=i-l:ze.JUSTIFIED)}}function Uf(){return[]}function oh(o,e,t,n,s,r){const i=[],a=new Map;for(let l of o){const{paragraph:c,table:u,tableOfContents:h,blockType:d,customBlock:g,blockId:m}=l;if(s!=null&&s.get(m))continue;let _=[],p=e;i.length>0&&(p=i[i.length-1]),d===ke.PARAGRAPH&&c?_=kf(l.blockId,c,p,t,n,r):d===ke.TABLE&&u||d===ke.SECTION_BREAK&&h||d===ke.CUSTOM&&(_=$g(l.blockId,g,p,t,n,r)),_.length===0&&(_=Uf()),s3(_),Wf(i,_),a.set(m,!0)}return{pages:i,renderedBlockIdMap:a}}function Wf(o,e){const t=o[o.length-1],n=e[0];t===n&&e.splice(0,1),o.push(...e)}function Es(o,e,t=1,n=hs.SECTION){var Le,Ve,it,Ze;const s=Hf(),{pageNumberStart:r=1,pageSize:i={width:1/0,height:1/0},pageOrient:a=us.PORTRAIT,headerIds:l={},footerIds:c={},useFirstPageHeaderFooter:u,useEvenPageHeaderFooter:h,footers:d,headers:g,columnProperties:m=[],columnSeparatorType:_,marginTop:p=0,marginBottom:v=0,marginHeader:b=0,marginFooter:C=0,marginLeft:D=0,marginRight:O=0,renderConfig:F={}}=o,{skeHeaders:S,skeFooters:E}=e,{width:w=1/0,height:I=1/0}=i;s.pageNumber=t,s.pageNumberStart=r,s.renderConfig=F,s.marginLeft=D,s.marginRight=O,s.breakType=n,s.width=s.pageWidth=w,s.height=s.pageHeight=I,s.pageOrient=a;const{defaultHeaderId:P,evenPageHeaderId:L,firstPageHeaderId:y}=l,{defaultFooterId:k,evenPageFooterId:M,firstPageFooterId:U}=c;let z=P!=null?P:"",K=k!=null?k:"";t===r&&u?(z=y!=null?y:"",K=U!=null?U:""):t%2===0&&h&&(z=L!=null?L:"",K=M!=null?M:"");let j,q;z&&((Le=S.get(z))!=null&&Le.has(w)?j=(Ve=S.get(z))==null?void 0:Ve.get(w):g&&(j=sh(g[z],o,e),S.set(z,new Map([[w,j]]))),s.headerId=z),K&&((it=E.get(K))!=null&&it.has(w)?q=(Ze=E.get(K))==null?void 0:Ze.get(w):d&&(q=sh(d[K],o,e),E.set(z,new Map([[w,q]]))),s.footerId=K),s.marginTop=rh(p,b,j),s.marginBottom=rh(v,C,q);const se=s.sections,le=se[se.length-1],{marginTop:Te,marginBottom:pe,marginLeft:oe,marginRight:ie}=s,de=w-oe-ie,Ne=I-Te-pe;let Ce=0;le&&(Ce=le.top+le.height);const Ie=Ku(m,_,Ce,0,de,Ne-Ce);return Ie.parent=s,se.push(Ie),s}function Hf(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:us.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:hs.SECTION,st:0,ed:0,skeDrawings:new Map}}function sh(o,e,t,n=!0){const{body:s}=o,{lists:r,headers:i,footers:a,fontLocale:l,pageSize:c,marginLeft:u=0,marginRight:h=0,drawings:d,marginTop:g=0,marginBottom:m=0,marginHeader:_=0,marginFooter:p=0}=e,v=(c==null?void 0:c.width)||1/0,b={lists:r,headers:i,footers:a,pageSize:{width:v-u-h,height:1/0},fontLocale:l,drawings:d},{blockElements:C,blockElementOrder:D}=s,O=[];D.forEach(k=>{const M=C[k];O.push(M)});const F=Es(b,t),S=oh(O,F,b,t)[0],E=S.sections[0].columns[0],w=E.height||0,{skeDrawings:I,st:P,ed:L}=S,y={lines:E.lines,skeDrawings:I,height:w,st:P,ed:L,marginLeft:u,marginRight:h};return n?{...y,marginTop:$f(g,_,w)}:{...y,marginBottom:Vf(m,p,w)}}function rh(o,e,t){return!t||t.lines.length===0?o:Math.max(o,e,(t==null?void 0:t.height)||0)}function $f(o,e,t){const n=Math.max(o,e);return t>n?0:n-t}function Vf(o,e,t){const n=Math.max(o,e);return t>n?0:n-t}function ih(o,e,t){return Vi(Zt.WORD,o,e,t)}function $i(o,e,t){return Vi(Zt.LETTER,o,e,t)}function Xf(o,e){return Vi(Zt.TAB," ",o,e)}function Vi(o,e,t,n){const{fontStyle:s,textStyle:r,charSpace:i=1,gridType:a=kt.LINES,snapToGrid:l=Y.FALSE}=t,c=Oo.getTextSize(e,s),{width:u=0}=c;let h=n!=null?n:u,d=0;return lh(a,l)&&(h=Math.ceil(u/i)*i,a===kt.LINES_AND_CHARS&&(d=(h-u)/2)),{content:e,ts:r,fontStyle:s,width:h,bBox:c,paddingLeft:d,left:0,spanType:o}}function Yf(o,e,t){const{bBox:n,symbol:s,ts:r,fontStyle:i,bulletAlign:a=Pe.START,bulletType:l=!1}=e,c=n.width,u=Math.ceil(c/t);let h=(u<2?2:u)*t,d=0;l&&(a===Pe.CENTER?(d=-c/2,h-=d):a===Pe.END&&(d=-c,h-=d));const g=jf(o,e);return{content:s,ts:r,fontStyle:i,width:h,paddingLeft:0,bBox:g,left:d,spanType:Zt.LIST}}function Gf(o,e=0){const t=o.length;let n;for(let s=0;s<t;s++){const r=o[s];r.left=n?n.left+n.width:e,n=r}}function jf(o,e){const{ba:t,bd:n}=o.bBox,{ba:s,bd:r}=e.bBox;return t+n>s+r?o.bBox:e.bBox}class Xi{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,t=0){this._translateX=e,this._translateY=t}translate(e=0,t=0){this._translateX+=e,this._translateY+=t}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:r=0}=e;this.translate(s,t)}restorePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:r=0}=e;this.translate(-s,-t)}translatePage(e,t=wn.VERTICAL,n=0,s=0,r=0,i=0){const{sections:a,marginTop:l=0,marginBottom:c=0,marginLeft:u=0,marginRight:h=0,width:d,height:g,pageNumber:m=1,renderConfig:_={}}=e;let p=0,v=0;return t===wn.VERTICAL?p=g+s:t===wn.HORIZONTAL&&(v=d+n),this.translate(v,p),{x:v,y:p}}translateSection(e){const{top:t=0}=e;return this.translate(0,t),{x:0,y:t}}translateColumn(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}translateLine(e){const{top:t,marginBottom:n=0,marginTop:s=0,paddingTop:r=0,paddingBottom:i=0}=e,a=t+s+r;return this.translate(0,a),{x:0,y:a}}translateDivide(e){const{left:t,paddingLeft:n}=e,s=t+n;return this.translate(s,0),{x:s,y:0}}translateSpan(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}}function No(o){return o==null?void 0:o[o.length-1]}function Er(o){var e;return(e=o==null?void 0:o.sections)==null?void 0:e[o.sections.length-1]}function Kf(o){var t;const e=(t=wr(o))==null?void 0:t.column.lines;return e==null?void 0:e[e.length-1]}function qf(o){return o.lines[o.lines.length-1]}function Zf(o){const{width:e,marginLeft:t,marginRight:n}=o;return e-t-n}function Jf(o){var t;const e=(t=o.parent)==null?void 0:t.parent;if(e)return e}function wr(o){const e=Er(o);for(let t=0;t<e.columns.length;t++){const n=e.columns[t];if(!n.isFull)return{column:n,isLast:t===e.columns.length-1,index:t}}}function Qf(o){const e=Kf(o);if(!!e)for(let t=0;t<e.divides.length;t++){const n=e.divides[t];if(!n.isFull)return{divide:n,isLast:t===e.divides.length-1,index:t}}}function e3(o){const e=Er(o),t=e.columns.length;for(let n=0;n<t;n++)if(!e.columns[n].isFull)return!1;return!0}function t3(o){if(o.sections.length>1)return!1;const e=Er(o),t=e.columns.length;for(let n=0;n<t;n++){const s=e.columns[n];if(!ah(s))return!1}return!0}function ah(o){const e=o.lines;if(e.length>1)return!1;const t=e[e.length-1];return n3(t)}function n3(o){if(!o)return!0;for(let e=0;e<o.divides.length;e++){const t=o.divides[e].spanGroup.length;if(t>1)return!1;if(t===1){const n=o.divides[e].spanGroup[0],{spanType:s}=n;if(s!==Zt.TAB&&s!==Zt.LIST)return!1}}return!0}function Pn(o,e){if(o instanceof Object){const{v:t,u:n}=o;return n===Ai.POINT?t:t*e}return o}function Yi(o=0,e,t=kt.LINES,n=Y.TRUE){let s=1;return lh(t,n)&&(s=o),s*=e,s}function lh(o=kt.LINES,e=Y.FALSE){return e===Y.TRUE&&(o===kt.LINES_AND_CHARS||o===kt.SNAP_TO_CHARS)}function ch(o,e){const{paragraphStyle:t={}}=e,{linePitch:n=15.6,gridType:s=kt.LINES,paragraphLineGapDefault:r=0}=o,{lineSpacing:i=1,spacingRule:a=Ro.AUTO,snapToGrid:l=Y.TRUE}=t;return{paragraphLineGapDefault:r,linePitch:n,gridType:s,lineSpacing:i,spacingRule:a,snapToGrid:l}}function o3(o,e){const{paragraphStyle:t={}}=e,{charSpace:n=0,gridType:s=kt.LINES,defaultTabStop:r=36,documentTextStyle:i={}}=o,{fs:a=wg}=i,{snapToGrid:l=Y.TRUE}=t;return{charSpace:n,documentFontSize:a,defaultTabStop:r,gridType:s,snapToGrid:l}}function s3(o){const e=o[0],{st:t}=e;let n=t;for(let s of o){const{sections:r}=s;let i=n,a=i,l=0,c=-1/0,u=0;for(let h of r){const{columns:d}=h;let g=l,m=i,_=0,p=-1/0;for(let v of d){const{lines:b}=v;let C=_,D=C,O=0,F=0,S=-1/0,E=null;for(let w of b){const{divides:I,lineHeight:P}=w;let L=O,y=L,k=0,M=0,U=0;F+=P;const z=I.length;for(let K=0;K<z;K++){const j=I[K],{spanGroup:q}=j;let se=k,le=se;for(let Te of q){const pe=Te.spanType===Zt.LIST?0:Te.count||1;a+=pe,m+=pe,D+=pe,y+=pe,le+=pe;const oe=Te.bBox,{ba:ie}=oe;U=Math.max(U,ie),K===z-1&&j.width===1/0&&(M+=Te.width)}K===z-1&&(j.width===1/0?j.width=M:M+=j.width,M+=j.left),j.st=se,j.ed=le}w.st=L,w.ed=y,w.width=M,w.asc=U,S=Math.max(S,M),w.top=((E==null?void 0:E.top)||0)+((E==null?void 0:E.lineHeight)||0),E=w}v.st=C,v.ed=D,v.height=F,v.width===1/0&&(v.width=S),c=Math.max(c,S),p=Math.max(p,v.height)}h.st=g,h.ed=m,h.height=p,u+=p}s.st=i,s.ed=a,s.height=u,s.width=c,n=a}}function r3(o,e){for(let t of o){const{sections:n}=t;for(let s of n){const{columns:r}=s;for(let i of r){const{lines:a}=i;for(let l of a)e&&ku(e)&&e(l)}}}}function i3(o,e){for(let t of o){const{sections:n}=t;for(let s of n){const{columns:r}=s;for(let i of r)e&&ku(e)&&e(i)}}}function a3(o,e,t,n,s=!1){const{relativeFrom:r,align:i,posOffset:a,percent:l}=o;if(i!=null)if(i===Cn.INSIDE||i===Cn.OUTSIDE)r===Ue.MARGIN||Ue.PAGE;else{if(r===Ue.COLUMN){const{width:c,left:u}=e;let h=0;return i===Cn.LEFT?h=u:i===Cn.RIGHT?h=u+c-n:i===Cn.CENTER&&(h=u+c/2-n/2),h}if(r!==Ue.LEFT_MARGIN){if(r!==Ue.MARGIN){if(r!==Ue.RIGHT_MARGIN){if(r!==Ue.INSIDE_MARGIN){if(r!==Ue.OUTSIDE_MARGIN){if(r===Ue.PAGE){const{width:c}=t;let u=0;return i===Cn.RIGHT?u=c-n:i===Cn.CENTER&&(u=c/2-n/2),u}}}}}}}else if(a){const{width:c,marginLeft:u,marginRight:h}=t,d=c-h;let g=0;return r===Ue.COLUMN?g=(s?0:(e==null?void 0:e.left)||0)+a:r===Ue.LEFT_MARGIN||(r===Ue.MARGIN?g=a+u:r===Ue.RIGHT_MARGIN||r===Ue.INSIDE_MARGIN||r===Ue.OUTSIDE_MARGIN||r===Ue.PAGE&&(g=a)),g+n>d&&(g=d-n),g}else if(l){const{width:c,marginLeft:u,marginRight:h}=t;if(r!==Ue.LEFT_MARGIN){if(r!==Ue.MARGIN){if(r!==Ue.RIGHT_MARGIN){if(r!==Ue.INSIDE_MARGIN){if(r!==Ue.OUTSIDE_MARGIN){if(r===Ue.PAGE)return l*c}}}}}}}function l3(o,e,t,n,s,r,i=!1){const{relativeFrom:a,align:l,posOffset:c,percent:u}=o;if(l!=null){if(a===$e.LINE){let h=0;return l===to.BOTTOM?h=t+n-s:l===to.TOP?h=t:l===to.CENTER&&(h=t+n/2-s/2),h}if(a!==$e.TOP_MARGIN){if(a!==$e.MARGIN){if(a!==$e.BOTTOM_MARGIN){if(a!==$e.INSIDE_MARGIN){if(a!==$e.OUTSIDE_MARGIN){if(a===$e.PAGE){const{height:h}=e;let d=0;return l===to.BOTTOM?d=h-s:l===to.CENTER&&(d=h/2-s/2),d}}}}}}}else if(c){let h=0;return a===$e.LINE?h=t||0+c:a===$e.TOP_MARGIN||a===$e.MARGIN||a===$e.BOTTOM_MARGIN||a===$e.INSIDE_MARGIN||a===$e.OUTSIDE_MARGIN||(a===$e.PAGE?h=c:a===$e.PARAGRAPH&&(h=(i?0:r||t)+c)),h}else if(u){const{height:h,marginBottom:d,marginTop:g}=e;if(a!==$e.TOP_MARGIN){if(a!==$e.MARGIN){if(a!==$e.BOTTOM_MARGIN){if(a!==$e.INSIDE_MARGIN){if(a!==$e.OUTSIDE_MARGIN){if(a===$e.PAGE)return u*h}}}}}}}function c3(o){const e=o.spanGroup;let t=0;for(let n of e)t+=n.width;return t}class Lo extends Uu{constructor(e,t){super(t),this._renderedBlockIdMap=new Map,this.onRecalculateChangeObservable=new ae,this._documentData=e}updateDrawing(e,t){const n=this._documentData.drawings;if(!n)return;const s=n[e];if(!s)return;const r=s.objectProperties;r.size.width=t.width,r.size.height=t.height,r.positionH.posOffset=t.left,r.positionV.posOffset=t.top}calculate(e){!this.dirty||(this._skeletonData=this._createSkeleton(e),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(e,t){const n=this._documentData.documentStyle;if(!n.pageSize){e=e!=null?e:1/0,t=t!=null?t:1/0,n.pageSize={width:e,height:t};return}e!==void 0&&(n.pageSize.width=e),t!==void 0&&(n.pageSize.height=t)}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t,blockElementOrder:n}=e;if(!t||n.length===0)return[];const s=[];let r={blockElements:[],sectionBreak:void 0};return n.forEach(i=>{const a=t[i],{sectionBreak:l}=a;l?(r.sectionBreak=l,s.push(r),r={blockElements:[],sectionBreak:void 0}):r.blockElements.push(a)}),r.sectionBreak||(r.sectionBreak={columnProperties:[],columnSeparatorType:eo.NONE,sectionType:cs.SECTION_TYPE_UNSPECIFIED},s.push(r)),s}_createSkeleton(e){var ie;const t=this.__getContentMapArr(),n={width:1/0,height:1/0},{documentStyle:s,footers:r,headers:i,lists:a,drawings:l}=this._documentData,{pageNumberStart:c=1,pageSize:u=n,pageOrient:h=us.PORTRAIT,defaultHeaderId:d,defaultFooterId:g,evenPageHeaderId:m,evenPageFooterId:_,firstPageHeaderId:p,firstPageFooterId:v,useFirstPageHeaderFooter:b,useEvenPageHeaderFooter:C,marginTop:D=0,marginBottom:O=0,marginRight:F=0,marginLeft:S=0,marginHeader:E=0,marginFooter:w=0,charSpace:I=0,linePitch:P=15.6,gridType:L=kt.LINES,paragraphLineGapDefault:y=0,defaultTabStop:k=10.5,textStyle:M={fs:14},renderConfig:U={horizontalAlign:ze.UNSPECIFIED,verticalAlign:St.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:at.UNSPECIFIED}}=s,z=this.__getNullSke();if(t.length===0)return z;const K=this.getFontLocale(),j={footers:r,headers:i,lists:a,drawings:l,charSpace:I,linePitch:P,gridType:L,fontLocale:K,paragraphLineGapDefault:y,defaultTabStop:k,documentTextStyle:M},{skeHeaders:q,skeFooters:se,skeListLevel:le,blockAnchor:Te}=z,pe={skeHeaders:q,skeFooters:se,skeListLevel:le,blockAnchor:Te},oe=[];z.pages=oe;for(let de=0;de<t.length;de++){const Ne=t[de];if(!Ne.sectionBreak)continue;const{pageNumberStart:Ce=c,pageSize:Ie=u,pageOrient:Le=h,marginTop:Ve=D,marginBottom:it=O,marginRight:Ze=F,marginLeft:Dt=S,marginHeader:sn=E,marginFooter:et=w,defaultHeaderId:Nt=d,defaultFooterId:$t=g,evenPageHeaderId:pn=m,evenPageFooterId:Ot=_,firstPageHeaderId:rn=p,firstPageFooterId:Vt=v,useFirstPageHeaderFooter:N=b,useEvenPageHeaderFooter:W=C,columnProperties:X=[],columnSeparatorType:J=eo.NONE,contentDirection:ue,sectionType:Xe,textDirection:Ee,renderConfig:we=U}=Ne.sectionBreak,$=t[de+1],he=(ie=$==null?void 0:$.sectionBreak)==null?void 0:ie.sectionType,te={defaultHeaderId:Nt,evenPageHeaderId:pn,firstPageHeaderId:rn},be={defaultFooterId:$t,evenPageFooterId:Ot,firstPageFooterId:Vt};Ie.width===null&&(Ie.width=1/0),Ie.height===null&&(Ie.height=1/0);const De={pageNumberStart:Ce,pageSize:Ie,pageOrient:Le,marginTop:Ve,marginBottom:it,marginRight:Ze,marginLeft:Dt,marginHeader:sn,marginFooter:et,headerIds:te,footerIds:be,useFirstPageHeaderFooter:N,useEvenPageHeaderFooter:W,columnProperties:X,columnSeparatorType:J,contentDirection:ue,sectionType:Xe,sectionTypeNext:he,textDirection:Ee,renderConfig:we,...j};let Oe=No(oe);Xe===cs.CONTINUOUS?this.__addNewSectionByContinuous(Oe,X,J):Oe=Es(De,pe,Oe==null?void 0:Oe.pageNumber);const T=this.getContext(),x=oh(Ne.blockElements,Oe,De,pe,this._renderedBlockIdMap,T);he===cs.CONTINUOUS&&X.length>0;const{pages:Ae,renderedBlockIdMap:YT}=x;Ae.forEach(GT=>{}),oe.push(...Ae)}return z}__addNewSectionByContinuous(e,t,n){const s=e.sections,r=s[s.length-1],{width:i,height:a,marginTop:l,marginBottom:c,marginLeft:u,marginRight:h}=e,d=i-u-h,g=a-l-c,m=((r==null?void 0:r.top)||0)+((r==null?void 0:r.height)||0),_=Ku(t,n,m,d,g-m);_.parent=e,s.push(_)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}static create(e,t){return new Lo(e,t)}}class u3 extends Vu{constructor(e,t,n=!1){super(e),this._skeleton=t,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new Mo),this.onIsAddedToParentObserver.add(s=>{var r;(r=s==null?void 0:s.getEngine())==null||r.onTransformChangeObservable.add(i=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas()})}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(e,t),e.restore()}_getBounding(e){}_draw(e,t){}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===ve.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}}var Gi=(o=>(o[o.SPAN=0]="SPAN",o[o.LINE=1]="LINE",o))(Gi||{});class Sr extends Wu{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}const h3="DefaultDocsFontAndBaseLineExtension";class d3 extends Sr{constructor(){super(...arguments),this.uKey=h3,this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var g;if(!((g=n.parent)==null?void 0:g.parent))return;const{ts:r,content:i,fontStyle:a,bBox:l}=n;let{spanPointWithFont:c=re.create(0,0)}=this.extensionOffset;if(!r){i!=null&&e.fillText(i,c.x,c.y);return}if(i==null)return;this._preFontString!==(a==null?void 0:a.fontString)&&(e.font=this._preFontString=(a==null?void 0:a.fontString)||"");const{cl:u,va:h}=r,d=_t(u)||Fn;if(d&&this._preFontColor!==d&&(e.fillStyle=d),h===yt.SUBSCRIPT||h===yt.SUPERSCRIPT){let m=l.spo;h===yt.SUPERSCRIPT&&(m=-l.sbo),c.y+=m}e.fillText(i,c.x,c.y)}clearCache(){this._preFontString="",this._preFontColor=""}}bs.add(new d3);const g3="DefaultDocsBackgroundExtension";class f3 extends Sr{constructor(){super(...arguments),this.uKey=g3,this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var d;const s=(d=n.parent)==null?void 0:d.parent;if(!s)return;const{lineHeight:r=0}=s,{ts:i,width:a,content:l}=n;if(!i)return;const{bg:c}=i;if(!c)return;const u=_t(c),{spanStartPoint:h=re.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,a+1,r))}clearCache(){this._preBackgroundColor=""}}bs.add(new f3);const m3="DefaultDocsLineExtension";class _3 extends Sr{constructor(){super(...arguments),this.uKey=m3,this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var F;const s=(F=n.parent)==null?void 0:F.parent;if(!s)return;const{asc:r=0,lineHeight:i=0}=s,{ts:a,left:l,width:c,bBox:u}=n;if(!a)return;const{sp:h}=u,d=xo(t),{ul:g,st:m,ol:_}=a,{originTranslate:p=re.create(0,0),centerPoint:v=re.create(0,0),alignOffset:b=re.create(0,0),renderConfig:C={}}=this.extensionOffset,{centerAngle:D=0,vertexAngle:O=0}=C;if(g){const{s:S,cl:E,t:w}=g;if(S===Y.TRUE){e.beginPath();const I=_t(E)||Fn;e.strokeStyle=I,this._setLineType(e,w||qe.SINGLE);const P=ge(i+Su-.5,d),L=Nn(p.addByPoint(l,P),v,D,O,b),y=Nn(p.addByPoint(l+c,P),v,D,O,b);e.moveTo(L.x,L.y),e.lineTo(y.x,y.y),e.stroke()}}if(m){const{s:S,cl:E,t:w}=m;if(S===Y.TRUE){e.beginPath();const I=_t(E)||Fn;e.strokeStyle=I,this._setLineType(e,w||qe.SINGLE);const P=ge(h-.5,d),L=Nn(p.addByPoint(l,P),v,D,O,b),y=Nn(p.addByPoint(l+c,P),v,D,O,b);e.moveTo(L.x,L.y),e.lineTo(y.x,y.y),e.stroke()}}if(_){const{s:S,cl:E,t:w}=_;if(S===Y.TRUE){e.beginPath();const I=_t(E)||Fn;e.strokeStyle=I,this._setLineType(e,w||qe.SINGLE);const P=ge(-Su-.5,d),L=Nn(p.addByPoint(l,P),v,D,O,b),y=Nn(p.addByPoint(l+c,P),v,D,O,b);e.moveTo(L.x,L.y),e.lineTo(y.x,y.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===qe.DASH_DOT_DOT_HEAVY||t===qe.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===qe.DASH_DOT_HEAVY||t===qe.DOT_DASH?e.setLineDash([2,5,2]):t===qe.DOTTED||t===qe.DOTTED_HEAVY?e.setLineDash([2]):t===qe.DASH||t===qe.DASHED_HEAVY?e.setLineDash([3]):t===qe.DASH_LONG||t===qe.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===qe.WAVY_HEAVY||e===qe.DASHED_HEAVY||e===qe.DOTTED_HEAVY||e===qe.DASH_DOT_HEAVY||e===qe.DASH_LONG_HEAVY||e===qe.DASH_DOT_DOT_HEAVY?t=2:e===qe.THICK&&(t=3),t}}bs.add(new _3);const p3="DefaultDocsBorderExtension";class v3 extends Sr{constructor(){super(...arguments),this.uKey=p3,this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var m;const s=(m=n.parent)==null?void 0:m.parent;if(!s)return;const{asc:r=0,lineHeight:i=0}=s,{ts:a,left:l,width:c}=n;if(!a)return;const{bd:u}=a;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:g=re.create(0,0)}=this.extensionOffset;for(let _ of d.keys()){const p=d.get(_);if(!p)continue;const{s:v,cl:b}=p,C=_t(b)||Fn;v!==this._preBorderStyle&&(Ru(e,v),e.lineWidth=Au(v)/h,this._preBorderStyle=v),C!==this._preBorderColor&&(e.strokeStyle=C||Fn,this._preBorderColor=C),Tu(e,_,{startX:g.x,startY:g.y,endX:g.x+c,endY:g.y+i})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:s,r}=e,i=new Map;return t&&i.set(pt.TOP,t),n&&i.set(pt.BOTTOM,n),s&&i.set(pt.LEFT,s),r&&i.set(pt.RIGHT,r),i}}bs.add(new v3);var yr=(o=>(o[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.span=5]="span",o))(yr||{});const Po={page:0,section:1,column:2,line:3,divide:4,span:5},b3="__TestSelection__";class uh{constructor(e,t,n){this._scene=e,this.startNodePosition=t,this.endNodePosition=n,this._current=!1,this._Liquid=new Xi,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_setNodePositionState(e=0,t,n,s){s===t?this._currentStartState[e]=1:this._currentStartState[e]=0,s===n?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let n=e,s;for(;n>=0;){const r=yr[n];let i;if(t?i=this._currentStartState[r]:i=this._currentEndState[r],i===void 0)return;if(s===void 0&&(s=i),i!==s)return 0;n--}return s}_getSelectionRuler(e,t,n,s,r){let i=0,a=s;const l=yr[e],c=yr[e+1];if(c===null||l===null)return{start_nest:i,end_nest:a};const u=t[l],h=n[l];this._setNodePositionState(l,u,h,r);const d=this._checkPreviousNodePositionState(e),g=this._checkPreviousNodePositionState(e,!1);return d===1&&(i=t[c]),g===2&&(a=n[c]),{start_nest:i,end_nest:a}}_pushToPoints(e){const{startX:t,startY:n,endX:s,endY:r}=e,i=[];return i.push({x:t,y:n}),i.push({x:s,y:n}),i.push({x:s,y:r}),i.push({x:t,y:r}),i.push({x:t,y:n}),i}isEmpty(){return this.startNodePosition===void 0&&this.endNodePosition===void 0}isCollapsed(){return!!(this.startNodePosition!==void 0&&this.endNodePosition===void 0||this.isSamePosition())}isRange(){const e=this.startNodePosition,t=this.endNodePosition;return!(e===void 0||t===void 0||this.isSamePosition())}dispose(){var e;(e=this._polygon)==null||e.dispose(),this._polygon=null}isIntersection(e){return!1}isSamePosition(){const e=this.startNodePosition,t=this.endNodePosition;if(e===void 0||t===void 0)return!1;const n=Object.keys(Po);for(let s of n){const r=e[s],i=t[s];if(r!==i)return!1}return!0}_createAndUpdatePolygon(e,t,n){if(this._polygon){this._polygon.translate(t,n),this._polygon.updatePointGroup(e);return}const s=new br(b3+mt(6),{pointsGroup:e,fill:lt(Io.black,.2),left:t,top:n,evented:!1});this._polygon=s,this._scene.addObject(s,2)}generate(e){const t=e.getSkeleton();if(!t)return;const n=[],s=this.startNodePosition,r=this.endNodePosition;if(this.isEmpty())return n;if(!this.isCollapsed())return this._selectionIterator(s,r,t,(i,a,l,c)=>{const{lineHeight:u}=c,h=l.spanGroup,{width:d}=l,{x:g,y:m}=this._Liquid;let _;if(i===0&&a===h.length-1)_={startX:g,startY:m,endX:g+d,endY:m+u};else{const p=h[i],v=h[a];_={startX:g+p.left,startY:m,endX:g+v.left+v.width,endY:m+u}}n.push(this._pushToPoints(_))}),this._createAndUpdatePolygon(n,e.left,e.top),n}_selectionIterator(e,t,n,s){if(!n)return[];this._Liquid.reset();const i=n.getSkeletonData().pages,{page:a}=e,{page:l}=t;this._resetCurrentNodePositionState();for(let c=a;c<=l;c++){const u=i[c],h=u.sections,{start_nest:d,end_nest:g}=this._getSelectionRuler(Po.page,e,t,h.length-1,c);this._Liquid.translatePagePadding(u);for(let m=d;m<=g;m++){const _=h[m],p=_.columns,{start_nest:v,end_nest:b}=this._getSelectionRuler(Po.section,e,t,p.length-1,m);this._Liquid.translateSection(_);for(let C=v;C<=b;C++){const D=p[C],O=D.lines,{start_nest:F,end_nest:S}=this._getSelectionRuler(Po.column,e,t,O.length-1,C);this._Liquid.translateColumn(D);for(let E=F;E<=S;E++){const w=O[E],{divides:I,type:P,lineHeight:L=0}=w,{start_nest:y,end_nest:k}=this._getSelectionRuler(Po.line,e,t,I.length-1,E);this._Liquid.translateSave(),this._Liquid.translateLine(w);for(let M=y;M<=k;M++){const U=I[M];this._Liquid.translateSave(),this._Liquid.translateDivide(U);const z=U.spanGroup,{start_nest:K,end_nest:j}=this._getSelectionRuler(Po.divide,e,t,z.length-1,M);s&&s(K,j,U,w,D,_,u),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}}}}const Tr=class{constructor(o){this._documents=o,this._textSelectionList=[],this._initialDom(),this._documents&&this.changeDocuments(this._documents)}_initialDom(){const o=document.createElement("div");o.style.position="absolute",o.style.position="absolute",o.style.left="0px",o.style.top="0px";const e=document.createElement("div"),t=document.createElement("div");e.appendChild(t);const n=document.createElement("div");o.appendChild(e),o.appendChild(n),this._container=o,this._inputParent=e,this._input=t,this._cursor=n,this._initialInput(),this._initialCursor(),document.body.appendChild(o)}_initialInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.style.cssText=`
            position: absolute; 
            overflow: hidden; 
            opacity: 1; 
            background: #000; 
            color: transparent; 
            outline: none; 
            z-index: -2; 
            caret-color: transparent; 
            white-space: pre-wrap; 
            user-select: text;
        `}_initialCursor(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,Tr.isInsertKeyFrame||(Tr.isInsertKeyFrame=!0,Ug([`
                @-webkit-keyframes univer-blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    50% {
                        opacity: 0;
                    }
                
                    to {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer-blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    50% {
                        opacity: 0;
                    }
                
                    to {
                        opacity: 1;
                    }
                }
            `]))}active(o,e){this._container.style.left=`${o}px`,this._container.style.top=`${e}px`,this._cursor.style.animation="univer-blinkStyle 1s steps(1) infinity",this._cursor.style.display="revert"}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none"}_getSkeletonData(){var o,e;return(e=(o=this._documents)==null?void 0:o.getSkeleton())==null?void 0:e.getSkeletonData()}_getNodePosition(o){if(o===!1)return;const e=o.parent,t=e==null?void 0:e.parent,n=t==null?void 0:t.parent,s=n==null?void 0:n.parent,r=s==null?void 0:s.parent,i=this._getSkeletonData();if(!e||!n||!s||!r||!i)return;const a=e.spanGroup.indexOf(o),l=t.divides.indexOf(e),c=n.lines.indexOf(t),u=s.columns.indexOf(n),h=r.sections.indexOf(s),d=i.pages.indexOf(r);return{span:a,divide:l,line:c,column:u,section:h,page:d}}_compareNodePosition(o,e){return o.page>e.page?!1:o.page<e.page?!0:o.section>e.section?!1:o.section<e.section?!0:o.column>e.column?!1:o.column<e.column?!0:o.line>e.line?!1:o.line<e.line?!0:o.divide>e.divide?!1:o.divide<e.divide?!0:o.span>e.span?!1:(o.span<e.span,!0)}_interactTextSelection(o){const e=[];let t=!1;this._textSelectionList.forEach(n=>{o.isIntersection(n)?(t=!0,n.dispose()):e.push(n)}),t&&(e.push(o),this._textSelectionList=e)}_deleteAllTextSelection(){this._textSelectionList.forEach(o=>{o.dispose()})}_deactivateTextSelection(){this._textSelectionList.forEach(o=>{o.deactivate()})}_addTextSelection(o){this._deactivateTextSelection(),o.activate(),this._textSelectionList.push(o)}_updateTextSelection(o){let e=this._textSelectionList.pop();if(!e){if(!this._documents)return;e=new uh(this._documents.getScene(),o)}this._deleteAllTextSelection(),e.activate(),e.startNodePosition=o,this._textSelectionList=[e]}_getActiveTextSelection(){const o=this._textSelectionList;for(let e of o)if(e.isActive())return e}_isEmptyTextSelection(){return this._textSelectionList.length===0}_moving(o,e,t){const{scrollX:n,scrollY:s}=ko(t),r=o-this._viewportScrollX+n,i=e-this._viewportScrollY+s;if(!this._documents)return;const a=this._documents.findNodeByCoord(r,i),l=this._getNodePosition(a);if(!l)return;const c=this._getActiveTextSelection();if(!c)return;this._compareNodePosition(this._startNodePosition,l)?c.endNodePosition=l:(c.startNodePosition=l,c.endNodePosition=this._startNodePosition),c.generate(this._documents),this._interactTextSelection(c)}_attachEvent(o){this._moveInObserver=o.onPointerEnterObserver.add(()=>{o.cursor=Ye.TEXT}),this._moveOutObserver=o.onPointerLeaveObserver.add(()=>{o.cursor=Ye.DEFAULT,e.resetCursor()});const e=o.getScene();this._downObserver=o.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:r}=t;if(this._startOffsetX=s,this._startOffsetY=r,!this._documents)return;const i=this._documents.findNodeByCoord(s,r),a=this._getNodePosition(i);if(console.log(i,s,r),!a){this._deleteAllTextSelection();return}if(t.ctrlKey||this._isEmptyTextSelection()){const h=new uh(this._documents.getScene(),a);this._addTextSelection(h)}else this._updateTextSelection(a);this._startNodePosition=a,e.disableEvent();const l=so.create(e);l.startScroll(s,r);const{scrollX:c,scrollY:u}=ko(l);this._viewportScrollX=c,this._viewportScrollY=u,this._moveObserver=e.onPointerMoveObserver.add(h=>{const{offsetX:d,offsetY:g}=h;this._moving(d,g,l),e.setCursor(Ye.TEXT)}),this._upObserver=e.onPointerUpObserver.add(h=>{e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent(),l.stopScroll()}),n.stopPropagation()})}_detachEvent(o){o.onPointerEnterObserver.remove(this._moveInObserver),o.onPointerLeaveObserver.remove(this._moveOutObserver),o.onPointerDownObserver.remove(this._downObserver)}changeDocuments(o){this._documents&&this._detachEvent(this._documents),this._documents=o,this._attachEvent(this._documents)}dispose(){}static create(o){return new Tr(o)}};let hh=Tr;hh.isInsertKeyFrame=!1;class ws extends u3{constructor(e,t,n){super(e,t,n==null?void 0:n.allowCache),this._hasEditor=!1,this.isCalculateSkeleton=!0,this.onPageRenderObservable=new ae,(n==null?void 0:n.pageMarginLeft)===void 0?this.pageMarginLeft=17:this.pageMarginLeft=n==null?void 0:n.pageMarginLeft,(n==null?void 0:n.pageMarginTop)===void 0?this.pageMarginTop=14:this.pageMarginTop=n==null?void 0:n.pageMarginTop,this.pageLayoutType=(n==null?void 0:n.pageLayoutType)||wn.VERTICAL,this._drawLiquid=new Xi,this._findLiquid=new Xi,this._hasEditor=(n==null?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(t),this.makeDirty(!0)}_draw(e,t){this.draw(e,t)}_horizontalHandler(e,t,n,s){let r=0;return s===ze.CENTER?r=(this.width-e)/2:s===ze.RIGHT?r=this.width-e-n:r=t,r}_verticalHandler(e,t,n,s){let r=0;return s===St.MIDDLE?r=(this.height-e)/2:s===St.BOTTOM?r=this.height-e-n:r=t,r}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){bs.getData().forEach(e=>{this.register(e)})}enableEditor(){this._hasEditor||(this._editor=hh.create(this),this._hasEditor=!0)}disableEditor(){var e;(e=this._editor)==null||e.dispose(),this._hasEditor=!1}get hasEditor(){return this._hasEditor}draw(e,t){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const s=n.getSkeletonData(),{pages:r}=s,i=this.getParentScale(),a=this.getExtensionsByOrder(),l=xo(i);for(let h of a)h.clearCache();let c=0,u=0;for(let h=0,d=r.length;h<d;h++){const g=r[h],{sections:m,marginTop:_=0,marginBottom:p=0,marginLeft:v=0,marginRight:b=0,width:C,height:D,renderConfig:O={}}=g,{verticalAlign:F=St.TOP,horizontalAlign:S=ze.LEFT,centerAngle:E=0,vertexAngle:w=0,wrapStrategy:I=at.UNSPECIFIED,isRotateNonEastAsian:P=Y.FALSE}=O,L=this._horizontalHandler(C,v,b,S),y=this._verticalHandler(D,_,p,F),k=re.create(L,y),M=ds(E),U=ds(w),z=U-M;this.onPageRenderObservable.notifyObservers({page:g,pageLeft:u,pageTop:c,ctx:e}),this._startRotation(e,z);for(let q of m){const{columns:se}=q;this._drawLiquid.translateSection(q);for(let le of se){const{lines:Te,width:pe}=le;this._drawLiquid.translateColumn(le);const oe=Te.length;let ie,de=null;if(U!==0){const{rotateTranslateXList:Ne,rotatedHeight:Ce,rotatedWidth:Ie,fixOffsetX:Le,fixOffsetY:Ve,rotateTranslateY:it}=Du(Te,pe,U);let Ze=Ie;Ce>this.height&&I!==at.WRAP&&(I===at.OVERFLOW||U>0)&&(Ze=this.height/Math.tan(Math.abs(U)));const Dt=this._horizontalHandler(Ze,v,b,S);let et=this._verticalHandler(Ce,_,p,F)-Ve;Ce>this.height&&(U<0?et=this.height-(Ce+Ve):et=-Ve),ie=re.create(Dt+Le,et),this._drawLiquid.translate(0,-it),de=Ne}else ie=k;for(let Ne=0;Ne<oe;Ne++){const Ce=Te[Ne],{divides:Ie,asc:Le=0,type:Ve,lineHeight:it=0}=Ce;let Ze=Le;const Dt=Ze*Math.sin(M),sn=Ze*Math.cos(M);if(Ve===fr.BLOCK)for(let et of a)et.type===Gi.LINE&&(et.extensionOffset={alignOffset:ie,renderConfig:O},et.draw(e,i,Ce));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(Ce),de&&this._drawLiquid.translate(de[Ne]);const et=Ie.length;for(let Nt=0;Nt<et;Nt++){const $t=Ie[Nt],{spanGroup:pn}=$t;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide($t);for(let Ot of pn){if(!Ot.content||Ot.content.length===0)continue;const{width:rn,left:Vt}=Ot,{x:N,y:W}=this._drawLiquid,X=re.create(ge(N,l),ge(W,l)),J=re.create(ge(rn/2,l),ge(it/2,l)),ue=Nn(X.addByPoint(ge(Vt,l),0),J,M,U,ie),Xe=Nn(X.addByPoint(ge(Vt+Dt,l),ge(sn,l)),J,M,U,ie),Ee={originTranslate:X,spanStartPoint:ue,spanPointWithFont:Xe,centerPoint:J,alignOffset:ie,renderConfig:O};for(let we of a)we.type===Gi.SPAN&&(we.extensionOffset=Ee,we.draw(e,i,Ot))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,z);const{x:K,y:j}=this._drawLiquid.translatePage(g,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);u=K,c=j}}_addSkeletonChangeObserver(e){!e||(this._skeletonObserver=e.onRecalculateChangeObservable.add(t=>{const n=t.pages;let s=0,r=0;for(let i=0,a=n.length;i<a;i++){const l=n[i],{pageWidth:c,pageHeight:u}=l;this.pageLayoutType===wn.VERTICAL?(r+=u,i!==a-1&&(r+=this.pageMarginTop),s=Math.max(s,c)):this.pageLayoutType===wn.HORIZONTAL&&(s+=c,i!==a-1&&(s+=this.pageMarginLeft),r=Math.max(r,u))}this.resize(s,r)}))}_disposeSkeletonChangeObserver(e){!e||e.onRecalculateChangeObservable.remove(this._skeletonObserver)}changeSkeleton(e){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(e),this._addSkeletonChangeObserver(e),this}_getPageBoundingBox(e){const{pageWidth:t,pageHeight:n}=e;let{x:s,y:r}=this._findLiquid,i=-1,a=-1;return this.pageLayoutType===wn.VERTICAL?(i=t,a=r+n):this.pageLayoutType===wn.HORIZONTAL&&(i=s+t,a=n),{startX:s,startY:r,endX:i,endY:a}}findNodeByCoord(e,t){const s=this.getScene().transformToSceneCoord(re.FromArray([e,t]));if(!s)return!1;const r=this._getInverseCoord(s);let{x:i,y:a}=r;const l=this.getSkeleton();if(!l)return!1;this._findLiquid.reset();const u=l.getSkeletonData().pages;for(let h=0,d=u.length;h<d;h++){const g=u[h],{startX:m,startY:_,endX:p,endY:v}=this._getPageBoundingBox(g);if(!(i>=m&&i<=p&&a>=_&&a<=v))continue;this._findLiquid.translatePagePadding(g);const b=g.sections;for(let C of b){const{columns:D,height:O}=C;this._findLiquid.translateSection(C);const{y:F}=this._findLiquid;if(a>=F&&a<=F+O)for(let S of D){const{lines:E,width:w}=S;this._findLiquid.translateColumn(S);const{x:I}=this._findLiquid;if(!(i>=I&&i<=I+w))continue;const P=E.length;for(let L=0;L<P;L++){const y=E[L],{divides:k,type:M,lineHeight:U=0}=y;if(M!==fr.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(y);const{y:z}=this._findLiquid;if(!(a>=z&&a<=z+U)){this._findLiquid.translateRestore();continue}const K=k.length;for(let j=0;j<K;j++){const q=k[j],{spanGroup:se,width:le}=q;this._findLiquid.translateSave(),this._findLiquid.translateDivide(q);const{x:Te}=this._findLiquid;if(!(i>=Te&&i<=Te+le)){this._findLiquid.translateRestore();continue}for(let pe of se){if(!pe.content||pe.content.length===0)continue;const{width:oe,left:ie}=pe;if(i>=Te+ie&&i<=Te+ie+oe)return pe}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(g),this._findLiquid.translatePage(g,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}return!1}static create(e,t,n){return new ws(e,t,n)}}class dh extends Vu{constructor(e,t){super(e),this._skeleton=t}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,t),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===ve.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e,t,n){const s=e.length,r=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:r-1};let i=-1,a=-1,l=-1,c=-1;return i=jt(e,n.tl.y),a=jt(e,n.bl.y),i===-1&&(i=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=jt(t,n.tl.x),c=jt(t,n.tr.x),l===-1&&(l=0),c===-1&&(c=r-1),c>=r&&(c=r-1),{startRow:i-1,endRow:a+1,startColumn:l-1,endColumn:c+1}}_draw(e,t){}}class gh extends dh{_draw(e,t){this.draw(e,t)}}class zo extends Wu{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,s,r){return gs(e,t,n,s,r)}}const C3="DefaultBackgroundExtension";class E3 extends zo{constructor(){super(...arguments),this.uKey=C3,this.zIndex=20}draw(e,t,n){const{rowTitleWidth:s,columnTitleHeight:r,dataMergeCache:i,stylesCache:a}=n,{background:l}=a;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:u,columnWidthAccumulation:h,rowTotalHeight:d}=n;if(!c||!h||u===void 0||d===void 0)return;e.save();const{scaleX:g=1,scaleY:m=1}=t;l&&Object.keys(l).forEach(_=>{const p=l[_];e.fillStyle=_||lt([255,255,255]),e.beginPath(),p.forEach((v,b)=>{b.forEach(C=>{let{isMerged:D,startY:O,endY:F,startX:S,endX:E}=this.getCellIndex(v,C,c,h,i);if(D)return!0;O=ge(O,m),F=ge(F,m),S=ge(S,g),E=ge(E,g),e.moveTo(S,O),e.lineTo(S,F),e.lineTo(E,F),e.lineTo(E,O)})}),e.closePath(),e.fill()}),e.restore()}}vs.add(new E3);const w3="DefaultBorderExtension";class S3 extends zo{constructor(){super(...arguments),this.uKey=w3,this.zIndex=30}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:r,columnTitleHeight:i,dataMergeCache:a,stylesCache:l,overflowCache:c}=n,{border:u}=l;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;e.save();const{scaleX:_=1,scaleY:p=1}=t,v=this._getScale(t);let b,C;u==null||u.forEach((D,O)=>{O==null||O.forEach((F,S)=>{if(!S)return!0;let{isMerged:E,startY:w,endY:I,startX:P,endX:L}=this.getCellIndex(D,F,h,g,a);if(E)return!0;w=ge(w,p),I=ge(I,p),P=ge(P,_),L=ge(L,_);for(let y in S){const{type:k,style:M,color:U}=S[y];this._getOverflowExclusion(c,k,D,F)||(M!==b&&(Ru(e,M),e.lineWidth=Au(M)/v,b=M),U!==C&&(e.strokeStyle=U||Fn,C=U),Tu(e,k,{startX:P,startY:w,endX:L,endY:I}))}})}),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,s){let r=!1;return t===pt.TOP||t===pt.BOTTOM||e&&e.forEach((i,a)=>{if(i!==n)return!0;a.forEach((l,c)=>{const{startColumn:u,endColumn:h}=c;if(t===pt.LEFT&&l>u&&l<=h||t===pt.RIGHT&&l>=u&&l<h)return r=!0,!1})}),r}}vs.add(new S3);const y3="DefaultBorderAuxiliaryExtension";class T3 extends zo{constructor(){super(...arguments),this.uKey=y3,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:r=0,columnTitleHeight:i=0,dataMergeCache:a,overflowCache:l,stylesCache:c}=n,{startRow:u,endRow:h,startColumn:d,endColumn:g}=s;if(!n)return;const{rowHeightAccumulation:m,columnTotalWidth:_,columnWidthAccumulation:p,rowTotalHeight:v}=n;if(!m||!p||_===void 0||v===void 0)return;e.save();const b=this._getScale(t);e.beginPath(),e.lineWidth=1/b,e.strokeStyle=lt([217,217,217]);let C=ge(_,b),D=ge(v,b);const O=p.length,F=m.length;for(let S=u-1;S<=h;S++){if(S<0||S>F-1)continue;const E=ge(m[S],b);e.moveTo(0,E),e.lineTo(C,E)}for(let S=d;S<=g;S++){if(S<0||S>O-1)continue;const E=ge(p[S],b);e.moveTo(E,0),e.lineTo(E,D)}e.stroke(),e.closePath(),this._clearRectangle(e,b,m,p,a),this._clearRectangle(e,b,m,p,l),e.restore()}_clearRectangle(e,t,n,s,r){r==null||r.forEach((i,a)=>{a==null||a.forEach((l,c)=>{const{startRow:u,endRow:h,startColumn:d,endColumn:g}=c,m=ge(n[u-1]||0,t),_=ge(n[h],t),p=ge(s[d-1]||0,t),v=ge(s[g],t);e.clearRect(p,m,v-p,_-m),e.beginPath(),e.moveTo(p,m),e.lineTo(v,m),e.lineTo(v,_),e.lineTo(p,_),e.lineTo(p,m),e.stroke(),e.closePath()})})}}vs.add(new T3);const R3="DefaultFontExtension";class A3 extends zo{constructor(){super(...arguments),this.uKey=R3,this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:r,columnTitleHeight:i,stylesCache:a,dataMergeCache:l,overflowCache:c}=n,{font:u}=a;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;e.save();const _=this._getScale(t),{scaleX:p=1,scaleY:v=1}=t;u&&Object.keys(u).forEach(b=>{u[b].forEach((D,O)=>{O.forEach((F,S)=>{let{isMerged:E,isMergedMainCell:w,startY:I,endY:P,startX:L,endX:y,mergeInfo:k}=this.getCellIndex(D,F,h,g,l);if(E)return!0;I=ge(I,v),P=ge(P,v),L=ge(L,p),y=ge(y,p);const M=y-L,U=P-I,z=c.getValue(D,F),{horizontalAlign:K}=S;if(e.save(),e.beginPath(),z){const{startColumn:j,startRow:q,endColumn:se,endRow:le}=z;j===se&&j===F?e.rect(L,I,M,U):K===ze.CENTER?this._clipRectangle(e,q,le,j,se,_,h,g):K===ze.RIGHT?this._clipRectangle(e,q,D,j,F,_,h,g):this._clipRectangle(e,D,le,F,se,_,h,g)}else e.rect(L,I,M,U);e.clip(),e.translate(L,I),this._renderDocuments(e,S,L,I,y,P,D,F),e.restore()})})}),e.restore()}_renderDocuments(e,t,n,s,r,i,a,l){const c=this.getDocuments(),{documentSkeleton:u,angle:h,verticalAlign:d,horizontalAlign:g,wrapStrategy:m,content:_}=t,p=r-n,v=i-s;m===at.WRAP&&h===0&&(u.updateDocumentDataPageSize(p),u.calculate()),u.makeDirty(!1),c.resize(p,v),c.changeSkeleton(u).render(e)}_clipRectangle(e,t,n,s,r,i,a,l){const c=ge(a[t-1]||0,i),u=ge(a[n],i),h=ge(l[s-1]||0,i),d=ge(l[r],i);e.rect(h,c,d-h,u-c)}}vs.add(new A3);const I3="DefaultRowTitleLayoutExtension";class D3 extends zo{constructor(){super(...arguments),this.uKey=I3,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:r=0,columnTitleHeight:i=0}=n,{startRow:a,endRow:l,startColumn:c,endColumn:u}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;const _=this._getScale(t);e.fillStyle=lt([248,249,250]),e.fillRect(0,0,r,m),e.textAlign="center",e.textBaseline="middle",e.fillStyle=lt([0,0,0]),e.beginPath(),e.lineWidth=1/_,e.strokeStyle=lt([217,217,217]);let p=0;const v=h.length;for(let b=a-1;b<=l;b++){if(b<0||b>v-1)continue;const C=ge(h[b],_);if(p===C)continue;e.moveTo(0,C),e.lineTo(r,C);const D=p+(C-p)/2;e.fillText(`${b+1}`,r/2,D+wu),p=C}e.moveTo(ge(r,_),0),e.lineTo(ge(r,_),m),e.stroke()}}Hu.add(new D3);const O3="DefaultColumnTitleLayoutExtension";class x3 extends zo{constructor(){super(...arguments),this.uKey=O3,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:r=0,columnTitleHeight:i=0}=n,{startRow:a,endRow:l,startColumn:c,endColumn:u}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:g,rowTotalHeight:m}=n;if(!h||!g||d===void 0||m===void 0)return;const _=this._getScale(t);e.fillStyle=lt([248,249,250]),e.fillRect(0,0,d,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=lt([0,0,0]),e.beginPath(),e.lineWidth=1/_,e.strokeStyle=lt([217,217,217]);let p=0;const v=g.length;for(let C=c-1;C<=u;C++){if(C<0||C>v-1)continue;const D=ge(g[C],_);if(p===D)continue;e.moveTo(D,0),e.lineTo(D,i);const O=p+(D-p)/2;e.fillText(Xc(C),O,i/2+wu),p=D}const b=ge(i,_);e.moveTo(0,b),e.lineTo(d,b),e.stroke()}}$u.add(new x3);const M3="__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__";class k3 extends dh{constructor(e,t,n=!0){super(e,t),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._documents=new ws(M3,void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new Mo),this.onIsAddedToParentObserver.add(s=>{var r;(r=s==null?void 0:s.getEngine())==null||r.onTransformChangeObservable.add(i=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()}),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}_draw(e,t){this.draw(e,t)}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const r=xo(s),{rowTitleWidth:i,columnTitleHeight:a}=n;e.translate(ge(i,r)-.5/r,ge(a,r)-.5/r),this._calculateOverflow();const l=this.getExtensionsByOrder();for(let c of l)c.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:r}=n;return t.x>s&&t.y>r}getNoMergeCellPositionByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:s,columnWidthAccumulation:r,rowTitleWidth:i,columnTitleHeight:a}=n,{scaleX:l=1,scaleY:c=1}=this.getParentScale();let{startY:u,endY:h,startX:d,endX:g}=pr(e,t,s,r);return u=ge(u+a,c),h=ge(h+a,c),d=ge(d+i,l),g=ge(g+i,l),{startY:u,endY:h,startX:d,endX:g}}calculateCellIndexByPosition(e,t,n){const s=this.getSkeleton();if(!s)return;const{x:r,y:i}=n,{rowHeightAccumulation:a,columnWidthAccumulation:l,rowTitleWidth:c,columnTitleHeight:u,dataMergeCacheAll:h}=s;e+=r-c,t+=i-u;let d=jt(a,t),g=jt(l,e);if(d===-1){const S=a.length-1;a[S]<=t?d=a.length-1:d=0}if(g===-1){const S=l.length-1;l[S]<=e?g=l.length-1:g=0}const{scaleX:m=1,scaleY:_=1}=this.getParentScale();let{isMerged:p,startY:v,endY:b,startX:C,endX:D,mergeInfo:O,isMergedMainCell:F}=gs(d,g,a,l,h);return v=ge(v+u,_),b=ge(b+u,_),C=ge(C+c,m),D=ge(D+c,m),O=Pu(O,c,u,m,_),{row:d,column:g,startY:v,endY:b,startX:C,endX:D,isMerged:p,isMergedMainCell:F,mergeInfo:O}}getCellByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{scaleX:s=1,scaleY:r=1}=this.getParentScale(),{rowHeightAccumulation:i,columnWidthAccumulation:a,rowTitleWidth:l,columnTitleHeight:c,dataMergeCacheAll:u}=n;let{isMerged:h,startY:d,endY:g,startX:m,endX:_,mergeInfo:p,isMergedMainCell:v}=gs(e,t,i,a,u);return d=ge(d+c,r),g=ge(g+c,r),m=ge(m+l,s),_=ge(_+l,s),p=Pu(p,l,c,s,r),{row:e,column:t,startY:d,endY:g,startX:m,endX:_,isMerged:h,isMergedMainCell:v,mergeInfo:p}}getAncestorScrollXY(e,t){let n=this.getParent(),s=0,r=0;for(;n;){if(n.classType===ve.SCENE){const a=n.getViewports().find(l=>l.isHit(re.FromArray([e,t])));if(a){const l=a.actualScrollX||0,c=a.actualScrollY||0;s+=l,r+=c}}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}return{x:s,y:r}}getSelectionBounding(e,t,n,s){var r;return(r=this.getSkeleton())==null?void 0:r.getMergeBounding(e,t,n,s)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=t;const s=this._cacheCanvas.getContext();if(n){const{dx:r=0,dy:i=0}=n;this._cacheOffsetX=r,this._cacheOffsetY=i}this._cacheCanvas.clear(),s.save(),s.setTransform(e.getTransform()),this._draw(s,n),s.restore(),this._boundsCache=t}this._applyCache(e)}else e.save(),this._draw(e,t),e.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const e=this._getAncestorSize();if(!e)return;const{width:t,height:n}=e,s=this.getSkeleton();s&&(s.rowTitleWidth,s.columnTitleHeight),this._cacheCanvas.setSize(t,n),this.makeDirty(!0)}_getAncestorSize(){const e=this._getAncestorParent();if(!!e){if(e.classType===ve.ENGINE){const t=e.getCanvas();return{width:t.getWidth(),height:t.getHeight()}}if(e.classType===ve.SCENE_VIEWER)return{width:e.width,height:e.height}}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===ve.ENGINE||e.classType===ve.SCENE_VIEWER)return e;e=(e==null?void 0:e.getParent)&&(e==null?void 0:e.getParent())}}_applyCache(e){!e||(e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),0,0),e.restore())}_initialDefaultExtension(){vs.getData().sort(ht).forEach(e=>{this.register(e)}),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,e=>{e.onScrollBeforeObserver.add(()=>{this.makeDirty(!0)})})}_hasScrollViewportOperator(e,t){let n=e.getParent();for(;n;){if(n.classType===ve.SCENE){const s=n.getViewports();this._getHasScrollViewports(s);for(let r of s)r&&t(r)}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}}_getHasScrollViewports(e){const t=[];for(let n of e)n.getScrollBar()&&t.push(n);return t}getDocsSkeletonPageSize(e,t=0){const n=e==null?void 0:e.getSkeletonData();if(!n)return;const{pages:s}=n,r=s[s.length-1];if(t===0){const{width:g,height:m}=r;return{width:g,height:m}}let i=0,a=0;const l=Iu(t),c=[];i3([r],g=>{const{lines:m,width:_,spaceWidth:p}=g,{rotatedHeight:v,rotatedWidth:b}=Du(m,_,t);a+=v,c.push({rotatedWidth:b,spaceWidth:p})});const u=Math.tan(t),h=Math.sin(t),d=c.length;for(let g=0;g<d;g++){const{rotatedWidth:m,spaceWidth:_}=c[g];g===0&&(i+=m),(l===Do.UP&&g===0||l===Do.DOWN&&g===d-1)&&(i+=(m+_/h)/u)}return{width:i,height:a}}_calculateOverflow(){const e=new Q,t=this.getSkeleton();if(!t)return;const n=t.getColumnCount(),{stylesCache:s,rowHeightAccumulation:r,columnWidthAccumulation:i,dataMergeCache:a}=t,{font:l}=s;l&&Object.keys(l).forEach(c=>{l[c].forEach((h,d)=>{d.forEach((g,m)=>{let{documentSkeleton:_,angle:p=0,verticalAlign:v,horizontalAlign:b,wrapStrategy:C}=m;const D=t.getCellData().getValue(h,g),O=this.getSkeleton();if(!O)return!0;const{t:F=ns.STRING}=D||{};if(C===at.OVERFLOW&&F!==ns.NUMBER&&F!==ns.BOOLEAN&&b!==ze.JUSTIFIED){let S=this.getDocsSkeletonPageSize(_,p);if(!S)return!0;if(p!==0){let{startY:P,endY:L,startX:y,endX:k}=gs(h,g,r,i,a);const M=k-y,U=L-P;S.height>U&&(S={width:U/Math.tan(Math.abs(p))+M,height:U})}const E=t.getOverflowPosition(S,b,h,g,n),{startColumn:w,endColumn:I}=E;e.setValue(h,g,{startRow:h,endRow:h,startColumn:w,endColumn:I})}else if(C===at.WRAP&&p!==0){let{startY:S,endY:E}=gs(h,g,r,i,a);const w=E-S;_.updateDocumentDataPageSize(w),_.calculate();const I=this.getDocsSkeletonPageSize(_,p);if(!I)return!0;const{startColumn:P,endColumn:L}=O.getOverflowPosition(I,b,h,g,O.getColumnCount());e.setValue(h,g,{startRow:h,endRow:h,startColumn:P,endColumn:L})}})})}),t.setOverflowCache(e)}_differentBounds(e){if(!this._boundsCache)return e;const{tl:t,tr:n,bl:s,br:r,dx:i,dy:a}=e,{tl:l,tr:c,bl:u,br:h,dx:d,dy:g}=this._boundsCache,m={tl:t,tr:n,bl:s,br:r,dx:0,dy:0};return t.x===l.x?(t.y>l.y?(m.tl=u,m.tr=h):(m.bl=l,m.br=c),m.dy=l.y-t.y):t.y===l.y&&(t.x>l.x?(m.tl=c,m.bl=h):(m.tr=l,m.br=u),m.dx=l.x-t.x),m}_checkSheetDifferentBounds(e,t){const{tl:n,tr:s,bl:r,br:i}=e,{tl:a,tr:l,bl:c,br:u}=t;return n.x===a.x&&s.x===l.x&&r.x===c.x&&i.x===u.x?n.y>=a.y&&n.y<=c.y||r.y>=a.y&&r.y<=c.y:n.y===a.y&&s.y===l.y&&r.y===c.y&&i.y===u.y?(n.x>=a.x&&n.x<=l.x||s.x>=a.x&&s.x<=l.x,!0):!1}}class B3 extends gh{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const r=xo(s),{columnTitleHeight:i}=n;e.translate(-.5/r,ge(i,r)-.5/r);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:r}=n;return t.x>=0&&t.x<=s&&t.y>r}_initialDefaultExtension(){Hu.getData().forEach(e=>{this.register(e)}),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class F3 extends gh{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}_initialDefaultExtension(){$u.getData().forEach(e=>{this.register(e)}),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const r=xo(s),{rowTitleWidth:i}=n;e.translate(ge(i,r)-.5/r,-.5/r);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:r}=n;return t.x>s&&t.y>=0&&t.y<=r}}class ji extends Uu{constructor(e,t,n,s){super(s),this._config=e,this._cellData=t,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateMatrix(),this.updateDataMergeCacheAll()}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}setOverflowCache(e){this._overflowCache=e}calculate(e){if(!this._config||(this.dirty&&this.updateMatrix(),!this._rowHeightAccumulation||!this._columnWidthAccumulation))return;const{mergeData:t}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(e),this._dataMergeCache=t&&this._getMergeCells(t,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateMatrix(){if(!this.dirty)return;const{rowData:e,columnData:t,defaultRowHeight:n,defaultColumnWidth:s,rowCount:r,columnCount:i,rowTitle:a,columnTitle:l}=this._config,{rowTotalHeight:c,rowHeightAccumulation:u}=this._generateRowMatrixCache(r,e,n),{columnTotalWidth:h,columnWidthAccumulation:d}=this._generateColumnMatrixCache(i,t,s);return this._rowTitleWidth=a.hidden!==Y.TRUE?a.width:0,this._columnTitleHeight=l.hidden!==Y.TRUE?l.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=u,this._columnTotalWidth=h,this._columnWidthAccumulation=d,this.makeDirty(!0),this}updateDataMergeCacheAll(){const{mergeData:e}=this._config;this._dataMergeCacheAll=e&&this._getMergeCells(e)}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,t,n,s){const r=this._dataMergeCacheAll;if(!r)return{startRow:e,startColumn:t,endRow:n,endColumn:s};let i=!0,a=new Q;for(;i;)i=!1,r.forEach((l,c)=>{c.forEach((u,h)=>{if(!h||a.getValue(l,u))return!0;const{startRow:d,startColumn:g,endRow:m,endColumn:_}=h;zg({left:t,top:e,right:s,bottom:n},{left:g,top:d,right:_,bottom:m})&&(e=Math.min(e,d),t=Math.min(t,g),n=Math.max(n,m),s=Math.max(s,_),a.setValue(l,u,!0),i=!0)})});return{startRow:e,startColumn:t,endRow:n,endColumn:s}}appendToOverflowCache(e,t,n,s){this._overflowCache.setValue(e,t,{startRow:e,endRow:e,startColumn:n,endColumn:s})}getColumnCount(){return this._columnWidthAccumulation.length}get dataMergeCacheAll(){return this._dataMergeCacheAll}_generateRowMatrixCache(e,t,n){let s=0;const r=[],i=new xe(t);for(let a=0;a<e;a++){let l=n;if(i.get(a)!=null){const c=i.get(a);if(!c)continue;c.h!=null?l=c.h:c.ah!=null&&(l=c.ah),c.hd===Y.TRUE&&(l=0)}s+=l,r.push(s)}return{rowTotalHeight:s,rowHeightAccumulation:r}}_generateColumnMatrixCache(e,t,n){let s=0;const r=[],i=new xe(t);for(let a=0;a<e;a++){let l=n;if(i.get(a)!=null){const c=i.get(a);if(!c)continue;c.w!=null&&(l=c.w),c.hd===Y.TRUE&&(l=0)}s+=l,r.push(s)}return{columnTotalWidth:s,columnWidthAccumulation:r}}_getBounding(e,t,n){const s=e.length,r=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:r-1};let i=-1,a=-1,l=-1,c=-1;return i=jt(e,n.tl.y-this.columnTitleHeight),a=jt(e,n.bl.y-this.columnTitleHeight),i===-1&&(i=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=jt(t,n.tl.x-this.rowTitleWidth),c=jt(t,n.tr.x-this.rowTitleWidth),l===-1&&(l=0),c===-1&&(c=r-1),c>=r&&(c=r-1),{startRow:i-1,endRow:a+1,startColumn:l-1,endColumn:c+1}}getOverflowPosition(e,t,n,s,r){const{width:i,height:a}=e;let l=s,c=s;return t===ze.CENTER?(l=this._getOverflowBound(n,s,0,i/2),c=this._getOverflowBound(n,s,r-1,i/2)):t===ze.RIGHT?l=this._getOverflowBound(n,s,0,i):c=this._getOverflowBound(n,s,r-1,i),{startColumn:l,endColumn:c}}_getOverflowBound(e,t,n,s){let r=0;if(t>n){const i=this._columnWidthAccumulation.length-1;for(let a=t;a>=n;a--){const l=a,c=this._cellData.getValue(e,l);if(!pi(c)&&l!==t||this._intersectMergeRange(e,l))return l===t?l:l+1>i?i:l+1;const{startX:u,endX:h}=pr(e,l,this.rowHeightAccumulation,this.columnWidthAccumulation);if(r+=h-u,s<r)return l}return t}for(let i=t;i<=n;i++){const a=i,l=this._cellData.getValue(e,a);if(!pi(l)&&a!==t||this._intersectMergeRange(e,a))return a===t?a:a-1<0?0:a-1;const{startX:c,endX:u}=pr(e,a,this.rowHeightAccumulation,this.columnWidthAccumulation);if(r+=u-c,s<r)return a}return n}_intersectMergeRange(e,t){const n=this.dataMergeCache;let s=!1;return n==null||n.forEach((r,i)=>{i==null||i.forEach((a,l)=>{const{startRow:c,endRow:u,startColumn:h,endColumn:d}=l;if(e>=c&&e<=u&&t>=h&&t<=d)return s=!0,!1})}),s}_calculateStylesCache(){const e={background:{},font:{},border:new Q},t=this.getFontLocale(),n=this._dataMergeCache,s=this._rowColumnSegment,r=this.columnWidthAccumulation,i=this._styles,a=this._cellData,{startRow:l,endRow:c,startColumn:u,endColumn:h}=s;for(let d=l;d<=c;d++){for(let g=u;g<=h;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!1},t);for(let g=0;g<u;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!0},t);for(let g=h+1;g<r.length;g++)this.__setCellCache(d,g,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!0},t)}return n&&n.forEach((d,g)=>{g.forEach((m,_)=>{if(!_)return!0;this.__setCellCache(d,m,{cache:e,styles:i,cellData:a,skipBackgroundAndBorder:!1},t)})}),e}__setCellCache(e,t,n,s){const{cache:r,skipBackgroundAndBorder:i=!1,styles:a,cellData:l}=n;if(!l)return!0;const c=l.getValue(e,t);if(!c)return!0;const u=vi(a,c);if(!i&&u&&u.bg&&u.bg.rgb){const F=u.bg.rgb;r.background[F]||(r.background[F]=new Q),r.background[F].setValue(e,t,F)}!i&&u&&u.bd&&(this.___setBorderProps(e,t,pt.TOP,u,r),this.___setBorderProps(e,t,pt.BOTTOM,u,r),this.___setBorderProps(e,t,pt.LEFT,u,r),this.___setBorderProps(e,t,pt.RIGHT,u,r));const h=c.m||c.v;let d,g="document";const m=this._getOtherStyle(u),_=m.textRotation||{a:0,v:Y.FALSE},p=m.horizontalAlign||ze.UNSPECIFIED,v=m.verticalAlign||St.UNSPECIFIED,b=m.wrapStrategy||at.UNSPECIFIED;if(c.p){r.font[g]||(r.font[g]=new Q);let{a:F=0,v:S=Y.FALSE}=_,E=0,w=F;S===Y.TRUE&&(E=90,w=90),d=this._updateRenderConfigAndHorizon(c.p,p,{horizontalAlign:p,verticalAlign:v,centerAngle:E,vertexAngle:w,wrapStrategy:b})}else if(h){const F=this._getFontFormat(u);g=ki(F,s).fontString,r.font[g]||(r.font[g]=new Q),d=this._getDocumentDataByStyle(h.toString(),F,m)}const C=r.font[g];let{a:D,v:O=Y.FALSE}=_;if(O===Y.TRUE&&(D=90),d){const F=Lo.create(d,this.getContext());(D===0||b!==at.WRAP)&&F.calculate(),C.setValue(e,t,{documentSkeleton:F,angle:D,verticalAlign:v,horizontalAlign:p,wrapStrategy:b,content:h==null?void 0:h.toString()})}}_updateRenderConfigAndHorizon(e,t,n){var i;if(!n||!((i=e.body)!=null&&i.blockElements))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=n;const s=e.body.blockElements,r=Object.keys(e.body.blockElements);for(let a of r){const l=s[a];if(l.blockType===ke.PARAGRAPH){if(!l.paragraph)continue;l.paragraph.paragraphStyle||(l.paragraph.paragraphStyle={}),l.paragraph.paragraphStyle.horizontalAlign=t}}return e}_getDocumentDataByStyle(e,t,n){const s=e.length-1,{textRotation:r={a:0,v:Y.FALSE},textDirection:i=po.UNSPECIFIED,paddingData:a={t:0,r:2,b:0,l:2},horizontalAlign:l=ze.UNSPECIFIED,verticalAlign:c=St.UNSPECIFIED,wrapStrategy:u=at.UNSPECIFIED}=n,{a:h=0,v:d=Y.FALSE}=r,{t:g,r:m,b:_,l:p}=a;hr.NORMAL;let v=0,b=h;return d===Y.TRUE&&(v=90,b=90,hr.TBRL),{documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:s,blockType:ke.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:l},elements:{oneElement:{eId:"oneElement",st:0,ed:s,et:H.TEXT_RUN,tr:{ct:e,ts:t}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:g,marginBottom:_,marginRight:m,marginLeft:p,renderConfig:{horizontalAlign:l,verticalAlign:c,centerAngle:v,vertexAngle:b,wrapStrategy:u}}}}___setBorderProps(e,t,n,s,r){var c;const i=(c=s.bd)==null?void 0:c[n];if(!i||!r.border)return!0;const a=_t(i.cl)||Fn,l=r.border;l.getValue(e,t)||l.setValue(e,t,{[n]:{}}),l.getValue(e,t)[n]={type:n,style:i.s,color:a}}_getFontFormat(e){if(!e)return{};const{ff:t,fs:n,it:s,bl:r,ul:i,st:a,ol:l,cl:c,bg:u,bd:h}=e;return{ff:t,fs:n,it:s,bl:r,ul:i,st:a,ol:l,cl:c}}_getOtherStyle(e){if(!e)return{};const{tr:t,td:n,ht:s,vt:r,tb:i,pd:a}=e;return{textRotation:t,textDirection:n,horizontalAlign:s,verticalAlign:r,wrapStrategy:i,paddingData:a}}_getMergeCells(e,t){const n=this.columnWidthAccumulation.length-1;if(t)t={startRow:t.startRow,endRow:t.endRow,endColumn:n,startColumn:0};else{const c=this.rowHeightAccumulation.length-1;t={startRow:0,startColumn:0,endRow:c,endColumn:n}}const{startRow:s,startColumn:r,endRow:i,endColumn:a}=t,l=new Q;for(let c=0;c<e.length;c++){const{startRow:u,endRow:h,startColumn:d,endColumn:g}=e[c];for(let m=s;m<=i;m++){let _=!1;for(let p=r;p<=a;p++)if(m>=u&&m<=h&&p>=d&&p<=g){l.setValue(u,d,{startRow:u,endRow:h,startColumn:d,endColumn:g}),_=!0;break}if(_)break}}return l}static create(e,t,n,s){return new ji(e,t,n,s)}}const fh=["text","richText"];class mh extends fs{constructor(e,t,n){super(t),this._allowCache=!1,n!=null&&n.richText?this._documentData=n.richText:this._documentData=this.convertToDocumentData((n==null?void 0:n.text)||""),this._allowCache&&(this._cacheCanvas=new Mo,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._context=e,this._documentSkeleton=Lo.create(this._documentData,this._context),this._documents=new ws(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(n),this.onTransformChangeObservable.add(s=>{const{type:r,value:i,preValue:a}=s;if(r===st.resize||r===st.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const l=this.getDocsSkeletonPageSize();this.height=(l==null?void 0:l.height)||this.height,this._setTransForm()}})}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var i;const e=(i=this._documentSkeleton)==null?void 0:i.getSkeletonData();if(!e)return;const{pages:t}=e,n=t[t.length-1],{width:s,height:r}=n;return{width:s,height:r}}convertToDocumentData(e){const t=e.length;return{documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:t,blockType:ke.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:t,et:H.TEXT_RUN,tr:{ct:e}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(e){this._documentSkeleton.updateDocumentDataPageSize(e==null?void 0:e.width,e==null?void 0:e.height),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.transformByState({width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0,left:(e==null?void 0:e.left)||0,top:(e==null?void 0:e.top)||0,angle:e==null?void 0:e.angle}),this.setProps(e),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(n=>{if(e[n]===void 0)return!0;fh.indexOf(n)===-1&&(this[`_${n}`]=e[n])}),this.makeDirty(!0),this}_draw(e){this._documents.render(e)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const s=this.transform.clone().invert().applyPoint(t.tl),r=this.transform.clone().invert().applyPoint(t.tr),i=this.transform.clone().invert().applyPoint(t.bl),a=this.transform.clone().invert().applyPoint(t.br),l=[s.x,r.x,i.x,a.x],c=[s.y,r.y,i.y,a.y],u=Math.max(...l),h=Math.min(...l),d=Math.max(...c),g=Math.min(...c);if(this.width+this.strokeWidth<h||u<0||this.height+this.strokeWidth<g||d<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const s=this._cacheCanvas.getContext();this._cacheCanvas.clear(),s.save(),s.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(s),s.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}getContext(){return this._context}toJson(){const e={};return fh.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const N3=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];class L3{constructor(e,t){this._scene=e,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this._observerMap=new Map,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this.onChangeStartObservable=new ae,this.onChangingObservable=new ae,this.onChangeEndObservable=new ae,this._initialProps(t),this._scene.onPointerDownObserver.add(n=>{this._selectedObjectMap.clear(),this._clearControl()})}_initialProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{if(e[n]===void 0)return!0;this[n]=e[n]})}_updateControlChildren(){this._updateControlIterator((e,t)=>{const{left:n,top:s,width:r,height:i,scaleX:a,scaleY:l}=t.getState();e.getObjects().forEach(u=>{const h=u.oKey,d=this._checkTransformerType(h);if(!d)return!0;if(d==="__SpreadsheetTransformerOutline__")u.transformByState(this._getOutlinePosition(r,i,a,l));else{const{left:g,top:m}=this._getRotateAnchorPosition(d,i,r,a,l);u.transformByState({left:g,top:m})}}),e.transformByState({left:n,top:s})})}_anchorMoving(e,t,n,s){const{scrollX:r,scrollY:i}=ko(s),a=t-this._viewportScrollX+r,l=n-this._viewportScrollY+i,c=a-this._startOffsetX,u=l-this._startOffsetY;this._selectedObjectMap.forEach(h=>{const{left:d,top:g,width:m,height:_}=h,p={};switch(e){case"__SpreadsheetTransformerResizeLT__":p.left=d+c,p.top=g+u,p.width=m-c,p.height=_-u;break;case"__SpreadsheetTransformerResizeCT__":p.top=g+u,p.height=_-u;break;case"__SpreadsheetTransformerResizeRT__":p.top=g+u,p.width=m+c,p.height=_-u;break;case"__SpreadsheetTransformerResizeLM__":p.left=d+c,p.width=m-c;break;case"__SpreadsheetTransformerResizeRM__":p.width=c+m;break;case"__SpreadsheetTransformerResizeLB__":p.left=d+c,p.width=m-c,p.height=_+u;break;case"__SpreadsheetTransformerResizeCB__":p.height=u+_;break;case"__SpreadsheetTransformerResizeRB__":p.width=c+m,p.height=u+_;break}h.transformByState(p)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:c,moveY:u,type:1}),this._startOffsetX=a,this._startOffsetY=l}_attachEventToAnchor(e,t="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((n,s)=>{const{offsetX:r,offsetY:i}=n;this._startOffsetX=r,this._startOffsetY=i;const a=this.getScene();a.disableEvent();const l=so.create(this.getScene());l.startScroll(r,i);const{scrollX:c,scrollY:u}=ko(l);this._viewportScrollX=c,this._viewportScrollY=u;const h=this._getRotateAnchorCursor(t);this._moveObserver=a.onPointerMoveObserver.add(d=>{const{offsetX:g,offsetY:m}=d;this._anchorMoving(t,g,m,l),l.scrolling(g,m,()=>{this._anchorMoving(t,g,m,l)}),a.setCursor(h)}),this._upObserver=a.onPointerUpObserver.add(d=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),a.resetCursor(),l.stopScroll()}),s.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:r}=t;this._startOffsetX=s,this._startOffsetY=r;const i=this.getScene();i.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=i.onPointerMoveObserver.add(a=>{}),this._upObserver=i.onPointerUpObserver.add(a=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent()}),n.stopPropagation()})}_getOutlinePosition(e,t,n,s){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:t+this.borderSpacing*2}}_getRotateAnchorCursor(e){let t=Ye.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":t=Ye.MOVE;break;case"__SpreadsheetTransformerRotateLine__":t=Ye.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":t=Ye.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":t=Ye.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":t=Ye.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":t=Ye.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":t=Ye.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":t=Ye.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":t=Ye.SOUTH_EAST_RESIZE;break}return t}_getRotateAnchorPosition(e,t,n,s,r){let i=-this.anchorSize/2,a=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":i=n/2-this.rotateSize/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":i=n/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":i+=n/2,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeRM__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeLB__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":i+=n/2,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":i+=n+this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break}return{left:i,top:a}}_createResizeAnchor(e,t,n){let{height:s,width:r,scaleX:i,scaleY:a}=t.getState();const{left:l,top:c}=this._getRotateAnchorPosition(e,s,r,i,a),u=this._getRotateAnchorCursor(e),h=new Fe(`${e}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:l,top:c});return this._attachHover(h,u,Ye.DEFAULT),h}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((t,n)=>{const s=this._selectedObjectMap.get(n);if(!s)return!0;e(t,s)})}_updateControl(){this._updateControlIterator((e,t)=>{const{left:n,top:s}=t.getState();e.transformByState({left:n,top:s}),e.show(),e.makeDirty(!0)})}_hiddenControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,t,n){e.onPointerEnterObserver.add(()=>{e.cursor=t}),e.onPointerLeaveObserver.add(()=>{e.cursor=n})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear()}_createControl(e){let{left:t,top:n,height:s,width:r,angle:i,scaleX:a,scaleY:l,skewX:c,skewY:u,flipX:h,flipY:d}=e.getState();const g=e.oKey,m=this._selectedObjectMap.size,_=[];if(this.borderEnabled){const b=new Fe(`__SpreadsheetTransformerOutline___${m}`,{zIndex:m-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(r,s,a,l)});_.push(b)}if(this.resizeEnabled){const{left:b,top:C}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",s,r,a,l),D=new Fe(`__SpreadsheetTransformerRotateLine___${m}`,{zIndex:m-1,evented:!1,left:b,top:C,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:O,top:F}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",s,r,a,l),S=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),E=new Fe(`__SpreadsheetTransformerRotate___${m}`,{zIndex:m-1,left:O,top:F,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(E),this._attachHover(E,S,Ye.DEFAULT),_.push(D,E)}if(this.resizeEnabled)for(let b=0,C=this.enabledAnchors.length;b<C;b++){if(this.enabledAnchors[b]!==1)continue;const O=N3[b],F=this._createResizeAnchor(O,e,m);this._attachEventToAnchor(F,O),_.push(F)}const p=new Fi(`__SpreadsheetTransformer___${m}`,..._);p.zIndex=m,p.evented=!1,p.transformByState({left:t,top:n});const v=this.getScene();return v.addObject(p,2),console.log(v,e),this._transformerControlMap.set(g,p),p}getScene(){return this._scene}_moving(e,t,n){const{scrollX:s,scrollY:r}=ko(n),i=e-this._viewportScrollX+s,a=t-this._viewportScrollY+r,l=i-this._startOffsetX,c=a-this._startOffsetY;this._selectedObjectMap.forEach(u=>{u.translate(l+u.left,c+u.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:c,type:1}),this._startOffsetX=i,this._startOffsetY=a}_updateActiveObjectList(e,t){this._selectedObjectMap.has(e.oKey)||(t.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}attachTo(e){if(!!e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:r}=t;this._startOffsetX=s,this._startOffsetY=r;const i=this.getScene();i.disableEvent();const a=so.create(i);a.startScroll(s,r);const{scrollX:l,scrollY:c}=ko(a);this._viewportScrollX=l,this._viewportScrollY=c,this._updateActiveObjectList(e,t),this._moveObserver=i.onPointerMoveObserver.add(u=>{const{offsetX:h,offsetY:d}=u;this._moving(h,d,a),this._hiddenControl(),a.scrolling(h,d,()=>{this._moving(h,d,a)})}),this._upObserver=i.onPointerUpObserver.add(u=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent(),this._updateControl(),a.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),n.stopPropagation()}),e}}class Ki{constructor(e,t,n){var s;if(this._parent=t,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new dt,this._isFirstDirty=!0,this._evented=!0,this._cursor=Ye.DEFAULT,this._transformerOpenState=!1,this.onPointerDownObserver=new ae,this.onPointerMoveObserver=new ae,this.onPointerUpObserver=new ae,this.onDblclickObserver=new ae,this.onMouseWheelObserver=new ae,this.onKeyDownObservable=new ae,this.onKeyUpObservable=new ae,this.onTransformChangeObservable=new ae,this._sceneKey=e,n&&this.transformByState(n),this._parent.classType===ve.ENGINE){const r=this._parent;r.addScene(this),r.hasActiveScene()&&r.setActiveScene(e),this._inputManager=new ms(this)}else this._parent.classType===ve.SCENE_VIEWER&&this._parent.addObject(this);(s=this._parent)==null||s.onTransformChangeObservable.add(r=>{this._resetViewportSize(),this._setTransForm()})}attachControl(e=!0,t=!0,n=!0,s=!0){var r;if(this._parent.classType===ve.ENGINE)return(r=this._inputManager)==null||r.attachControl(e,t,n,s),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach(n=>{n.makeDirty(e)}),this._parent.classType===ve.SCENE_VIEWER&&((t=this._parent)==null||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(t=>{t.makeDirty(e)}),this}isDirty(){for(let e=0;e<this._viewports.length;e++)if(this._viewports[e].isDirty()===!0)return!0;return!1}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(Ye.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;const n=t.getCanvas().getCanvasEle();n.style.cursor=e}get classType(){return ve.SCENE}get transform(){return this._transform}set transform(e){this._transform=e}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===ve.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===ve.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}scaleBy(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX+=e);const s=this.scaleY;return t!==void 0&&(this.scaleY+=t),this.scaleX=Mi(this.scaleX,1),this.scaleY=Mi(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}transformByState(e){const t=Object.keys(e),n={};t.length!==0&&(t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:st.all,value:e,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===ve.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e===ve.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}_createDefaultLayer(e=1){const t=oo.create(this,[],e);return this.addLayer(t),t}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const n=this._layers[t];n.zIndex>=e&&(e=n.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add(t=>{e.scaleCacheCanvas()}),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObjects(e),this}removeObject(e){const t=this.getLayers();for(let n of t)n.removeObject(e);return this}getAllObjects(){const e=[];this._layers.sort(ht);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],n=e?wi:ht;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrder().sort(n));return t}getAllObjectsByOrderForPick(e=!1){const t=[],n=e?wi:ht;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrderForPick().sort(n));return t}getObject(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let s of n)if(s.oKey===e)return s}}fuzzyMathObjects(e){const t=[];for(let n of this._layers){const s=n.getObjectsByOrder();for(let r of s)r.oKey.indexOf(e)>-1&&s.push(r)}return t}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}get sceneKey(){return this._sceneKey}async requestRender(e){return new Promise((t,n)=>{this.render(e),mr(t)})}renderObjects(e,t){return this.getAllObjectsByOrder().forEach(n=>{n.render(e,t)}),this}render(e){var t,n;!this.isDirty()||(!e&&((t=this.getEngine())==null||t.getCanvas().clear()),(n=this.getViewports())==null||n.forEach(s=>s.render(e)))}_resetViewportSize(){this.getViewports().forEach(e=>{e.resetSize()})}_setTransForm(){const e=dt.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(t=>{t.resizeScrollBar()}),this.makeDirty(!0)}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}get evented(){return this._evented}openTransformer(e){this._transformer||(this._transformer=new L3(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var t;!this._transformerOpenState||(t=this._transformer)==null||t.attachTo(e)}getTransformer(){return this._transformer}transformToSceneCoord(e){const t=this._viewports.find(n=>n.isHit(e));if(!!t)return t.getRelativeVector(e)}pick(e){const t=this._viewports.find(l=>l.isHit(e));if(!this._evented||!t)return;const n=t.pickScrollBar(e);if(n)return n;const s=t.getRelativeVector(e);let r=null;const i=this.getAllObjectsByOrderForPick().reverse(),a=i.length;for(let l=0;l<a;l++){const c=i[l];if(!c.visible||!c.evented||c.classType===ve.GROUP)continue;let u=s;if(c.isInGroup&&c.parent.classType===ve.GROUP){const{cumLeft:h,cumTop:d}=this._getGroupCumLeftRight(c);u=u.clone().add(re.FromArray([-h,-d]))}if(c.isHit(u)){if(c.classType===ve.SCENE_VIEWER){const h=c.pick(u);h?r=h:r=c.scene}else r=c;break}else if(c.classType===ve.SCENE_VIEWER){const h=c.pick(u);if(h){r=h;break}}}return!r&&this._parent.classType===ve.ENGINE?this:r}_getGroupCumLeftRight(e){let t=e.parent,n=0,s=0;for(;t.classType===ve.GROUP;){const{left:r,top:i}=t;n+=r,s+=i,t=t.parent}return{cumLeft:n,cumTop:s}}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,n;return!((t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===ve.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var t,n;return!((t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===ve.SCENE_VIEWER?((n=this._parent)==null||n.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var t,n;return!((t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===ve.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerMove(e),!1):!0}triggerDblclick(e){var t,n;return!((t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===ve.SCENE_VIEWER?((n=this._parent)==null||n.triggerDblclick(e),!1):!0}triggerPointerDown(e){var t,n;return!((t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===ve.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var t;return this._parent.classType===ve.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var t;return this._parent.classType===ve.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var t;return this._parent.classType===ve.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var t;return this._parent.classType===ve.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerEnter(e),!1):!0}}class Uo{constructor(e,t,n){var s;this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this.scrollX=0,this.scrollY=0,this._preScrollX=0,this._preScrollY=0,this.onMouseWheelObserver=new ae,this.onScrollAfterObserver=new ae,this.onScrollBeforeObserver=new ae,this._viewPortKey=e,this._scene=t,this.top=(n==null?void 0:n.top)||0,this.left=(n==null?void 0:n.left)||0,this.bottom=(n==null?void 0:n.bottom)||0,this.right=(n==null?void 0:n.right)||0,n!=null&&n.width&&(this.width=n==null?void 0:n.width,this._widthOrigin=this.width),n!=null&&n.height&&(this.height=n==null?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new Mo),this._isWheelPreventDefaultX=(n==null?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(n==null?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),(s=this._scene)==null||s.getParent().onTransformChangeObservable.add(()=>{this._resizeCacheCanvasAndScrollBar()})}get scene(){return this._scene}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}set top(e){var t,n;this._topOrigin=e,this._top=Ln(e,(n=(t=this._scene)==null?void 0:t.getParent())==null?void 0:n.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Ln(e,(t=this.scene.getParent())==null?void 0:t.width)}get bottom(){return this._bottom}set bottom(e){var t;this._bottomOrigin=e,this._bottom=Ln(e,(t=this.scene.getParent())==null?void 0:t.height)}get right(){return this._right}set right(e){var t;this._rightOrigin=e,this._right=Ln(e,(t=this.scene.getParent())==null?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);t.length!==0&&(this._width=void 0,this._height=void 0,t.forEach(n=>{e[n]!==void 0&&(this[n]=e[n])}),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}_resizeCacheCanvasAndScrollBar(e=!1){var i;const{width:t,height:n}=this._getViewPortSize(e);this.width=t,this.height=n;const s=this._scene.width*this._scene.scaleX,r=this._scene.height*this._scene.scaleY;(i=this._scrollBar)==null||i.resize(t,n,s,r),this.makeDirty(!0)}_getViewPortSize(e=!1){var r;const t=(r=this._scene)==null?void 0:r.getParent();let n,s;if(!e&&this._widthOrigin!==void 0)n=this._widthOrigin;else{const i=t.width;n=(t.classType===ve.SCENE_VIEWER?i*t.scaleX:i)-(this._left+this._right)}if(!e&&this._heightOrigin!==void 0)s=this._heightOrigin;else{const i=t.height;s=(t.classType===ve.SCENE_VIEWER?i*t.scaleY:i)-(this._top+this._bottom)}return{width:n,height:s}}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var r,i;if(!this._scrollBar)return;const e=((r=this._scrollBar)==null?void 0:r.limitX)||1/0,t=((i=this._scrollBar)==null?void 0:i.limitY)||1/0;let n=!0,s=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>e?this.scrollX=e:n=!1,this.scrollY<0?this.scrollY=0:this.scrollY>t?this.scrollY=t:s=!1,{isLimitedX:n,isLimitedY:s}}_scroll(e,t){var a,l,c,u;const{x:n,y:s}=t;n!==void 0&&(e===1?this.scrollX+=n:this.scrollX=n),s!==void 0&&(e===1?this.scrollY+=s:this.scrollY=s);const r=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,limitX:(a=this._scrollBar)==null?void 0:a.limitX,limitY:(l=this._scrollBar)==null?void 0:l.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const i=this.transformScroll();return this.actualScrollX=i.x,this.actualScrollY=i.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,actualScrollX:i.x,actualScrollY:i.y,limitX:(c=this._scrollBar)==null?void 0:c.limitX,limitY:(u=this._scrollBar)==null?void 0:u.limitY}),r}getActualScroll(e,t){let n=e,s=t;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,s/=this._scrollBar.ratioScrollY;const{scaleX:r,scaleY:i}=this.scene;n=Math.round(n)/r,s=Math.round(s)/i}else this.actualScrollX!==void 0&&(n=this.actualScrollX),this.actualScrollY!==void 0&&(s=this.actualScrollY);return{x:n,y:s}}transformScroll(){let e=this.scrollX,t=this.scrollY;return this.getActualScroll(e,t)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:n,actualScrollX:s,actualScrollY:r}=e;return t!==void 0&&(this.scrollX=t),n!==void 0&&(this.scrollY=n),s!==void 0&&(this.actualScrollX=s),r!==void 0&&(this.actualScrollY=r),this}getScrollBarTransForm(e=!1){const t=dt.create();return(e||!this._allowCache)&&t.multiply(dt.create([1,0,0,1,this._left,this._top])),t}render(e){var a;const t=e||((a=this._scene.getEngine())==null?void 0:a.getCanvas().getContext());if(!this.isDirty()&&this._allowCache){this._applyCache(t);return}let n=this._scene.transform.clone();n.multiply(dt.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=t;if(!s)return;this._allowCache&&(n.multiply(dt.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const r=n.getMatrix(),i=this.getScrollBarTransForm().getMatrix();s.save(),this._allowCache||(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.drawScrollbar(s),s.restore()),this._allowCache&&this._applyCache(t),this.makeDirty(!1),this._scrollRendered()}_calViewportRelativeBounding(){var u,h,d,g;let e=(h=(u=this._scrollBar)==null?void 0:u.ratioScrollX)!=null?h:1,t=(g=(d=this._scrollBar)==null?void 0:d.ratioScrollY)!=null?g:1,n=this.left,s=(this.width||0)+this.left,r=this.top,i=(this.height||0)+this.top,a=0,l=0;this._preScrollX!=null&&(a=(this._preScrollX-this.scrollX)/e),this._preScrollY!=null&&(l=(this._preScrollY-this.scrollY)/t);const c={tl:re.FromArray([n,r]),tr:re.FromArray([s,r]),bl:re.FromArray([n,i]),br:re.FromArray([s,i]),dx:a,dy:l};return c.tl=this.getRelativeVector(c.tl),c.tr=this.getRelativeVector(c.tr),c.bl=this.getRelativeVector(c.bl),c.br=this.getRelativeVector(c.br),c}getRelativeVector(e){const t=this.scene.transform.clone().invert(),n=this.transformScroll();return t.applyPoint(e).add(re.FromArray([n.x,n.y]))}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();t.classType===ve.SCENE_VIEWER?this._scrollBar.render(e):t.classType===ve.ENGINE&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,this.left,this.top,this.width||0,this.height||0)}onMouseWheel(e,t){if(!this._scrollBar)return;let n;if(e.inputIndex===ce.MouseWheelX){const s=Math.abs(e.deltaX),r=this._scene.width;let a=(this.width||1)/r*s;e.deltaX>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===ve.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()}if(e.inputIndex===ce.MouseWheelY){const s=Math.abs(e.deltaY),r=this._scene.height;let a=(this.height||1)/r*s;e.shiftKey?(e.deltaY>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===ve.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()):(e.deltaY>0?n=this.scrollBy({y:a}):n=this.scrollBy({y:-a}),this._scene.getParent().classType===ve.SCENE_VIEWER?n!=null&&n.isLimitedY||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():n!=null&&n.isLimitedY||e.preventDefault())}e.inputIndex,ce.MouseWheelZ}isHit(e){const{width:t,height:n}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+n}pickScrollBar(e){if(!this._scrollBar)return;const n=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(n)}}class Ss extends To{constructor(){super(Me.BASE_RENDER),this._engine=new Xg}static create(){return new Ss}installTo(e){e.installPlugin(this)}getEngine(){return this._engine}}var ys,me,_h,Ts,ph,vh,Rr={},bh=[],P3=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Sn(o,e){for(var t in e)o[t]=e[t];return o}function Ch(o){var e=o.parentNode;e&&e.removeChild(o)}function f(o,e,t){var n,s,r,i={};for(r in e)r=="key"?n=e[r]:r=="ref"?s=e[r]:i[r]=e[r];if(arguments.length>2&&(i.children=arguments.length>3?ys.call(arguments,2):t),typeof o=="function"&&o.defaultProps!=null)for(r in o.defaultProps)i[r]===void 0&&(i[r]=o.defaultProps[r]);return Rs(o,i,n,s,null)}function Rs(o,e,t,n,s){var r={type:o,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s==null?++_h:s};return s==null&&me.vnode!=null&&me.vnode(r),r}function ee(){return{current:null}}function gt(o){return o.children}function rt(o,e){this.props=o,this.context=e}function As(o,e){if(e==null)return o.__?As(o.__,o.__.__k.indexOf(o)+1):null;for(var t;e<o.__k.length;e++)if((t=o.__k[e])!=null&&t.__e!=null)return t.__e;return typeof o.type=="function"?As(o):null}function Eh(o){var e,t;if((o=o.__)!=null&&o.__c!=null){for(o.__e=o.__c.base=null,e=0;e<o.__k.length;e++)if((t=o.__k[e])!=null&&t.__e!=null){o.__e=o.__c.base=t.__e;break}return Eh(o)}}function qi(o){(!o.__d&&(o.__d=!0)&&Ts.push(o)&&!Ar.__r++||ph!==me.debounceRendering)&&((ph=me.debounceRendering)||setTimeout)(Ar)}function Ar(){for(var o;Ar.__r=Ts.length;)o=Ts.sort(function(e,t){return e.__v.__b-t.__v.__b}),Ts=[],o.some(function(e){var t,n,s,r,i,a;e.__d&&(i=(r=(t=e).__v).__e,(a=t.__P)&&(n=[],(s=Sn({},r)).__v=r.__v+1,Zi(a,r,s,t.__n,a.ownerSVGElement!==void 0,r.__h!=null?[i]:null,n,i==null?As(r):i,r.__h),Ih(n,r),r.__e!=i&&Eh(r)))})}function wh(o,e,t,n,s,r,i,a,l,c){var u,h,d,g,m,_,p,v=n&&n.__k||bh,b=v.length;for(t.__k=[],u=0;u<e.length;u++)if((g=t.__k[u]=(g=e[u])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?Rs(null,g,null,null,g):Array.isArray(g)?Rs(gt,{children:g},null,null,null):g.__b>0?Rs(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)!=null){if(g.__=t,g.__b=t.__b+1,(d=v[u])===null||d&&g.key==d.key&&g.type===d.type)v[u]=void 0;else for(h=0;h<b;h++){if((d=v[h])&&g.key==d.key&&g.type===d.type){v[h]=void 0;break}d=null}Zi(o,g,d=d||Rr,s,r,i,a,l,c),m=g.__e,(h=g.ref)&&d.ref!=h&&(p||(p=[]),d.ref&&p.push(d.ref,null,g),p.push(h,g.__c||m,g)),m!=null?(_==null&&(_=m),typeof g.type=="function"&&g.__k===d.__k?g.__d=l=Sh(g,l,o):l=yh(o,g,d,v,m,l),typeof t.type=="function"&&(t.__d=l)):l&&d.__e==l&&l.parentNode!=o&&(l=As(d))}for(t.__e=_,u=b;u--;)v[u]!=null&&Oh(v[u],v[u]);if(p)for(u=0;u<p.length;u++)Dh(p[u],p[++u],p[++u])}function Sh(o,e,t){for(var n,s=o.__k,r=0;s&&r<s.length;r++)(n=s[r])&&(n.__=o,e=typeof n.type=="function"?Sh(n,e,t):yh(t,n,n,s,n.__e,e));return e}function hn(o,e){return e=e||[],o==null||typeof o=="boolean"||(Array.isArray(o)?o.some(function(t){hn(t,e)}):e.push(o)),e}function yh(o,e,t,n,s,r){var i,a,l;if(e.__d!==void 0)i=e.__d,e.__d=void 0;else if(t==null||s!=r||s.parentNode==null)e:if(r==null||r.parentNode!==o)o.appendChild(s),i=null;else{for(a=r,l=0;(a=a.nextSibling)&&l<n.length;l+=1)if(a==s)break e;o.insertBefore(s,r),i=r}return i!==void 0?i:s.nextSibling}function z3(o,e,t,n,s){var r;for(r in t)r==="children"||r==="key"||r in e||Ir(o,r,null,t[r],n);for(r in e)s&&typeof e[r]!="function"||r==="children"||r==="key"||r==="value"||r==="checked"||t[r]===e[r]||Ir(o,r,e[r],t[r],n)}function Th(o,e,t){e[0]==="-"?o.setProperty(e,t):o[e]=t==null?"":typeof t!="number"||P3.test(e)?t:t+"px"}function Ir(o,e,t,n,s){var r;e:if(e==="style")if(typeof t=="string")o.style.cssText=t;else{if(typeof n=="string"&&(o.style.cssText=n=""),n)for(e in n)t&&e in t||Th(o.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||Th(o.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")r=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in o?e.toLowerCase().slice(2):e.slice(2),o.l||(o.l={}),o.l[e+r]=t,t?n||o.addEventListener(e,r?Ah:Rh,r):o.removeEventListener(e,r?Ah:Rh,r);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in o)try{o[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?o.removeAttribute(e):o.setAttribute(e,t))}}function Rh(o){this.l[o.type+!1](me.event?me.event(o):o)}function Ah(o){this.l[o.type+!0](me.event?me.event(o):o)}function Zi(o,e,t,n,s,r,i,a,l){var c,u,h,d,g,m,_,p,v,b,C,D,O,F,S,E=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,a=e.__e=t.__e,e.__h=null,r=[a]),(c=me.__b)&&c(e);try{e:if(typeof E=="function"){if(p=e.props,v=(c=E.contextType)&&n[c.__c],b=c?v?v.props.value:c.__:n,t.__c?_=(u=e.__c=t.__c).__=u.__E:("prototype"in E&&E.prototype.render?e.__c=u=new E(p,b):(e.__c=u=new rt(p,b),u.constructor=E,u.render=W3),v&&v.sub(u),u.props=p,u.state||(u.state={}),u.context=b,u.__n=n,h=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),E.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Sn({},u.__s)),Sn(u.__s,E.getDerivedStateFromProps(p,u.__s))),d=u.props,g=u.state,h)E.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(E.getDerivedStateFromProps==null&&p!==d&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(p,b),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(p,u.__s,b)===!1||e.__v===t.__v){for(u.props=p,u.state=u.__s,e.__v!==t.__v&&(u.__d=!1),u.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(w){w&&(w.__=e)}),C=0;C<u._sb.length;C++)u.__h.push(u._sb[C]);u._sb=[],u.__h.length&&i.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(p,u.__s,b),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(d,g,m)})}if(u.context=b,u.props=p,u.__v=e,u.__P=o,D=me.__r,O=0,"prototype"in E&&E.prototype.render){for(u.state=u.__s,u.__d=!1,D&&D(e),c=u.render(u.props,u.state,u.context),F=0;F<u._sb.length;F++)u.__h.push(u._sb[F]);u._sb=[]}else do u.__d=!1,D&&D(e),c=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++O<25);u.state=u.__s,u.getChildContext!=null&&(n=Sn(Sn({},n),u.getChildContext())),h||u.getSnapshotBeforeUpdate==null||(m=u.getSnapshotBeforeUpdate(d,g)),S=c!=null&&c.type===gt&&c.key==null?c.props.children:c,wh(o,Array.isArray(S)?S:[S],e,t,n,s,r,i,a,l),u.base=e.__e,e.__h=null,u.__h.length&&i.push(u),_&&(u.__E=u.__=null),u.__e=!1}else r==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=U3(t.__e,e,t,n,s,r,i,l);(c=me.diffed)&&c(e)}catch(w){e.__v=null,(l||r!=null)&&(e.__e=a,e.__h=!!l,r[r.indexOf(a)]=null),me.__e(w,e,t)}}function Ih(o,e){me.__c&&me.__c(e,o),o.some(function(t){try{o=t.__h,t.__h=[],o.some(function(n){n.call(t)})}catch(n){me.__e(n,t.__v)}})}function U3(o,e,t,n,s,r,i,a){var l,c,u,h=t.props,d=e.props,g=e.type,m=0;if(g==="svg"&&(s=!0),r!=null){for(;m<r.length;m++)if((l=r[m])&&"setAttribute"in l==!!g&&(g?l.localName===g:l.nodeType===3)){o=l,r[m]=null;break}}if(o==null){if(g===null)return document.createTextNode(d);o=s?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,d.is&&d),r=null,a=!1}if(g===null)h===d||a&&o.data===d||(o.data=d);else{if(r=r&&ys.call(o.childNodes),c=(h=t.props||Rr).dangerouslySetInnerHTML,u=d.dangerouslySetInnerHTML,!a){if(r!=null)for(h={},m=0;m<o.attributes.length;m++)h[o.attributes[m].name]=o.attributes[m].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===o.innerHTML)||(o.innerHTML=u&&u.__html||""))}if(z3(o,d,h,s,a),u)e.__k=[];else if(m=e.props.children,wh(o,Array.isArray(m)?m:[m],e,t,n,s&&g!=="foreignObject",r,i,r?r[0]:t.__k&&As(t,0),a),r!=null)for(m=r.length;m--;)r[m]!=null&&Ch(r[m]);a||("value"in d&&(m=d.value)!==void 0&&(m!==o.value||g==="progress"&&!m||g==="option"&&m!==h.value)&&Ir(o,"value",m,h.value,!1),"checked"in d&&(m=d.checked)!==void 0&&m!==o.checked&&Ir(o,"checked",m,h.checked,!1))}return o}function Dh(o,e,t){try{typeof o=="function"?o(e):o.current=e}catch(n){me.__e(n,t)}}function Oh(o,e,t){var n,s;if(me.unmount&&me.unmount(o),(n=o.ref)&&(n.current&&n.current!==o.__e||Dh(n,null,e)),(n=o.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(r){me.__e(r,e)}n.base=n.__P=null,o.__c=void 0}if(n=o.__k)for(s=0;s<n.length;s++)n[s]&&Oh(n[s],e,t||typeof o.type!="function");t||o.__e==null||Ch(o.__e),o.__=o.__e=o.__d=void 0}function W3(o,e,t){return this.constructor(o,t)}function zn(o,e,t){var n,s,r;me.__&&me.__(o,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,r=[],Zi(e,o=(!n&&t||e).__k=f(gt,null,[o]),s||Rr,Rr,e.ownerSVGElement!==void 0,!n&&t?[t]:s?null:e.firstChild?ys.call(e.childNodes):null,r,!n&&t?t:s?s.__e:e.firstChild,n),Ih(r,o)}function xh(o,e){zn(o,e,xh)}function ro(o,e,t){var n,s,r,i=Sn({},o.props);for(r in e)r=="key"?n=e[r]:r=="ref"?s=e[r]:i[r]=e[r];return arguments.length>2&&(i.children=arguments.length>3?ys.call(arguments,2):t),Rs(o.type,i,n||o.key,s||o.ref,null)}function Mh(o,e){var t={__c:e="__cC"+vh++,__:o,Consumer:function(n,s){return n.children(s)},Provider:function(n){var s,r;return this.getChildContext||(s=[],(r={})[e]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(i){this.props.value!==i.value&&s.some(qi)},this.sub=function(i){s.push(i);var a=i.componentWillUnmount;i.componentWillUnmount=function(){s.splice(s.indexOf(i),1),a&&a.call(i)}}),n.children}};return t.Provider.__=t.Consumer.contextType=t}ys=bh.slice,me={__e:function(o,e,t,n){for(var s,r,i;e=e.__;)if((s=e.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(o)),i=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(o,n||{}),i=s.__d),i)return s.__E=s}catch(a){o=a}throw o}},_h=0,rt.prototype.setState=function(o,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Sn({},this.state),typeof o=="function"&&(o=o(Sn({},t),this.props)),o&&Sn(t,o),o!=null&&this.__v&&(e&&this._sb.push(e),qi(this))},rt.prototype.forceUpdate=function(o){this.__v&&(this.__e=!0,o&&this.__h.push(o),qi(this))},rt.prototype.render=gt,Ts=[],Ar.__r=0,vh=0;const Is=Mh({});var Jt=(o=>(o.INPUT="input",o.COLOR="color",o.DOUBLE="double",o.JSX="jsx",o.INPUT_NUMBER="inputNumber",o))(Jt||{}),Un=(o=>(o.JSX="jsx",o.JSX_STRING="jsx_string",o.HTML="html",o.HTML_STRING="html_string",o.STRING="string",o.SINGLE="single",o.SELECT="select",o))(Un||{}),io,je,Ji,kh,Wo=0,Bh=[],Dr=[],Fh=me.__b,Nh=me.__r,Lh=me.diffed,Ph=me.__c,zh=me.unmount;function Ho(o,e){me.__h&&me.__h(je,o,Wo||e),Wo=0;var t=je.__H||(je.__H={__:[],__h:[]});return o>=t.__.length&&t.__.push({__V:Dr}),t.__[o]}function Ds(o){return Wo=1,Uh(Hh,o)}function Uh(o,e,t){var n=Ho(io++,2);if(n.t=o,!n.__c&&(n.__=[t?t(e):Hh(void 0,e),function(r){var i=n.__N?n.__N[0]:n.__[0],a=n.t(i,r);i!==a&&(n.__N=[a,n.__[1]],n.__c.setState({}))}],n.__c=je,!je.u)){je.u=!0;var s=je.shouldComponentUpdate;je.shouldComponentUpdate=function(r,i,a){if(!n.__c.__H)return!0;var l=n.__c.__H.__.filter(function(u){return u.__c});if(l.every(function(u){return!u.__N}))return!s||s.call(this,r,i,a);var c=!1;return l.forEach(function(u){if(u.__N){var h=u.__[0];u.__=u.__N,u.__N=void 0,h!==u.__[0]&&(c=!0)}}),!(!c&&n.__c.props===r)&&(!s||s.call(this,r,i,a))}}return n.__N||n.__}function ao(o,e){var t=Ho(io++,3);!me.__s&&ea(t.__H,e)&&(t.__=o,t.i=e,je.__H.__h.push(t))}function Os(o,e){var t=Ho(io++,4);!me.__s&&ea(t.__H,e)&&(t.__=o,t.i=e,je.__h.push(t))}function dn(o){return Wo=5,Or(function(){return{current:o}},[])}function H3(o,e,t){Wo=6,Os(function(){return typeof o=="function"?(o(e()),function(){return o(null)}):o?(o.current=e(),function(){return o.current=null}):void 0},t==null?t:t.concat(o))}function Or(o,e){var t=Ho(io++,7);return ea(t.__H,e)?(t.__V=o(),t.i=e,t.__h=o,t.__V):t.__}function $o(o,e){return Wo=8,Or(function(){return o},e)}function $3(o){var e=je.context[o.__c],t=Ho(io++,9);return t.c=o,e?(t.__==null&&(t.__=!0,e.sub(je)),e.props.value):o.__}function V3(o,e){me.useDebugValue&&me.useDebugValue(e?e(o):o)}function X3(){var o=Ho(io++,11);if(!o.__){for(var e=je.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);o.__="P"+t[0]+"-"+t[1]++}return o.__}function Y3(){for(var o;o=Bh.shift();)if(o.__P&&o.__H)try{o.__H.__h.forEach(xr),o.__H.__h.forEach(Qi),o.__H.__h=[]}catch(e){o.__H.__h=[],me.__e(e,o.__v)}}me.__b=function(o){je=null,Fh&&Fh(o)},me.__r=function(o){Nh&&Nh(o),io=0;var e=(je=o.__c).__H;e&&(Ji===je?(e.__h=[],je.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=Dr,t.__N=t.i=void 0})):(e.__h.forEach(xr),e.__h.forEach(Qi),e.__h=[])),Ji=je},me.diffed=function(o){Lh&&Lh(o);var e=o.__c;e&&e.__H&&(e.__H.__h.length&&(Bh.push(e)!==1&&kh===me.requestAnimationFrame||((kh=me.requestAnimationFrame)||G3)(Y3)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==Dr&&(t.__=t.__V),t.i=void 0,t.__V=Dr})),Ji=je=null},me.__c=function(o,e){e.some(function(t){try{t.__h.forEach(xr),t.__h=t.__h.filter(function(n){return!n.__||Qi(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],me.__e(n,t.__v)}}),Ph&&Ph(o,e)},me.unmount=function(o){zh&&zh(o);var e,t=o.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{xr(n)}catch(s){e=s}}),t.__H=void 0,e&&me.__e(e,t.__v))};var Wh=typeof requestAnimationFrame=="function";function G3(o){var e,t=function(){clearTimeout(n),Wh&&cancelAnimationFrame(e),setTimeout(o)},n=setTimeout(t,100);Wh&&(e=requestAnimationFrame(t))}function xr(o){var e=je,t=o.__c;typeof t=="function"&&(o.__c=void 0,t()),je=e}function Qi(o){var e=je;o.__c=o.__(),je=e}function ea(o,e){return!o||o.length!==e.length||e.some(function(t,n){return t!==o[n]})}function Hh(o,e){return typeof e=="function"?e(o):e}function $h(o,e){for(var t in e)o[t]=e[t];return o}function ta(o,e){for(var t in o)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&o[n]!==e[n])return!0;return!1}function na(o,e){return o===e&&(o!==0||1/o==1/e)||o!=o&&e!=e}function Vo(o){this.props=o}function j3(o,e){function t(s){var r=this.props.ref,i=r==s.ref;return!i&&r&&(r.call?r(null):r.current=null),e?!e(this.props,s)||!i:ta(this.props,s)}function n(s){return this.shouldComponentUpdate=t,f(o,s)}return n.displayName="Memo("+(o.displayName||o.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(Vo.prototype=new rt).isPureReactComponent=!0,Vo.prototype.shouldComponentUpdate=function(o,e){return ta(this.props,o)||ta(this.state,e)};var Vh=me.__b;me.__b=function(o){o.type&&o.type.__f&&o.ref&&(o.props.ref=o.ref,o.ref=null),Vh&&Vh(o)};var K3=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function oa(o){function e(t){var n=$h({},t);return delete n.ref,o(n,t.ref||null)}return e.$$typeof=K3,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(o.displayName||o.name)+")",e}var Xh=function(o,e){return o==null?null:hn(hn(o).map(e))},q3={map:Xh,forEach:Xh,count:function(o){return o?hn(o).length:0},only:function(o){var e=hn(o);if(e.length!==1)throw"Children.only";return e[0]},toArray:hn},Z3=me.__e;me.__e=function(o,e,t,n){if(o.then){for(var s,r=e;r=r.__;)if((s=r.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(o,e)}Z3(o,e,t,n)};var Yh=me.unmount;function Gh(o,e,t){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),o.__c.__H=null),(o=$h({},o)).__c!=null&&(o.__c.__P===t&&(o.__c.__P=e),o.__c=null),o.__k=o.__k&&o.__k.map(function(n){return Gh(n,e,t)})),o}function jh(o,e,t){return o&&(o.__v=null,o.__k=o.__k&&o.__k.map(function(n){return jh(n,e,t)}),o.__c&&o.__c.__P===e&&(o.__e&&t.insertBefore(o.__e,o.__d),o.__c.__e=!0,o.__c.__P=t)),o}function Mr(){this.__u=0,this.t=null,this.__b=null}function Kh(o){var e=o.__.__c;return e&&e.__a&&e.__a(o)}function J3(o){var e,t,n;function s(r){if(e||(e=o()).then(function(i){t=i.default||i},function(i){n=i}),n)throw n;if(!t)throw e;return f(t,r)}return s.displayName="Lazy",s.__f=!0,s}function xs(){this.u=null,this.o=null}me.unmount=function(o){var e=o.__c;e&&e.__R&&e.__R(),e&&o.__h===!0&&(o.type=null),Yh&&Yh(o)},(Mr.prototype=new rt).__c=function(o,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var s=Kh(n.__v),r=!1,i=function(){r||(r=!0,t.__R=null,s?s(a):a())};t.__R=i;var a=function(){if(!--n.__u){if(n.state.__a){var c=n.state.__a;n.__v.__k[0]=jh(c,c.__c.__P,c.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.t.pop();)u.forceUpdate()}},l=e.__h===!0;n.__u++||l||n.setState({__a:n.__b=n.__v.__k[0]}),o.then(i,i)},Mr.prototype.componentWillUnmount=function(){this.t=[]},Mr.prototype.render=function(o,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Gh(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&f(gt,null,o.fallback);return s&&(s.__h=null),[f(gt,null,e.__a?null:o.children),s]};var qh=function(o,e,t){if(++t[1]===t[0]&&o.o.delete(e),o.props.revealOrder&&(o.props.revealOrder[0]!=="t"||!o.o.size))for(t=o.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;o.u=t=t[2]}};function Q3(o){return this.getChildContext=function(){return o.context},o.children}function em(o){var e=this,t=o.i;e.componentWillUnmount=function(){zn(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),o.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,s){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),zn(f(Q3,{context:e.context},o.__v),e.l)):e.l&&e.componentWillUnmount()}function tm(o,e){var t=f(em,{__v:o,i:e});return t.containerInfo=e,t}(xs.prototype=new rt).__a=function(o){var e=this,t=Kh(e.__v),n=e.o.get(o);return n[0]++,function(s){var r=function(){e.props.revealOrder?(n.push(s),qh(e,o,n)):s()};t?t(r):r()}},xs.prototype.render=function(o){this.u=null,this.o=new Map;var e=hn(o.children);o.revealOrder&&o.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return o.children},xs.prototype.componentDidUpdate=xs.prototype.componentDidMount=function(){var o=this;this.o.forEach(function(e,t){qh(o,t,e)})};var Zh=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,nm=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,om=typeof document!="undefined",sm=function(o){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(o)};function rm(o,e,t){return e.__k==null&&(e.textContent=""),zn(o,e),typeof t=="function"&&t(),o?o.__c:null}function im(o,e,t){return xh(o,e),typeof t=="function"&&t(),o?o.__c:null}rt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(o){Object.defineProperty(rt.prototype,o,{configurable:!0,get:function(){return this["UNSAFE_"+o]},set:function(e){Object.defineProperty(this,o,{configurable:!0,writable:!0,value:e})}})});var Jh=me.event;function am(){}function lm(){return this.cancelBubble}function cm(){return this.defaultPrevented}me.event=function(o){return Jh&&(o=Jh(o)),o.persist=am,o.isPropagationStopped=lm,o.isDefaultPrevented=cm,o.nativeEvent=o};var Qh,ed={configurable:!0,get:function(){return this.class}},td=me.vnode;me.vnode=function(o){var e=o.type,t=o.props,n=t;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var r in n={},t){var i=t[r];om&&r==="children"&&e==="noscript"||r==="value"&&"defaultValue"in t&&i==null||(r==="defaultValue"&&"value"in t&&t.value==null?r="value":r==="download"&&i===!0?i="":/ondoubleclick/i.test(r)?r="ondblclick":/^onchange(textarea|input)/i.test(r+e)&&!sm(t.type)?r="oninput":/^onfocus$/i.test(r)?r="onfocusin":/^onblur$/i.test(r)?r="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(r)?r=r.toLowerCase():s&&nm.test(r)?r=r.replace(/[A-Z0-9]/g,"-$&").toLowerCase():i===null&&(i=void 0),/^oninput$/i.test(r)&&(r=r.toLowerCase(),n[r]&&(r="oninputCapture")),n[r]=i)}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=hn(t.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=hn(t.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),o.props=n,t.class!=t.className&&(ed.enumerable="className"in t,t.className!=null&&(n.class=t.className),Object.defineProperty(n,"className",ed))}o.$$typeof=Zh,td&&td(o)};var nd=me.__r;me.__r=function(o){nd&&nd(o),Qh=o.__c};var um={ReactCurrentDispatcher:{current:{readContext:function(o){return Qh.__n[o.__c].props.value}}}};function hm(o){return f.bind(null,o)}function od(o){return!!o&&o.$$typeof===Zh}function dm(o){return od(o)?ro.apply(null,arguments):o}function gm(o){return!!o.__k&&(zn(null,o),!0)}function fm(o){return o&&(o.base||o.nodeType===1&&o)||null}var mm=function(o,e){return o(e)},_m=function(o,e){return o(e)},pm=gt;function sd(o){o()}function vm(o){return o}function bm(){return[!1,sd]}var Cm=Os;function Em(o,e){var t=e(),n=Ds({h:{__:t,v:e}}),s=n[0].h,r=n[1];return Os(function(){s.__=t,s.v=e,na(s.__,e())||r({h:s})},[o,t,e]),ao(function(){return na(s.__,s.v())||r({h:s}),o(function(){na(s.__,s.v())||r({h:s})})},[o]),t}var Ke={useState:Ds,useId:X3,useReducer:Uh,useEffect:ao,useLayoutEffect:Os,useInsertionEffect:Cm,useTransition:bm,useDeferredValue:vm,useSyncExternalStore:Em,startTransition:sd,useRef:dn,useImperativeHandle:H3,useMemo:Or,useCallback:$o,useContext:$3,useDebugValue:V3,version:"17.0.2",Children:q3,render:rm,hydrate:im,unmountComponentAtNode:gm,createPortal:tm,createElement:f,createContext:Mh,createFactory:hm,cloneElement:dm,createRef:ee,Fragment:gt,isValidElement:od,findDOMNode:fm,Component:rt,PureComponent:Vo,memo:j3,forwardRef:oa,flushSync:_m,unstable_batchedUpdates:mm,StrictMode:pm,Suspense:Mr,SuspenseList:xs,lazy:J3,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:um};class _e extends rt{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}_e.contextType=Is;class wm extends Vo{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}wm.contextType=Is;function sa(o){return o instanceof Element||o instanceof HTMLDocument}const Sm=typeof HTMLElement=="object"?function(o){return o instanceof HTMLElement}:function(o){return o&&typeof o=="object"&&o.nodeType===1&&typeof o.nodeName=="string"};function kr(o,e){e=e||document;let t=e.querySelectorAll(o);return t.length===1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function ra(o){return o=o?`${o}-`:"",o+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function ym(o){let e=[],t=o.getElementsByTagName("*");for(let n=0,s=t.length;n<s;++n){if(t[n].nodeType!==1)continue;let r=t[n].parentNode;r&&r.nodeType===1?r===o&&(e[e.length]=t[n]):r&&r.parentNode===o&&(e[e.length]=t[n])}return e}function Ct(...o){if(!o.length)return;let e="";return o.forEach(t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=` ${t}`}),e}function Xo(o,e){let t=null;return function(...n){clearTimeout(t),t=setTimeout(()=>{o(...n)},e)}}function Tm(o){var e,t;if(window.getSelection){let n=document.createRange(),s=o.firstChild;s&&(n.setStart(s,0),n.setEnd(s,s.length),n.startContainer&&rd(n.startContainer)&&((e=window.getSelection())==null||e.removeAllRanges(),(t=window.getSelection())==null||t.addRange(n)))}}function Rm(o,e){var t,n;if(window.getSelection){let s=document.createRange(),r=o.firstChild,i=e.firstChild;r&&i&&(s.setStart(r,0),s.setEnd(i,i.length),s.startContainer&&rd(s.startContainer)&&((t=window.getSelection())==null||t.removeAllRanges(),(n=window.getSelection())==null||n.addRange(s)))}}function rd(o){return o===document.body?!1:document.body.contains(o)}function Et(o){return o.length===0?o:o.replace(/^\s+|\s+$/gm,"")}function Ms(o){if(Sm(o.current))return o.current;let e=o.current;return e?e==null?void 0:e.base:o.base}function Am(o){return typeof o!="string"?o:o.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}function Im(o){const e=window.getSelection();e&&e.selectAllChildren(o),e&&e.collapseToEnd()}function Dm(o){var a;let e=o.childNodes;if(e.length===0)return o.textContent;if(e[0].nodeName==="DIV"&&(e=e[0].childNodes),e.length===1&&e[0].nodeName==="#text")return e[0].textContent;const t={},n=[];let s=0;for(let l=0;l<e.length;l++){let c=e[`${l}`],u;c.nodeName==="#text"?(u=(a=c.textContent)!=null?a:"",c=c.parentElement):u=c.innerText;let h=id(c);xm(u).forEach(g=>{s=+g.length;let m=mt(6);t[m]={eId:m,st:0,ed:g.length-1,et:0,tr:{ct:g,ts:h}},n.push({elementId:m,paragraphElementType:0})})}const r=mt(6);return{documentId:mt(6),body:{blockElements:{[r]:{blockId:r,st:0,ed:s,blockType:0,paragraph:{elements:t,elementOrder:n}},b:{blockId:"b",st:0,ed:0,blockType:ke.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}},blockElementOrder:[r,"b"]},documentStyle:{}}}function Om(o){var t;let e="";if((t=o.body)!=null&&t.blockElements)for(let n in o.body.blockElements){const s=o.body.blockElements[n];if(!(s.blockType!==ke.PARAGRAPH&&s.blockType!==ke.SECTION_BREAK)&&s.blockType===ke.PARAGRAPH)for(let r in s.paragraph){const i=s.paragraph[r];for(let a in i){const l=i[a];if(l.et===H.TEXT_RUN){let c=`display:inline-block;${ad(l.tr.ts)}`;e+=`<span id='${l.eId}' ${c.length?`style="${c}"`:""} >${l.tr.ct}</span>`}}}}return e}function id(o){const e=o.style.cssText;if(e==null||e.length===0)return{};let t=e.split(";"),n={};return t.forEach(s=>{s=s.toLowerCase();let r=Et(s.substr(0,s.indexOf(":"))),i=Et(s.substr(s.indexOf(":")+1));if(r==="font-weight")i==="bold"?n.bl=1:n.bl=0;else if(r==="font-style")i==="italic"?n.it=1:n.it=0;else if(r==="font-family")n.ff=i;else if(r==="font-size"){let a=parseInt(i);e.indexOf("vertical-align")>-1&&(e.indexOf("sub")>-1||e.indexOf("sup")>-1)&&(a*=2),i.indexOf("px")!==-1&&(a=Lg(parseInt(i))),n.fs=a}else r==="color"?n.cl={rgb:i}:r==="background"||r==="background-color"?n.bg={rgb:i}:r==="text-decoration-line"?i==="underline"?(n.ul||(n.ul={s:1}),n.ul.s=1):i==="line-through"?(n.st||(n.st={s:1}),n.st.s=1):i==="overline"&&(n.ol||(n.ol={s:1}),n.ol.s=1):r==="text-decoration-color"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,cl:{rgb:i}}),n.ul.cl={rgb:i}),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,cl:{rgb:i}}),n.st.cl={rgb:i}),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,cl:{rgb:i}}),n.ol.cl={rgb:i})):r==="text-decoration-style"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,t:Number(i)}),n.ul.t=Number(i)),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,t:Number(i)}),n.st.t=Number(i)),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,t:Number(i)}),n.ol.t=Number(i))):(r==="text-decoration"||r==="univer-strike")&&(n.st={s:1});if(r==="univer-underline"&&(n.ul={s:1}),r==="vertical-align"&&(i==="sub"?n.va=1:i==="super"?n.va=2:i==="top"?n.vt=1:i==="middle"?n.vt=2:i==="bottom"?n.vt=3:n.va=0),r==="transform"){const a=i.split(")"),l=a.findIndex(c=>c.includes("rotate"));if(l>-1){const c=a[l].match(/\d+/g);let u=0,h=0;c!=null&&c.length&&(u=+c[0]),o.dataset.vertical&&(h=+o.dataset.vertical),n.tr={a:u,v:h}}}r==="text-align"&&(i==="left"?n.ht=1:i==="center"?n.ht=2:i==="right"?n.ht=3:i==="justify"?n.ht=4:n.ht=0),(r==="overflow-wrap"||r==="overflowWrap")&&i==="break-word"&&(n.tb=3)}),n}function xm(o){if(o==="")return[o];const e=/(?:(\n+.+)|(.+))/g;return o.match(e).map(s=>s.replace(/\n/g,`\r
`))}function ad(o,e=!1){var r;let t="";const n=new Map([["ff",()=>{o.ff&&(t+=`font-family: ${o.ff}; `)}],["fs",()=>{if(o.fs){let i=o.fs;o.va&&(i/=2),t+=`font-size: ${i}pt; `}}],["it",()=>{o.it?t+="font-style: italic; ":t+="font-style: normal; "}],["bl",()=>{o.bl?t+="font-weight: bold; ":t+="font-weight: normal; "}],["ul",()=>{var i;(i=o.ul)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):t+="text-decoration-line: underline; ",o.ul.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${_t(o.ul.cl)}; `),o.ul.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${o.ul.t} `))}],["st",()=>{var i;(i=o.st)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):t+="text-decoration-line: line-through; ",o.st.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${_t(o.st.cl)}; `),o.st.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${o.st.t} `))}],["ol",()=>{var i;(i=o.ol)!=null&&i.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):t+="text-decoration-line: overline; ",o.ol.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${_t(o.ol.cl)}; `),o.ol.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${o.ol.t} `))}],["bg",()=>{t+=`background: ${_t(o.bg)}; `}],["bd",()=>{var i,a,l,c,u,h,d,g,m,_,p,v;(i=o.bd)!=null&&i.b&&(t+=`border-bottom: ${Br((a=o.bd)==null?void 0:a.b.s)} ${(l=_t(o.bd.b.cl))!=null?l:""}; `),(c=o.bd)!=null&&c.t&&(t+=`border-top: ${Br((u=o.bd)==null?void 0:u.t.s)} ${(h=_t(o.bd.t.cl))!=null?h:""}; `),(d=o.bd)!=null&&d.r&&(t+=`border-right: ${Br((g=o.bd)==null?void 0:g.r.s)} ${(m=_t(o.bd.r.cl))!=null?m:""}; `),(_=o.bd)!=null&&_.l&&(t+=`border-left: ${Br((p=o.bd)==null?void 0:p.l.s)} ${(v=_t(o.bd.l.cl))!=null?v:""}; `)}],["cl",()=>{t+=`color: ${_t(o.cl)}; `}],["va",()=>{o.va===yt.NORMAL?t+="vertical-align: baseline; ":o.va===yt.SUBSCRIPT?t+="vertical-align: sub; ":t+="vertical-align: super; "}],["td",()=>{o.td===po.UNSPECIFIED?t+="direction: inherit; ":o.td===po.LEFT_TO_RIGHT?t+="direction: ltr; ":t+="direction: rtl; "}],["tr",()=>{var i,a,l;t+=`data-rotate: (${(i=o.tr)==null?void 0:i.a}deg${(a=o.tr)!=null&&a.v?` ,${(l=o.tr)==null?void 0:l.v}`:""});`}],["ht",()=>{o.ht===ze.UNSPECIFIED?t+="text-align: inherit; ":o.ht===ze.LEFT?t+="text-align: left; ":o.ht===ze.RIGHT?t+="text-align: right; ":o.ht===ze.CENTER?t+="text-align: center; ":t+="text-align: justify; "}],["vt",()=>{o.vt===St.UNSPECIFIED?t+="vertical-align: inherit; ":o.vt===St.BOTTOM?t+="vertical-align: bottom; ":o.vt===St.TOP?t+="vertical-align: top; ":t+="vertical-align: middle; "}],["tb",()=>{o.tb===at.CLIP?t+="text-overflow: clip; ":o.tb===at.OVERFLOW?t+="text-break: overflow; ":o.tb===at.WRAP&&(t+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var u,h,d,g,m,_,p,v;let i=`${(u=o.pd)==null?void 0:u.b}pt`,a=`${(h=o.pd)==null?void 0:h.t}pt`,l=`${(d=o.pd)==null?void 0:d.l}pt`,c=`${(g=o.pd)==null?void 0:g.r}pt`;(m=o.pd)!=null&&m.b&&(t+=`padding-bottom: ${i}; `),(_=o.pd)!=null&&_.t&&(t+=`padding-top: ${a}; `),(p=o.pd)!=null&&p.l&&(t+=`padding-left: ${l}; `),(v=o.pd)!=null&&v.r&&(t+=`padding-right: ${c}; `)}]]),s=["bd","tr","tb"];for(let i in o)e&&s.includes(i)||(r=n.get(i))==null||r();return t}function Br(o){let e="";return o===ye.NONE?e="none":o===ye.THIN?e="0.5pt solid":o===ye.HAIR?e="0.5pt double":o===ye.DOTTED?e="0.5pt dotted":o===ye.DASHED||o===ye.DASH_DOT?e="0.5pt dashed":o===ye.DASH_DOT_DOT?e="0.5pt dotted":o===ye.DOUBLE?e="0.5pt double":o===ye.MEDIUM?e="1pt solid":o===ye.MEDIUM_DASHED||o===ye.MEDIUM_DASH_DOT?e="1pt dashed":o===ye.MEDIUM_DASH_DOT_DOT?e="1pt dotted":o===ye.SLANT_DASH_DOT?e="0.5pt dashed":o===ye.THICK&&(e="1.5pt solid"),e}var k2={avatar:"univer-avatar",avatarImage:"univer-avatar-image",avatarSquare:"univer-avatar-square",avatarLg:"univer-avatar-lg",avatarSm:"univer-avatar-sm"},ia={icon:"univer-icon",iconIcon:"univer-icon-icon",iconSpin:"univer-icon-spin",loadingCircle:"univer-loadingCircle"};const ne=o=>{const{spin:e,rotate:t,children:n,name:s,style:r,className:i}=o;let a;r?(a=r,a.transform=t?`rotate(${t}deg)`:""):a=t?{transform:`rotate(${t}deg)`}:{};const l=Ct(ia.icon,{[`${ia.icon}-${s}`]:s,[`${ia.icon}-spin`]:e||s==="loading"},i);return f("span",{role:"img",className:l,style:{...a}},n)},ld=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"loading",style:o.style},f("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));class Mm{render(){return ld}}const km=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"logo",style:o.style},f("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},f("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),f("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),f("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),f("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),f("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"})));class Bm{render(){return km}}const Fm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),f("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),f("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),f("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),f("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),Nm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),f("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),f("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),f("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),Lm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),Pm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),zm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),Um=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),f("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),Wm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})));class Hm{render(){return Fm}}class $m{render(){return Nm}}class Vm{render(){return Lm}}class Xm{render(){return Pm}}class Ym{render(){return zm}}class Gm{render(){return Um}}class jm{render(){return Wm}}const Km=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),qm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),f("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),f("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Zm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),f("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),f("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),Jm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),f("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),f("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),f("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),Qm=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));class e0{render(){return Km}}class t0{render(){return qm}}class n0{render(){return Zm}}class o0{render(){return Jm}}class s0{render(){return Qm}}const r0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),f("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),i0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),a0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),f("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),l0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),f("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),f("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),f("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),f("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),f("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),f("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),c0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),f("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),f("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),f("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),f("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),f("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),u0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),f("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),f("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),f("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),f("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),f("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),f("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),h0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),f("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),f("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),d0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),f("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),f("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),g0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),f("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),f0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),m0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),f("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),_0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),f("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));class p0{render(){return r0}}class v0{render(){return i0}}class b0{render(){return a0}}class C0{render(){return l0}}class E0{render(){return c0}}class w0{render(){return u0}}class S0{render(){return h0}}class y0{render(){return d0}}class T0{render(){return g0}}class R0{render(){return f0}}class A0{render(){return m0}}class I0{render(){return _0}}const D0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),O0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),x0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),M0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),k0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),B0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),F0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),N0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),L0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),P0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),z0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),U0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),W0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),f("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),f("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),H0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),f("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),$0=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),f("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));class V0{render(){return D0}}class X0{render(){return O0}}class Y0{render(){return x0}}class G0{render(){return M0}}class j0{render(){return k0}}class K0{render(){return B0}}class q0{render(){return F0}}class Z0{render(){return N0}}class J0{render(){return L0}}class Q0{render(){return P0}}class e1{render(){return z0}}class t1{render(){return U0}}class n1{render(){return W0}}class o1{render(){return H0}}class s1{render(){return $0}}const r1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),i1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),f("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),a1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),f("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),f("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})));class l1{render(){return r1}}class c1{render(){return i1}}class u1{render(){return a1}}const cd=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),ud=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),hd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),dd=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"nextIcon",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),gd=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"rightIcon",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),fd=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),f("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),md=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},f("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),f("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),aa=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),f("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),_d=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),pd=o=>f(ne,{spin:o.spin,rotate:o.rotate,className:o.className,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),f("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),f("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var ks={BackIcon:cd,ForwardIcon:ud,FormatIcon:hd,NextIcon:dd,RightIcon:gd,CorrectIcon:fd,LtIcon:md,CloseIcon:aa,MenuIcon:_d,HideIcon:pd};class h1{render(){return cd}}class d1{render(){return ud}}class g1{render(){return hd}}class f1{render(){return dd}}class m1{render(){return gd}}class _1{render(){return fd}}class p1{render(){return md}}class v1{render(){return aa}}class b1{render(){return aa}}class C1{render(){return _d}}class E1{render(){return pd}}const w1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),S1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),y1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),T1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),R1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),A1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),I1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),f("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),D1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),O1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})));class x1{render(){return w1}}class M1{render(){return S1}}class k1{render(){return y1}}class B1{render(){return T1}}class F1{render(){return R1}}class N1{render(){return A1}}class L1{render(){return I1}}class P1{render(){return D1}}class z1{render(){return O1}}const vd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),f("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"})));class U1{render(){return vd}}const bd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},f("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),f("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),f("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),f("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),f("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"})));class W1{render(){return bd}}const Cd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"})));class H1{render(){return Cd}}const Ed=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"})));class $1{render(){return Ed}}const wd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"})));class V1{render(){return wd}}const Sd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"})));class X1{render(){return Sd}}const yd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"})));class Y1{render(){return yd}}const Td=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"})));class G1{render(){return Td}}const Rd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),f("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),f("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"})));class j1{render(){return Rd}}const Ad=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),f("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),f("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"})));class K1{render(){return Ad}}const Id=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"})));class q1{render(){return Id}}const Dd=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));class Z1{render(){return Dd}}var J1={CommentIcon:vd,FreezeIcon:bd,conditionalFormatIcon:Cd,DivideIcon:Ed,ReplaceIcon:wd,SearchIcon:Sd,LockIcon:yd,LocationIcon:Td,PageIcon:Rd,RegularIcon:Ad,LayoutIcon:Id,TableIcon:Dd};const Q1=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),f("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),f("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),e_=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),t_=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),n_=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),f("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),o_=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"foward",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})));class s_{render(){return Q1}}class r_{render(){return e_}}class i_{render(){return t_}}class a_{render(){return n_}}class l_{render(){return o_}}const c_=o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"logo",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},f("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),f("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"})));class u_{render(){return c_}}var Od={Close:o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"logo",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),f("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),DropDownIcon:o=>f(ne,{spin:o.spin,rotate:o.rotate,name:"dropdown",style:o.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},f("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),f("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})))};const h_={RightIcon:f(ks.RightIcon,null)};var lo={btn:"univer-btn",btnLg:"univer-btn-lg",btnSm:"univer-btn-sm",btnPrimary:"univer-btn-primary",btnDanger:"univer-btn-danger",btnText:"univer-btn-text",btnRound:"univer-btn-round",btnCircle:"univer-btn-circle",btnBlock:"univer-btn-block",btnLoading:"univer-btn-loading"};const Qt=o=>{const{type:e,shape:t,size:n,htmlType:s="button",danger:r=!1,disabled:i,block:a=!1,loading:l=!1,active:c=!1,onClick:u,children:h,className:d="",style:g}=o,m=C=>{if(i){C.preventDefault();return}u&&u(C)};let _="";switch(n){case"large":_="lg";break;case"small":_="sm";break}const p=Ct(lo.btn,{[`${lo.btn}-${e}`]:e,[`${lo.btn}-${t}`]:t,[`${lo.btn}-${_}`]:n,[`${lo.btn}-danger`]:!!r,[`${lo.btn}-block`]:a,[`${lo.btn}-loading`]:l},d);let v=g;return c&&(v=Object.assign(g||{},{background:"#eee"})),f("button",{type:s,onClick:m,className:p,disabled:i,style:{...v}},l?f(ld,null):"",h)};class d_{render(){return Qt}}var g_={};class en extends _e{constructor(){super(...arguments),this.canvasRef=ee()}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,n,s,r,i,a){try{t==="Hair"?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(l){console.log(l)}e.beginPath(),t.indexOf("Medium")>-1?(n==="h"?(e.moveTo(s,r-.5),e.lineTo(i,a-.5)):(e.moveTo(s-.5,r),e.lineTo(i-.5,a)),e.lineWidth=2):t==="Thick"?(e.moveTo(s,r),e.lineTo(i,a),e.lineWidth=3):(e.moveTo(s,r),e.lineTo(i,a),e.lineWidth=1)}render(){return f("canvas",{ref:this.canvasRef,className:g_.canvas,width:this.props.width,height:this.props.height})}}class f_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thin","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class m_{render(){return f_}}class __ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Hair","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class p_{render(){return __}}class v_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dotted","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class b_{render(){return v_}}class C_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class E_{render(){return C_}}class w_ extends _e{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class S_{render(){return w_}}class y_ extends _e{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class T_{render(){return y_}}class R_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Medium","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class A_{render(){return R_}}class I_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class D_{render(){return I_}}class O_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class x_{render(){return O_}}class M_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class k_{render(){return M_}}class B_ extends rt{constructor(){super(...arguments),this.ref=ee()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thick","h",0,5,100,5),n.stroke(),n.closePath()}render(){return f(en,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class F_{render(){return B_}}var xd={cellRangeModal:"univer-cell-range-modal",input:"univer-input",cellModalIcon:"univer-cell-modal-icon"};class N_ extends _e{constructor(){super(...arguments),this.ref=ee(),this.state={modalData:[{name:"dataValidation.selectCellRange2",show:!1,group:[{name:"button.confirm",type:"primary",onClick:()=>this.handleOk()},{name:"button.cancel"}]}],placeholderState:{name:"dataValidation.selectCellRange2"},value:""},this.showModal=(e,t)=>{let{modalData:n}=this.state;const s=n.findIndex(r=>r.name===e);s>-1&&(n[s].show=t),this.setValue({modalData:n})},this.handleOk=()=>{const e=this.ref.current.getValue();this.showModal("dataValidation.selectCellRange2",!1),this.setValue({value:e})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.changeRange=e=>{const t=e.target;this.setValue({value:t.value})},this.showRange=()=>{var e;this.showModal("dataValidation.selectCellRange2",!0),(e=this._context.getWorkBook().getActiveSheet())==null||e.getSelection().setSelection({selection:this.state.value})}}setLocale(){const e=this.context.locale;this.setState(t=>{let{modalData:n,placeholderState:s}=t;return n.forEach(r=>{r.title=e.get(r.locale),r.group&&r.group.length&&r.group.forEach(i=>{i.label=e.get(i.locale)})}),s.label=e.get(s.name),{modalData:n,placeholderState:s}})}componentWillReceiveProps(e){this.setValue({value:e.valueProps})}componentDidMount(){var e,t;this.setValue({value:this.props.valueProps}),this.setLocale(),this._context,this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()}),this._localeObserver1=(t=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable","worksheet"))==null?void 0:t.add(n=>{console.dir(n)})}componentWillUnmount(){}render(e,t){const{modalData:n,placeholderState:s,value:r}=t,{placeholderProps:i}=e;return f("div",{className:xd.cellRangeModal},f(Ns,{placeholder:i,value:r,onChange:a=>this.changeRange(a)}),f("span",{className:xd.cellModalIcon,onClick:this.showRange},f(J1.TableIcon,null)),n.map(a=>{if(!!a.show)return f(fa,{title:a.title,visible:a.show,group:a.group,onCancel:a.onCancel},f(Ns,{readonly:!0,placeholder:s.label,value:r,ref:this.ref}))}))}}class L_{render(){return N_}}var yn={checkboxWrapper:"univer-checkbox-wrapper",checkBox:"univer-check-box",checkboxInput:"univer-checkbox-input",checkboxInner:"univer-checkbox-inner",checkBoxChecked:"univer-check-box-checked",checkBoxDisabled:"univer-check-box-disabled",checkboxGroup:"univer-checkbox-group"};class Md extends _e{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${yn.checkBox}`:yn.checkBox,check:!0},this.handleStyle=(e,t)=>{let n=Ct(yn.checkBox,{[`${yn.checkBox}-checked`]:e,[`${yn.checkBox}-disabled`]:t});this.setState(s=>({classes:n,check:e}))},this.handleChange=e=>{var n,s;const t=e.target;this.handleStyle(t.checked,this.props.disabled),(s=(n=this.props).onChange)==null||s.call(n,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:n,check:s}=t,{value:r,name:i,disabled:a,children:l}=e;return f("label",{className:yn.checkboxWrapper},f("span",{className:n},f("span",{className:yn.checkboxInner}),f("input",{type:"checkbox",name:i,checked:s,disabled:a,className:yn.checkboxInput,value:r,onChange:this.handleChange})),l&&f("span",null,l))}}class P_{render(){return Md}}const z_=o=>{let{options:e,onChange:t,disabled:n,name:s}=o,r=dn(null);n&&e.forEach(a=>{a.disabled=!0}),s&&e.forEach(a=>{a.name=s});const i=()=>{var c;if(!t)return;let a=(c=r.current)==null?void 0:c.querySelectorAll("label input"),l=[];a==null||a.forEach(u=>{let h=u;h.checked&&l.push(h.value)}),t(l)};return f("div",{className:yn.checkboxGroup,ref:r},e.map(a=>f(Md,{name:a.name,disabled:a.disabled,checked:a.checked,onChange:i,value:a.value},a.label)))};class U_{render(){return z_}}var Tn={panelWrapper:"univer-panel-wrapper",panelHeader:"univer-panel-header",panelHeaderIcon:"univer-panel-header-icon",panelHeaderIconRotate:"univer-panel-header-icon-rotate",panelBody:"univer-panel-body",active:"univer-active"};const W_=o=>{const{header:e,children:t}=o;let[n,s]=Ds(Ct(Tn.panelBody));const r=()=>{n.includes("active")?s(Ct(Tn.panelBody)):s(Ct(Tn.panelBody,Tn.active))};return f("div",{className:Tn.panelWrapper},f("div",{className:Tn.panelHeader,onClick:()=>r()},e,f("span",{className:`${Tn.panelHeaderIcon} ${n.includes("active")?Tn.panelHeaderIconRotate:""}`},f(ks.NextIcon,null))),f("div",{className:n},t))},H_=o=>{const{children:e}=o;return f("div",{className:Tn.collapseWrapper},e)};class $_{render(){return H_}}class V_{render(){return W_}}function Yo(){return(Yo=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o}).apply(this,arguments)}function Fr(o,e){if(o==null)return{};var t,n,s={},r=Object.keys(o);for(n=0;n<r.length;n++)e.indexOf(t=r[n])>=0||(s[t]=o[t]);return s}function Bs(o){var e=dn(o),t=dn(function(n){e.current&&e.current(n)});return e.current=o,t.current}var Go=function(o,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),o>t?t:o<e?e:o},Fs=function(o){return"touches"in o},la=function(o){return o&&o.ownerDocument.defaultView||self},kd=function(o,e,t){var n=o.getBoundingClientRect(),s=Fs(e)?function(r,i){for(var a=0;a<r.length;a++)if(r[a].identifier===i)return r[a];return r[0]}(e.touches,t):e;return{left:Go((s.pageX-(n.left+la(o).pageXOffset))/n.width),top:Go((s.pageY-(n.top+la(o).pageYOffset))/n.height)}},Bd=function(o){!Fs(o)&&o.preventDefault()},ca=Ke.memo(function(o){var e=o.onMove,t=o.onKey,n=Fr(o,["onMove","onKey"]),s=dn(null),r=Bs(e),i=Bs(t),a=dn(null),l=dn(!1),c=Or(function(){var g=function(p){Bd(p),(Fs(p)?p.touches.length>0:p.buttons>0)&&s.current?r(kd(s.current,p,a.current)):_(!1)},m=function(){return _(!1)};function _(p){var v=l.current,b=la(s.current),C=p?b.addEventListener:b.removeEventListener;C(v?"touchmove":"mousemove",g),C(v?"touchend":"mouseup",m)}return[function(p){var v=p.nativeEvent,b=s.current;if(b&&(Bd(v),!function(D,O){return O&&!Fs(D)}(v,l.current)&&b)){if(Fs(v)){l.current=!0;var C=v.changedTouches||[];C.length&&(a.current=C[0].identifier)}b.focus(),r(kd(b,v,a.current)),_(!0)}},function(p){var v=p.which||p.keyCode;v<37||v>40||(p.preventDefault(),i({left:v===39?.05:v===37?-.05:0,top:v===40?.05:v===38?-.05:0}))},_]},[i,r]),u=c[0],h=c[1],d=c[2];return ao(function(){return d},[d]),Ke.createElement("div",Yo({},n,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:s,onKeyDown:h,tabIndex:0,role:"slider"}))}),Nr=function(o){return o.filter(Boolean).join(" ")},ua=function(o){var e=o.color,t=o.left,n=o.top,s=n===void 0?.5:n,r=Nr(["react-colorful__pointer",o.className]);return Ke.createElement("div",{className:r,style:{top:100*s+"%",left:100*t+"%"}},Ke.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Rt=function(o,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*o)/t},Fd=function(o){var e=o.s,t=o.v,n=o.a,s=(200-e)*t/100;return{h:Rt(o.h),s:Rt(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:Rt(s/2),a:Rt(n,2)}},ha=function(o){var e=Fd(o);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},da=function(o){var e=Fd(o);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},X_=function(o){var e=o.h,t=o.s,n=o.v,s=o.a;e=e/360*6,t/=100,n/=100;var r=Math.floor(e),i=n*(1-t),a=n*(1-(e-r)*t),l=n*(1-(1-e+r)*t),c=r%6;return{r:Rt(255*[n,a,i,i,l,n][c]),g:Rt(255*[l,n,n,a,i,i][c]),b:Rt(255*[i,i,l,n,n,a][c]),a:Rt(s,2)}},Y_=function(o){var e=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(o);return e?G_({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}},G_=function(o){var e=o.r,t=o.g,n=o.b,s=o.a,r=Math.max(e,t,n),i=r-Math.min(e,t,n),a=i?r===e?(t-n)/i:r===t?2+(n-e)/i:4+(e-t)/i:0;return{h:Rt(60*(a<0?a+6:a)),s:Rt(r?i/r*100:0),v:Rt(r/255*100),a:s}},j_=Ke.memo(function(o){var e=o.hue,t=o.onChange,n=Nr(["react-colorful__hue",o.className]);return Ke.createElement("div",{className:n},Ke.createElement(ca,{onMove:function(s){t({h:360*s.left})},onKey:function(s){t({h:Go(e+360*s.left,0,360)})},"aria-label":"Hue","aria-valuenow":Rt(e),"aria-valuemax":"360","aria-valuemin":"0"},Ke.createElement(ua,{className:"react-colorful__hue-pointer",left:e/360,color:ha({h:e,s:100,v:100,a:1})})))}),K_=Ke.memo(function(o){var e=o.hsva,t=o.onChange,n={backgroundColor:ha({h:e.h,s:100,v:100,a:1})};return Ke.createElement("div",{className:"react-colorful__saturation",style:n},Ke.createElement(ca,{onMove:function(s){t({s:100*s.left,v:100-100*s.top})},onKey:function(s){t({s:Go(e.s+100*s.left,0,100),v:Go(e.v-100*s.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Rt(e.s)+"%, Brightness "+Rt(e.v)+"%"},Ke.createElement(ua,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:ha(e)})))}),q_=function(o,e){if(o===e)return!0;for(var t in o)if(o[t]!==e[t])return!1;return!0},Z_=function(o,e){return o.replace(/\s/g,"")===e.replace(/\s/g,"")};function J_(o,e,t){var n=Bs(t),s=Ds(function(){return o.toHsva(e)}),r=s[0],i=s[1],a=dn({color:e,hsva:r});ao(function(){if(!o.equal(e,a.current.color)){var c=o.toHsva(e);a.current={hsva:c,color:e},i(c)}},[e,o]),ao(function(){var c;q_(r,a.current.hsva)||o.equal(c=o.fromHsva(r),a.current.color)||(a.current={hsva:r,color:c},n(c))},[r,o,n]);var l=$o(function(c){i(function(u){return Object.assign({},u,c)})},[]);return[r,l]}var Q_=typeof window!="undefined"?Os:ao,ep=function(){return typeof __webpack_nonce__!="undefined"?__webpack_nonce__:void 0},Nd=new Map,tp=function(o){Q_(function(){var e=o.current?o.current.ownerDocument:document;if(e!==void 0&&!Nd.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Nd.set(e,t);var n=ep();n&&t.setAttribute("nonce",n),e.head.appendChild(t)}},[])},np=function(o){var e=o.className,t=o.hsva,n=o.onChange,s={backgroundImage:"linear-gradient(90deg, "+da(Object.assign({},t,{a:0}))+", "+da(Object.assign({},t,{a:1}))+")"},r=Nr(["react-colorful__alpha",e]),i=Rt(100*t.a);return Ke.createElement("div",{className:r},Ke.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),Ke.createElement(ca,{onMove:function(a){n({a:a.left})},onKey:function(a){n({a:Go(t.a+a.left)})},"aria-label":"Alpha","aria-valuetext":i+"%","aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"},Ke.createElement(ua,{className:"react-colorful__alpha-pointer",left:t.a,color:da(t)})))},op=function(o){var e=o.className,t=o.colorModel,n=o.color,s=n===void 0?t.defaultColor:n,r=o.onChange,i=Fr(o,["className","colorModel","color","onChange"]),a=dn(null);tp(a);var l=J_(t,s,r),c=l[0],u=l[1],h=Nr(["react-colorful",e]);return Ke.createElement("div",Yo({},i,{ref:a,className:h}),Ke.createElement(K_,{hsva:c,onChange:u}),Ke.createElement(j_,{hue:c.h,onChange:u}),Ke.createElement(np,{hsva:c,onChange:u,className:"react-colorful__last-control"}))},sp={defaultColor:"rgba(0, 0, 0, 1)",toHsva:Y_,fromHsva:function(o){var e=X_(o);return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},equal:Z_},rp=function(o){return Ke.createElement(op,Yo({},o,{colorModel:sp}))},ip=/^#?([0-9A-F]{3,8})$/i,ap=function(o){var e=o.color,t=e===void 0?"":e,n=o.onChange,s=o.onBlur,r=o.escape,i=o.validate,a=o.format,l=o.process,c=Fr(o,["color","onChange","onBlur","escape","validate","format","process"]),u=Ds(function(){return r(t)}),h=u[0],d=u[1],g=Bs(n),m=Bs(s),_=$o(function(v){var b=r(v.target.value);d(b),i(b)&&g(l?l(b):b)},[r,l,i,g]),p=$o(function(v){i(v.target.value)||d(r(t)),m(v)},[t,r,i,m]);return ao(function(){d(r(t))},[t,r]),Ke.createElement("input",Yo({},c,{value:a?a(h):h,spellCheck:"false",onChange:_,onBlur:p}))},Ld=function(o){return"#"+o},lp=function(o){var e=o.prefixed,t=o.alpha,n=Fr(o,["prefixed","alpha"]),s=$o(function(i){return i.replace(/([^0-9A-F]+)/gi,"").substring(0,t?8:6)},[t]),r=$o(function(i){return function(a,l){var c=ip.exec(a),u=c?c[1].length:0;return u===3||u===6||!!l&&u===4||!!l&&u===8}(i,t)},[t]);return Ke.createElement(ap,Yo({},n,{escape:s,format:e?Ld:void 0,process:Ld,validate:r}))},ga={input:"univer-input",inputFocused:"univer-input-focused",inputDisabled:"univer-input-disabled",inputBorderless:"univer-input-borderless",inputBorderlessFocused:"univer-input-borderless-focused"};class Ns extends _e{constructor(){super(...arguments),this.ref=ee(),this.setValue=(e,t)=>{this.setState(n=>({value:e}),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const n=e.target;this.setValue(n.value),t(e)},this.handleKeyUp=e=>{const{onKeyUp:t}=this.props;t==null||t(e)},this.onFocus=e=>{const{onFocus:t}=this.props;t==null||t(e)},this.onClick=e=>{const{onClick:t}=this.props;t==null||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;t==null||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:n,disabled:s,type:r,placeholder:i,bordered:a=!0,className:l="",readonly:c}=e,{value:u}=t,h=Ct(ga.input,{[`${ga.input}-disable`]:s,[`${ga.input}-borderless`]:!a},l);return f("input",{type:r,onBlur:this.onBlur,onFocus:this.onFocus,className:h,placeholder:i,disabled:s,ref:this.ref,onChange:this.handleChange,value:u,onClick:this.onClick,readonly:c,id:n,onKeyUp:this.handleKeyUp})}}class cp{render(){return Ns}}const up=o=>{let{color:e}=o;if(!e)return null;let t;if(e.indexOf("#")>-1){if(e=ln.hexToRgbString(e),!e)return null;t=e.replace("rgba(","").replace(")","").split(",")}else e.indexOf("rgba")>-1?t=e.replace("rgba(","").replace(")","").split(","):(t=e.replace("rgb(","").replace(")","").split(","),t.push("1"));let n=dn(null);const s=()=>{o.onChange(n.current.base.value)};return f(Ns,{ref:n,type:"text",value:`rgba(${t})`,onChange:s})};var Ls={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class hp extends _e{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return f("div",{className:Ls.colorPickerPanel,onClick:e=>e.stopPropagation()},f(rp,{className:Ls.colorPicker,color:this.state.color,onChange:Xo(this.setColor.bind(this),500)}),f("div",{className:Ls.colorPickerPanelSetting},f("div",{className:Ls.panelInput},this.props.rgb?f(up,{color:this.state.color,onChange:Xo(this.setColor.bind(this),500)}):f(lp,{color:this.state.color,onChange:Xo(this.setColor.bind(this),500)})),f("div",{className:Ls.panelColor},f("div",{style:{background:this.state.color}}),f("div",{style:{background:this.props.color}}))))}}var Rn={colorPickerOuter:"univer-color-picker-outer",colorPicker:"univer-color-picker",picker:"univer-picker",pickerSwatches:"univer-picker-swatches",pickerSwatchesItem:"univer-picker-swatches-item",pickerSwatch:"univer-picker-swatch",pickerSwatchBtn:"univer-picker-swatch-btn",colorfulWarp:"univer-colorful-warp",colorBtn:"univer-color-btn",colorPickerSlot:"univer-color-picker-slot"};let dp=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class tn extends _e{constructor(){super(...arguments),this.ulRef=ee(),this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState(t=>({styles:{display:"none"}})),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState(t=>({styles:{display:"block"}})),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const n=e.getBoundingClientRect(),s=this.ulRef.current.getBoundingClientRect(),r=document.documentElement.clientWidth||document.body.clientWidth,i=document.documentElement.clientHeight||document.body.clientHeight;let a=0,l=0;return l=n.top+s.height>i?n.top-s.height:n.top+n.height,a=n.left+s.width>r?r-s.width:n.left,{left:a,top:l}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise((t,n)=>{this.setState({setting:!this.state.setting}),t("end")}).then(()=>{if(this.state.root){const{top:t,left:n}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${n}px`,this.ulRef.current.style.top=`${t}px`}})}}initialize(e){this.state={presetColors:dp,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",locale:{},root:null}}componentWillMount(){}componentWillUnmount(){}setLocale(){const t=this.context.locale.get("toolbar");this.setState({locale:t})}render(){const e=Object.assign(this.state.styles||{},this.props.style);return f("div",{className:`${Rn.colorPickerOuter} ${this.props.className}`,ref:this.ulRef,style:{...e}},this.props.slot&&this.props.slot.header?f("div",{className:Rn.colorPickerSlot},this.props.slot.header.content):null,f("div",{className:Rn.colorPicker,onClick:t=>{}},f("div",{className:Rn.picker},f("div",{className:Rn.pickerSwatches},this.state.presetColors.map(t=>f("div",{className:Rn.pickerSwatchesItem},t.map(n=>f("span",{className:Rn.pickerSwatch,style:{background:n}},f(Hn,{title:n,placement:"top"},f("button",{key:n,className:Rn.pickerSwatchBtn,style:{background:n},onClick:s=>{this.props.onClick&&this.props.onClick(n,s)}}))))))),f("div",null,f(Qt,{onClick:this.onSwitch},this.state.setting?this.state.locale.collapse:this.state.locale.customColor))),this.state.setting?f("div",{className:Rn.colorfulWarp},f(hp,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),f("div",null,f(Qt,{type:"primary",onClick:t=>{var n;(n=this.onClick)==null||n.call(this,this.state.afterColor,t)}},this.state.locale.confirmColor),f(Qt,{danger:!0,onClick:t=>{this.onCancel()}},this.state.locale.cancelColor),f(Qt,{onClick:t=>{t.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.state.locale.change))):null))}}class gp{render(){return tn}}var Lr={colorPickerCircleButton:"univer-color-picker-circle-button",colorSelectCircle:"univer-color-select-circle",verticalMiddle:"univer-vertical-middle"};class fp extends _e{constructor(){super(...arguments),this.ref=ee(),this.colorRef=ee(),this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:n,onCancel:s,style:r,colorPickerStyle:i}=e,a=this.getComponentRender().renderFunction("NextIcon");return f("div",{style:r,className:Lr.colorPickerCircleButton,ref:this.ref,onClick:this.handleColorSelectButtonClick},f("span",{className:`${Lr.colorSelectCircle} ${Lr.verticalMiddle}`,style:{backgroundColor:t}}),f(a,{className:Lr.verticalMiddle}),f(tn,{color:t,onClick:n,onCancel:s,style:i,ref:this.colorRef}))}}class mp{render(){return fp}}const gn=oa((o,e)=>{const{children:t,style:n,className:s,onClick:r}=o;return f("div",{ref:e,style:n,className:s,onClick:r},t)});class _p{render(){return gn}}var zC={countBar:"univer-count-bar",btn:"univer-btn",countZoom:"univer-count-zoom",countSlider:"univer-count-slider",countStatistic:"univer-count-statistic"},pp={formatModal:"univer-format-modal",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",colsMenuitemContent:"univer-cols-menuitem-content"};class vp extends _e{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.showModal=(e,t)=>{let n=this.state.data,s=n.findIndex(r=>r.name===e);s>-1&&(n[s].show=t,this.setValue({data:n},()=>({data:n})))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach(n=>{var s;n.title=e.get(n.name),n.name==="format.titleCurrency"?n.children=e.get("currencyDetail").map(r=>({label:r.name,icon:r.value})):n.name==="format.titleDateTime"?n.children=e.get("dateFmtList").map(r=>({label:r.name,icon:r.value})):n.name==="format.titleNumber"&&(n.children=e.get("numFmtList").map(r=>({label:r.name,icon:r.value}))),(s=n.group)!=null&&s.length&&n.group.forEach(r=>{r.label=e.get(r.locale)})}),this.setState(n=>({data:t}))}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}render(e,t){const{data:n}=t;return f(gt,null,n.map((s,r)=>s.show?f(fa,{title:s.title,className:pp.formatModal,group:s.group,visible:s.show,onCancel:s.onCancel},s.label,f(fo,{show:!0,children:s.children,ref:i=>this.refs[r]=i})):f(gt,null)))}}class bp{render(){return vp}}var Ps={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class Pd extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:r}=this.props;return f("div",{className:Ct(Ps.selectItem,r?Ps.selectDisabledItem:"")},t?f("span",{className:Ps.selectItemSelected},f(e,null)):"",f("span",{className:Ps.selectItemContent},n),s?f("span",{className:Ps.selectItemSuffix},s):"")}}var Pt={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"};class zd extends _e{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(r=>{r.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Button");return f("div",{className:`${Pt.selectSingle} ${n}`},f(r,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return f("div",{className:`${Pt.selectInput} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f(r,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,className:t="",tooltip:n}=this.props,{color:s,menu:r}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return f("div",{className:`${Pt.selectColor} ${Pt.selectDouble} ${t}`},f(i,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:r,onClick:this.onClick},icon:f(a,null)},f("div",{className:Pt.selectLabel},e),f("div",{className:Pt.selectLine,style:{background:s}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,r=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return f("div",{className:`${Pt.selectDouble} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:f(r,null)},f("div",{className:Pt.selectLabel},e))))},this.getFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button");return f("div",{className:`${Pt.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},f("div",{className:Pt.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return f("div",{className:`${Pt.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:f(i,null)},f("div",{className:Pt.selectLabel},e))))}}initialize(){var r;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(r=this.props.defaultColor)!=null?r:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=this.handleSelected(r),a=n[r];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const c=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),c.unSelectable)return;const u=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:u}):this.setState({content:n[l[2]].label,menu:u})}}else if(e===1){if(!n.length)return;const r=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(c=>i===c.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(u=>u.selected);a<0&&(a=0);let l=this.handleSelected(a);const c=n[a];this.setState({content:c.label,menu:l})}};r(s),this.onClick=(...i)=>{var l,c;(c=(l=this.props).onClick)==null||c.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,c;const a=i.currentTarget.value;(c=(l=this.props).onKeyUp)==null||c.call(l,a),r(a)}}else if(e===2){const r=this.handleSelected(null);this.setState({menu:r}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=n[r],a=this.handleSelected(r);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var c,u,h,d;if(l.length){(u=(c=this.props).onClick)==null||u.call(c,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(e){this.props=Object.assign(this.props,e),this.initData()}resetMenu(e,t){var s;const n=[];for(let r=0;r<e.length;r++){let i=!1;t||(i=(s=e[r].selected)!=null?s:!1),n[r]={label:""},n[r].label=f(Pd,{disabled:e[r].disabled,border:e[r].border,selected:i,label:e[r].label,suffix:e[r].suffix}),n[r].disabled=e[r].disabled,n[r].style=e[r].style,n[r].value=e[r].value,n[r].className=e[r].className,n[r].onClick=e[r].onClick,n[r].border=e[r].border,e[r].children&&(n[r].children=this.resetMenu(e[r].children))}return this.props.type===2&&(n[0]={label:f(Pd,{label:f(tn,{style:{display:"block"},ref:r=>this.ColorRef=r,color:"#000",onClick:r=>{this.ColorRef.hideSelect(),this.setState({color:r},()=>{this.onClick()})}})})}),n}render(){const{type:e=0}=this.props;return f("div",{className:Pt.selectComponent},this.getType(e))}}var co={formulaBox:"univer-formula-box",selectButton:"univer-select-button",tooltipGroup:"univer-tooltip-Group",tooltipBody:"univer-tooltip-body",formulaBar:"univer-formula-bar",formulaIcon:"univer-formula-icon",formulaGrey:"univer-formula-grey",formulaBlack:"univer-formula-black",formulaInput:"univer-formula-input",formulaContent:"univer-formula-content"};class Cp extends _e{constructor(){super(...arguments),this.onkeyUp=e=>{},this.printChange=e=>{this.onkeyUp(e.target)}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.Render.renderFunction("NextIcon"),this.state={namedRanges:[{value:"1",label:"1"}],spanClass:co.formulaGrey,formulaContent:""},this.onkeyUp=Xo(this.onkeyUp,300)}setFormulaContent(e){this.setState({formulaContent:e})}setNamedRanges(e){this.setState({namedRanges:e})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onFormulaBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{namedRanges:n}=t,s=this.Render.renderFunction("CloseIcon"),r=this.Render.renderFunction("CorrectIcon"),i=this.Render.renderFunction("FxIcon");return f("div",{className:co.formulaBox},f(zd,{children:n,type:0}),f("div",{className:co.formulaBar},f("div",{className:co.formulaIcon},f("span",{className:t.spanClass},f(s,null)),f("span",{className:t.spanClass},f(r,null)),f("span",{className:co.formulaBlack},f(i,null))),f("div",{className:co.formulaInput},f("div",{autoFocus:!0,contentEditable:!0,className:co.formulaContent,onKeyUp:a=>this.printChange(a)},t.formulaContent))))}}var b5="",uo={layoutWrapper:"univer-layout-wrapper",layoutWrapperHasSider:"univer-layout-wrapper-has-sider",headerWrapper:"univer-header-wrapper",footerWrapper:"univer-footer-wrapper",contentWrapper:"univer-content-wrapper",siderWrapper:"univer-sider-wrapper"};class fn extends _e{constructor(){super(...arguments),this.ref=ee(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=ym(this.ref.current);const t=e instanceof Array?e:[e];for(const n of t)n.tagName==="ASIDE"&&this.setState({isAside:!0})}}render(e,t){const{children:n,style:s,className:r}=e,{isAside:i}=t;return f("section",{style:s,ref:this.ref,className:i?`${uo.layoutWrapper} ${uo.layoutWrapperHasSider} ${r}`:`${uo.layoutWrapper} ${r}`},n)}}const Pr=o=>{const{children:e,style:t,className:n}=o;return f("header",{style:t,className:`${uo.headerWrapper} ${n}`},e)},zr=o=>{const{children:e,style:t,className:n}=o;return f("footer",{style:t,className:`${uo.footerWrapper} ${n}`},e)},Ur=oa((o,e)=>{const{children:t,style:n,className:s}=o;return f("main",{ref:e,style:n,className:`${uo.contentWrapper} ${s}`},t)}),zt=o=>{const{children:e,style:t,className:n}=o;return f("aside",{style:t,className:`${uo.siderWrapper} ${n}`},e)};class Ep{render(){return fn}}class wp{render(){return Pr}}class Sp{render(){return zr}}class yp{render(){return Ur}}class Tp{render(){return zt}}var Wr={colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",colsMenuitemLine:"univer-cols-menuitem-line",colsMenuitemDisabled:"univer-cols-menuitem-disabled"};class Hr extends _e{constructor(){super(...arguments),this._MenuRef=ee(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,n)=>{const{deep:s=0}=this.props;t.onClick?t.onClick.call(null,e,t.value,n,s):this.props.onClick&&this.props.onClick.call(null,e,t.value,n,s),this.showMenu(!1)},this.showMenu=e=>{this.setState(t=>({show:e}),()=>{this.getStyle()})},this.mouseEnter=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var a;const e=this._MenuRef.current;if(!e)return;let t={};const n=e.getBoundingClientRect();let s;const{dom:r,parent:i}=this.props;if(s={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},i){e.style.position="fixed";let l=(a=e.parentElement)==null?void 0:a.getBoundingClientRect();if(!l)return;l.right+n.width>s.right?(t.left=`${l.left-n.width}px`,t.top=`${l.top}px`):(t.left=`${l.right}px`,t.top=`${l.top}px`),this.setState({posStyle:t})}}}initialize(){this.state={show:!1,posStyle:{}}}render(){const{className:e="",style:t="",menu:n,deep:s=0}=this.props,{show:r,posStyle:i}=this.state;return f("ul",{className:Ct(Wr.colsMenu,e),style:{...t,...i,display:r?"block":"none"},ref:this._MenuRef},n==null?void 0:n.map((a,l)=>{var c,u;if(!a.hide)return f(gt,null,f("li",{className:Ct(Wr.colsMenuitem,(c=a.className)!=null?c:"",a.disabled?Wr.colsMenuitemDisabled:""),style:(u=a.style)!=null?u:"",onClick:h=>this.handleClick(h,a,l),onMouseEnter:h=>{this.mouseEnter(h,l)},onMouseLeave:h=>{this.mouseLeave(h,l)}},a.label,a.children?f(Hr,{ref:h=>this._refs[l]=h,menu:a.children,onClick:a.onClick,className:a.className,style:a.style,parent:this,deep:s+1}):f(gt,null)),a.border?f("div",{className:Wr.colsMenuitemLine}):"")}))}}class Rp{render(){return Hr}}var Ap={drag:"univer-drag",dragTop:"univer-drag-top",dragBottom:"univer-drag-bottom",dragLeft:"univer-drag-left",dragRight:"univer-drag-right"};class Ip extends _e{constructor(){super(...arguments),this.root=ee(),this.onMouseMove=e=>{let t=this.state.offsetX,n=this.state.offsetY,s=e.x,r=e.y,i=`${s-t}px`,a=`${r-n}px`;this.setState({top:a,left:i})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(e){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(e){window.addEventListener("mousemove",this.onMouseMove);let t=e.offsetX,n=e.offsetY;this.setState({offsetX:t,offsetY:n})}getWindowRect(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth,s=this.root.current.offsetHeight,r=this.root.current.offsetLeft,i=this.root.current.offsetTop,a=`${(t-s)/2}px`,l=`${(e-n)/2}px`;this.setState({width:e,height:t,rootW:n,rootH:s,rootL:r,rootT:i,top:a,left:l})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:e}=this.props;return f(gt,null,e?f("div",{ref:this.root,className:Ap.drag,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}var ho={modalMask:"univer-modal-mask",modalWrapper:"univer-modal-wrapper",modalDargWrapper:"univer-modal-darg-wrapper",modalHeader:"univer-modal-header",modalClose:"univer-modal-close",modalBody:"univer-modal-body",modalFooter:"univer-modal-footer"};class fa extends _e{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState(t=>({visible:e}))},this.handleClick=e=>{this.showModal(!1),e&&e()}}initialize(){var e;this.state={visible:(e=this.props.visible)!=null?e:!1}}componentWillReceiveProps(e){e.visible!==this.state.visible&&this.setState({visible:e.visible})}render(){const{title:e,width:t=500,top:n=0,style:s,children:r,className:i,group:a=[],isDrag:l=!1,mask:c=!0,footer:u=!0}=this.props,{visible:h}=this.state;return f(gt,null,h?f("div",{className:i},c?f("div",{className:ho.modalMask,onClick:d=>{var g,m;(m=(g=this.props).onCancel)==null||m.call(g,d),this.showModal(!1)}}):null,f(Ip,{isDrag:l},f("div",{className:`${l?ho.modalDargWrapper:ho.modalWrapper}`,style:{width:`${t}px`,...s}},f("div",{className:ho.modalHeader},f("span",null,e),f("span",{className:ho.modalClose,onClick:d=>{var g,m;(m=(g=this.props).onCancel)==null||m.call(g,d),this.showModal(!1)}},f(Od.Close,null))),f("div",{className:ho.modalBody},r),u?f("div",{className:ho.modalFooter},a.map(d=>f(Qt,{type:d.type,onClick:()=>this.handleClick(d.onClick)},d.label))):null))):null)}}class Dp{render(){return fa}}var jo={radioGroup:"univer-radio-group",radioWrap:"univer-radio-wrap",radioLeft:"univer-radio-left",circle:"univer-circle",active:"univer-active",fork:"univer-fork",label:"univer-label"};class Ud extends _e{render(){return f("div",{className:jo.radioWrap},f("div",{className:jo.radioLeft},f("div",{onClick:this.props.onClick.bind(this,this.props.value)},f("div",{className:`${jo.circle} ${this.props.active&&jo.active}`},f("div",{className:jo.fork})),f("div",{className:jo.label},this.props.label)),this.props.children))}}class Op{render(){return Ud}}class xp{render(){return Ud}}var g4={resizeDialog:"univer-resize-dialog",dialogMove:"univer-dialog-move",moveItem:"univer-move-item",moveTop:"univer-move-top",moveRight:"univer-move-right",moveBottom:"univer-move-bottom",moveLeft:"univer-move-left",dialogResize:"univer-dialog-resize",dialogResizeActive:"univer-dialog-resize-active",resizeItem:"univer-resize-item",resizeLt:"univer-resize-lt",resizeMt:"univer-resize-mt",resizeLm:"univer-resize-lm",resizeRm:"univer-resize-rm",resizeRt:"univer-resize-rt",resizeLb:"univer-resize-lb",resizeMb:"univer-resize-mb",resizeRb:"univer-resize-rb"},zs={richTextEditorContainer:"univer-rich-text-editor-container",richTextEditor:"univer-rich-text-editor",formulaTextColor:"univer-formula-text-color",formulaTextString:"univer-formula-text-string"};class Mp{constructor(e){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=e}updateFormat(e,t){e in this.inlineStyleAffectAttribute&&this.editor.textContent.substr(0,1)!=="="&&this.updateInlineStringFormat(e,t)}updateInlineStringFormat(e,t){var u;let n=window.getSelection(),s;if((n==null?void 0:n.type)==="None"||(s=n==null?void 0:n.getRangeAt(0)),!s)return;let r=this.editor,i=s.endContainer,a=s.startContainer,l=s.endOffset,c=s.startOffset;if(r){if(a===i){let h=a.parentNode,d,g=!1,m=h.innerHTML;r.innerHTML.substr(0,5)!=="<span"&&(g=!0);let p="",v="",b="",C=0,D=c,O=l,F=m.length;p=m.substring(C,D),v=m.substring(D,O),b=m.substring(O,F);let S="";if(p!==""){let w=h.style.cssText;if(g){let I=h.closest(`.${zs.richTextEditorContainer}`);I!=null&&(w=this.extendCssText(I.style.cssText,w))}S+=`<span style='${w}'>${p}</span>`}if(v!==""){let w=this.getCssText(h.style.cssText,e,t);if(g){let I=h.closest(`.${zs.richTextEditorContainer}`);I!=null&&(w=this.extendCssText(I.style.cssText,w))}S+=`<span style='${w}'>${v}</span>`}if(b!==""){let w=h.style.cssText;if(g){let I=h.closest(`.${zs.richTextEditorContainer}`);I!=null&&(w=this.extendCssText(I.style.cssText,w))}S+=`<span style='${w}'>${b}</span>`}if(a.parentNode.tagName==="SPAN"){d=kr("span",r).indexOf(h);let w=(u=h.parentElement)==null?void 0:u.innerHTML,I=h.outerHTML.replace("\\","");const P=w==null?void 0:w.replace(I,S);h.parentElement.innerHTML=P}else d=0,h.innerHTML=S;let E=0;C===D?E=d:E=d+1,Tm(r.querySelectorAll("span")[E])}else if(a.parentNode.tagName==="SPAN"&&i.parentNode.tagName==="SPAN"){let h=a.parentNode,d,g=i.parentNode,m;d=kr("span",r).indexOf(h),m=kr("span",r).indexOf(g);let _=h.innerHTML,p=g.innerHTML,v="",b="",C="",D="",O=0,F=c,S=l,E=p.length;v=_.substring(O,F),b=_.substring(F,_.length),C=p.substring(0,S),D=p.substring(S,E);let w=Array.prototype.slice.call(r.querySelectorAll("span"));w.slice(d,m+1);let I="";for(let y=0;y<d;y++){let k=w[`${y}`],M=k.innerHTML;I+=`<span style='${k.style.cssText}'>${M}</span>`}if(v!==""&&(I+=`<span style='${h.style.cssText}'>${v}</span>`),b!==""&&(I+=`<span style='${this.getCssText(h.style.cssText,e,t)}'>${b}</span>`),d<m)for(let y=d+1;y<m;y++){let k=w[`${y}`],M=k.innerHTML;I+=`<span style='${this.getCssText(k.style.cssText,e,t)}'>${M}</span>`}C!==""&&(I+=`<span style='${this.getCssText(g.style.cssText,e,t)}'>${C}</span>`),D!==""&&(I+=`<span style='${g.style.cssText}'>${D}</span>`);for(let y=m+1;y<w.length;y++){let k=w[`${y}`],M=k.innerHTML;I+=`<span style='${k.style.cssText}'>${M}</span>`}r.innerHTML=I;let P,L;O===F?(P=d,L=m):(P=d+1,L=m+1),w=r.querySelectorAll("span"),Rm(w[`${P}`],w[`${L}`])}}}extendCssText(e,t,n=!0){let s=e.split(";"),r=t.split(";"),i="",a={};for(let l=0;l<s.length;l++){let c=s[l],u=!0;c=c.toLowerCase();let h=Et(c.substr(0,c.indexOf(":")));if(h==="font-size")continue;let d=Et(c.substr(c.indexOf(":")+1));if(!(n&&!(h in this.inlineStyleAffectCssName))){for(let g=0;g<r.length;g++){let m=r[g];m=m.toLowerCase();let _=Et(m.substr(0,m.indexOf(":"))),p=Et(m.substr(m.indexOf(":")+1));if(h===_){i+=`${_}:${p};`,u=!1;continue}}u&&(i+=`${h}:${d};`),a[h]=1}}for(let l=0;l<r.length;l++){let c=r[l];c=c.toLowerCase();let u=Et(c.substr(0,c.indexOf(":"))),h=Et(c.substr(c.indexOf(":")+1));n&&!(u in this.inlineStyleAffectCssName)||u in a||(i+=`${u}:${h};`)}return i}getCssText(e,t,n){let s={};if(s[t]=n,t==="un"){let l=this.getClassWithcss(e,"color");l===""&&(l="#000000");let c=this.getClassWithcss(e,"font-size"),u=parseInt(c);c===""&&(u=11),s._fontSize=u,s._color=l}let r=this.getFontStyleByCell(s,void 0,void 0,!1),i=Et(r&&r.substr(0,r.indexOf(":"))),a=Et(r&&r.substr(r.indexOf(":")+1));return a=a.substr(0,a.length-1),e=this.removeClassWidthCss(e,t),e=this.upsetClassWithCss(e,i,a),e}getClassWithcss(e,t){let n=e.split(";");if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let s=0;s<n.length;s++){let r=n[s];r=r.toLowerCase();let i=Et(r.substr(0,r.indexOf(":"))),a=Et(r.substr(r.indexOf(":")+1));if(i===t)return a}return""}removeClassWidthCss(e,t){let n=e.split(";"),s="",r=t;if(t==null||t.length===0)return e;if(t in this.univerToCssName&&(t=this.univerToCssName[t]),e.indexOf(t)>-1)for(let i=0;i<n.length;i++){let a=n[i];a=a.toLowerCase();let l=Et(a.substr(0,a.indexOf(":"))),c=Et(a.substr(a.indexOf(":")+1));l===t||r==="cl"&&l==="lucky-strike"||r==="un"&&l==="lucky-underline"||l.length>0&&(s+=`${l}:${c};`)}else s=e;return s}upsetClassWithCss(e,t,n){let s=e.split(";"),r="";if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let i=0;i<s.length;i++){let a=s[i];a=a.toLowerCase();let l=Et(a.substr(0,a.indexOf(":"))),c=Et(a.substr(a.indexOf(":")+1));l===t?r+=`${l}:${n};`:l.length>0&&(r+=`${l}:${c};`)}else t.length>0&&(e+=`${t}:${n};`,r=e);return r}getFontStyleByCell(e,t,n,s=!0){if(e==null)return"";let r="";for(let i in e){let a=e[i];if(s&&(a=this.checkstatusByCell(e,i)),i==="bl"&&a!=="0"&&(r+="font-weight: bold;"),i==="it"&&a!=="0"&&(r+="font-style:italic;"),i==="ff"&&(r+=`font-family: ${a};`),i==="fs"&&a!=="10"&&(r+=`font-size: ${a}pt;`),(i==="fc"&&a!=="#000000"||t!=null||n!=null&&n.textColor!=null)&&(n!=null&&n.textColor!=null?r+=`color: ${n.textColor};`:t!=null?r+=`color: ${t[0]};`:r+=`color: ${a};`),i==="bg"&&a!=="#ffffff"&&a!=="#fff"&&(r+=`background: ${a};`),i==="cl"&&a!=="0"&&(r+="text-decoration: line-through;"),i==="un"&&(a==="1"||a==="3")){let l=e._color;l==null&&(l=e.fc);let c=e._fontSize||11;c==null&&(c=e.fs||11),r+=`border-bottom: ${Math.floor(c/9)}px solid ${l};`}}return r}checkstatusByCell(e,t){let n;return t in{bl:1,it:1,ff:1,cl:1,un:1}?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="fc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000"),n.indexOf("rgba")>-1&&(n=ln.rgbColorToHexValue(n))):t==="bg"?n==null?n=null:(n=n[t],n==null?n=null:n.toString().indexOf("rgba")>-1&&(n=ln.rgbColorToHexValue(n))):t.substr(0,2)==="bs"?n==null?n="none":(n=n[t],n==null&&(n="none")):t.substr(0,2)==="bc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000")):t==="ht"?(n==null?n="1":(n=n[t],n==null&&(n="1")),["0","1","2"].indexOf(n.toString())===-1&&(n="1")):t==="vt"?(n==null?n="0":(n=n[t],n==null&&(n="0")),["0","1","2"].indexOf(n.toString())===-1&&(n="0")):t==="ct"?n==null?n=null:(n=n[t],n==null&&(n=null)):t==="fs"?n==null?n="10":(n=n[t],n==null&&(n="10")):t==="tb"||t==="tr"?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="rt"&&(n==null?n=null:(n=n[t],n==null&&(n=null))),n}}class $r extends _e{constructor(){super(...arguments),this.container=ee(),this.ref=ee(),this.hooks=new Map}initialize(e){}setValue(e){this.ref.current&&(this.ref.current.innerHTML=Am(e))}getValue(){var e;return((e=this.ref.current)==null?void 0:e.innerHTML)||""}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(e){e.ctrlKey,e.altKey,e.shiftKey,e.keyCode;const t=this.hooks.get("onKeyDown");t&&t(e)}onKeyUp(e){const t=this.hooks.get("onKeyUp");t&&t(e)}componentWillMount(){}componentDidMount(){var e;this.cellTextStyle=new Mp(this.ref.current),(e=this._context.getObserverManager().getObserver("onRichTextDidMountObservable"))==null||e.notifyObservers(this)}componentWillUnmount(){}render(e,t){const{style:n,className:s,onClick:r,text:i}=e;return f("div",{className:`${zs.richTextEditorContainer} ${s}`,style:n,ref:this.container},f("div",{ref:this.ref,className:zs.richTextEditor,onClick:r,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:i||""},contentEditable:!0}))}}var Ge={selectButton:"univer-select-button",selectButtonInner:"univer-select-button-inner",selectColor:"univer-select-color",selectButtonInnerLabelIcon:"univer-select-button-inner-label-icon",selectButtonInnerLabelString:"univer-select-button-inner-label-string",selectInput:"univer-select-input",selectLine:"univer-select-line",btn:"univer-btn",colorPicker:"univer-color-picker",selectDoubleButton:"univer-select-double-button",doubleButtons:"univer-double-buttons"};class kp extends Vo{constructor(e){super(e),this.ref=ee(),this.inputRef=ee(),this.colorBtn=ee(),this.showSelect=n=>{n.stopImmediatePropagation();const s=this.ref.current;s&&this.props.selectType===Jt.COLOR?s.showSelect(this.colorBtn.current):s&&s.showSelect(),window.addEventListener("click",this.hide,!0)},this.hide=n=>{!this.ref.current||!this.ref.current.ulRef&&!this.ref.current.ulRef.current||this.ref.current.ulRef.current.contains(n.target)||this.hideSelect(n)},this.hideSelect=n=>{this.ref.current.hideSelect(n),window.removeEventListener("click",this.hide,!0)},this.changeValue=n=>{this.setState(s=>({...n}))},this.update=n=>{const s=typeof this.props.label,r=this.state.children;let i;r==null||r.forEach((a,l)=>{a.value===n?(a.selected=!0,this.props.needChange&&(this.setState({label:s==="string"?a.label:a.icon}),i=a.label)):a.selected=!1}),this.setState({children:r}),this.props.selectType===Jt.INPUT_NUMBER&&this.inputRef.current.setValue(i)},this.handleClick=(...n)=>{var c,u;const s=typeof this.props.label;this.hideSelect(n[0]);const{item:r,index:i}=n[1],a=this.state.children;a==null||a.forEach(h=>h.selected=!1),a[i].selected=!0;let l=a[i].label;if(this.setState({children:a}),this.props.needChange){this.setState({label:s==="string"?l:r.icon}),[Jt.INPUT,Jt.INPUT_NUMBER].includes(this.props.selectType)&&this.inputRef.current.setValue(l);const h=this.props.children;if(h[10]&&h[10].locale==="borderLine.borderColor"){let m=h[10].children[0].value,_=h[11].value;(c=this.props.onClick)==null||c.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label,m,_);return}}(u=this.props.onClick)==null||u.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label)},this.handleButtonClick=()=>{var i,a,l,c;const n=this.state.children,s=n==null?void 0:n.find(u=>u.selected===!0),r=this.props.children;if(this.props.selectType==="color")(i=this.props.onClick)==null||i.call(this,this.state.selectColor);else if(r&&r[10]&&r[10].locale==="borderLine.borderColor"){let d=r[10].children[0].value,g=r[11].value;s&&((a=this.props.onClick)==null||a.call(this,s.hasOwnProperty("value")?s.value:s.label,d,g));return}else if(r&&r[0]&&r[0].locale&&r[0].locale.indexOf("merge")>-1){(l=this.props.onClick)==null||l.call(this,"all");return}s&&((c=this.props.onClick)==null||c.call(this,s.hasOwnProperty("value")?s.value:s.label))},this.handleKeyUp=n=>{var s;if(n.key==="Enter"){this.props.selectType===Jt.INPUT_NUMBER&&this.inputRef.current.base.blur();const r=n.currentTarget.value;this.update(r),this.hideSelect(n),(s=this.props.onKeyUp)==null||s.call(this,r)}},this.state={label:"",children:[],selectColor:"#000"};const{triggerUpdate:t}=e;t&&t(this.update.bind(this))}componentWillMount(){this.changeValue({label:this.props.label,children:this.props.children})}render(e){const{icon:t,tooltip:n,selectType:s,border:r,slot:i,style:a,onClick:l}=e;return this.state.label,s===Jt.INPUT||s===Jt.INPUT_NUMBER?f("div",{className:Ge.selectButton},f("div",{className:Ge.selectInput},f(Ns,{type:s===Jt.INPUT_NUMBER?"number":"text",value:this.state.label,onClick:this.showSelect,ref:this.inputRef,bordered:!1,onKeyUp:this.handleKeyUp}),f("span",{onClick:this.showSelect},t)),r?f("div",{className:Ge.selectLine}):"",f(fo,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Jt.DOUBLE?f("div",{className:`${Ge.selectButton} ${Ge.selectDoubleButton}`},f("div",{style:{display:"flex",alignItems:"center"}},f(Hn,{title:n,placement:"bottom"},f(Qt,{type:"text",onClick:this.handleButtonClick},f("div",{className:Ge.selectButtonInner},f("div",{className:typeof this.state.label=="string"?Ge.selectButtonInnerLabelString:Ge.selectButtonInnerLabelIcon},this.state.label)))),f(Hn,{title:this.props.tooltipRight,placement:"bottom"},f(Qt,{type:"text",onClick:this.showSelect,className:Ge.doubleButtons},f("div",{className:Ge.selectButtonInner},t)))),r?f("div",{className:Ge.selectLine}):"",f(fo,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Jt.COLOR?f("div",{className:`${Ge.selectButton} ${Ge.selectDoubleButton}`,ref:this.colorBtn},f("div",{style:{display:"flex",alignItems:"center"}},f(Hn,{title:n,placement:"bottom"},f(Qt,{type:"text",onClick:this.handleButtonClick},f("div",{className:Ge.selectButtonInner},f("div",{className:typeof this.state.label=="string"?Ge.selectButtonInnerLabelString:Ge.selectButtonInnerLabelIcon},this.state.label),f("div",{className:Ge.selectColor,style:{backgroundColor:this.state.selectColor}})))),f(Hn,{title:this.props.tooltipRight,placement:"bottom"},f(Qt,{type:"text",onClick:this.showSelect,className:Ge.doubleButtons},f("div",{className:Ge.selectButtonInner},t)))),r?f("div",{className:Ge.selectLine}):"",f(tn,{color:"#000",onClick:c=>{this.setState({selectColor:c},()=>{l&&l(this.state.selectColor)})},slot:i,ref:this.ref})):f("div",{className:Ge.selectButton},f(Hn,{title:n,placement:"bottom"},f(Qt,{type:"text",onClick:this.showSelect},f("div",{className:Ge.selectButtonInner},f("div",{className:typeof this.state.label=="string"?Ge.selectButtonInnerLabelString:Ge.selectButtonInnerLabelIcon},this.state.label),t))),r?f("div",{className:Ge.selectLine}):"",f(fo,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a}))}}class Bp{render(){return kp}}var ma={dropdown:"univer-dropdown",dropContent:"univer-drop-content",dropIcon:"univer-drop-icon"};class ct extends _e{constructor(){super(...arguments),this.MenuRef=ee(),this.DropRef=ee(),this.IconRef=ee(),this.handleClick=e=>{var n,s,r;(s=(n=this.props).onClick)==null||s.call(n);const{icon:t}=this.props;t||(r=this.MenuRef.current)==null||r.showMenu(!0)},this.handleSubClick=()=>{var e;(e=this.MenuRef.current)==null||e.showMenu(!0)},this.hideMenu=e=>{var t,n;(!this.DropRef.current||!((t=this.DropRef.current)!=null&&t.contains(e.target)))&&((n=this.MenuRef.current)==null||n.showMenu(!1))}}initialize(){this.state={menuStyle:{}}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};!e||e==="Bottom"?(t.left=0,t.top="100%"):e==="Top"?(t.left=0,t.top="-100%"):e==="Left"?(t.left="-100%",t.top=0):(t.left="100%",t.top=0),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenu)}componentWillUnmount(){window.removeEventListener("click",this.hideMenu)}render(){const{children:e,menu:t,showArrow:n,icon:s,tooltip:r}=this.props,{menuStyle:i}=this.state;return f("div",{className:ma.dropdown,ref:this.DropRef},f(Hn,{title:r,placement:"bottom"},f("div",{className:ma.dropContent,onClick:this.handleClick},e,n?f(ks.NextIcon,null):"")),s?f("div",{ref:this.IconRef,className:ma.dropIcon,onClick:this.handleSubClick},s):"",f(Hr,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:{...t.style,...i}}))}}class Fp{render(){return ct}}var B4={line:"univer-line",vertical:"univer-vertical"},go={siderModal:"univer-sider-modal",siderModalHeader:"univer-sider-modal-header",siderModalTitle:"univer-sider-modal-title",siderModalClose:"univer-sider-modal-close",siderModalBody:"univer-sider-modal-body",siderModalBodyInner:"univer-sider-modal-body-inner",siderModalFooter:"univer-sider-modal-footer"};class Np extends _e{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t,style:n}=e;return f("div",{className:`${go.siderModal} ${t}`,style:{...n}},f("div",{className:go.siderModalHeader},f("h3",{className:go.siderModalTitle},this.props.title),f("span",{className:go.siderModalClose,onClick:()=>this.close()},f(Od.Close,null))),f("div",{className:go.siderModalBody},f("div",{className:go.siderModalBodyInner},this.props.children)),f("div",{className:go.siderModalFooter},this.props.footer))}}class Lp{render(){return Np}}var Ko={slider:"univer-slider",srOnly:"univer-sr-only"};class Pp extends _e{constructor(){super(...arguments),this.ref=ee(),this.onInput=(e,t)=>{var r;const s=t.target.value;this.changeInputValue(e,s),(r=this.props.onChange)==null||r.call(this,t)},this.onClick=(e,t)=>{var u;const{min:n=0,max:s=100,step:r=1}=this.props,i=t.currentTarget;let a=t.offsetX;const l=i.offsetWidth;if(a<0||a>l)return;let c=a/this.width*(s-n);c%r&&(c+=r-c%r),this.changeInputValue(e,c),(u=this.props.onClick)==null||u.call(this,t,c)},this.changeInputValue=(e,t)=>{let n=this.ref.current,r=n.getElementsByTagName("input")[e].id;n.style.setProperty(`--${r}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=ra("slider"),this.idNext=ra("slider")}componentDidMount(){const{min:e=0,max:t=100,range:n}=this.props;let s=t-e,r=this.ref.current;if(this.width=r.offsetWidth,r.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${Ko.slider}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${Ko.slider}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);}`,0),document.styleSheets[0].addRule(`.${Ko.slider}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${Ko.slider}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);}`,0),n){let{value:i}=this.props;i=i||[0,0],this.setValue({valuePrev:i[0],valueNext:i[1]})}else{let{value:i}=this.props;i=i||0,this.changeInputValue(0,i)}}render(e,t){const{valuePrev:n,valueNext:s}=t,{step:r=1,min:i=0,max:a=100,range:l=!1}=e;return l?f("div",{className:Ko.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref},f("label",{class:"sr-only",for:this.idPrev}),f("input",{id:this.idPrev,type:"range",min:i,value:n,max:a,step:r,onInput:c=>this.onInput(0,c)}),f("label",{class:"sr-only",for:this.idNext}),f("input",{id:this.idNext,type:"range",min:i,value:s,max:a,step:r,onInput:c=>this.onInput(1,c)})):f("div",{className:Ko.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref,onClick:c=>this.onClick(0,c)},f("label",{class:"sr-only",for:this.idPrev}),f("input",{id:this.idPrev,type:"range",min:i,value:n,max:a,step:r,onInput:c=>this.onInput(0,c)}))}}class zp{render(){return Pp}}var nn={tabs:"univer-tabs",tabsNav:"univer-tabs-nav",tabsNavWrap:"univer-tabs-nav-wrap",tabsNavList:"univer-tabs-nav-list",tabsTab:"univer-tabs-tab",tabsTabActive:"univer-tabs-tab-active",tabsContent:"univer-tabs-content",tabsPanel:"univer-tabs-panel",tabsPanelActive:"univer-tabs-panel-active",tabsCard:"univer-tabs-card"};class Up extends Vo{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.parseNavList=()=>{const{active:e}=this.state;return hn(this.props.children).map(t=>{const{tab:n,keys:s}=t.props,r=`${ra("tab")}-${s}`;return e===s?f("div",{id:r,onClick:this.handleClick,className:Ct(nn.tabsTab,nn.tabsTabActive)},n):f("div",{id:r,onClick:this.handleClick,className:nn.tabsTab},n)})},this.handleClick=e=>{var r,i;const t=e.target.id,n=t.lastIndexOf("-"),s=t.slice(n+1);this.setValue({active:s}),(i=(r=this.props).onTabClick)==null||i.call(r,s,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:n,type:s="line",className:r}=e,i=Ct(nn.tabs,{[`${nn.tabs}-card`]:s==="card"},r);return f("div",{className:i},f("div",{className:nn.tabsNav},f("div",{className:nn.tabsNavWrap},f("div",{className:nn.tabsNavList},this.parseNavList()))),f("div",{className:nn.tabsContent},n.map(a=>f(Wd,{keys:a.props.keys,active:a.props.keys===this.state.active},a.props.children))))}}const Wd=o=>{const{id:e,keys:t,style:n,children:s,active:r}=o;return f("div",{id:e&&`${e}-panel-${t}`,role:"tabpanel",style:{...n},className:Ct(nn.tabsPanel,r&&nn.tabsPanelActive)},r&&s)};class Wp{render(){return Up}}class Hp{render(){return Wd}}var Wn={tooltipGroup:"univer-tooltip-Group",tooltipTitle:"univer-tooltip-title",tooltipBody:"univer-tooltip-body",tooltipSs:"univer-tooltip-ss",top:"univer-top",tooltipTriangle:"univer-tooltip-triangle",right:"univer-right",bottom:"univer-bottom",left:"univer-left"};const $p={top:Wn.top,bottom:Wn.bottom,left:Wn.left,right:Wn.right};class Hn extends _e{constructor(){super(...arguments),this.tooltip=ee()}initialize(e){this.state={placement:e.placement||"top",placementClassName:Ct(Wn.tooltipTitle,$p[e.placement||"top"]),top:"",left:""}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,n=e.width;this.state.placement==="bottom"?this.setState({top:t+10,left:n/2}):this.state.placement==="left"?this.setState({top:t/2,left:n+5}):this.state.placement==="right"?this.setState({top:t/2,left:-n-10}):this.setState({top:-t-20,left:n/2})}}render(){return f("div",{ref:this.tooltip,className:Wn.tooltipGroup,style:this.props.styles},f("div",{className:Wn.tooltipBody,onMouseEnter:this.handleMouseOver.bind(this)},this.props.children),this.props.title?f("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`}},this.props.title,f("span",{className:Wn.tooltipTriangle})):null)}}class Vp{render(){return Hn}}var mn={colsMenu:"univer-cols-menu",colsMenuJsx:"univer-cols-menu-jsx",colsMenuitem:"univer-cols-menuitem",line:"univer-line",colsMenuitemContent:"univer-cols-menuitem-content",ulIcon:"univer-ul-icon",submenuArrow:"univer-submenu-arrow",iconRightIcon:"univer-icon-rightIcon"};class fo extends _e{constructor(){super(...arguments),this.refs=[],this.ulRef=ee(),this.filterChildren=e=>{let t;return Array.from(e.children).forEach(n=>{n.nodeName==="UL"&&(t=!0)}),t},this.mouseOver=(e,t)=>{this.refs.forEach(s=>{s.hideSelect()});const n=e.currentTarget;!this.filterChildren(n)||this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{(this.refs[t]?this.refs[t].props.children[0].selectType:"")!=="jsx"&&this.refs.forEach(s=>{s.hideSelect()})},this.handleClick=(e,{item:t,index:n,ref:s},r)=>{e.stopImmediatePropagation(),r==null||r.call(this,e,{item:t,index:n,ref:s})},this.handleKeyUp=(e,{item:t,index:n,ref:s},r)=>{e.stopImmediatePropagation(),r==null||r.call(this,e,{item:t,index:n,ref:s})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),((e=this.state.style)==null?void 0:e.display)!=="none"&&(this.refs.forEach(t=>{t.hideSelect()}),this.setState(t=>({style:{display:"none"}})))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState(e=>({style:{display:"inline-block"}}),()=>{this.getStyle()})},this.getStyle=()=>{var u;const e=(u=this.ulRef.current)==null?void 0:u.parentElement,t=this.ulRef.current;let n={},s;if(!t||!e)return;const r=t.getBoundingClientRect();let i=e==null?void 0:e.getBoundingClientRect();s=this.getContext().getPluginManager().getPluginByName("spreadsheet").getContentRef().current.getBoundingClientRect(),!(!s||!i)&&((e==null?void 0:e.nodeName)==="LI"?(t.style.position="fixed",i=e==null?void 0:e.getBoundingClientRect(),i.right+r.width>s.right?(n.left=`${i.left-r.width}px`,n.top=`${i.top}px`):(n.left=`${i.right}px`,n.top=`${i.top}px`)):(e==null?void 0:e.nodeName)==="DIV"&&(i.right+r.width>s.right||i.right+r.width>document.documentElement.clientWidth?(n.right="0",n.left="auto"):(n.left="0",n.right="auto"),r.top>=s.bottom&&(n.top="auto",n.bottom="100%")),this.setState(h=>({posStyle:n})))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?f("span",{className:mn.ulIcon},f(ks.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?f("span",{className:mn.ulIcon},f(ks.HideIcon,{style:{fontSize:"13px"}})):f("span",{className:mn.ulIcon}):"",this.getIcon=e=>{let t=e;return typeof t=="string"&&/Icon$/.test(t)&&(t=h_[t]),f("span",{className:mn.submenuArrow},t)},this.getParent=()=>{var e;return(e=this.props.getParent())!=null?e:null}}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=Xo(this.getStyle,200)}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState(t=>({style:{display:"inline-block"}}))}render(e,t){var c;const{children:n,onClick:s,style:r,onKeyUp:i}=e,{posStyle:a}=t,l=Object.assign((c=this.state.style)!=null?c:{},a,r||{});return n!=null&&n.length?(n.some((u,h)=>u.selected?(n.forEach((d,g)=>{h!==g&&(d.selected=!1)}),!0):!1),f("ul",{className:n[0].selectType==="jsx"?mn.colsMenuJsx:mn.colsMenu,style:{...l},ref:this.ulRef},n==null?void 0:n.map((u,h)=>{var g;let d=u.className?`${mn.colsMenuitem} ${u.className}`:mn.colsMenuitem;if(!u.hideLi)return f("li",{className:d,style:{...u.style},onClick:m=>{m.stopPropagation(),this.handleClick(m,{item:u,index:h,ref:this},u.onClick?u.onClick:s)},onMouseEnter:m=>{this.mouseOver(m,h)},onMouseLeave:m=>{this.mouseLeave(m,h)},onKeyUp:m=>{this.handleKeyUp(m,{item:u,index:h,ref:this},u.onKeyUp?u.onKeyUp:i)}},f("div",{className:u.selectType==="jsx"?"":mn.colsMenuitemContent},this.showIcon(u),f("div",null,u.selectType==="jsx"?f("span",null,ro(u.label,{onChange:this.getStyle})):f("span",null,u.label),u.icon?this.getIcon(u.icon):"")),(g=u.children)!=null&&g.length?f(fo,{children:u.children,onClick:u.onClick,ref:m=>this.refs[h]=m,getParent:this.sendParent}):f(gt,null),u.border?f("div",{className:mn.line}):"")}))):f(gt,null)}}class Xp{render(){return fo}}class _a extends To{constructor(){super("ComponentSheet")}getComponentRender(){return new Yp(this.getComponentFactory())}getComponentFactory(){return new Gp}}class Yp{constructor(e){this._componentFactory=e}renderForwardFn(e){return this._componentFactory.createComponent(e).render()}renderClass(e){return this._componentFactory.createComponent(e).render()}renderFunction(e){return this._componentFactory.createComponent(e).render()}}class Gp{createComponent(e){switch(e){case"Button":return new d_;case"Select":return new Bp;case"Container":return new _p;case"CellRangeModal":return new L_;case"Modal":return new Dp;case"SiderModal":return new Lp;case"Layout":return new Ep;case"Header":return new wp;case"Footer":return new Sp;case"Content":return new yp;case"Sider":return new Tp;case"Checkbox":return new P_;case"CheckboxGroup":return new U_;case"ColorPicker":return new gp;case"ColorPickerCircleButton":return new mp;case"Input":return new cp;case"Radio":return new Op;case"RadioGroup":return new xp;case"Tab":return new Wp;case"TabPane":return new Hp;case"Tooltip":return new Vp;case"Ul":return new Xp;case"Collapse":return new $_;case"Panel":return new V_;case"FormatModal":return new bp;case"Menu":return new Rp;case"Dropdown":return new Fp;case"NextIcon":return new f1;case"RightIcon":return new m1;case"OrderIcon":return new k1;case"CommentIcon":return new U1;case"ConditionalFormatIcon":return new H1;case"ScreenshotIcon":return new r_;case"CheckIcon":return new z1;case"SearchIcon":return new X1;case"ReplaceIcon":return new V1;case"FreezeIcon":return new W1;case"PivotableIcon":return new x1;case"FillColorIcon":return new p0;case"BoldIcon":return new e0;case"FullBorderIcon":return new v0;case"TopBorderIcon":return new b0;case"BottomBorderIcon":return new C0;case"LeftBorderIcon":return new E0;case"RightBorderIcon":return new w0;case"NoneBorderIcon":return new S0;case"OuterBorderIcon":return new y0;case"InnerBorderIcon":return new T0;case"StripingBorderIcon":return new R0;case"VerticalBorderIcon":return new A0;case"MergeIcon":return new I0;case"SumIcon":return new M1;case"OrderDESCIcon":return new B1;case"OrderASCIcon":return new F1;case"FilterIcon":return new N1;case"FilterRankIcon":return new L1;case"CleanIcon":return new P1;case"DeleteIcon":return new u_;case"DeleteLineIcon":return new n0;case"UnderLineIcon":return new o0;case"ItalicIcon":return new t0;case"TextColorIcon":return new s0;case"BackIcon":return new h1;case"ForwardIcon":return new d1;case"FormatIcon":return new g1;case"CorrectIcon":return new _1;case"LtIcon":return new p1;case"CloseIcon":return new v1;case"DropDownIcon":return new b1;case"MenuIcon":return new C1;case"HideIcon":return new E1;case"PhotoIcon":return new l1;case"LinkIcon":return new c1;case"ChartIcon":return new u1;case"LoadingIcon":return new Mm;case"LogoIcon":return new Bm;case"AddNumIcon":return new Hm;case"ReduceNumIcon":return new $m;case"PercentIcon":return new Vm;case"MoneyIcon":return new Xm;case"FxIcon":return new Ym;case"AddIcon":return new Gm;case"ReduceIcon":return new jm;case"DivideIcon":return new $1;case"LockIcon":return new Y1;case"LocationIcon":return new G1;case"PageIcon":return new j1;case"RegularIcon":return new K1;case"LayoutIcon":return new q1;case"TableIcon":return new Z1;case"ImageIcon":return new l_;case"LeftAlignIcon":return new V0;case"CenterAlignIcon":return new X0;case"RightAlignIcon":return new Y0;case"TopVerticalIcon":return new G0;case"CenterVerticalIcon":return new j0;case"BottomVerticalIcon":return new K0;case"TextRotateIcon":return new q0;case"TextRotateAngleUpIcon":return new Z0;case"TextRotateAngleDownIcon":return new J0;case"TextRotateVerticalIcon":return new Q0;case"TextRotateRotationUpIcon":return new e1;case"TextRotateRotationDownIcon":return new t1;case"BrIcon":return new n1;case"OverflowIcon":return new o1;case"CutIcon":return new s1;case"PrintIcon":return new s_;case"PrintAreaIcon":return new i_;case"PrintTitleIcon":return new a_;case"BorderDashDot":return new S_;case"BorderDashDotDot":return new T_;case"BorderDashed":return new E_;case"BorderDotted":return new b_;case"BorderHair":return new p_;case"BorderMedium":return new A_;case"BorderMediumDashDot":return new x_;case"BorderMediumDashDotDot":return new k_;case"BorderMediumDashed":return new D_;case"BorderThick":return new F_;case"BorderThin":return new m_;case"Slider":return new zp}throw new Error("Not Found Component")}}function jp(o){o.deleteObserve("onAfterChangeFontFamilyObservable"),o.deleteObserve("onAfterChangeFontSizeObservable"),o.deleteObserve("onAfterChangeFontWeightObservable"),o.deleteObserve("onAfterChangeFontItalicObservable"),o.deleteObserve("onAfterChangeFontStrikethroughObservable"),o.deleteObserve("onAfterChangeFontUnderlineObservable"),o.deleteObserve("onAfterChangeFontBackgroundObservable"),o.deleteObserve("onAfterChangeFontColorObservable"),o.deleteObserve("onDragAndDropStartObserver"),o.deleteObserve("onDragAndDroppingObserver"),o.deleteObserve("onDragAndDropEndEndObserver"),o.deleteObserve("onFillStartObserver"),o.deleteObserve("onFillingObserver"),o.deleteObserve("onFillEndObserver"),o.deleteObserve("onChangeSelectionObserver"),o.deleteObserve("onToolBarDidMountObservable"),o.deleteObserve("onModalGroupDidMountObservable"),o.deleteObserve("onRichTextDidMountObservable"),o.deleteObserve("onRichTextKeyDownObservable"),o.deleteObserve("onRichTextKeyUpObservable"),o.deleteObserve("onFormulaBarDidMountObservable"),o.deleteObserve("onChangeCurrentSheetObserver"),o.deleteObserve("onSheetContainerDidMountObservable"),o.deleteObserve("onCellRangeModalDidMountObservable"),o.deleteObserve("onSpreadsheetKeyDownObservable"),o.deleteObserve("onSpreadsheetKeyUpObservable"),o.deleteObserve("onSpreadsheetKeyCopyObservable"),o.deleteObserve("onSpreadsheetKeyPasteObservable"),o.deleteObserve("onSpreadsheetKeyCutObservable"),o.deleteObserve("onSpreadsheetKeyCompositionStartObservable"),o.deleteObserve("onSpreadsheetKeyCompositionUpdateObservable"),o.deleteObserve("onSpreadsheetKeyCompositionEndObservable")}function Kp(o){o.pushToObserve("onAfterChangeFontFamilyObservable"),o.pushToObserve("onAfterChangeFontSizeObservable"),o.pushToObserve("onAfterChangeFontWeightObservable"),o.pushToObserve("onAfterChangeFontItalicObservable"),o.pushToObserve("onAfterChangeFontStrikethroughObservable"),o.pushToObserve("onAfterChangeFontUnderlineObservable"),o.pushToObserve("onAfterChangeFontBackgroundObservable"),o.pushToObserve("onAfterChangeFontColorObservable"),o.pushToObserve("onDragAndDropStartObserver"),o.pushToObserve("onDragAndDroppingObserver"),o.pushToObserve("onDragAndDropEndEndObserver"),o.pushToObserve("onFillStartObserver"),o.pushToObserve("onFillingObserver"),o.pushToObserve("onFillEndObserver"),o.pushToObserve("onChangeSelectionObserver"),o.pushToObserve("onChangeCurrentSheetObserver"),o.pushToObserve("onToolBarDidMountObservable"),o.pushToObserve("onCellRangeModalDidMountObservable"),o.pushToObserve("onModalGroupDidMountObservable"),o.pushToObserve("onRichTextDidMountObservable"),o.pushToObserve("onRichTextKeyDownObservable"),o.pushToObserve("onRichTextKeyUpObservable"),o.pushToObserve("onFormulaBarDidMountObservable"),o.pushToObserve("onLineColorDidMountObservable"),o.pushToObserve("onSheetBarDidMountObservable"),o.pushToObserve("onCountBarDidMountObservable"),o.pushToObserve("onInfoBarDidMountObservable"),o.pushToObserve("onRightMenuDidMountObservable"),o.pushToObserve("onSheetContainerDidMountObservable"),o.pushToObserve("onSpreadsheetKeyDownObservable"),o.pushToObserve("onSpreadsheetKeyUpObservable"),o.pushToObserve("onSpreadsheetKeyCopyObservable"),o.pushToObserve("onSpreadsheetKeyPasteObservable"),o.pushToObserve("onSpreadsheetKeyCutObservable"),o.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),o.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),o.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}var qp={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",cut:"\u526A\u5207",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},Zp={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};class Hd{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(e){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var At=(o=>(o.MAIN_SCENE="mainScene",o.VIEW_MAIN="viewMain",o.VIEW_TOP="viewTop",o.VIEW_LEFT="viewLeft",o.VIEW_LEFT_TOP="viewLeftTop",o.SHEET_VIEW="sheetView",o))(At||{});const pa=cn.create();/*!
 * css-vars-ponyfill
 * v2.4.8
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Ft(){return Ft=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},Ft.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function $d(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={mimeType:e.mimeType||null,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},n=Array.isArray(o)?o:[o],s=Array.apply(null,Array(n.length)).map(function(c){return null});function r(c){var u=typeof c=="string",h=u&&c.trim().charAt(0)==="<";return u&&!h}function i(c,u){t.onError(c,n[u],u)}function a(c,u){var h=t.onSuccess(c,n[u],u);c=h===!1?"":h||c,s[u]=c,s.indexOf(null)===-1&&t.onComplete(s)}var l=document.createElement("a");n.forEach(function(c,u){l.setAttribute("href",c),l.href=String(l.href);var h=Boolean(document.all&&!window.atob),d=h&&l.host.split(":")[0]!==location.host.split(":")[0];if(d){var g=l.protocol===location.protocol;if(g){var m=new XDomainRequest;m.open("GET",c),m.timeout=0,m.onprogress=Function.prototype,m.ontimeout=Function.prototype,m.onload=function(){var p=m.responseText;r(p)?a(p,u):i(m,u)},m.onerror=function(p){i(m,u)},setTimeout(function(){m.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(c,")")),i(null,u)}else{var _=new XMLHttpRequest;_.open("GET",c),t.mimeType&&_.overrideMimeType&&_.overrideMimeType(t.mimeType),t.onBeforeSend(_,c,u),_.onreadystatechange=function(){if(_.readyState===4){var p=_.responseText;_.status<400&&r(p)||_.status===0&&r(p)?a(p,u):i(_,u)}},_.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function Vd(o){var e={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},t={rootElement:o.rootElement||document,include:o.include||'style,link[rel="stylesheet"]',exclude:o.exclude||null,filter:o.filter||null,skipDisabled:o.skipDisabled!==!1,useCSSOM:o.useCSSOM||!1,onBeforeSend:o.onBeforeSend||Function.prototype,onSuccess:o.onSuccess||Function.prototype,onError:o.onError||Function.prototype,onComplete:o.onComplete||Function.prototype},n=Array.apply(null,t.rootElement.querySelectorAll(t.include)).filter(function(c){return!Jp(c,t.exclude)}),s=Array.apply(null,Array(n.length)).map(function(c){return null});function r(){var c=s.indexOf(null)===-1;if(c){s.reduce(function(h,d,g){return d===""&&h.push(g),h},[]).reverse().forEach(function(h){return[n,s].forEach(function(d){return d.splice(h,1)})});var u=s.join("");t.onComplete(u,s,n)}}function i(c,u,h,d){var g=t.onSuccess(c,h,d);c=g!==void 0&&Boolean(g)===!1?"":g||c,l(c,h,d,function(m,_){s[u]===null&&(_.forEach(function(p){return t.onError(p.xhr,h,p.url)}),!t.filter||t.filter.test(m)?s[u]=m:s[u]="",r())})}function a(c,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],d={};return d.rules=(c.replace(e.cssComments,"").match(e.cssImports)||[]).filter(function(g){return h.indexOf(g)===-1}),d.urls=d.rules.map(function(g){return g.replace(e.cssImports,"$1")}),d.absoluteUrls=d.urls.map(function(g){return va(g,u)}),d.absoluteRules=d.rules.map(function(g,m){var _=d.urls[m],p=va(d.absoluteUrls[m],u);return g.replace(_,p)}),d}function l(c,u,h,d){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],_=a(c,h,m);_.rules.length?$d(_.absoluteUrls,{onBeforeSend:function(v,b,C){t.onBeforeSend(v,u,b)},onSuccess:function(v,b,C){var D=t.onSuccess(v,u,b);v=D===!1?"":D||v;var O=a(v,b,m);return O.rules.forEach(function(F,S){v=v.replace(F,O.absoluteRules[S])}),v},onError:function(v,b,C){g.push({xhr:v,url:b}),m.push(_.rules[C]),l(c,u,h,d,g,m)},onComplete:function(v){v.forEach(function(b,C){c=c.replace(_.rules[C],b)}),l(c,u,h,d,g,m)}}):d(c,g)}n.length?n.forEach(function(c,u){var h=c.getAttribute("href"),d=c.getAttribute("rel"),g=c.nodeName.toLowerCase()==="link"&&h&&d&&d.toLowerCase().indexOf("stylesheet")!==-1,m=t.skipDisabled===!1?!1:c.disabled,_=c.nodeName.toLowerCase()==="style";if(g&&!m){var p=h.indexOf("data:text/css")!==-1;if(p){var v=decodeURIComponent(h.substring(h.indexOf(",")+1));t.useCSSOM&&(v=Array.apply(null,c.sheet.cssRules).map(function(C){return C.cssText}).join("")),i(v,u,c,location.href)}else $d(h,{mimeType:"text/css",onBeforeSend:function(D,O,F){t.onBeforeSend(D,c,O)},onSuccess:function(D,O,F){var S=va(h);i(D,u,c,S)},onError:function(D,O,F){s[u]="",t.onError(D,c,O),r()}})}else if(_&&!m){var b=c.textContent;t.useCSSOM&&(b=Array.apply(null,c.sheet.cssRules).map(function(C){return C.cssText}).join("")),i(b,u,c,location.href)}else s[u]="",r()}):t.onComplete("",[])}function va(o,e){var t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e||document.baseURI||(document.querySelector("base")||{}).href||location.href,s.href=o,s.href}function Jp(o,e){var t=o.matches||o.matchesSelector||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector;return t.call(o,e)}var Xd=Yd;function Yd(o,e,t){o instanceof RegExp&&(o=Gd(o,t)),e instanceof RegExp&&(e=Gd(e,t));var n=jd(o,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+o.length,n[1]),post:t.slice(n[1]+e.length)}}function Gd(o,e){var t=e.match(o);return t?t[0]:null}Yd.range=jd;function jd(o,e,t){var n,s,r,i,a,l=t.indexOf(o),c=t.indexOf(e,l+1),u=l;if(l>=0&&c>0){if(o===e)return[l,c];for(n=[],r=t.length;u>=0&&!a;)u==l?(n.push(u),l=t.indexOf(o,u+1)):n.length==1?a=[n.pop(),c]:(s=n.pop(),s<r&&(r=s,i=c),c=t.indexOf(e,u+1)),u=l<c&&l>=0?l:c;n.length&&(a=[r,i])}return a}function ba(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,removeComments:!1},n=Ft({},t,e),s=[];function r(y){throw new Error("CSS parse error: ".concat(y))}function i(y){var k=y.exec(o);if(k)return o=o.slice(k[0].length),k}function a(){return i(/^{\s*/)}function l(){return i(/^}/)}function c(){i(/^\s*/)}function u(){if(c(),!(o[0]!=="/"||o[1]!=="*")){for(var y=2;o[y]&&(o[y]!=="*"||o[y+1]!=="/");)y++;if(!o[y])return r("end of comment is missing");var k=o.slice(2,y);return o=o.slice(y+2),{type:"comment",comment:k}}}function h(){for(var y=[],k;k=u();)y.push(k);return n.removeComments?[]:y}function d(){for(c();o[0]==="}";)r("extra closing bracket");var y=i(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(y){var k=y[0].trim(),M,U=/\/\*/.test(k);U&&(k=k.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var z=/["']\w*,\w*["']/.test(k);z&&(k=k.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(j){return j.replace(/,/g,"\u200C")}));var K=/,/.test(k);return K?M=k.split(/\s*(?![^(]*\)),\s*/):M=[k],z&&(M=M.map(function(j){return j.replace(/\u200C/g,",")})),M}}function g(){if(o[0]==="@")return I();i(/^([;\s]*)+/);var y=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,k=i(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(!!k){if(k=k[0].trim(),!i(/^:\s*/))return r("property missing ':'");var M=i(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),U={type:"declaration",property:k.replace(y,""),value:M?M[0].replace(y,"").trim():""};return i(/^[;\s]*/),U}}function m(){if(!a())return r("missing '{'");for(var y,k=h();y=g();)k.push(y),k=k.concat(h());return l()?k:r("missing '}'")}function _(){c();for(var y=[],k;k=i(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)y.push(k[1]),i(/^,\s*/);if(y.length)return{type:"keyframe",values:y,declarations:m()}}function p(){var y=i(/^@([-\w]+)?keyframes\s*/);if(!!y){var k=y[1];if(y=i(/^([-\w]+)\s*/),!y)return r("@keyframes missing name");var M=y[1];if(!a())return r("@keyframes missing '{'");for(var U,z=h();U=_();)z.push(U),z=z.concat(h());return l()?{type:"keyframes",name:M,vendor:k,keyframes:z}:r("@keyframes missing '}'")}}function v(){var y=i(/^@page */);if(y){var k=d()||[];return{type:"page",selectors:k,declarations:m()}}}function b(){var y=i(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(y){var k="".concat(y[1],"-").concat(y[2])+(y[3]?"-".concat(y[3]):"");return{type:"page-margin-box",name:k,declarations:m()}}}function C(){var y=i(/^@font-face\s*/);if(y)return{type:"font-face",declarations:m()}}function D(){var y=i(/^@supports *([^{]+)/);if(y)return{type:"supports",supports:y[1].trim(),rules:L()}}function O(){var y=i(/^@host\s*/);if(y)return{type:"host",rules:L()}}function F(){var y=i(/^@media([^{]+)*/);if(y)return{type:"media",media:(y[1]||"").trim(),rules:L()}}function S(){var y=i(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(y)return{type:"custom-media",name:y[1].trim(),media:y[2].trim()}}function E(){var y=i(/^@([-\w]+)?document *([^{]+)/);if(y)return{type:"document",document:y[2].trim(),vendor:y[1]?y[1].trim():null,rules:L()}}function w(){var y=i(/^@(import|charset|namespace)\s*([^;]+);/);if(y)return{type:y[1],name:y[2].trim()}}function I(){if(c(),o[0]==="@"){var y=w()||C()||F()||p()||D()||E()||S()||O()||v()||b();if(y&&!n.preserveStatic){var k=!1;if(y.declarations)k=y.declarations.some(function(U){return/var\(/.test(U.value)});else{var M=y.keyframes||y.rules||[];k=M.some(function(U){return(U.declarations||[]).some(function(z){return/var\(/.test(z.value)})})}return k?y:{}}return y}}function P(){if(!n.preserveStatic){var y=Xd("{","}",o);if(y){var k=/:(?:root|host)(?![.:#(])/.test(y.pre)&&/--\S*\s*:/.test(y.body),M=/var\(/.test(y.body);if(!k&&!M)return o=o.slice(y.end+1),{}}}var U=d()||[],z=n.preserveStatic?m():m().filter(function(K){var j=U.some(function(se){return/:(?:root|host)(?![.:#(])/.test(se)})&&/^--\S/.test(K.property),q=/var\(/.test(K.value);return j||q});return U.length||r("selector missing"),{type:"rule",selectors:U,declarations:z}}function L(y){if(!y&&!a())return r("missing '{'");for(var k,M=h();o.length&&(y||o[0]!=="}")&&(k=I()||P());)k.type&&M.push(k),M=M.concat(h());return!y&&!l()?r("missing '}'"):M}return{type:"stylesheet",stylesheet:{rules:L(!0),errors:s}}}function Kd(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={parseHost:!1,store:{},onWarning:function(){}},n=Ft({},t,e),s=new RegExp(":".concat(n.parseHost?"host":"root","$"));return typeof o=="string"&&(o=ba(o,n)),o.stylesheet.rules.forEach(function(r){r.type!=="rule"||!r.selectors.some(function(i){return s.test(i)})||r.declarations.forEach(function(i,a){var l=i.property,c=i.value;l&&l.indexOf("--")===0&&(n.store[l]=c)})}),n.store}function qd(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,n={charset:function(i){return"@charset "+i.name+";"},comment:function(i){return i.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+i.comment+"*/":""},"custom-media":function(i){return"@custom-media "+i.name+" "+i.media+";"},declaration:function(i){return i.property+":"+i.value+";"},document:function(i){return"@"+(i.vendor||"")+"document "+i.document+"{"+s(i.rules)+"}"},"font-face":function(i){return"@font-face{"+s(i.declarations)+"}"},host:function(i){return"@host{"+s(i.rules)+"}"},import:function(i){return"@import "+i.name+";"},keyframe:function(i){return i.values.join(",")+"{"+s(i.declarations)+"}"},keyframes:function(i){return"@"+(i.vendor||"")+"keyframes "+i.name+"{"+s(i.keyframes)+"}"},media:function(i){return"@media "+i.media+"{"+s(i.rules)+"}"},namespace:function(i){return"@namespace "+i.name+";"},page:function(i){return"@page "+(i.selectors.length?i.selectors.join(", "):"")+"{"+s(i.declarations)+"}"},"page-margin-box":function(i){return"@"+i.name+"{"+s(i.declarations)+"}"},rule:function(i){var a=i.declarations;if(a.length)return i.selectors.join(",")+"{"+s(a)+"}"},supports:function(i){return"@supports "+i.supports+"{"+s(i.rules)+"}"}};function s(r){for(var i="",a=0;a<r.length;a++){var l=r[a];t&&t(l);var c=n[l.type](l);c&&(i+=c,c.length&&l.selectors&&(i+=e))}return i}return s(o.stylesheet.rules)}function Zd(o,e){o.rules.forEach(function(t){if(t.rules){Zd(t,e);return}if(t.keyframes){t.keyframes.forEach(function(n){n.type==="keyframe"&&e(n.declarations,t)});return}!t.declarations||e(t.declarations,o)})}var Qp="--",ev="var";function tv(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},n=Ft({},t,e);return typeof o=="string"&&(o=ba(o,n)),Zd(o.stylesheet,function(s,r){for(var i=0;i<s.length;i++){var a=s[i],l=a.type,c=a.property,u=a.value;if(l==="declaration"){if(!n.preserveVars&&c&&c.indexOf(Qp)===0){s.splice(i,1),i--;continue}if(u.indexOf(ev+"(")!==-1){var h=Us(u,n);h!==a.value&&(h=nv(h),n.preserveVars?(s.splice(i,0,{type:l,property:c,value:h}),i++):a.value=h)}}}}),qd(o)}function nv(o){var e=/calc\(([^)]+)\)/g;return(o.match(e)||[]).forEach(function(t){var n="calc".concat(t.split("calc").join(""));o=o.replace(t,n)}),o}function Us(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;if(o.indexOf("var(")===-1)return o;var n=Xd("(",")",o);function s(i){var a=i.split(",")[0].replace(/[\s\n\t]/g,""),l=(i.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],c=Object.prototype.hasOwnProperty.call(e.variables,a)?String(e.variables[a]):void 0,u=c||(l?String(l):void 0),h=t||i;return c||e.onWarning('variable "'.concat(a,'" is undefined')),u&&u!=="undefined"&&u.length>0?Us(u,e,h):"var(".concat(h,")")}if(n)if(n.pre.slice(-3)==="var"){var r=n.body.trim().length===0;return r?(e.onWarning("var() must contain a non-whitespace string"),o):n.pre.slice(0,-3)+s(n.body)+Us(n.post,e)}else return n.pre+"(".concat(Us(n.body,e),")")+Us(n.post,e);else return o.indexOf("var(")!==-1&&e.onWarning('missing closing ")" in the value "'.concat(o,'"')),o}var Vr=typeof window!="undefined",Jd=Vr&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),mo={group:0,job:0},Xr={rootElement:Vr?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},_n={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},Qe={dom:{},job:{},user:{}},Yr=!1,Ut=null,Ws=0,Ca=null,Ea=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function on(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e="cssVars(): ",t=Ft({},Xr,o);function n(u,h,d,g){!t.silent&&window.console&&console.error("".concat(e).concat(u,`
`),h),t.onError(u,h,d,g)}function s(u){!t.silent&&window.console&&console.warn("".concat(e).concat(u)),t.onWarning(u)}function r(u){t.onFinally(Boolean(u),Jd,wa()-t.__benchmark)}if(!!Vr){if(t.watch){t.watch=Xr.watch,ov(t),on(t);return}else t.watch===!1&&Ut&&(Ut.disconnect(),Ut=null);if(!t.__benchmark){if(Yr===t.rootElement){sv(o);return}var i=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(t.__benchmark=wa(),t.exclude=[Ut?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",t.exclude].filter(function(u){return u}).join(","),t.variables=av(t.variables),i.forEach(function(u){var h=u.nodeName.toLowerCase()==="style"&&u.__cssVars.text,d=h&&u.textContent!==u.__cssVars.text;h&&d&&(u.sheet&&(u.sheet.disabled=!1),u.setAttribute("data-cssvars",""))}),!Ut){var a=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars="out"]'));a.forEach(function(u){var h=u.getAttribute("data-cssvars-group"),d=h?t.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(h,'"]')):null;d||u.parentNode.removeChild(u)}),Ws&&i.length<Ws&&(Ws=i.length,Qe.dom={})}}if(document.readyState!=="loading")if(Jd&&t.onlyLegacy){var l=!1;if(t.updateDOM){var c=t.rootElement.host||(t.rootElement===document?document.documentElement:t.rootElement);Object.keys(t.variables).forEach(function(u){var h=t.variables[u];l=l||h!==getComputedStyle(c).getPropertyValue(u),c.style.setProperty(u,h)})}r(l)}else!Ea&&(t.shadowDOM||t.rootElement.shadowRoot||t.rootElement.host)?Vd({rootElement:Xr.rootElement,include:Xr.include,exclude:t.exclude,skipDisabled:!1,onSuccess:function(h,d,g){var m=(d.sheet||{}).disabled&&!d.__cssVars;return m?!1:(h=h.replace(_n.cssComments,"").replace(_n.cssMediaQueries,""),h=(h.match(_n.cssVarDeclRules)||[]).join(""),h||!1)},onComplete:function(h,d,g){Kd(h,{store:Qe.dom,onWarning:s}),Ea=!0,on(t)}}):(Yr=t.rootElement,Vd({rootElement:t.rootElement,include:t.include,exclude:t.exclude,skipDisabled:!1,onBeforeSend:t.onBeforeSend,onError:function(h,d,g){var m=h.responseURL||Qd(g,location.href),_=h.statusText?"(".concat(h.statusText,")"):"Unspecified Error"+(h.status===0?" (possibly CORS related)":""),p="CSS XHR Error: ".concat(m," ").concat(h.status," ").concat(_);n(p,d,h,m)},onSuccess:function(h,d,g){var m=(d.sheet||{}).disabled&&!d.__cssVars;if(m)return!1;var _=d.nodeName.toLowerCase()==="link",p=d.nodeName.toLowerCase()==="style"&&h!==d.textContent,v=t.onSuccess(h,d,g);return h=v!==void 0&&Boolean(v)===!1?"":v||h,t.updateURLs&&(_||p)&&(h=iv(h,g)),h},onComplete:function(h,d){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],m=Ft({},Qe.dom,Qe.user),_=!1;if(Qe.job={},g.forEach(function(S,E){var w=d[E];if(S.__cssVars=S.__cssVars||{},S.__cssVars.text=w,_n.cssVars.test(w))try{var I=ba(w,{preserveStatic:t.preserveStatic,removeComments:!0});Kd(I,{parseHost:Boolean(t.rootElement.host),store:Qe.dom,onWarning:s}),S.__cssVars.tree=I}catch(P){n(P.message,S)}}),Ft(Qe.job,Qe.dom),t.updateDOM?(Ft(Qe.user,t.variables),Ft(Qe.job,Qe.user)):(Ft(Qe.job,Qe.user,t.variables),Ft(m,t.variables)),_=mo.job>0&&Boolean(Object.keys(Qe.job).length>Object.keys(m).length||Boolean(Object.keys(m).length&&Object.keys(Qe.job).some(function(S){return Qe.job[S]!==m[S]}))),_)Sa(t.rootElement),on(t);else{var p=[],v=[],b=!1;if(t.updateDOM&&mo.job++,g.forEach(function(S,E){var w=!S.__cssVars.tree;if(S.__cssVars.tree)try{tv(S.__cssVars.tree,Ft({},t,{variables:Qe.job,onWarning:s}));var I=qd(S.__cssVars.tree);if(t.updateDOM){var P=d[E],L=_n.cssVarFunc.test(P);if(S.getAttribute("data-cssvars")||S.setAttribute("data-cssvars","src"),I.length&&L){var y=S.getAttribute("data-cssvars-group")||++mo.group,k=I.replace(/\s/g,""),M=t.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(y,'"]'))||document.createElement("style");b=b||_n.cssKeyframes.test(I),t.preserveStatic&&S.sheet&&(S.sheet.disabled=!0),M.hasAttribute("data-cssvars")||M.setAttribute("data-cssvars","out"),k===S.textContent.replace(/\s/g,"")?(w=!0,M&&M.parentNode&&(S.removeAttribute("data-cssvars-group"),M.parentNode.removeChild(M))):k!==M.textContent.replace(/\s/g,"")&&([S,M].forEach(function(U){U.setAttribute("data-cssvars-job",mo.job),U.setAttribute("data-cssvars-group",y)}),M.textContent=I,p.push(I),v.push(M),M.parentNode||S.parentNode.insertBefore(M,S.nextSibling))}}else S.textContent.replace(/\s/g,"")!==I&&p.push(I)}catch(U){n(U.message,S)}w&&S.setAttribute("data-cssvars","skip"),S.hasAttribute("data-cssvars-job")||S.setAttribute("data-cssvars-job",mo.job)}),Ws=t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,t.shadowDOM){for(var C=[].concat(t.rootElement).concat([].slice.call(t.rootElement.querySelectorAll("*"))),D=0,O;O=C[D];++D)if(O.shadowRoot&&O.shadowRoot.querySelector("style")){var F=Ft({},t,{rootElement:O.shadowRoot});on(F)}}t.updateDOM&&b&&rv(t.rootElement),Yr=!1,t.onComplete(p.join(""),v,JSON.parse(JSON.stringify(Qe.job)),wa()-t.__benchmark),r(v.length)}}}));else document.addEventListener("DOMContentLoaded",function u(h){on(o),document.removeEventListener("DOMContentLoaded",u)})}}on.reset=function(){mo.job=0,mo.group=0,Yr=!1,Ut&&(Ut.disconnect(),Ut=null),Ws=0,Ca=null,Ea=!1;for(var o in Qe)Qe[o]={}};function ov(o){function e(l){var c=t(l)&&l.hasAttribute("disabled"),u=(l.sheet||{}).disabled;return c||u}function t(l){var c=l.nodeName.toLowerCase()==="link"&&(l.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return c}function n(l){return l.nodeName.toLowerCase()==="style"}function s(l){var c=!1;if(l.type==="attributes"&&t(l.target)&&!e(l.target)){var u=l.attributeName==="disabled",h=l.attributeName==="href",d=l.target.getAttribute("data-cssvars")==="skip",g=l.target.getAttribute("data-cssvars")==="src";u?c=!d&&!g:h&&(d?l.target.setAttribute("data-cssvars",""):g&&Sa(o.rootElement,!0),c=!0)}return c}function r(l){var c=!1;if(l.type==="childList"){var u=n(l.target),h=l.target.getAttribute("data-cssvars")==="out";c=u&&!h}return c}function i(l){var c=!1;return l.type==="childList"&&(c=[].slice.call(l.addedNodes).some(function(u){var h=u.nodeType===1,d=h&&u.hasAttribute("data-cssvars"),g=n(u)&&_n.cssVars.test(u.textContent),m=!d&&(t(u)||g);return m&&!e(u)})),c}function a(l){var c=!1;return l.type==="childList"&&(c=[].slice.call(l.removedNodes).some(function(u){var h=u.nodeType===1,d=h&&u.getAttribute("data-cssvars")==="out",g=h&&u.getAttribute("data-cssvars")==="src",m=g;if(g||d){var _=u.getAttribute("data-cssvars-group"),p=o.rootElement.querySelector('[data-cssvars-group="'.concat(_,'"]'));g&&Sa(o.rootElement,!0),p&&p.parentNode.removeChild(p)}return m})),c}!window.MutationObserver||(Ut&&(Ut.disconnect(),Ut=null),Ut=new MutationObserver(function(l){var c=l.some(function(u){return s(u)||r(u)||i(u)||a(u)});c&&on(o)}),Ut.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function sv(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(Ca),Ca=setTimeout(function(){o.__benchmark=null,on(o)},e)}function rv(o){var e=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(d){return getComputedStyle(document.body)[d]})[0];if(e){for(var t=[].slice.call(o.querySelectorAll("*")),n=[],s="__CSSVARSPONYFILL-KEYFRAMES__",r=0,i=t.length;r<i;r++){var a=t[r],l=getComputedStyle(a)[e];l!=="none"&&(a.style[e]+=s,n.push(a))}document.body.offsetHeight;for(var c=0,u=n.length;c<u;c++){var h=n[c].style;h[e]=h[e].replace(s,"")}}}function iv(o,e){var t=o.replace(_n.cssComments,"").match(_n.cssUrls)||[];return t.forEach(function(n){var s=n.replace(_n.cssUrls,"$1"),r=Qd(s,e);o=o.replace(n,n.replace(s,r))}),o}function av(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=/^-{2}/;return Object.keys(o).reduce(function(t,n){var s=e.test(n)?n:"--".concat(n.replace(/^-+/,""));return t[s]=o[n],t},{})}function Qd(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e,s.href=o,s.href}function wa(){return Vr&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function Sa(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=[].slice.call(o.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));t.forEach(function(n){return n.setAttribute("data-cssvars","")}),e&&(Qe.dom={})}var ya={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"},Ta={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#0d1117",fontSize:"14px",headingColor:"rgba(255, 255, 255, 0.85)",textColor:"#8b949e",textColorSecondary:"rgba(255, 255, 255, 0.45)",disabledColor:"rgba(255, 255, 255, 0.25)",disabledBg:"rgba(255, 255, 255, 0.04)",borderColorBase:"rgba(255, 255, 255, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(255, 255, 255, 0.12), 0 6px 16px 0 rgba(255, 255, 255, 0.08), 0 9px 28px 8px rgba(255, 255, 255, 0.05)",borderColorBaseHover:"#bfbfbf"},Ra={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#004b1c",primaryColorHover:"#0e5c2f",linkColor:"#217346",bg:"#fff",fontSize:"14px",headingColor:"rgba(0, 0, 0, 0.85)",textColor:"rgba(0, 0, 0, 0.65)",textColorSecondary:"rgba(0, 0, 0, 0.45)",disabledColor:"rgba(0, 0, 0, 0.25)",disabledBg:"rgba(0, 0, 0, 0.04)",borderColorBase:"rgba(0, 0, 0, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"},Gr={contextMenu:"univer-context-menu",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",btn:"univer-btn",rightMenuCenter:"univer-right-menu-center",rightMenuItem:"univer-right-menu-item"};class lv extends _e{constructor(){super(...arguments),this.ulRef=ee(),this.root=ee(),this.handleContextMenu=async(e,t,n)=>{e.preventDefault(),this.setState({visible:!0,srcElement:e.target,eventType:e.type},()=>{new Promise((s,r)=>{this.ulRef.current.showMenu(!0),s()}).then(()=>{const s=n?t.x:e.clientX,r=n?t.y:e.clientY,i=window.innerWidth,a=window.innerHeight,l=this.ulRef.current.base.offsetWidth,c=this.ulRef.current.base.offsetHeight,u=i-s>l,h=!u,d=a-r>c,g=!d;u&&(this.root.current.style.left=`${s}px`),h&&(this.root.current.style.left=`${s-l}px`),d&&(this.root.current.style.top=`${r}px`),g&&(this.root.current.style.top=`${r-c}px`)})})},this.handleClick=e=>{const{visible:t,eventType:n,srcElement:s}=this.state;!this.root.current||n==="click"&&s&&s.contains(e.target)||this.root.current.contains(e.target)||t&&this.setState({visible:!1})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={visible:!1,srcElement:null,eventType:null,children:[]}}resetMenuList(e){var n;const t=this._context.getPluginManager().getPluginByName(Me.SPREADSHEET);for(let s=0;s<e.length;s++){const r=e[s];if(r.customLabel){const i=t.getRegisterComponent(r.customLabel.name),a=(n=r.customLabel.props)!=null?n:{};i&&(r.label=f(i,{...a}))}r.children&&(r.children=this.resetMenuList(r.children))}return e}setMenuList(e){this.setState({children:this.resetMenuList(e)})}componentDidMount(){var e;document.addEventListener("click",this.handleClick),(e=this._context.getObserverManager().getObserver("onRightMenuDidMountObservable",Me.SPREADSHEET))==null||e.notifyObservers(this)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}showRightMenu(e){this.ulRef.current.showMenu(e)}render(){if(!this.state.children.length)return;const e={...this.props.style},{visible:t}=this.state,n=this.Render.renderFunction("Menu");return t&&f("div",{ref:this.root,className:Gr.contextMenu,style:e,onContextMenu:s=>{s.preventDefault()}},f(n,{ref:this.ulRef,menu:this.state.children,onClick:this.handleClick}))}}class qo extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,children:t}=this.props,n=this._render.renderFunction("Button");return f("div",null,e,t.map(s=>f(n,{type:"primary"},s.label)))}}class $n extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}handleClick(e){e.stopPropagation()}handleKeyUp(e){const{onKeyUp:t}=this.props;t==null||t(e)}render(){const{prefix:e,suffix:t}=this.props,n=this._render.renderFunction("Input");return f("div",null,e,f(n,{onKeyUp:this.handleKeyUp.bind(this),type:"number",placeholder:"1",onClick:this.handleClick}),t)}}class jr extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e}=this.props,t=this._render.renderFunction("RightIcon");return f("div",{className:Gr.rightMenuItem},e,f(t,null))}}class Aa extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,options:t}=this.props,n=this._render.renderFunction("Input");return f("div",null,f("div",null,e),f("select",null,t.map(s=>f("option",null,s.label))),f(n,{type:"number",placeholder:"2"}))}}var Hs={infoDetail:"univer-info-detail",infoReturn:"univer-info-return",univericon:"univer-univericon",univericonLogo:"univer-univericon-logo",sheetName:"univer-sheet-name",infoDetailUpdate:"univer-info-detail-update",infoDetailSave:"univer-info-detail-save"};class cv extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Me.SPREADSHEET))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),s=this.Render.renderFunction("Tooltip"),r=this.Render.renderFunction("DropDownIcon"),i=this.Render.renderFunction("LogoIcon"),{back:a,sheet:l,update:c,save:u,rename:h}=this.state.infoList;return f(t,{className:Hs.infoDetail},f("div",{style:{marginRight:"18px"}},f(s,{title:a.label,placement:"bottom"},f(e,{className:Hs.infoReturn,type:"text"},f(r,{rotate:90})))),f(i,{style:{width:"152px",height:"32px"}}),f("div",{className:Hs.sheetName},f(s,{title:h.label,placement:"bottom"},f(n,{bordered:!1,value:l.label,onBlur:l.onBlur}))),f("div",{className:Hs.infoDetailUpdate},c.label),f("div",{className:Hs.infoDetailSave},u.label))}}var Vn={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},uv={textButton:"univer-text-button"};class hv extends _e{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}componentWillReceiveProps(e,t){e.active!==this.props.active&&this.setState({active:e.active})}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return f("div",{className:uv.textButton},f(n,{type:"text",active:t,onClick:this.handleClick},e))}}var It={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectDoubleString:"univer-select-double-string",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",univericonNextIcon:"univer-univericon-nextIcon",moreButton:"univer-more-button",moreTool:"univer-more-tool"};class dv extends _e{constructor(){super(...arguments),this.toolbarRef=ee(),this.moreBtnRef=ee(),this.moreToolRef=ee(),this.SelectRef=ee(),this.clientWidth=0,this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.debounceSetToolbarListWidth=Xo(()=>{this.setToolbarListWidth()},50),this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${It.toolbarWarp} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,s=null;const r=document.documentElement.clientWidth;if(r<=this.clientWidth){this.clientWidth=r;for(let i=0;i<e.length;i++)if(n+=e[i].clientWidth+6,n>r){s=i;break}s!==null&&this.setState({defaultToolList:this.state.toolList.slice(0,s),moreToolList:s?this.state.toolList.slice(s):[]},()=>{this.resetUl(),this.forceUpdate()})}else if(this.clientWidth=r,this.state.moreToolList.length){let i=30+t;for(let u=0;u<e.length;u++)i+=e[u].clientWidth+6;const a=this.moreToolRef.current.querySelectorAll(`.${It.moreTool} > div`);let l=null,c=!1;for(let u=0;u<a.length;u++)if(i+=a[u].clientWidth+6,i>r){l=u;break}else u===a.length-1&&(l=u,c=!0);l!==null&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,c?l+1:l)),moreToolList:c?[]:this.state.moreToolList.slice(l)},()=>{this.resetUl(),this.forceUpdate()})}},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Me.SPREADSHEET);for(let r=0;r<e.length;r++){const i=e[r];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=f(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=f(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=(e,t)=>{e=this.resetLabel(e),this.setState({toolList:e,defaultToolList:e,moreText:t},()=>{this.setToolbarListWidth()})},this.resetUl=()=>{var s;const t=`${((s=this._context.getPluginManager().getPluginByName(Me.SPREADSHEET))==null?void 0:s.getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let r=0;r<n.length;r++)n[r].style.maxHeight=t}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[],moreText:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolBarList(e){const t=this.Render.renderFunction("Tooltip");return e.map(n=>{if(n.toolbarType){if(n.show)return f(t,{title:n.tooltip,placement:"bottom"},f(hv,{active:n.active,label:n.label,onClick:n.onClick}))}else if(n.show)return f(zd,{tooltip:n.tooltip,type:n.type,display:n.display,children:n.children,customLabel:n.customLabel,customSuffix:n.customSuffix,label:n.label,onClick:n.onClick,onKeyUp:n.onKeyUp,defaultColor:n.defaultColor,hideSelectedIcon:n.hideSelectedIcon,className:n.className});return null})}render(){const{defaultToolList:e,moreToolList:t,moreText:n,showMore:s}=this.state,r=this.Render.renderFunction("Button"),i=this.Render.renderFunction("Container"),a=this.Render.renderFunction("Tooltip");return f(i,{style:{position:"relative"}},f("div",{className:`${It.toolbarWarp} ${It.toolbar}`,ref:this.toolbarRef},this.getToolBarList(e),f("div",{ref:this.moreBtnRef,className:It.moreButton,style:{visibility:t.length?"visible":"hidden"}},f(a,{title:n.tip,placement:"bottom"},f(r,{type:"text",onClick:this.showMore},f("div",{style:{fontSize:"14px"}},n.more))))),t.length?f("div",{style:{visibility:s?"visible":"hidden"},className:`${It.moreTool} ${It.toolbar}`,ref:this.moreToolRef},this.getToolBarList(t)):"")}}var Kr={countBar:"univer-count-bar",btn:"univer-btn",countZoom:"univer-count-zoom",countSlider:"univer-count-slider",countStatistic:"univer-count-statistic"};class gv extends _e{constructor(){super(...arguments),this.max=400,this.min=0,this.ref=ee(),this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.onChange=e=>{let t=e.target;this.state.onChange&&this.state.onChange(t.value),this.setValue({zoom:t.value}),console.log(t.value),this.ref.current.changeInputValue(0,t.value)},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let t=(Math.floor(this.state.zoom/10)+1)*10;t>=this.max&&(t=this.max),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t))},this.reduceZoom=()=>{let t=(Math.ceil(this.state.zoom/10)-1)*10;t<=this.min&&(t=this.min),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t)),this.ref.current.changeInputValue(0,t)}}initialize(e){this.state={zoom:100,content:""}}setZoom(e){e!==this.state.zoom&&(this.setValue({zoom:e}),this.ref.current.changeInputValue(0,e))}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCountBarDidMountObservable",Me.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{zoom:n,content:s}=t,r=this.getComponentRender().renderFunction("ReduceIcon"),i=this.getComponentRender().renderFunction("RegularIcon"),a=this.getComponentRender().renderFunction("Slider"),l=this.getComponentRender().renderFunction("Button"),c=this.getComponentRender().renderFunction("AddIcon");return f("div",{className:Kr.countBar},f(l,{type:"text",className:Kr.countZoom},n),f(l,{type:"text",onClick:this.addZoom},f(c,null)),f("div",{className:Kr.countSlider},f(a,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),f(l,{type:"text",onClick:this.reduceZoom},f(r,null)),f(l,{type:"text"},f(i,null)),f("span",{className:Kr.countStatistic},s))}}class fv extends _e{constructor(){super(...arguments),this.refs=[]}initialize(){this.state={modalGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onModalGroupDidMountObservable"))==null||e.notifyObservers(this)}setModalGroup(e){const t=this._context.getPluginManager().getPluginByName(Me.SPREADSHEET),n=e.map((s,r)=>{const i=t==null?void 0:t.getRegisterComponent(s);return i?f(i,{ref:a=>this.refs[r]=a}):null});this.setState({modalGroup:n})}getModalGroup(){return this.refs}render(){const{modalGroup:e}=this.state;return f(gt,null,e.map(t=>t))}}class mv extends _e{initialize(){this.state={sideGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSideGroupDidMountObservable"))==null||e.notifyObservers(this)}setSideGroup(e){const t=this._context.getPluginManager().getPluginByName(Me.SPREADSHEET),n=e.map(s=>{const r=t==null?void 0:t.getRegisterComponent(s.name);return r&&(s.side=f(r,null)),s});this.setState({sideGroup:n})}render(){const{sideGroup:e}=this.state;return f("div",null,e.map(t=>t.show?f("div",{onClick:()=>t.onClick(t.name),style:{zIndex:t.zIndex}},t.side):f(gt,null)))}}class _v{constructor(e){const t=e.primeval();this._scrollX=t.scrollLeft,this._slideTabBar=e}scrollX(e){const t=this._slideTabBar.primeval();t.scrollLeft=e,this._scrollX=t.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const pv={easeOutStrong(o,e,t,n){return-t*((o=o/n-1)*o*o*o-1)+e},backOut(o,e,t,n,s){return typeof s=="undefined"&&(s=.7),t*((o=o/n-1)*o*((s+1)*o+s)+1)+e}},vv={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(o){},success(o){},cancel(o){},complete(o){}};class bv{static success(...e){let t=0;return new Promise(n=>{for(let s=0;s<e.length;s++){let r=e[s],i=r._config,a=i.success;i.loop||(i.success=c=>{t++,a&&a.call(r,c),t===e.length&&n()})}})}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;let n=pv[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(n),this._status===1){this._config.cancel(n),this._config.complete(n);return}if(e===this._config.duration){this._config.success(n),this._config.complete(n);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}constructor(e){this._config={...vv,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}}class An{static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static make(e,t){let n=[];return e.forEach(s=>n.push(new An(s,t))),n}constructor(e,t){this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=t,this._placeholder=null,this._scrollbar=t.getScrollbar(),this.update()}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}primeval(){return this._slideTabItem}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}editor(e){if(this._editMode===!1){let t=this.primeval().querySelector("span"),n=r=>{this._editMode=!1,t&&(t.removeAttribute("contentEditable"),t.removeEventListener("blur",n),t.removeEventListener("input",s)),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName&&this._slideTabBar.getConfig().onChangeName(r),e&&e(r)},s=()=>{if(t){const r=t.querySelectorAll("br");r.length>0&&(r.forEach(i=>{t&&t.removeChild(i)}),t.blur())}};t&&(t.setAttribute("contentEditable","true"),t.addEventListener("blur",n),t.addEventListener("input",s),this._editMode=!0,qr.keepLastIndex(t))}}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new bv({begin:this._translateX,end:e,receive:t=>{this._slideTabItem.style.transform=`translateX(${t}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=An.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("box-shadow"),this._slideTabItem.style.removeProperty("background"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),t=this.getBoundingRect();this._placeholder=e,this._placeholder.style.width=`${t.width}px`,this._placeholder.style.height=`${t.height}px`,this._placeholder.style.flexShrink="0",this._slideTabItem.style.left=`${t.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${t.y}px`,this._slideTabItem.style.width=`${t.width}px`,this._slideTabItem.style.height=`${t.height}px`,this._slideTabItem.style.background=getComputedStyle(this._slideTabItem).background,this._slideTabItem.style.boxShadow="0px 0px 1px 1px rgba(82,82,82,0.1)",this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,t,n){this._slideTabItem.addEventListener(e,t,n)}removeEventListener(e,t,n){this._slideTabItem.removeEventListener(e,t,n)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=An.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}}class qr{static checkedSkipSlide(e){let t=e.target;for(;t!=null&&t!==document.body;){if(t.getAttribute("data-slide-skip"))return!0;t=t.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{const t=window.getSelection();t&&(t.selectAllChildren(e),t.collapseToEnd())})}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s<n&&(this._scrollIncremental=-Math.min(Math.abs(s-n)*.1,50))}_scrollRight(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s>t.width-n&&(this._scrollIncremental=Math.min(Math.abs(s-(t.width-n))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){let t=this._slideTabItems[e],n=this._slideTabItems[e+1];n&&t.after(n)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let e=this._slideTabItems.findIndex(r=>r.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let r=0;r<e&&!(r>=e);r++)n.push(this._slideTabItems[r]);for(let r=e+1;r<t;r++)this._slideTabItems[r].animate().translateX(0);let s=!0;for(let r=n.length-1;r>=0;r--){let i=n[r];An.midline(this._activeTabItem)<i.getMidLine()?(i.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=r,s=!1):(i.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let e=this._slideTabItems.findIndex(r=>r.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let r=e+1;r<t;r++)n.push(this._slideTabItems[r]);for(let r=0;r<e;r++)this._slideTabItems[r].animate().translateX(0);let s=!0;for(let r=0;r<n.length;r++){let i=n[r];An.midline(this._activeTabItem)>i.getMidLine()?(i.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+r+1,s=!1):(i.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_initialize(){document.addEventListener("mousemove",this._moveAction),document.addEventListener("mouseup",this._upAction),this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("mousedown",this._downAction)})}constructor(e){var a,l;if(e.slideTabRoot==null)throw new Error("not found slide-tab-bar root element");const t=e.slideTabRoot.querySelector(`.${(a=e.slideTabBarClassName)!=null?a:"slide-tab-bar"}`),n=e.slideTabRoot.querySelectorAll(`.${(l=e.slideTabBarItemClassName)!=null?l:"slide-tab-item"}`);if(t==null)throw new Error("not found slide-tab-bar");this._config=e,this._activeTabItem=null,this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._activeTabItemIndex=0,this._slideTabBar=t,this._slideScrollbar=new _v(this),this._slideTabItems=An.make(n,this);let s=0,r=0,i=0;this._downAction=c=>{var p;if(c.button===2){s=0,i=0,r=0;return}const{pageX:u,pageY:h}=c,d=Date.now();if(d-i<=800&&u===s&&h===r){const v=this._slideTabItems.find(b=>b.equals(new An(c.currentTarget,this)));v&&v.editor(),i=0,s=0,r=0}else{if(!this._hasEditItem()){if(qr.checkedSkipSlide(c)){s=0,i=0,r=0;return}const v=this._slideTabItems.findIndex(b=>b.equals(new An(c.currentTarget,this)));v>-1?(this._compareIndex=v,this._downActionX=c.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[v],this._activeTabItemIndex=v,this._config.activeClassNameAutoController&&(this._slideTabItems.forEach(b=>{var C;b.classList().remove((C=this._config.slideTabBarItemActiveClassName)!=null?C:"slide-tab-active")}),this._activeTabItem.classList().add((p=this._config.slideTabBarItemActiveClassName)!=null?p:"slide-tab-active")),this._activeTabItem.enableFixed(),this._startAutoScroll()):(this.updateItems(),this._activeTabItemIndex=0,this._downActionX=0,this._scrollIncremental=0,this._compareIndex=0,this._activeTabItem=null)}s=u,r=h,i=d}},this._upAction=c=>{if(this._activeTabItem){this._closeAutoScroll(),this._activeTabItem.disableFixed(),this._sortedItems(),this.updateItems(),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&this._config.onSlideEnd(c);let u=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this._activeTabItem.primeval().dispatchEvent(u),this._scrollIncremental=0,this._activeTabItemIndex=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null}},this._moveAction=c=>{this._activeTabItem&&(this._moveActionX=c.pageX-this._downActionX,this._scrollIncremental=0,this._scrollLeft(c),this._scrollRight(c))},this._wheelAction=c=>{c.deltaY>0?this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+c.deltaY):this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+c.deltaY)},this._initialize()}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}destroy(){document.removeEventListener("mousemove",this._moveAction),document.removeEventListener("mouseup",this._upAction),document.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("mousedown",this._downAction)})}}var ft={sheetBar:"univer-sheet-bar",sheetBarOptions:"univer-sheet-bar-options",sheetBarOptionsButton:"univer-sheet-bar-options-button",sheetBarScrollButton:"univer-sheet_bar_scroll_button",slideTabBar:"univer-slide-tab-bar",slideTabActive:"univer-slide-tab-active",slideTabItem:"univer-slide-tab-item",slideTabDivider:"univer-slide-tab-divider",slideTabContent:"univer-slide-tab-content",slideTabTitle:"univer-slide-tab-title",slideTabIcon:"univer-slide-tab-icon",slideTabFooter:"univer-slide-tab-footer",slideTabActiveBar:"univer-slide-tab-active-bar"};class Cv extends _e{constructor(){super(...arguments),this.ref=ee(),this.ulRef=ee(),this.sheetContainerRef=ee(),this.slideTabRoot=ee(),this.sheetContentRef=ee(),this.sheetBarContentRef=ee(),this._renderKey=1,this.setValue=(e,t)=>{const{sheetList:n,menuList:s,sheetUl:r}=e;n&&this.jointJsx(n),s&&this.jointJsx(s),r&&this.jointJsx(r),this.setState(i=>({...e}),t)},this.scrollLeft=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()-50)},this.scrollRight=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()+50)},this.overGrid=()=>{},this.contextMenu=e=>{e.preventDefault(),this.showUlList(e)},this.showSelect=(e,t)=>{e.stopImmediatePropagation();const n=t.current;n&&n.showSelect(),window.addEventListener("click",this.hideSelect)},this.hideSelect=e=>{const t=this.ref.current,n=this.ulRef.current;t&&t.hideSelect(),n&&n.hideSelect(),window.removeEventListener("click",this.hideSelect)},this.showUlList=e=>{new Promise(t=>{e.currentTarget.dataset.id,this.showSelect(e,this.ulRef),t()}).then(()=>{const t=e.currentTarget.closest(`.${ft.slideTabItem}`);if(t){const n=t.getBoundingClientRect(),s=`${n.left}px`,r=`${n.height}px`,i=this.ulRef.current.ulRef.current;i.style.left=s,i.style.bottom=r,i.style.top="auto",i.style.right="auto"}})},this.reNameSheet=e=>{const t=this.slideTabBar.getSlideTabItems().find(n=>n.primeval().dataset.id===e);t&&t.editor()},this.changeEditable=e=>{const t=e.target;let n;t.contentEditable="true",t.focus(),t.addEventListener("blur",n=s=>{this.state.changeSheetName&&this.state.changeSheetName(e),t.contentEditable="false",t.removeEventListener("blur",n)})},this.time=0,this.target=null,this.cloneTarget=null}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={sheetList:[],sheetUl:[],menuList:[],addSheet:null,contextMenu:null,selectSheet:null,changeSheetName:null,dragEnd:null}}jointJsx(e){e.forEach(t=>{if(t.icon&&typeof t.icon=="string"&&/Icon$/.test(t.icon)){const n=this.Render.renderFunction(t.icon);t.icon=f(n,null)}if(t.selectType&&t.selectType==="jsx"){const n=this.Render.renderFunction(t.label);t.label=f(n,{style:{visibility:"visible",marginTop:"-60px",marginLeft:"-50px"},onClick:s=>{t.onClick(s)}})}t.children&&t.children.length>0&&this.jointJsx(t.children)})}componentWillUnmount(){}componentDidUpdate(){this.slideTabBar&&this.slideTabBar.destroy(),this.slideTabBar=new qr({slideTabBarClassName:"univer-slide-tab-bar",slideTabBarItemActiveClassName:"univer-slide-tab-active",slideTabBarItemClassName:"univer-slide-tab-item",slideTabBarItemAutoSort:!0,slideTabRoot:this.slideTabRoot.current,onChangeName:e=>{this.state.changeSheetName&&this.state.changeSheetName(e)},onSlideEnd:e=>{this.state.dragEnd&&this.state.dragEnd(this.slideTabBar.getSlideTabItems().map(t=>t.primeval()))}})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSheetBarDidMountObservable",Me.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{sheetList:n,menuList:s,sheetUl:r,addSheet:i,contextMenu:a,selectSheet:l}=t;if(!i||!l||!a)return;const c=this.Render.renderFunction("Button"),u=this.Render.renderFunction("Ul"),h=this.Render.renderFunction("AddIcon"),d=this.Render.renderFunction("MenuIcon"),g=this.Render.renderFunction("NextIcon");return f("div",{className:ft.sheetBar,ref:this.slideTabRoot},f("div",{className:ft.sheetBarOptions},f(c,{className:ft.sheetBarOptionsButton,onClick:i,type:"text"},f(h,{style:{fontSize:"20px"}})),f(c,{className:ft.sheetBarOptionsButton,onClick:m=>this.showSelect(m,this.ref),type:"text"},f(d,{style:{fontSize:"20px"}}),f(u,{onClick:l,children:s,ref:this.ref,style:{bottom:"2.2rem",left:"0"}}))),f("div",{className:ft.slideTabBar,ref:this.sheetContainerRef},n.map(m=>f("div",{onMouseDown:m.onDown,onClick:m.onClick,onContextMenu:a,"data-id":m.sheetId,key:this._renderKey++,className:`${ft.slideTabItem} ${m.selected?ft.slideTabActive:""}`},f("div",{className:`${ft.slideTabContent}`},f("div",{className:`${ft.slideTabDivider}`}),f("div",{className:`${ft.slideTabTitle}`},f("span",{style:{padding:"2px 5px 2px 5px"}},m.label)),f("div",{className:`${ft.slideTabIcon}`,"data-slide-skip":"true",style:{lineHeight:1},"data-id":m.sheetId,onClick:a},m.icon)),f("div",{className:`${ft.slideTabFooter}`},f("div",{className:`${ft.slideTabActiveBar}`,style:m.color?{background:m.color}:{}}))))),f(u,{children:r,ref:this.ulRef}),f("div",{className:`${ft.sheetBarOptions} ${ft.sheetBarScrollButton}`},f(c,{type:"text",className:ft.sheetBarOptionsButton,onClick:this.scrollLeft},f(g,{rotate:90,style:{padding:"5px"}})),f(c,{type:"text",className:ft.sheetBarOptionsButton,onClick:this.scrollRight},f(g,{rotate:-90,style:{padding:"5px"}}))))}}const $s={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,formulaBar:!0,toolBar:!0,countBar:!0,sheetBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},contentSplit:!1};class Ev extends _e{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=ee(),this.rightRef=ee(),this.menuRef=ee(),this.cellRightRef=ee(),this.btnRef=ee(),this.contentRef=ee(),this.layoutContainerRef=ee(),this.containerRef=ee(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var g,m,_,p,v;this.leftContentLeft=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().left,this.leftContentTop=(m=this.splitLeftRef.current)==null?void 0:m.getBoundingClientRect().top;const d=(_=this.splitLeftRef.current)==null?void 0:_.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(v=d==null?void 0:d.getBoundingClientRect())==null?void 0:v.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,g=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,g=g>=this.rightBorderY?this.rightBorderY:g,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${g}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:n,layout:s,context:r,addSider:i,addMain:a,showSiderByName:l,showMainByName:c}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),l(this.showSiderByName.bind(this)),c(this.showMainByName.bind(this));const u=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=u.getComponentRender(),this.setSkin(t,n),this.state={layout:s==="auto"?R.deepClone($s):R.deepMerge($s,s),currentLocale:r.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}changeLocale(e){var s;const n=e.target.value;this.props.config.context.getLocale().change(n),this.setState({currentLocale:n}),(s=this.props.config.context.getContextObserver("onAfterChangeUILocaleObservable"))==null||s.notifyObservers()}setSkin(e,t){let n=document.documentElement,r={default:ya,dark:Ta,green:Ra}[t];r=Object.fromEntries(Object.keys(r).map(l=>[`--${l.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,r[l]])),R.isIEBrowser()?on({rootElement:n,variables:r}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(r).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const c="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===c)return a(document.styleSheets[d],l),document.styleSheets[d];const u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=c,u.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,c){let u=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${c}`){u=h,l.deleteRule(u);break}}}}changeSkin(e){var s;const n=e.target.value;this.setSkin(this.props.config.container,n),this.setState({currentSkin:n}),(s=this.props.config.context.getObserverManager().getObserver("onAfterChangeUISkinObservable"))==null||s.notifyObservers(this.props.config.context.getWorkBook())}addSider(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.siderPanelList.length+1});return{siderPanelList:[...n.siderPanelList,s]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.mainList.length+1});return{mainList:[...n.mainList,s]}},()=>{t()})})}showSiderByName(e,t){return new Promise(n=>{this.setState(s=>{let r=!1,i=0,a=s.siderPanelList.map(c=>(c.name===e&&(i=c.zIndex),c.zIndex));return{siderPanelList:s.siderPanelList.map(c=>(c.name===e?(c.show=t,c.zIndex=Math.max(...a)):c.zIndex>i&&c.zIndex--,c.show&&(r=!0),c)),showSider:r}},()=>{n()})})}showMainByName(e,t){return new Promise(n=>{this.setState(s=>({mainList:s.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{n()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Me.SPREADSHEET).getObserver("onSheetContainerDidMountObservable"))==null||e.notifyObservers(this)})}render(){const{context:e}=this.props.config,{layout:t,currentLocale:n,currentSkin:s,siderPanelList:r,mainList:i,showSider:a,renderState:l}=this.state;return f(Is.Provider,{value:{locale:e.getLocale(),currentLocale:e.getLocale().options.currentLocale,coreContext:e}},f(gn,{ref:this.layoutContainerRef,className:Vn.layoutContainer},f(fn,null,f(zt,{style:{display:t.outerLeft?"block":"none"}}),f(fn,{className:Vn.mainContent,style:{position:"relative"}},f(Pr,{style:{display:t.header?"block":"none"}},t.infoBar&&f(cv,null),t.toolBar&&f(dv,{toolList:[]}),t.formulaBar&&f(Cp,null)),f(fn,null,f(zt,{style:{display:t.innerLeft?"block":"none"}}),f(Ur,{className:t.contentSplit==="vertical"?Vn.contentContainerVertical:Vn.contentContainerHorizontal},f(fv,null),!!t.contentSplit&&f(gn,{ref:this.splitLeftRef,className:Vn.contentInnerLeftContainer},f("div",{className:Vn.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),f(gn,{ref:this.contentRef,className:Vn.contentInnerRightContainer,onClick:this.handleContentClick},f(lv,null),f("div",{style:{position:"fixed",right:"200px",top:"10px",fontSize:"14px"}},f("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u76AE\u80A4"),f("select",{value:s,onChange:this.changeSkin.bind(this),style:{width:55}},f("option",{value:"default"},"\u9ED8\u8BA4"),f("option",{value:"dark"},"\u6697\u9ED1"),f("option",{value:"green"},"\u7EFF\u8272")),f("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u8BED\u8A00"),f("select",{value:n,onChange:this.changeLocale.bind(this),style:{width:55}},f("option",{value:"en"},"English"),f("option",{value:"zh"},"\u4E2D\u6587")),f("span",{style:{visibility:"hidden"}},l)))),f(zt,{style:{display:t.innerRight?"block":"none"}},f(mv,null))),f(zr,{style:{display:t.footer?"block":"none"}},t.sheetBar&&f(Cv,null),t.countBar&&f(gv,null))),f(zt,{style:{display:t.outerRight&&a?"block":"none"},className:Vn.outerRightContainer},r.map((c,u)=>c.type===Un.JSX?ro(c.label,{style:{display:c.show?"":"none",zIndex:c.zIndex}}):c)))))}}const wv={container:"universheet",layout:$s,selections:{"sheet-01":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}],"sheet-02":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}]}};var Zo=(o=>(o.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction",o))(Zo||{});class Ia{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Ia}}const Sv=Ia.create();class yv{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellEditExtensionFactoryList.push(...e),this._cellEditExtensionFactoryList.sort(ht)}delete(e){const t=this._cellEditExtensionFactoryList.indexOf(e);this._cellEditExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...Sv.getData().sort(ht))}}class Vs{handle(e){var s;const t=(s=Vs==null?void 0:Vs.register)==null?void 0:s.cellEditExtensionFactoryList;if(!t)return;this._cellEditExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length&&(t=this._cellEditExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new yv,this.register.initialize()),this.register}}class Da{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Da}}const Tv=Da.create();class Rv{constructor(){this._cellInputExtensionFactoryList=[]}get cellInputExtensionFactoryList(){return this._cellInputExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellInputExtensionFactoryList.push(...e),this._cellInputExtensionFactoryList.sort(ht)}delete(e){const t=this._cellInputExtensionFactoryList.indexOf(e);this._cellInputExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellInputExtensionFactoryList.push(...Tv.getData().sort(ht))}}class Xs{handle(e){var s;const t=(s=Xs==null?void 0:Xs.register)==null?void 0:s.cellInputExtensionFactoryList;if(!t)return;this._cellInputExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellInputExtensionFactoryList)return!1;for(let n=0;n<this._cellInputExtensionFactoryList.length&&(t=this._cellInputExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new Rv,this.register.initialize()),this.register}}function e6(o,e){var s;const t=(s=o.getContext().getPluginManager().getPluginByName(Me.SPREADSHEET))==null?void 0:s.getSelectionManager();if(!t)return[];const n=t==null?void 0:t.getCurrentModelsValue();return t.setModels(e),n}class Av extends Re{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]};const s=this.do();this._oldActionData={...e,selections:s},this.validate()}do(){const{selections:e}=this._doActionData,t=this.getWorkSheet(),n=e6(t,e);return this._observers.notifyObservers({type:Z.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e}=this._doActionData,t=this.do();this._oldActionData={actionName:Zo.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:t}}undo(){const{selections:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Zo.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:e6(n,e)},this._observers.notifyObservers({type:Z.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}fe.register(Zo.SET_SELECTION_VALUE_ACTION,Av);class Zr{constructor(e){this._type=e}isEqual(e,t){const{startColumn:n,startRow:s,endColumn:r,endRow:i,type:a}=this,{startColumn:l,startRow:c,endColumn:u,endRow:h}=e;return a!==t?!1:n===l&&s===c&&r===u&&i===h}isInclude(e,t){const{startColumn:n,startRow:s,endColumn:r,endRow:i,type:a}=this,{startColumn:l,startRow:c,endColumn:u,endRow:h}=e;return a!==t?!1:!(u<n||l>r||c>i||h<s)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}highlightToSelection(){return wo(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:s,endColumn:r,endRow:i,startX:a,startY:l,endX:c,endY:u}=e;this._startColumn=n,this._startRow=s,this._endColumn=r,this._endRow=i,this._startX=a,this._startY=l,this._endX=c,this._endY=u,this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}}class Iv{constructor(e){this._range=e}getRange(){return this._range}getRect(){return this._rect}setRect(e){this._rect=e}setRange(e){this._range=e}}class Dv{constructor(e){this._sheetId=e,this._antLineList=[]}deleteAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);t>-1&&this._antLineList.splice(t,1)}addAntLine(e){this._antLineList.push(e)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);if(t>-1)return this._antLineList[t]}}class Ov{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}const vt={hideInsertRow:!1,hideInsertColumn:!1,hideAddRowTop:!0,hideAddRowBottom:!0,hideAddColumnLeft:!0,hideAddColumnRight:!0,hideDeleteRow:!1,hideDeleteColumn:!1,hideHideRow:!0,hideShowRow:!0,hideRowHeight:!1,hideHideColumn:!0,hideShowColumn:!0,hideColumnWidth:!1,hideDeleteCell:!1,hideClearContent:!1,hideMatrix:!0};class xv{get copy(){return this._copy}get copyAs(){return this._copyAs}get paste(){return this._paste}get menuList(){return this._menuList}setValue(e){const{copy:t,copyAs:n,paste:s}=e;this._copy=t,this._copyAs=n,this._paste=s}setRightMenu(e){this._menuList=e}}class Mv{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class Oa{constructor(e){this._control=e,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=e.zIndex+1,this._model=e.model,this._initialize()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:t,rightControl:n,topControl:s,bottomControl:r,fillControl:i}=this._control;t.onPointerEnterObserver.add(c=>{t.cursor=Ye.MOVE}),t.onPointerLeaveObserver.add(c=>{t.resetCursor()}),n.onPointerEnterObserver.add(c=>{n.cursor=Ye.MOVE}),n.onPointerLeaveObserver.add(c=>{n.resetCursor()}),s.onPointerEnterObserver.add(c=>{s.cursor=Ye.MOVE}),s.onPointerLeaveObserver.add(c=>{s.resetCursor()}),r.onPointerEnterObserver.add(c=>{r.cursor=Ye.MOVE,console.log("onPointerEnterObserver")}),r.onPointerLeaveObserver.add(c=>{r.resetCursor(),console.log("onPointerLeaveObserver")}),r.onPointerDownObserver.add(c=>{console.log("onPointerDownObserver"),this.dragDown(c,B.BOTTOM)}),r.onPointerUpObserver.add(c=>{r.resetCursor(),console.log("onPointerUpObserver")});const a=this._zIndex;this._leftDragControl=new Fe("__LeftDragControl__"+a,{top:0,left:-Se.strokeWidth/2,width:Se.strokeWidth*2,fill:Se.strokeColor,zIndex:a}),this._rightDragControl=new Fe("__RightDragControl__"+a,{width:Se.strokeWidth*2,fill:Se.strokeColor,zIndex:a}),this._topDragControl=new Fe("__TopDragControl__"+a,{top:-Se.strokeWidth/2,left:-Se.strokeWidth/2,height:Se.strokeWidth*2,fill:Se.strokeColor,zIndex:a}),this._bottomDragControl=new Fe("__BottomDragControl__"+a,{height:Se.strokeWidth*2,fill:Se.strokeColor,left:-Se.strokeWidth/2,zIndex:a}),this._selectionDragShape=new Fi("__SelectionDragShape__"+a,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=a,this._control.getScene().addObject(this._selectionDragShape)}dragEventInitial(){}dragDown(e,t){const n=this._control.getPlugin().getMainComponent(),s=this._model.getValue().selection;this._model=new Zr(Jo.NORMAL),this._model.setValue(s),this._updateControl();const{offsetX:r,offsetY:i}=e;this._startOffsetX=r,this._startOffsetY=i;const a=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let l=null;switch(t){case B.LEFT:l=n.calculateCellIndexByPosition(r+Se.strokeWidth,i,a);break;case B.TOP:l=n.calculateCellIndexByPosition(r,i+Se.strokeWidth,a);break;case B.RIGHT:l=n.calculateCellIndexByPosition(r-Se.strokeWidth,i,a);break;case B.BOTTOM:l=n.calculateCellIndexByPosition(r,i-Se.strokeWidth,a);break}const c=wo(l);if(!c)return!1;const{startRow:u,startColumn:h,endColumn:d,endRow:g,startY:m,endY:_,startX:p,endX:v}=c,b={startColumn:h,startRow:u,endColumn:d,endRow:g,startY:m,endY:_,startX:p,endX:v};this._oldSelectionRange=b,this._cellPositionOffset={top:b.startRow-this._model.startRow,bottom:this._model.endRow-b.endRow,left:b.startColumn-this._model.startColumn,right:this._model.endColumn-b.endColumn};const C=this._control.getScene();C.disableEvent();const D=so.create(C);D.startScroll(r,i),this._moveObserver=C.onPointerMoveObserver.add(O=>{this.dragMoving(O);const{offsetX:F,offsetY:S}=O;D.scrolling(F,S,()=>{this.dragMoving(O)})}),this._upObserver=C.onPointerUpObserver.add(O=>{this.dragUp(),C.onPointerMoveObserver.remove(this._moveObserver),C.onPointerUpObserver.remove(this._upObserver),C.enableEvent(),D.stopScroll()})}dragMoving(e){const t=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:s,clientX:r,clientY:i}=e,a=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=t.calculateCellIndexByPosition(n,s,a),c=wo(l);if(!c)return!1;const{startRow:u,startColumn:h,endColumn:d,endRow:g,startX:m,startY:_,endX:p,endY:v}=c,b={startColumn:h,startRow:u,endColumn:d,endRow:g,startY:_||0,endY:v||0,startX:m||0,endX:p||0},{startRow:C,endRow:D,startColumn:O,endColumn:F}=this._oldSelectionRange;if(O!==h||C!==u||F!==d||D!==g){this._oldSelectionRange=b;const{left:S,right:E,top:w,bottom:I}=this._cellPositionOffset,P=u-w,L=g+I,y=h-S,k=d+E;if(P<0||L<0||y<0||k<0)return;const M={startRow:P,endRow:L,startColumn:y,endColumn:k},U=t.getNoMergeCellPositionByIndex(M.startRow,M.startColumn),z=t.getNoMergeCellPositionByIndex(M.endRow,M.endColumn),K=Object.assign(M,{startY:(U==null?void 0:U.startY)||0,endY:(z==null?void 0:z.endY)||0,startX:(U==null?void 0:U.startX)||0,endX:(z==null?void 0:z.endX)||0});this._model.setValue(K),this._updateControl()}}dragUp(){const e=this._control.getPlugin().getMainComponent();this.hide();const{selection:t}=this._model.getValue(),n=e.getCellByIndex(t.startRow,t.startColumn);this._control.update(t,n)}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._model;this._leftDragControl.resize(void 0,s-t),this._rightDragControl.transformByState({height:s-t,left:n-e-Se.strokeWidth/2}),this._topDragControl.resize(n-e+Se.strokeWidth),this._bottomDragControl.transformByState({width:n-e+Se.strokeWidth,top:s-t-Se.strokeWidth/2}),this._selectionDragShape.show(),this._selectionDragShape.translate(e,t),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.hide(),this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:e,rightControl:t,topControl:n,bottomControl:s}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),s.onPointerEnterObserver.clear(),s.onPointerLeaveObserver.clear()}static create(e){return new Oa(e)}}class xa{constructor(e){this._control=e,this._initialize()}_initialize(){const{fillControl:e}=this._control;this._control.getPlugin(),e.onPointerEnterObserver.add(t=>{e.cursor=Ye.CROSSHAIR}),e.onPointerLeaveObserver.add(t=>{e.resetCursor()})}remove(){const{fillControl:e}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear()}static create(e){return new xa(e)}}const Se={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var Jo=(o=>(o[o.NORMAL=0]="NORMAL",o[o.ROW=1]="ROW",o[o.COLUMN=2]="COLUMN",o))(Jo||{});class Qo{constructor(e,t){this._manager=e,this._zIndex=t,this._selectionModel=new Zr(0),this._initialize()}_initialize(){const e=this._zIndex;this._leftControl=new Fe("__SpreadsheetSelectionShapeLeftControl__"+e,{top:0,left:-Se.strokeWidth/2,width:Se.strokeWidth,fill:Se.strokeColor,zIndex:e}),this._rightControl=new Fe("__SpreadsheetSelectionShapeRightControl__"+e,{width:Se.strokeWidth,fill:Se.strokeColor,zIndex:e}),this._topControl=new Fe("__SpreadsheetSelectionTopControl__"+e,{top:-Se.strokeWidth/2,left:-Se.strokeWidth/2,height:Se.strokeWidth,fill:Se.strokeColor,zIndex:e}),this._bottomControl=new Fe("__SpreadsheetSelectionBottomControl__"+e,{height:Se.strokeWidth,fill:Se.strokeColor,left:-Se.strokeWidth/2,zIndex:e}),this._backgroundControlTop=new Fe("__SpreadsheetSelectionBackgroundControlTop__"+e,{fill:Se.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new Fe("__SpreadsheetSelectionBackgroundControlBottom__"+e,{fill:Se.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new Fe("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{fill:Se.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new Fe("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{fill:Se.backgroundColor,zIndex:e-1,evented:!1});const t=Se.fillSideLength-Se.fillStrokeLength;this._fillControl=new Fe("__SpreadsheetSelectionFillControl__"+e,{width:t,height:t,fill:Se.strokeColor,strokeWidth:Se.fillStrokeLength,stroke:Se.fillStrokeColor,zIndex:e+1}),this._selectionShape=new Fi("__SpreadsheetSelectionShape__"+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this._selectionDragAndDrop=Oa.create(this),this._selectionControlFill=xa.create(this),this.getScene().addObject(this._selectionShape)}get zIndex(){return this._zIndex}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._selectionModel;this.leftControl.resize(void 0,s-t),this.rightControl.transformByState({height:s-t,left:n-e-Se.strokeWidth/2}),this.topControl.resize(n-e+Se.strokeWidth),this.bottomControl.transformByState({width:n-e+Se.strokeWidth,top:s-t-Se.strokeWidth/2}),this.fillControl.translate(n-e-Se.fillSideLength/2,s-t-Se.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.show(),this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:s,startX:r,startY:i,endX:a,endY:l}=this._selectionModel,c=this._selectionModel.highlightToSelection();if(!c){this._backgroundControlTop.resize(a-r,l-i),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}const{startX:u,startY:h,endX:d,endY:g}=c,m=Se.strokeWidth/2,_={left:-m,top:-m,width:a-r+m*2,height:h-i+m};_.height<0&&(_.width=0,_.height=0),this._backgroundControlTop.transformByState(_);const p={left:-m,top:h-i,width:u-r+m,height:g-h};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleLeft.transformByState(p);const v={left:d-r-m,top:h-i,width:a-d+m*2,height:g-h};v.width<0&&(v.width=0,v.height=0),this._backgroundControlMiddleRight.transformByState(v);const b={left:-m,top:g-i,width:a-r+m*2,height:l-g+m};b.height<0&&(b.width=0,b.height=0),this._backgroundControlBottom.transformByState(b)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var e,t,n,s,r,i,a,l,c,u;(e=this._leftControl)==null||e.dispose(),(t=this._rightControl)==null||t.dispose(),(n=this._topControl)==null||n.dispose(),(s=this._bottomControl)==null||s.dispose(),(r=this._backgroundControlTop)==null||r.dispose(),(i=this._backgroundControlMiddleLeft)==null||i.dispose(),(a=this._backgroundControlMiddleRight)==null||a.dispose(),(l=this._backgroundControlBottom)==null||l.dispose(),(c=this._fillControl)==null||c.dispose(),(u=this._selectionShape)==null||u.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:s,startX:r,endX:i,startY:a,endY:l}=e;t={startRow:n,endRow:n,startColumn:s,endColumn:s,startX:r,endX:i,startY:a,endY:l}}return t}}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const s=Qo.create(e,t);return s.update(n),s}}class kv{constructor(e){this._sheetView=e,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this.hasSelection=!1,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(e){this._worksheet=e;const t=this.getWorksheetId();t&&(this._selectionModels.get(t)||this._selectionModels.set(t,[]))}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0){for(const t of e)if(t.model.currentCell)return t}}getCurrentModels(){const e=this.getWorksheetId();return e?(this._selectionModels.get(e)||this._selectionModels.set(e,[]),this._selectionModels.get(e)):void 0}getCurrentModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return n}}getCurrentModelsValue(){const e=this.getCurrentModels();if(!e)return[];const t=[];for(let n of e)t.push(n.getValue());return t}renderCurrentControls(e){const t=this.getWorksheetId();if(t){if(this._selectionControls)for(let s of this._selectionControls)s.dispose();const n=e||this._selectionModels.get(t);this._selectionControls=[],n==null||n.forEach(s=>{const r=s.currentCell,i=this._mainComponent,a=Qo.create(this,this._selectionControls.length);let l=null;r&&(l=i.getCellByIndex(r.row,r.column));const{startRow:c,startColumn:u,endRow:h,endColumn:d}=s,g=i.getNoMergeCellPositionByIndex(c,u),m=i.getNoMergeCellPositionByIndex(h,d);a.update({startColumn:u,startRow:c,endColumn:d,endRow:h,startY:(g==null?void 0:g.startY)||0,endY:(m==null?void 0:m.endY)||0,startX:(g==null?void 0:g.startX)||0,endX:(m==null?void 0:m.endX)||0},l),this._selectionControls.push(a)}),this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var e;return(e=this._worksheet)==null?void 0:e.getSheetId()}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const s=this._mainComponent,r=Qo.create(this,n.length);let i=null;t&&(i=s.getCellByIndex(t.row,t.column));const{startRow:a,startColumn:l,endRow:c,endColumn:u}=e,h=s.getNoMergeCellPositionByIndex(a,l),d=s.getNoMergeCellPositionByIndex(c,u);r.update({startColumn:l,startRow:a,endColumn:u,endRow:c,startY:(h==null?void 0:h.startY)||0,endY:(d==null?void 0:d.endY)||0,startX:(h==null?void 0:h.startX)||0,endX:(d==null?void 0:d.endX)||0},i),n.push(r),this.setSelectionModel()}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}setSelectionModel(e){if(!this._worksheet)return;e||(e=this._selectionControls.map(i=>i.model.getValue()));const t=this._worksheet.getContext().getWorkBook(),n=t.getCommandManager(),s={sheetId:this._worksheet.getSheetId(),actionName:Zo.SET_SELECTION_VALUE_ACTION,selections:e},r=new V({WorkBookUnit:t},s);n.invoke(r)}updateSelectionModel(e,t,n){const s=this.getWorksheetId();if(!this._worksheet||!s)return;const r=this._selectionModels.get(s),i=[];r==null||r.forEach((h,d)=>{d===n?i.push({selection:e,cell:t}):i.push(h.getValue())});const a=this._worksheet.getContext().getWorkBook(),l=a.getCommandManager(),c={sheetId:this._worksheet.getSheetId(),actionName:Zo.SET_SELECTION_VALUE_ACTION,selections:i},u=new V({WorkBookUnit:a},c);l.invoke(u)}setModels(e){const t=this.getWorksheetId();if(!t)return;const n=e.map(({selection:s,cell:r})=>{const i=new Zr(Jo.NORMAL);return i.setValue(s,r),i});this._selectionModels.set(t,n)}move(e){var c,u;const t=this.getCurrentModel();if(!t)return;let{row:n,column:s}=t;const r=((c=this._worksheet)==null?void 0:c.getRowCount())||1e3,i=((u=this._worksheet)==null?void 0:u.getColumnCount())||50;switch(e){case B.TOP:n--,n<0&&(n=0);break;case B.BOTTOM:n++,n>r&&(n=r);break;case B.LEFT:s--,s<0&&(s=0);break;case B.RIGHT:s++,s>i&&(s=i);break}let a={startRow:n,endRow:n,startColumn:s,endColumn:s},l={row:n,column:s};this.clearSelectionControls(),this.addControlToCurrentByRangeData(a,l)}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels()}_mainEventInitial(){const e=this._mainComponent;e.onPointerDownObserver.add(t=>{var F;const{offsetX:n,offsetY:s}=t;this._startOffsetX=n,this._startOffsetY=s;const r=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=e.calculateCellIndexByPosition(n,s,r),a=wo(i);if(!a||!this._worksheet)return!1;const{startRow:l,startColumn:c,endColumn:u,endRow:h,startY:d,endY:g,startX:m,endX:_}=a,p={startColumn:c,startRow:l,endColumn:u,endRow:h,startY:d,endY:g,startX:m,endX:_};this._startSelectionRange=p;let v=this.getCurrentControl(),b=this.getCurrentControls();if(!b)return!1;for(let S of b){if(t.button===2&&S.model.isInclude(p,Jo.NORMAL)){v=S;return}if(S.model.isEqual(p,Jo.NORMAL)){v=S;break}t.shiftKey||S.clearHighlight()}if(b.length>0&&!t.ctrlKey&&!t.shiftKey){for(let S of b)S.dispose();b.length=0}const C=v&&v.model.currentCell;if(v&&t.shiftKey&&C){const{row:S,column:E}=C,w=e.getNoMergeCellPositionByIndex(S,E),I=e.getNoMergeCellPositionByIndex(h,u),P={startColumn:E,startRow:S,endColumn:p.startColumn,endRow:p.startRow,startY:(w==null?void 0:w.startY)||0,endY:(I==null?void 0:I.endY)||0,startX:(w==null?void 0:w.startX)||0,endX:(I==null?void 0:I.endX)||0};v.update(P,C)}else v=Qo.create(this,b.length),v.update(p,i),b.push(v);this.hasSelection=!0;const D=this.getScene();D.disableEvent();const O=so.create(this.getScene());O.startScroll(n,s),this.setSelectionModel(),(F=this._plugin.getObserver("onChangeSelectionObserver"))==null||F.notifyObservers(v),this._moveObserver=D.onPointerMoveObserver.add(S=>{this.moving(S,v);const{offsetX:E,offsetY:w}=S;O.scrolling(E,w,()=>{this.moving(S,v)})}),this._upObserver=D.onPointerUpObserver.add(S=>{this.up(),D.onPointerMoveObserver.remove(this._moveObserver),D.onPointerUpObserver.remove(this._upObserver),D.enableEvent(),O.stopScroll()})})}moving(e,t){var j;const n=this._mainComponent,{offsetX:s,offsetY:r,clientX:i,clientY:a}=e,{startRow:l,startColumn:c,endRow:u,endColumn:h}=this._startSelectionRange,d=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),g=n.calculateCellIndexByPosition(s,r,d),m=wo(g);if(!m)return!1;const{startRow:_,startColumn:p,endColumn:v,endRow:b}=m,C=Math.min(_,l),D=Math.min(p,c),O=Math.max(b,u),F=Math.max(v,h),S=n.getSelectionBounding(C,D,O,F);if(!S)return!1;const{startRow:E,startColumn:w,endRow:I,endColumn:P}=S,L=n.getNoMergeCellPositionByIndex(E,w),y=n.getNoMergeCellPositionByIndex(I,P),k={startColumn:w,startRow:E,endColumn:P,endRow:I,startY:(L==null?void 0:L.startY)||0,endY:(y==null?void 0:y.endY)||0,startX:(L==null?void 0:L.startX)||0,endX:(y==null?void 0:y.endX)||0},{startRow:M,endRow:U,startColumn:z,endColumn:K}=(t==null?void 0:t.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};(z!==w||M!==E||K!==P||U!==I)&&(t&&t.update(k),this.setSelectionModel(),t&&((j=this._plugin.getObserver("onChangeSelectionObserver"))==null||j.notifyObservers(t)))}up(){this.setSelectionModel()}_rowEventInitial(){this._rowComponent.onPointerDownObserver.add(t=>{console.log("rowTitle_moveObserver",t)})}_columnEventInitial(){this._columnComponent.onPointerDownObserver.add(t=>{console.log("columnTitle_moveObserver",t)})}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add(t=>{console.log("leftTop_moveObserver",t)})}_initModels(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(r=>{const{startColumn:i,startRow:a,endColumn:l,endRow:c}=r.selection,u=r.cell,h=new Zr(Jo.NORMAL),d=u?{row:u.row,column:u.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:i,startRow:a,endColumn:l,endRow:c,startY:0,endY:0,startX:0,endX:0}}:null;h.setValue({startColumn:i,startRow:a,endColumn:l,endRow:c,startY:0,endY:0,startX:0,endX:0},d),s.push(h)}),this._selectionModels.set(t,s)})}_initControls(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(r=>{const i=r.selection,a=r.cell,l=this._mainComponent,c=Qo.create(this,s.length);let u=null;a&&(u=l.getCellByIndex(a.row,a.column));const{startRow:h,startColumn:d,endRow:g,endColumn:m}=i,_=l.getNoMergeCellPositionByIndex(h,d),p=l.getNoMergeCellPositionByIndex(g,m);c.model.setValue({startColumn:d,startRow:h,endColumn:m,endRow:g,startY:(_==null?void 0:_.startY)||0,endY:(p==null?void 0:p.endY)||0,startX:(_==null?void 0:_.startX)||0,endX:(p==null?void 0:p.endX)||0},u),s.push(c)})})}_initializeObserver(){var t;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this.renderCurrentControls()}),(t=this._worksheet)==null||t.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this.renderCurrentControls()})}getActiveRangeListData(){const e=this.getCurrentModels();if(e&&e.length>0)return e==null?void 0:e.map(n=>({startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}))}getActiveRangeList(){var t;const e=this.getActiveRangeListData();return e&&((t=this._worksheet)==null?void 0:t.getRangeList(e))}getActiveRangeData(){const e=this.getCurrentModels();if(e&&e.length>0){for(const t of e)if(t.currentCell)return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}}getActiveRange(){var t;const e=this.getActiveRangeData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}getCurrentCellData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return{startRow:n.row,startColumn:n.column,endRow:n.row,endColumn:n.column}}}getCurrentCell(){var t;const e=this.getCurrentCellData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}}class Bv extends Hd{constructor(){super(...arguments),this.viewKey=At.SHEET_VIEW}_initialize(){const e=this.getScene(),n=this.getContext().getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const r=this._buildSkeleton(s),{rowTotalHeight:i,columnTotalWidth:a,rowTitleWidth:l,columnTitleHeight:c}=r,u=new k3("__SpreadsheetRender__",r),h=new B3("__SpreadsheetRowTitle__",r),d=new F3("__SpreadsheetColumnTitle__",r),g=new Fe("__SpreadsheetLeftTopPlaceholder__",{zIndex:2,left:-1,top:-1,width:l,height:c,fill:lt([248,249,250]),stroke:lt([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=r,this._spreadsheet=u,this._spreadsheetRowTitle=h,this._spreadsheetColumnTitle=d,this._spreadsheetLeftTopPlaceholder=g,e.addObjects([u],0),e.addObjects([h,d,g],2),e.transformByState({width:this._columnWidthByTitle(s)+a+100,height:this._rowHeightByTitle(s)+i+200}),this._updateViewport(l,c),this._selectionManager=new kv(this)}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(e){const t=this.getScene(),n=this._buildSkeleton(e),{rowTotalHeight:s,columnTotalWidth:r,rowTitleWidth:i,columnTitleHeight:a}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:i,height:a}),t.transformByState({width:this._columnWidthByTitle(e)+r+100,height:this._rowHeightByTitle(e)+s+200}),this._updateViewport(i,a),this._selectionManager.updateToSheet(e)}_updateViewport(e,t){const n=this.getScene(),s=e*n.scaleX,r=t*n.scaleY,i=n.getViewport(At.VIEW_MAIN),a=n.getViewport(At.VIEW_TOP),l=n.getViewport(At.VIEW_LEFT),c=n.getViewport(At.VIEW_LEFT_TOP);i==null||i.resize({left:s,top:r}),a==null||a.resize({left:s,height:r}),l==null||l.resize({top:r,width:s}),c==null||c.resize({width:s,height:r})}_buildSkeleton(e){const t=this.getContext(),n=t.getWorkBook(),s=e.getConfig();return ji.create(s,e.getCellMatrix(),n.getStyles(),t)}_rowHeightByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.columnTitle.height)||0}_columnWidthByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.rowTitle.width)||0}}class Fv{create(e,t){return new Bv().initialize(e,t)}}pa.add(new Fv);const Nv={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Ue.COLUMN,posOffset:100},positionV:{relativeFrom:$e.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:Bt.WRAP_SQUARE,behindDoc:Y.FALSE,wrapText:un.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:yt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:H.DRAWING},{elementId:"smallSub",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};class Lv extends Hd{_initialize(){var a;const e=this.getScene(),t=new Gt("path1",{data:"M848.2028 624.638c61.7667 0 111.9928-50.2538 111.9928-111.9928 0-61.7667-50.2262-111.9949-111.9928-111.9949h-19.414016c-3.9373-11.1831-8.448-22.1194-13.4779-32.7014l13.6704-13.698c21.0811-21.0801 32.7025-49.2165 32.7025-79.1828 0-29.995-11.6214-58.1028-32.7025-79.1839-21.0801-21.1098-49.2165-32.7035-79.1839-32.7035-29.9704 0-58.1048 11.5937-79.1818 32.7035l-13.6704 13.6714c-10.6107-5.033-21.5214-9.5437-32.7311-13.481v-19.412992c0-61.7656-50.2292-111.9939-111.9949-111.9939-61.7636 0-111.9928 50.2282-111.9928 111.9939v19.412992c-11.2118 3.9373-22.1225 8.448-32.7322 13.481l-13.6714-13.6714c-21.077-21.1098-49.2124-32.7035-79.1828-32.7035-29.9663 0-58.0987 11.5937-79.1839 32.7035-21.076 21.0801-32.7014 49.1889-32.7014 79.1839 0 29.9674 11.6255 58.1028 32.7014 79.1828l13.6714 13.6704c-5.0289 10.6097-9.5406 21.5194-13.4779 32.7291h-19.414016c-61.7636 0-111.9928 50.2282-111.9928 111.9949 0 61.739 50.2292 111.9928 111.9928 111.9928h19.414016c3.9373 11.2118 8.449 22.1215 13.4779 32.7291l-13.6714 13.6714c-21.076 21.0811-32.7014 49.1909-32.7014 79.1849 0 29.996 11.6255 58.1028 32.7014 79.1828 21.0852 21.078 49.2175 32.7035 79.1839 32.7035 29.9715 0 58.1059-11.6255 79.1828-32.7035l13.6714-13.6704c10.6097 5.0309 21.5204 9.5119 32.7322 13.4789v19.416064c0 61.7359 50.2292 111.9928 111.9928 111.9928 61.7656 0 111.9949-50.2569 111.9949-111.9928v-19.416064c11.2097-3.967 22.1204-8.448 32.7311-13.5045l13.6704 13.695c21.077 21.078 49.2124 32.7035 79.1818 32.7035 29.9674 0 58.1038-11.6255 79.1839-32.7035 21.0811-21.0801 32.7025-49.1868 32.7025-79.1828 0-29.994-11.6214-58.1038-32.7025-79.1849l-13.6704-13.698c5.0299-10.6076 9.5406-21.5194 13.4779-32.7025H848.202752zM789.3873 710.6294c10.5277 10.5001 16.297 24.5555 16.297 39.594 0 15.0108-5.7692 29.0673-16.297 39.5909-21.0504 21.0278-58.1294 21.0278-79.1808 0l-43.1186-43.1452-18.4842 10.3629c-18.647 10.4172-38.826 18.7556-60.0177 24.7695l-20.3694 5.7723v61.057024c0 30.8675-25.1279 55.9933-55.9985 55.9933s-55.9985-25.1259-55.9985-55.9933v-61.057024l-20.3674-5.7723c-21.2183-6.0416-41.4259-14.3534-60.0156-24.7695l-18.4852-10.3363-43.1206 43.1176c-21.0534 21.0278-58.1294 21.0278-79.1828 0-10.5267-10.5236-16.2939-24.5801-16.2939-39.5909 0-15.0385 5.7672-29.0939 16.2939-39.594l43.1176-43.1165-10.3588-18.4852c-10.3916-18.5907-18.7054-38.7697-24.746-60.0412l-5.7733-20.3448h-61.053951999999995c-30.8695 0-55.9954-25.1279-55.9954-55.9964 0-30.8705 25.1249-55.9985 55.9954-55.9985h61.053951999999995l5.7733-20.3704c6.0406-21.2449 14.3544-41.4505 24.746-60.0156l10.3588-18.4832-43.1176-43.1186c-10.5267-10.5277-16.2939-24.5811-16.2939-39.5919 0-15.0395 5.7672-29.0939 16.2939-39.5919 21.0545-21.0278 58.1304-21.0278 79.1828 0l43.1206 43.1176 18.4852-10.3608c18.5897-10.3905 38.7983-18.731 60.0156-24.746l20.3674-5.7702v-61.056000000000004c0-30.8951 25.1279-55.9964 55.9985-55.9964s55.9985 25.1013 55.9985 55.9964v61.056000000000004l20.3694 5.7702c21.1917 6.016 41.3706 14.3278 60.0177 24.7716l18.4842 10.3352 43.1186-43.1176c21.0524-21.0278 58.1315-21.0278 79.1808 0 10.5277 10.498 16.297 24.5524 16.297 39.5919 0 15.0108-5.7692 29.0642-16.297 39.5919l-43.0909 43.1186 10.3076 18.4832c10.4479 18.6737 18.7832 38.8813 24.7706 60.0156l5.7733 20.3704h61.053951999999995c30.8695 0 55.9974 25.1279 55.9974 55.9985 0 30.8685-25.1279 55.9964-55.9974 55.9964h-61.053951999999995l-5.7733 20.3448c-5.9884 21.161-14.3227 41.342-24.7706 60.0412l-10.3076 18.4852L789.3873 710.6294zM512.2181 344.6528c-92.6372 0-167.9913 75.3551-167.9913 167.9923 0 92.6351 75.3541 167.9913 167.9913 167.9913s167.9913-75.3562 167.9913-167.9913C680.2094 420.0079 604.8553 344.6528 512.2181 344.6528zM512.2181 624.638c-61.7636 0-111.9928-50.2538-111.9928-111.9928 0-61.7667 50.2292-111.9949 111.9928-111.9949 61.7656 0 111.9949 50.2282 111.9949 111.9949C624.213 574.3841 573.9848 624.638 512.2181 624.638z",width:200,height:200,left:600,top:300,zIndex:14,strokeWidth:1,stroke:lt([102,111,99],1),fill:lt([102,255,99],1),isTransformer:!0}),n=t.getRect();console.log("pathRect",n,t),new Fe("pathRect",{...n,strokeWidth:1,stroke:"rgba(102,111,99, 0.8)",zIndex:11});const s=new ps({url:"https://cnbabylon.com/assets/img/agents.png",top:500,left:800,zIndex:13,isTransformer:!0}),r=new Li("circle1",{left:800,top:200,radius:100,fill:"rgba(255,111,99, 0.8)",zIndex:14,isTransformer:!0}),i=new mh(this.getContext(),"richText1",{richText:Nv,width:300,zIndex:20,left:100,top:400,isTransformer:!0});new Fe("pathRect",{left:100,top:400,width:300,height:((a=i.getDocsSkeletonPageSize())==null?void 0:a.height)||0,strokeWidth:1,stroke:"rgba(102,111,99, 0.8)",zIndex:11}),console.log("insert path test",e),e.addObjects([t,s,r,i])}}class Pv{create(e,t){return new Lv().initialize(e,t)}}pa.add(new Pv);class zv{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine,t=this._plugin.getContext(),n=t.getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const r=s.getConfig(),i=r.rowTitle,a=r.columnTitle,l=new Ki(At.MAIN_SCENE,e,{width:1200,height:1e3});l.openTransformer(),this._scene=l;const c=new Uo(At.VIEW_MAIN,l,{left:i.width,top:a.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),u=new Uo(At.VIEW_TOP,l,{left:i.width,top:0,height:a.height,right:0,isWheelPreventDefaultX:!0}),h=new Uo(At.VIEW_LEFT,l,{left:0,top:a.height,bottom:0,width:i.width,isWheelPreventDefaultX:!0}),d=new Uo(At.VIEW_LEFT_TOP,l,{left:0,top:0,width:i.width,height:a.height,isWheelPreventDefaultX:!0});c.onScrollAfterObserver.add(g=>{const{scrollX:m,scrollY:_,actualScrollX:p,actualScrollY:v}=g;u.updateScroll({scrollX:m,actualScrollX:p}).makeDirty(!0),h.updateScroll({scrollY:_,actualScrollY:v}).makeDirty(!0)}),t.getContextObserver("onZoomRatioSheetObservable").add(g=>{this._plugin,this._scene.scale(g.zoomRatio,g.zoomRatio)}),l.addViewport(c,h,u,d).attachControl(),l.on(bt.wheel,(g,m)=>{const _=g;if(_.ctrlKey){const p=Math.abs(_.deltaX);let v=p<40?.2:p<80?.4:.2;if(v*=_.deltaY>0?-1:1,l.scaleX<1&&(v/=2),l.scaleX+v>4)l.scale(4,4);else if(l.scaleX+v<.1)l.scale(.1,.1);else{const b=t.getWorkBook().getActiveSheet(),C=_.deltaY>0?.1:-.1;b.setZoomRatio(b.getZoomRatio()+C),_.preventDefault()}}else c.onMouseWheel(_,m)}),new Ni(c),l.addLayer(oo.create(l,[],0),oo.create(l,[],2)),this._viewLoader(l,this._plugin),e.runRenderLoop(()=>{l.render();const g=document.getElementById("app");g&&(g.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getSheetView(){return this.getView(At.SHEET_VIEW)}updateToSheet(e){for(let t of this._views)t.updateToSheet(e)}_viewLoader(e,t){pa.getData().forEach(n=>{this._views.push(n.create(e,t))})}}class Uv{_removeAntLineModelBySheetId(e){const t=this._antLineModelList.findIndex(n=>n.getSheetId()!==e);t>-1&&this._antLineModelList.splice(t,1)}_findAntLineModelBySheetId(e,t){var n;return(n=this._antLineModelList.find(s=>s.getSheetId()===e))!=null?n:t}_saveOrUpdateAntLineModel(e){for(let t=0;t<this._antLineModelList.length;t++)if(this._antLineModelList[t].getSheetId()===e.getSheetId()){this._antLineModelList[t]=e;return}this._antLineModelList.push(e)}_createAntLineRectBySheetIdAndRange(e,t){let s=this.getWorkBook().getSheetBySheetId(e);if(s==null)throw new Error(`not found sheet from id: ${e}`);let r=s.getConfig().rowTitle.width,i=s.getConfig().columnTitle.height,a=s.getRowManager(),l=s.getColumnManager(),c=0,u=0;for(let g=t.startRow;g<t.endRow;g++)c+=a.getRowHeight(g);for(let g=t.startColumn;g<t.endColumn;g++)u+=l.getColumnWidth(g);let h=0,d=0;for(let g=0;g<=t.startRow-1;g++)d+=a.getRowHeight(g);for(let g=0;g<=t.startColumn-1;g++)h+=l.getColumnWidth(g);return new Fe("__AntLineShape__",{stroke:"red",strokeWidth:2,left:h+r,top:d+i,height:c,width:u,strokeDashArray:[5]})}_deleteSceneAllAntLineRect(){for(let e=0;e<this._antLineModelList.length;e++){let n=this._antLineModelList[e].getAntLineList();for(let s=0;s<n.length;s++){let i=n[s].getRect();i&&this.getSheetViewScene().removeObject(i)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e],n=t.getAntLineList();if(t.getSheetId()===this._activeSheetId)for(let s=0;s<n.length;s++){let r=n[s],i=this._createAntLineRectBySheetIdAndRange(t.getSheetId(),r.getRange());r.setRect(i),console.log(i),this.getSheetViewScene().addObject(i)}}}constructor(e){this._plugin=e,this._antLineModelList=[],e.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}),e.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})}removeSheetAntLine(e=this._activeSheetId){this._removeAntLineModelBySheetId(e),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(e,t=this._activeSheetId){const n=this._findAntLineModelBySheetId(t,new Dv(t));n.addAntLine(new Iv(e)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}}class Wv{constructor(e){this._plugin=e,this._initialize()}_initialize(){var e,t,n,s,r,i;(e=this._plugin.getObserver("onSheetContainerDidMountObservable"))==null||e.add(a=>{var l;this._initRegisterComponent(),this._sheetContainer=a,this._initRegisterComponent(),(l=this._plugin.getObserver("onRichTextDidMountObservable"))==null||l.add(c=>{this.richTextEle=Ms(c.container),this.richTextEditEle=kr("div",this.richTextEle),this.richText=c,this.hideEditContainer(),this._handleKeyboardAction(),this.richText.hooks.set("onKeyDown",u=>{var h;(h=this._plugin.getObserver("onRichTextKeyDownObservable"))==null||h.notifyObservers(u)}),this.richText.hooks.set("onKeyUp",u=>{var h;(h=this._plugin.getObserver("onRichTextKeyUpObservable"))==null||h.notifyObservers(u)})})}),(t=this._plugin.context.getObserverManager().getObserver("onSheetRenderDidMountObservable","core"))==null||t.add(a=>{const l=this._plugin.getMainComponent();l.onDblclickObserver.add(c=>{this.enterEditMode()}),l.onPointerDownObserver.add(c=>{this.exitEditMode(),c.preventDefault()})}),(n=this._plugin.getObserver("onSpreadsheetKeyDownObservable"))==null||n.add(a=>{if(!a.ctrlKey&&zc(a.key))this.handleEnter();else switch(a.key){case"Enter":this.isEditMode?(this.exitEditMode(),this._plugin.getSelectionManager().move(B.BOTTOM)):this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode();break;case"ArrowUp":this.isEditMode||this._plugin.getSelectionManager().move(B.TOP);break;case"ArrowDown":this.isEditMode||this._plugin.getSelectionManager().move(B.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._plugin.getSelectionManager().move(B.LEFT);break;case"ArrowRight":this.isEditMode||this._plugin.getSelectionManager().move(B.RIGHT);break;case"Tab":this.isEditMode||this._plugin.getSelectionManager().move(B.RIGHT),a.preventDefault();break}}),(s=this._plugin.getObserver("onSpreadsheetKeyCompositionStartObservable"))==null||s.add(a=>{this.isEditMode||this.enterEditMode()}),(r=this._plugin.getObserver("onSpreadsheetKeyCompositionUpdateObservable"))==null||r.add(a=>{}),(i=this._plugin.getObserver("onSpreadsheetKeyCompositionEndObservable"))==null||i.add(a=>{}),this._cellEditExtensionManager=new Vs}_initRegisterComponent(){this._plugin.registerModal(`${Me.SPREADSHEET+$r.name}cell`,$r),this._plugin.registerModal(`${Me.SPREADSHEET+$r.name}formula`,$r)}_handleKeyboardAction(){const e=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=0,u.currentState=1,(h=this._plugin.getObserver("onSpreadsheetKeyDownObservable"))==null||h.notifyObservers(u)},t=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyUpObservable"))==null||h.notifyObservers(u)},n=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyCopyObservable"))==null||h.notifyObservers(u)},s=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyPasteObservable"))==null||h.notifyObservers(u)},r=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyCutObservable"))==null||h.notifyObservers(u)},i=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyCompositionStartObservable"))==null||h.notifyObservers(u)},a=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyCompositionUpdateObservable"))==null||h.notifyObservers(u)},l=c=>{var h;let u=c;u.deviceType=ot.Keyboard,u.inputIndex=c.keyCode,u.previousState=1,u.currentState=0,(h=this._plugin.getObserver("onSpreadsheetKeyCompositionEndObservable"))==null||h.notifyObservers(u)};this.richTextEditEle.addEventListener("keydown",e),this.richTextEditEle.addEventListener("keyup",t),this.richTextEditEle.addEventListener("copy",n),this.richTextEditEle.addEventListener("paste",s),this.richTextEditEle.addEventListener("cut",r),this.richTextEditEle.addEventListener("compositionstart",i),this.richTextEditEle.addEventListener("compositionupdate",a),this.richTextEditEle.addEventListener("compositionend",l)}hideEditContainer(){this.richTextEle.style.maxHeight="0px",this.richTextEle.style.maxWidth="0px",this.richTextEle.style.minWidth="0px",this.richTextEle.style.minHeight="0px",this.richTextEle.style.borderWidth="0px"}enterEditMode(){var d,g,m,_;if(this.focusEditEle(),this.isEditMode)return;setTimeout(()=>{Im(this.richTextEditEle)},1),this.isEditMode=!0;const e=this._plugin.getSelectionManager().getCurrentModel();if(!e)return!1;let t,n,s,r;if(e.isMerged){const p=e.mergeInfo;t=p.startX,n=p.endX,s=p.startY,r=p.endY}else t=e.startX,n=e.endX,s=e.startY,r=e.endY;const i=((g=(d=this._plugin.getMainScene())==null?void 0:d.getViewport(At.VIEW_TOP))==null?void 0:g.actualScrollX)||0,a=((_=(m=this._plugin.getMainScene())==null?void 0:m.getViewport(At.VIEW_LEFT))==null?void 0:_.actualScrollY)||0;this.richTextEle.style.left=`${t-i}px`,this.richTextEle.style.top=`${s-a}px`,this.richTextEle.style.minWidth=`${n-t}px`,this.richTextEle.style.minHeight=`${r-s}px`,this.richTextEle.style.borderWidth="2px";const l=Ms(this._sheetContainer.contentRef).getBoundingClientRect();this.richTextEle.style.maxWidth=`${l.width-t+i}px`,this.richTextEle.style.maxHeight=`${l.height-s+a}px`;let c=this.getSelectionValue();const u=this._cellEditExtensionManager.handle({row:e.row,column:e.column,value:c});u&&(c=u.value),this.richText.setValue(c);const h=this.getSelectionStyle();this.richTextEditEle.style.cssText="",h&&(this.richTextEditEle.style.cssText=ad(h,!0)),this.setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const e=Dm(this.richTextEditEle),t=this.richTextEditEle.innerText;let n={};typeof e=="string"?(n.v=e,n.m=e):typeof e=="object"&&(n.p=e,n.v=t,n.m=t);const s=id(this.richTextEditEle);R.isPlainObject(s)&&(n.s=s),this.setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout(()=>{this.richTextEditEle.focus()},100)}setCurrentEditRangeData(){const e=this._plugin.getSelectionManager().getCurrentModel();!e||(this.currentEditRangeData={startRow:e.row,startColumn:e.column,endRow:e.row,endColumn:e.column})}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(e){const{startRow:t,startColumn:n,endRow:s,endColumn:r}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t,n,s,r).setRangeData(e)}getSelectionValue(){const e=this._plugin.getSelectionManager().getActiveRange();if(!e)return"";const t=e&&e.getDisplayValue();return typeof t=="string"?t:typeof t=="object"&&t!==null?Om(t):""}getSelectionStyle(){var e;return(e=this._plugin.getSelectionManager().getActiveRange())==null?void 0:e.getTextStyle()}setSelectionValue(e){const t=this._plugin.getSelectionManager().getActiveRange();!t||(typeof e=="string"&&t.setValue(e),typeof e=="object"&&t.setRangeData({p:e}))}handleEnter(){this.enterEditMode()}handleBackSpace(){}handleDirection(e){}}class Hv{constructor(e){this._master=e}}class $v{_initialize(){const n=this._master.getPlugin().getContext().getWorkBook();this._countBar.setState({onChange:s=>{n.getActiveSheet().setZoomRatio(R.numberFixed(s/100,2))}})}_totalRangeList(e){let t=e.getRangeList(),n=[],l=this._master.getPlugin().getContext().getWorkBook().getActiveSheet().getCellMatrix(),c=0,u=0,h=0;for(let d=0;d<t.length;d++){let g=t[d];for(let m=g.startRow;m<=g.endRow;m++)for(let _=g.startColumn;_<=g.endColumn;_++){if(n.includes(`${m}${_}`))continue;const p=l.getValue(m,_);if(p){let v=parseFloat(p.v);isNaN(v)||(h+=1,u+=v)}n.push(`${m}${_}`)}}h>0&&(c=u/h),this._countBar.setState({content:`\u5E73\u5747\u6570\uFF1A${R.numberFixed(c,2)} \u8BA1\u6570\uFF1A${R.numberFixed(u,2)} \u6570\u91CF\uFF1A${h}`})}_initializeSelectedObserver(){var n;const e=this._master.getPlugin(),t=e.getSelectionManager();(n=e.getObserver("onChangeSelectionObserver"))==null||n.add(()=>{const s=t.getActiveRangeList();s&&this._countBar&&this._totalRangeList(s)})}constructor(e){this._master=e;const t=e.getPlugin().getContext();t.getObserverManager().requiredObserver("onCountBarDidMountObservable").add(s=>{this._countBar=s,this._initialize()}),t.getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{const s=t.getWorkBook().getActiveSheet().getZoomRatio();this._countBar.setZoom(Math.trunc(s*100))}),t.getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._initializeSelectedObserver()}),t.getContextObserver("onZoomRatioSheetObservable").add(s=>{this._countBar.setZoom(Math.trunc(s.zoomRatio*100))})}}class Vv{constructor(e){this._plugin=e,this._uiController=new $v(this),this._apiController=new Hv(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}}class Xv{constructor(e){this._plugin=e;const t=e.getContext().getWorkBook().getConfig().name;this._infoBarModel=new Ov(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setSheetName(n)}}},this._initialize()}_initialize(){const e=this._plugin.context;e.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Me.SPREADSHEET).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class Yv{constructor(e){this.insertRow=(...t)=>{const n=this._getSelections();if((n==null?void 0:n.length)===1){const s=this._plugin.getContext().getWorkBook().getActiveSheet();s==null||s.insertRowBefore(n[0].startRow,n[0].endRow-n[0].startRow+1)}},this.deleteRow=(...t)=>{const n=this._getSelections();if((n==null?void 0:n.length)===1){const s=this._plugin.getContext().getWorkBook().getActiveSheet();s==null||s.deleteRows(n[0].startRow,n[0].endRow-n[0].startRow+1)}},this.insertColumn=(...t)=>{const n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(n[0].startColumn,n[0].endColumn-n[0].startColumn+1)},this.deleteColumn=(...t)=>{const n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(n[0].startColumn,n[0].endColumn-n[0].startColumn+1)},this.clear=(...t)=>{const n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(n[0]).clear()},this.deleteCellLeft=(...t)=>{const n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(n[0]).deleteCells(0)},this.deleteCellTop=(...t)=>{const n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(n[0]).deleteCells(1)},this.addItem=t=>{t instanceof Array?this._menuList.push(...t):this._menuList.push(t),this.resetMenuList(this.resetMenuLabel(this._menuList))},this._plugin=e,this._initRegisterComponent(),this._menuList=[{locale:["rightClick.insert","rightClick.row"],onClick:this.insertRow,hide:vt.hideInsertRow},{locale:["rightClick.insert","rightClick.column"],onClick:this.insertColumn,hide:vt.hideInsertColumn},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.to","rightClick.top","rightClick.add"],suffixLocale:"rightClick.row"}},hide:vt.hideAddRowTop},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.to","rightClick.bottom","rightClick.add"],suffixLocale:"rightClick.row"}},hide:vt.hideAddRowBottom},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.to","rightClick.left","rightClick.add"],suffixLocale:"rightClick.column"}},hide:vt.hideAddColumnLeft},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.to","rightClick.right","rightClick.add"],suffixLocale:"rightClick.column"}},hide:vt.hideAddColumnRight},{locale:["rightClick.deleteSelected","rightClick.row"],onClick:this.deleteRow,hide:vt.hideDeleteRow},{locale:["rightClick.deleteSelected","rightClick.column"],onClick:this.deleteColumn,hide:vt.hideDeleteColumn},{locale:["rightClick.hideSelected","rightClick.row"],hide:vt.hideHideRow},{locale:["rightClick.showHide","rightClick.row"],hide:vt.hideShowRow},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.row","rightClick.height"],suffix:"px",onKeyUp:this.setRowHeight.bind(this)}},onClick:(...t)=>console.dir(t),hide:vt.hideRowHeight},{locale:["rightClick.hideSelected","rightClick.column"],hide:vt.hideHideColumn},{locale:["rightClick.showHide","rightClick.column"],hide:vt.hideShowColumn},{customLabel:{name:$n.name,props:{prefixLocale:["rightClick.column","rightClick.width"],suffix:"px",onKeyUp:this.setColumnWidth.bind(this)}},hide:vt.hideColumnWidth},{hide:vt.hideDeleteCell,customLabel:{name:jr.name,props:{locale:"rightClick.deleteCell"}},border:!0,children:[{locale:["rightClick.moveLeft"],className:Gr.rightMenuCenter,onClick:(...t)=>this.deleteCellLeft(...t)},{locale:["rightClick.moveUp"],className:Gr.rightMenuCenter,onClick:(...t)=>this.deleteCellTop(...t)}]},{locale:["rightClick.clearContent"],onClick:(...t)=>this.clear(...t),border:!0,hide:vt.hideClearContent},{hide:vt.hideMatrix,customLabel:{name:jr.name,props:{locale:"rightClick.matrix"}},children:[{customLabel:{name:qo.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.upAndDown"},{locale:"rightClick.leftAndRight"}]}}},{customLabel:{name:qo.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.clockwise"},{locale:"rightClick.counterclockwise"}]}}},{locale:["rightClick.transpose"]},{customLabel:{name:Aa.name,props:{locale:"rightClick.matrixCalculation",options:[{locale:"rightClick.plus"},{locale:"rightClick.minus"},{locale:"rightClick.multiply"},{locale:"rightClick.divided"},{locale:"rightClick.power"},{locale:"rightClick.root"},{locale:"rightClick.log"}]}}},{customLabel:{name:qo.name,props:{locale:"rightClick.delete0",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}},{customLabel:{name:qo.name,props:{locale:"rightClick.removeDuplicate",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}}]}],this._rightMenuModel=new xv,this._initialize()}_initialize(){const e=this._plugin.getContext();e.getObserverManager().requiredObserver("onRightMenuDidMountObservable",Me.SPREADSHEET).add(n=>{this._RightMenu=n,this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onSheetRenderDidMountObservable").add(()=>{const n=this._plugin.getContentRef().current;!n||this._plugin.getMainComponent().onPointerDownObserver.add(s=>{s.button===2&&(n.oncontextmenu=()=>!1,this._RightMenu.handleContextMenu(s))})})}_initRegisterComponent(){this._plugin.registerComponent($n.name,$n),this._plugin.registerComponent(qo.name,qo),this._plugin.registerComponent(Aa.name,Aa),this._plugin.registerComponent(jr.name,jr)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if(t==="locale")e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this.findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this.resetMenuLabel(e[t]));return e}resetMenuLabel(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetMenuLabel(n.children))}return e}resetMenuList(e){var t;(t=this._RightMenu)==null||t.setMenuList(e)}_getSelections(){var n;const e=(n=this._plugin)==null?void 0:n.getSelectionManager().getCurrentControls();return e==null?void 0:e.map(s=>{const r=s.model;return{startRow:r.startRow,startColumn:r.startColumn,endRow:r.endRow,endColumn:r.endColumn}})}setColumnWidth(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setColumnWidth(n[0].startColumn,n[0].endColumn-n[0].startColumn+1,Number(t)),this._RightMenu.showRightMenu(!1)}setRowHeight(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setRowHeights(n[0].startRow,n[0].endRow-n[0].startRow+1,Number(t)),this._RightMenu.showRightMenu(!1)}}class Gv{constructor(e){this._barControl=e,this._sheetUl=[{locale:"sheetConfig.delete",onClick:()=>e.deleteSheet()},{locale:"sheetConfig.copy",onClick:()=>e.copySheet()},{locale:"sheetConfig.rename",onClick:()=>e.reNameSheet()},{locale:"sheetConfig.changeColor",icon:"RightIcon",children:[{selectType:"jsx",label:"ColorPicker",onClick:t=>{e.setSheetColor(t)}}]},{locale:"sheetConfig.hide",border:!0,onClick:()=>e.hideSheet()},{locale:"sheetConfig.unhide",onClick:()=>e.unHideSheet()},{locale:"sheetConfig.moveLeft",border:!0,onClick:()=>e.moveSheet("left")},{locale:"sheetConfig.moveRight",onClick:()=>e.moveSheet("right")}],this._initializeData(),this._initializeObserver()}getMenuList(){return this._menuList}getSheetList(){return this._sheetList}getSheetBar(){return this._sheetBar}getDataId(){return this._dataId}_initializeObserver(){const e=this._barControl.getPlugin(),t=e.getContext(),n=t.getObserverManager(),r=t.getWorkBook().getUnitId();n.requiredObserver("onSheetBarDidMountObservable",Me.SPREADSHEET).add(i=>{this._sheetBar=i,this.resetSheetUl(),this._sheetBar.setValue({sheetList:this._sheetList,sheetUl:this._sheetUl,menuList:this._menuList,addSheet:()=>{this._barControl.addSheet()},selectSheet:(a,l)=>{this._dataId=l.item.sheetId;const c=e.getContext().getWorkBook().getSheetBySheetId(this._dataId);c&&c.activate()},contextMenu:a=>{const l=a.currentTarget;this._dataId=l.dataset.id,this._barControl.contextMenu(a)},changeSheetName:a=>{this._barControl.changeSheetName(a)},dragEnd:a=>{this._barControl.dragEnd(a)}})}),t.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetSheetUl(),this._sheetBar.setValue({sheetUl:this._sheetUl})}),fe.getActionObservers().add(i=>{const c=i.action.getWorkSheet().getContext().getWorkBook().getUnitId();if(r!==c)return;const{data:u}=i;switch(u.actionName){case A.SET_SHEET_ORDER_ACTION:case A.INSERT_SHEET_ACTION:case A.SET_TAB_COLOR_ACTION:case A.REMOVE_SHEET_ACTION:case A.SET_WORKSHEET_NAME_ACTION:case A.SET_WORKSHEET_ACTIVATE_ACTION:case A.SET_WORKSHEET_STATUS_ACTION:{this._initializeData(),this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList});break}}})}_initializeData(){const n=this._barControl.getPlugin().getWorkbook().getSheets();this._menuList=n.map((s,r)=>({label:s.getName(),index:String(r),sheetId:s.getSheetId(),hidden:s.isSheetHidden(),selected:s.getStatus()===1,onClick:i=>{console.log("000000000");const a=i.currentTarget;this._dataId=a.dataset.id,s.showSheet(),s.activate()}})),this._sheetList=n.filter(s=>!s.isSheetHidden()).map((s,r)=>({sheetId:s.getSheetId(),label:s.getName(),icon:"NextIcon",index:String(r),selected:s.getStatus()===1,color:s.getTabColor(),onDown:i=>{const a=i.currentTarget;this._dataId=a.dataset.id},onClick:i=>{const a=i.currentTarget;this._dataId=a.dataset.id,s.activate()}})),this._sheetIndex=n.findIndex(s=>s.getStatus()===1),this._dataId=n[this._sheetIndex].getSheetId()}resetSheetUl(){const e=this._barControl.getPlugin().context.getLocale();this._sheetUl.forEach(t=>{t.label=e.get(t.locale)})}selectSheet(...e){}deleteSheet(){}sortMenu(e,t,n){}copySheet(){}addSheet(e,t){this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList},()=>{this._sheetBar.overGrid()})}reNameSheet(){this._sheetBar.reNameSheet(this._dataId)}hideSheet(){}unHideSheet(){this._sheetBar.ref.current.showSelect()}moveSheet(e){}changeSheetName(e){}contextMenu(e){this._sheetBar.contextMenu(e)}dragEnd(e){let t=[];Array.from(e).forEach(n=>{const s=this._sheetList.find(r=>r.sheetId===n.dataset.id);s&&t.push(s)}),this._sheetList=t,this._sheetBar.setValue({sheetList:t})}}class jv{constructor(e){this._barControl=e}deleteSheet(){const t=this._barControl.getPlugin().getWorkbook();t&&t.removeSheetBySheetId(this._barControl.getUIController().getDataId())}copySheet(){const e=this._barControl.getPlugin().getWorkbook(),n=e.getActiveSheet().copy(bn.getSheetName());e&&e.insertSheet(e.getActiveSheetIndex()+1,n.getConfig())}setSheetColor(e){const s=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());s&&s.setTabColor(e)}changeSheetName(e){const n=this._barControl.getUIController().getMenuList().find(a=>a.sheetId===this._barControl.getUIController().getDataId()),i=this._barControl.getPlugin().getContext().getWorkBook();if(n){const a=i.getSheetBySheetId(n.sheetId),l=e.target.innerText;a&&l!==a.getName()&&a.setName(l)}}addSheet(){this._barControl.getPlugin().getContext().getWorkBook().insertSheet()}moveSheet(e){const s=this._barControl.getPlugin().getContext().getWorkBook();switch(e){case"left":{const r=s.getActiveSheetIndex(),i=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(i.getSheetId(),Math.max(r-1,0));break}case"right":{const r=s.getActiveSheetIndex(),i=s.getSheetSize(),a=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(a.getSheetId(),Math.min(r+1,i));break}}}dragEnd(e){let t=[],n=this._barControl.getUIController().getDataId();Array.from(e).forEach(s=>{const r=this._barControl.getUIController().getSheetList().find(i=>i.sheetId===s.dataset.id);r&&t.push(r)}),console.log(n),t.forEach((s,r)=>{s.sheetId===n&&this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(s.sheetId,r)}),console.log(e)}hideSheet(){const n=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());n&&n.hideSheet()}}class Kv{constructor(e){this._plugin=e,this._apiController=new jv(this),this._uiController=new Gv(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}selectSheet(...e){}hideSheet(){this._apiController.hideSheet()}unHideSheet(){this._uiController.unHideSheet()}addSheet(e,t){this._apiController.addSheet(),this._uiController.addSheet(e,t),this._uiController.getSheetBar().slideTabBar.getScrollbar().scrollRight()}deleteSheet(){this._apiController.deleteSheet(),this._uiController.deleteSheet()}moveSheet(e){this._apiController.moveSheet(e)}copySheet(){this._apiController.copySheet()}reNameSheet(){this._uiController.reNameSheet()}changeSheetName(e){this._apiController.changeSheetName(e),this._uiController.changeSheetName(e)}setSheetColor(e){this._apiController.setSheetColor(e)}contextMenu(e){this._uiController.contextMenu(e)}dragEnd(e){this._apiController.dragEnd(e),this._uiController.dragEnd(e)}}class t6 extends _e{constructor(){super(...arguments),this.inputRef=ee(),this.modalRef=ee()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={modalData:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCellRangeModalDidMountObservable",Me.SPREADSHEET))==null||e.notifyObservers(this)}confirmRange(){var e;(e=this.inputRef.current)==null||e.value}setModal(e){this.setState({modalData:e})}render(){const{value:e,title:t,children:n,group:s,show:r}=this.state.modalData,i=this._render.renderFunction("Input"),a=this._render.renderFunction("Modal");if(!!r)return f(a,{isDrag:!0,visible:r,title:t,group:s,mask:!1},f(i,{ref:this.inputRef,readonly:!0,placeholder:n==null?void 0:n.placeholder,value:e}))}}class qv{constructor(e){this._plugin=e,this._initRegisterComponent(),this._initialize()}_initialize(){fe.getCommandObservers().add(({actions:e})=>{const t=this._plugin;if(!t||!e||e.length===0)return;const s=e[0].getWorkSheet(),r=t.context.getWorkBook().getUnitId(),i=s.getContext().getWorkBook().getUnitId();if(r===i&&s.getConfig().status===Y.TRUE)try{const a=t.getCanvasView();a&&(a.updateToSheet(s),t.getMainComponent().makeDirty(!0))}catch(a){console.info(a)}})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const t={ForwardIcon:this._render.renderFunction("ForwardIcon"),BackIcon:this._render.renderFunction("BackIcon"),BoldIcon:this._render.renderFunction("BoldIcon"),RightIcon:this._render.renderFunction("RightIcon"),ItalicIcon:this._render.renderFunction("ItalicIcon"),DeleteLineIcon:this._render.renderFunction("DeleteLineIcon"),UnderLineIcon:this._render.renderFunction("UnderLineIcon"),TextColorIcon:this._render.renderFunction("TextColorIcon"),FillColorIcon:this._render.renderFunction("FillColorIcon"),MergeIcon:this._render.renderFunction("MergeIcon"),TopBorderIcon:this._render.renderFunction("TopBorderIcon"),BottomBorderIcon:this._render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this._render.renderFunction("LeftBorderIcon"),RightBorderIcon:this._render.renderFunction("RightBorderIcon"),NoneBorderIcon:this._render.renderFunction("NoneBorderIcon"),FullBorderIcon:this._render.renderFunction("FullBorderIcon"),OuterBorderIcon:this._render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this._render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this._render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this._render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this._render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this._render.renderFunction("CenterAlignIcon"),RightAlignIcon:this._render.renderFunction("RightAlignIcon"),TopVerticalIcon:this._render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this._render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this._render.renderFunction("BottomVerticalIcon"),OverflowIcon:this._render.renderFunction("OverflowIcon"),BrIcon:this._render.renderFunction("BrIcon"),CutIcon:this._render.renderFunction("CutIcon"),TextRotateIcon:this._render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this._render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this._render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this._render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this._render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this._render.renderFunction("TextRotateRotationDownIcon"),SearchIcon:this._render.renderFunction("SearchIcon"),ReplaceIcon:this._render.renderFunction("ReplaceIcon"),LocationIcon:this._render.renderFunction("LocationIcon")};for(let n in t)this._plugin.registerComponent(n,t[n]);this._plugin.registerModal(t6.name,t6)}}class Ma extends _e{initialize(){var t;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={color:(t=this.props.color)!=null?t:"#000"}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setColor(e){this.setState({color:e})}render(){const e=this.Render.renderFunction("RightIcon"),{color:t}=this.state,{label:n}=this.props;return f("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},f("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},n),f(e,null))}}const Zv=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Jv=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],Qv=[{locale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{locale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{locale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{locale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{locale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{locale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{locale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{locale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{locale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{locale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],eb=[{locale:"merge.all",value:"all"},{locale:"merge.vertical",value:"vertical"},{locale:"merge.horizontal",value:"horizontal"},{locale:"merge.cancel",value:"cancel"}],tb=[{locale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{locale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{locale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],nb=[{locale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{locale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{locale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],ob=[{locale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{locale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{locale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],sb=[{locale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{locale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{locale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{locale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{locale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{locale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];class rb{_changeToolBarState(e){var s,r,i,a,l;const n=this._plugin.getContext().getWorkBook().getActiveSheet();if(n){const c=n.getCellMatrix(),u=e.getStrikeThrough(),h=e.getFontSize(),d=e.getFontWeight(),g=e.getFontFamily(),m=e.getFontStyle(),_=e.getUnderline(),p=e.getHorizontalAlignment(),v=e.getVerticalAlignment(),b=e.getTextRotation();console.log("cellMatrix:",c),console.log("fontSize:",h),console.log("horizontalAlign:",p),console.log("fontName:",g),console.log("verticalAlign:",v),console.log("fontItalic:",m),console.log("fontWeight:",d),console.log("strikeThrough:",u);const C=this._toolList.find(L=>L.name==="textRotateMode"),D=this._toolList.find(L=>L.name==="fontSize"),O=this._toolList.find(L=>L.name==="font"),F=this._toolList.find(L=>L.name==="bold"),S=this._toolList.find(L=>L.name==="italic"),E=this._toolList.find(L=>L.name==="strikethrough"),w=this._toolList.find(L=>L.name==="underline"),I=this._toolList.find(L=>L.name==="horizontalAlignMode"),P=this._toolList.find(L=>L.name==="verticalAlignMode");E&&(E.active=!!u.s),O&&((s=O.children)==null||s.forEach(L=>{L.selected=g===L.value})),D&&((r=D.children)==null||r.forEach(L=>{L.selected=h===L.value})),F&&(F.active=!!d),S&&(S.active=!!m),w&&(w.active=!!_.s),I&&((i=I.children)==null||i.forEach(L=>{L.selected=p===L.value})),C&&((a=C.children)==null||a.forEach(L=>{L.selected=b===L.value})),P&&((l=P.children)==null||l.forEach(L=>{L.selected=v===L.value})),this.resetToolBarList()}}constructor(e){this._plugin=e;const t=this._plugin.getPluginName();this._initRegisterComponent();const n=this._plugin.config.layout==="auto"?R.deepClone($s.toolBarConfig):R.deepMerge($s.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:n.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:n.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",className:It.selectLabelString,show:n.font,name:"font",border:!0,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||r.notifyObservers(s)},children:Jv},{type:1,tooltipLocale:"toolbar.fontSize",label:String(Zn.fs),show:n.fontSize,name:"fontSize",onClick:s=>{var r;debugger;(r=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||r.notifyObservers(s)},onKeyUp:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||r.notifyObservers(s)},children:Zv},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,show:n.bold,name:"bold",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:n.italic,name:"italic",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:n.strikethrough,name:"strikethrough",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:n.underline,name:"underline",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||r.notifyObservers(s)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:n.textColor,name:"textColor",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||r.notifyObservers(s)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:n.fillColor,name:"fillColor",onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||r.notifyObservers(s)}},{type:3,display:1,show:n.border,tooltipLocale:"toolbar.border.main",className:It.selectDoubleString,onClick:s=>{},name:"border",children:[...Qv,{customLabel:{name:t+Ma.name,props:{locale:"borderLine.borderColor"}},unSelectable:!0,className:It.selectColorPickerParent,children:[{customLabel:{name:t+tn.name,props:{onClick:(s,r)=>this.handleLineColor(s,r)}},className:It.selectColorPicker,onClick:this.handleLineColor}]}]},{type:5,tooltipLocale:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:n.mergeCell,onClick:s=>{this.setMerge(s)},name:"mergeCell",children:eb},{type:3,tooltipLocale:"toolbar.horizontalAlignMode.main",className:It.selectDoubleString,display:1,show:n.horizontalAlignMode,name:"horizontalAlignMode",onClick:s=>{this.setHorizontalAlignment(s)},children:tb},{type:3,tooltipLocale:"toolbar.verticalAlignMode.main",className:It.selectDoubleString,display:1,show:n.verticalAlignMode,name:"verticalAlignMode",onClick:s=>{this.setVerticalAlignment(s)},children:nb},{type:3,className:It.selectDoubleString,tooltipLocale:"toolbar.textWrapMode.main",display:1,show:n.textWrapMode,name:"textWrapMode",onClick:s=>{this.setWrapStrategy(s)},children:ob},{type:3,className:It.selectDoubleString,name:"textRotateMode",tooltipLocale:"toolbar.textRotateMode.main",display:1,show:n.textRotateMode,onClick:s=>{this.setTextRotation(s)},children:sb}],this._moreText={more:"toolbar.toolMore",tip:"toolbar.toolMoreTip"},this._toolBarModel=new Mv,this._toolBarModel.config=n,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,s,r,i,a,l,c,u,h,d;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("ff",g):this.setFontFamily(g)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fs",g):this.setFontSize(g)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bl",g?"1":"0"):this.setFontWeight(g)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("it",g?"1":"0"):this.setFontStyle(g)}),(r=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||r.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("cl",g?"1":"0"):this.setStrikeThrough(g)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("un",g?"1":"0"):this.setUnderline(g)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fc",g):this.setFontColor(g)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bg",g):this.setBackground(g)}),(c=this._plugin.getObserver("onToolBarDidMountObservable"))==null||c.add(g=>{this._toolBarComponent=g,this.resetToolBarList()}),(u=this._plugin.getObserver("onLineColorDidMountObservable"))==null||u.add(g=>{this._lineColor=g}),(h=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","core"))==null||h.add(()=>{this.resetToolBarList()}),(d=this._plugin.getObserver("onChangeSelectionObserver"))==null||d.add(g=>{const m=this._plugin.getSelectionManager(),_=m==null?void 0:m.getCurrentCell();_&&this._changeToolBarState(_)})}_initRegisterComponent(){const e=this._plugin.getPluginName();this._plugin.registerComponent(e+Ma.name,Ma),this._plugin.registerComponent(e+tn.name,tn)}resetLocale(e){var n,s;const t=this._plugin.context.getLocale();for(let r=0;r<e.length;r++){const i=e[r];i.tooltipLocale&&(i.tooltip=t.get(i.tooltipLocale)),i.locale&&(i.label=t.get(i.locale)),i.suffixLocale&&(i.suffix=t.get(i.suffixLocale)),(s=(n=i.customLabel)==null?void 0:n.props)!=null&&s.locale&&(i.customLabel.props.label=t.get(i.customLabel.props.locale)),i.children&&(i.children=this.resetLocale(i.children))}return e}resetToolBarList(){const e=this._plugin.context.getLocale(),t=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(t,{more:e.get(this._moreText.more),tip:e.get(this._moreText.tip)})}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontColor(e)}setBackground(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setBackground(e)}setFontSize(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontSize(e)}setFontFamily(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontFamily(e)}setFontWeight(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontWeight(e)}setFontStyle(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontStyle(e)}setStrikeThrough(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setStrikeThrough(e)}setUnderline(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setUnderline(e)}setMerge(e){const t=this._plugin.getSelectionManager().getActiveRange();switch(e){case"all":t==null||t.merge();break;case"vertical":t==null||t.mergeVertically();break;case"horizontal":t==null||t.mergeAcross();break;case"cancel":t==null||t.breakApart();break}}setHorizontalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setHorizontalAlignment(e)}setVerticalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalAlignment(e)}setWrapStrategy(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setWrapStrategy(e)}setTextRotation(e){var t,n;e==="v"?(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalText(1):(n=this._plugin.getSelectionManager().getActiveRangeList())==null||n.setTextRotation(e)}setBorder(e,t,n){const s=this._plugin.getSelectionManager().getCurrentControls();s&&s.length>0&&(s==null||s.forEach(r=>{const i=r.model,a={startRow:i.startRow,startColumn:i.startColumn,endRow:i.endRow,endColumn:i.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(a).setBorderByType(e,t,n)}))}handleLineColor(e,t){t.stopPropagation(),this._lineColor.setColor(e),this._borderInfo.color=e}addToolButton(e){this._toolList.findIndex(n=>n.name===e.name)>-1||(this._toolList.push(e),this._toolBarComponent&&this.resetToolBarList())}}class ib{constructor(e){this._plugin=e,this._ModalGroup=[],this.init()}init(){var e;(e=this._plugin.getObserver("onModalGroupDidMountObservable"))==null||e.add(t=>{this._ModalGroupComponent=t})}addModal(e,t){var s;this._ModalGroup.findIndex(r=>r===e)<0&&(this._plugin.registerComponent(e,t),this._ModalGroup.push(e),(s=this._ModalGroupComponent)==null||s.setModalGroup(this._ModalGroup))}getModal(e){return this._ModalGroupComponent.getModalGroup().find(n=>n.constructor.name===e)}}class ab{constructor(e){this._plugin=e,this._initialize()}_initialize(){var n;this._plugin.context.getObserverManager().requiredObserver("onFormulaBarDidMountObservable",Me.SPREADSHEET).add(s=>{this._formulaBar=s,this._namedRanges=this._plugin.getContext().getWorkBook().getConfig().namedRanges;const r=this._namedRanges.map(i=>({value:i.name,label:i.name}));this._formulaBar.setNamedRanges(r)}),(n=this._plugin.getObserver("onChangeSelectionObserver"))==null||n.add(s=>{const r=s.model.currentCell;if(r){let i;if(r.isMerged){const l=r.mergeInfo;i={startRow:l.startRow,endRow:l.endRow,startColumn:l.startColumn,endColumn:l.endColumn}}else{const{row:l,column:c}=r;i={startRow:l,endRow:l,startColumn:c,endColumn:c}}const a=this._plugin.getWorkbook().getActiveSheet().getRange(i).getObjectValue({isIncludeStyle:!0});if(a){let l=a.m||`${a.v}`||"";const c=this._cellInputExtensionManager.handle({row:i.startRow,column:i.startColumn,value:l});c&&(l=c.value),this._formulaBar.setFormulaContent(l)}}}),this._cellInputExtensionManager=new Xs}}class lb extends Ti{execute(){this._plugin.getContext().getWorkBook().getUnitId();const e=this.actionData.sheetId,t=this._plugin.getContext().getCommandManager(),n=this._plugin.getContext().getWorkBook(),s=R.deepClone(this._plugin.getWorkbook().getConfig().namedRanges),{rowCount:r,rowIndex:i}=this.actionData,a=[];for(let c=0;c<s.length;c++){const u=s[c].range.rangeData;if(i>u.endRow)continue;i>=u.startRow&&i<=u.endRow||(u.startRow+=r),u.endRow+=r;const h={actionName:A.SET_NAMED_RANGE_ACTION,namedRange:s[c],sheetId:e};a.push(h)}const l=new V({WorkBookUnit:n},...a);t.invoke(l)}}class cb extends Jc{get zIndex(){return 1}get actionName(){return A.INSERT_ROW_ACTION}create(e,t){return new lb(e,t,this._plugin)}}class ub extends To{constructor(e={}){super(Me.SPREADSHEET),this._config=R.deepMerge(wv,e)}register(e){let t=Ms(this.getContentRef());this._canvasEngine=e,e.setContainer(t),window.onresize=()=>{e.resize()}}initialize(e){var i;this.context=e,(i=this.getObserver("onSheetContainerDidMountObservable"))==null||i.add(()=>{this._initializeRender(e)}),e.getLocale().load({en:Zp,zh:qp});const t=e.getWorkBook().getConfig(),n=this._initContainer(this._config.container),s={skin:t.skin||"default",layout:this._config.layout,container:n,context:e,getSplitLeftRef:a=>{this._splitLeftRef=a},getContentRef:a=>{this._contentRef=a},addButton:a=>{this._addButtonFunc=a},addSider:a=>{this._addSiderFunc=a},addMain:a=>{this._addMainFunc=a},showSiderByName:a=>{this._showSiderByNameFunc=a},showMainByName:a=>{this._showMainByNameFunc=a},onDidMount:()=>{}};this._componentList=new Map;const r=this._config.layout;this._modalGroupController=new ib(this),this._sheetContainerController=new qv(this),this._rightMenuControl=new Yv(this),(r==="auto"||r.toolBar)&&(this._toolBarControl=new rb(this)),(r==="auto"||r.infoBar)&&(this._infoBarControl=new Xv(this)),(r==="auto"||r.sheetBar)&&(this._sheetBarControl=new Kv(this)),this._cellEditorController=new Wv(this),this._antLineController=new Uv(this),(r==="auto"||r.countBar)&&(this._countBarController=new Vv(this)),(r==="auto"||r.formulaBar)&&(this._formulaBarController=new ab(this)),zn(f(Ev,{config:s}),n),this.registerExtension()}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else sa(e)?t=e:(t=document.createElement("div"),t.id="universheet");return t}_initSelection(){}onMounted(e){Kp(this),this.initialize(e),fe.getActionObservers().add(t=>{const n=this.getContext().getWorkBook().getUnitId(),s=t.action,r=s.getDoActionData(),i=s.getWorkSheet().getContext().getWorkBook().getUnitId();n===i&&r.actionName===A.SET_NAMED_RANGE_ACTION&&r.namedRange})}get config(){return this._config}_initializeRender(e){var n,s;const t=(n=this.getPluginByName(Me.BASE_RENDER))==null?void 0:n.getEngine();this.register(t),this._canvasView=new zv(t,this),(s=this.context.getContextObserver("onSheetRenderDidMountObservable"))==null||s.notifyObservers()}onDestroy(){super.onDestroy(),jp(this),this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._namedRangeActionExtensionFactory)}registerExtension(){const e=this.context.getCommandManager().getActionExtensionManager().getRegister();this._namedRangeActionExtensionFactory=new cb(this),e.add(this._namedRangeActionExtensionFactory)}getSplitLeftRef(){return this._splitLeftRef}getContentRef(){return this._contentRef}addButton(e){this._addButtonFunc(e)}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(At.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var e;return(e=this.getSheetView())==null?void 0:e.getSelectionManager()}getCurrentControls(){var e;return(e=this.getSelectionManager())==null?void 0:e.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorController(){return this._cellEditorController}getModalGroupControl(){return this._modalGroupController}addSider(e){return this._addSiderFunc(e)}addMain(e){return this._addMainFunc(e)}showSiderByName(e,t){return this._showSiderByNameFunc(e,t)}showMainByName(e,t){return this._showMainByNameFunc(e,t)}addRightMenu(e){this._rightMenuControl.addItem(e)}addToolButton(e){this._toolBarControl.addToolButton(e)}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}registerModal(e,t){this._modalGroupController.addModal(e,t)}}var $7={cellRange:"univer-cell-range",cellModalIcon:"univer-cell-modal-icon"},hb={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},db={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};function gb(o){o.pushToObserve("onAfterChangeFontFamilyObservable"),o.pushToObserve("onAfterChangeFontSizeObservable"),o.pushToObserve("onAfterChangeFontWeightObservable"),o.pushToObserve("onAfterChangeFontItalicObservable"),o.pushToObserve("onAfterChangeFontStrikethroughObservable"),o.pushToObserve("onAfterChangeFontUnderlineObservable"),o.pushToObserve("onAfterChangeFontBackgroundObservable"),o.pushToObserve("onAfterChangeFontColorObservable"),o.pushToObserve("onDragAndDropStartObserver"),o.pushToObserve("onDragAndDroppingObserver"),o.pushToObserve("onDragAndDropEndEndObserver"),o.pushToObserve("onFillStartObserver"),o.pushToObserve("onFillingObserver"),o.pushToObserve("onFillEndObserver"),o.pushToObserve("onChangeCurrentSheetObserver"),o.pushToObserve("onToolBarDidMountObservable"),o.pushToObserve("onSheetBarDidMountObservable"),o.pushToObserve("onCountBarDidMountObservable"),o.pushToObserve("onInfoBarDidMountObservable"),o.pushToObserve("onRightMenuDidMountObservable"),o.pushToObserve("onDocContainerDidMountObservable"),o.pushToObserve("onSpreadsheetKeyDownObservable"),o.pushToObserve("onSpreadsheetKeyUpObservable"),o.pushToObserve("onSpreadsheetKeyCopyObservable"),o.pushToObserve("onSpreadsheetKeyPasteObservable"),o.pushToObserve("onSpreadsheetKeyCutObservable"),o.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),o.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),o.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}var Xn={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},Ys={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class ka extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:r}=this.props;return f("div",{className:Ct(Ys.selectItem,r?Ys.selectDisabledItem:"")},t?f("span",{className:Ys.selectItemSelected},f(e,null)):"",f("span",{className:Ys.selectItemContent},n),s?f("span",{className:Ys.selectItemSuffix},s):"")}}var Wt={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"};class fb extends _e{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(r=>{r.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Button");return f("div",{className:`${Wt.selectSingle} ${n}`},f(r,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return f("div",{className:`${Wt.selectInput} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f(r,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{color:s,menu:r}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return f("div",{className:`${Wt.selectColor} ${Wt.selectDouble} ${t}`},f(i,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:r,onClick:this.onClick},icon:f(a,null)},f("div",{className:Wt.selectLabel},e),f("div",{className:Wt.selectLine,style:{background:s}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return f("div",{className:`${Wt.selectDouble} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:f(r,null)},f("div",{className:Wt.selectLabel},e))))},this.getFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button");return f("div",{className:`${Wt.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},f("div",{className:Wt.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return f("div",{className:`${Wt.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:f(i,null)},f("div",{className:Wt.selectLabel},e))))}}initialize(){var r;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(r=this.props.defaultColor)!=null?r:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}componentDidMount(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=this.handleSelected(r),a=n[r];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const c=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),c.unSelectable)return;const u=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:u}):this.setState({content:n[l[2]].label,menu:u})}}else if(e===1){if(!n.length)return;const r=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(c=>i===c.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(u=>u.selected);a<0&&(a=0);let l=this.handleSelected(a);const c=n[a];this.setState({content:c.label,menu:l})}};r(s),this.onClick=(...i)=>{var l,c;(c=(l=this.props).onClick)==null||c.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,c;const a=i.currentTarget.value;(c=(l=this.props).onKeyUp)==null||c.call(l,a),r(a)}}else if(e===2){const r=this.handleSelected(null);this.setState({menu:r}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=n[r],a=this.handleSelected(r);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var c,u,h,d;if(l.length){(u=(c=this.props).onClick)==null||u.call(c,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}resetMenu(e,t){var s;const n=[];for(let r=0;r<e.length;r++){let i=!1;t||(i=(s=e[r].selected)!=null?s:!1),n[r]={label:""},n[r].label=f(ka,{disabled:e[r].disabled,border:e[r].border,selected:i,label:e[r].label,suffix:e[r].suffix}),n[r].disabled=e[r].disabled,n[r].style=e[r].style,n[r].value=e[r].value,n[r].className=e[r].className,n[r].onClick=e[r].onClick,e[r].children&&(n[r].children=this.getChildren(e[r].children))}return this.props.type===2&&(n[0]={label:f(ka,{label:f(tn,{style:{display:"block"},ref:r=>this.ColorRef=r,color:"#000",onClick:r=>{this.ColorRef.hideSelect(),this.setState({color:r},()=>{this.onClick()})}})})}),n}getChildren(e){return e.map(n=>{const s=this.props.hideSelectedIcon?!1:n.selected;return n.label=f(ka,{disabled:n.disabled,border:n.border,selected:s,label:n.label,suffix:n.suffix}),n.children&&(n.children=this.getChildren(n.children)),n})}render(){const{type:e=0}=this.props;return f("div",{className:Wt.selectComponent},this.getType(e))}}var mb={textButton:"univer-text-button"};class _b extends _e{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return f("div",{className:mb.textButton},f(n,{type:"text",active:t,onClick:this.handleClick},e))}}var es={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",doubleButton:"univer-double-button",colorBottom:"univer-color-bottom",doubleButtonRight:"univer-double-button-right",doubleButtonRightPopup:"univer-double-button-right-popup",doubleButtonMenuItem:"univer-double-button-menu-item",doubleButtonMenuItemIcon:"univer-double-button-menu-item-icon",doubleButtonMenuItemContent:"univer-double-button-menu-item-content",moreButton:"univer-more-button",moreTool:"univer-more-tool",univericonNextIcon:"univer-univericon-nextIcon"};class pb extends _e{constructor(){super(...arguments),this.toolbarWarp=ee(),this.toolbarRef=ee(),this.moreBtn=ee(),this.moreToolRef=ee(),this.SelectRef=ee(),this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Me.DOCUMENT);for(let r=0;r<e.length;r++){const i=e[r];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=f(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=f(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e})}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{toolList:n}=t,s=this.Render.renderFunction("Button"),r=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return f(r,{style:{position:"relative"}},f("div",{className:es.toolbarWarp,ref:this.toolbarWarp},f("div",{className:es.toolbar,ref:this.toolbarRef},n.map(a=>a.toolbarType?f(i,{title:a.tooltip,placement:"bottom"},f(_b,{label:a.label,onClick:a.onClick})):f(fb,{tooltip:a.tooltip,type:a.type,display:a.display,children:a.children,customLabel:a.customLabel,customSuffix:a.customSuffix,label:a.label,onClick:a.onClick,onKeyUp:a.onKeyUp,defaultColor:a.defaultColor,hideSelectedIcon:a.hideSelectedIcon,selectClassName:a.selectClassName}))),this.state.moreToolList.length===0?null:f("div",{ref:this.moreBtn,className:es.singleButton},f(i,{title:this.state.moreText,placement:"bottom"},f(s,{type:"text",onClick:this.moreTool},f("div",{style:{fontSize:"14px"}},this.state.moreText))))),f("div",{className:`${es.moreTool} ${this.state.more?es.moreShow:null}`,ref:this.moreToolRef}))}}var Wy="";class vb extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Me.DOCUMENT))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),s=this.Render.renderFunction("Tooltip"),r=this.Render.renderFunction("DropDownIcon");this.Render.renderFunction("LogoIcon");const{back:i,sheet:a,update:l,save:c,rename:u}=this.state.infoList;return f(t,{className:"universheet-info-detail"},f("div",{style:{marginRight:"18px"}},f(s,{title:i.label,placement:"bottom"},f(e,{className:"universheet-info-return",type:"text"},f(r,{rotate:90})))),f("div",{className:"sheet-name"},f(s,{title:u.label,placement:"bottom"},f(n,{bordered:!1,value:a.label,onBlur:a.onBlur}))),f("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},l.label),f("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},c.label))}}const Jr={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,toolBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class bb extends _e{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=ee(),this.rightRef=ee(),this.menuRef=ee(),this.cellRightRef=ee(),this.btnRef=ee(),this.contentRef=ee(),this.layoutContainerRef=ee(),this.containerRef=ee(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var g,m,_,p,v;this.leftContentLeft=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().left,this.leftContentTop=(m=this.splitLeftRef.current)==null?void 0:m.getBoundingClientRect().top;const d=(_=this.splitLeftRef.current)==null?void 0:_.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(v=d==null?void 0:d.getBoundingClientRect())==null?void 0:v.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,g=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,g=g>=this.rightBorderY?this.rightBorderY:g,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${g}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:n,layout:s,context:r,addSider:i,addMain:a,showSiderByName:l,showMainByName:c}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),l(this.showSiderByName.bind(this)),c(this.showMainByName.bind(this));const u=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=u.getComponentRender(),this.setSkin(t,n),this.state={layout:s==="auto"?R.deepClone(Jr):R.deepMerge(Jr,s),currentLocale:r.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}setSkin(e,t){let n=document.documentElement,r={default:ya,dark:Ta,green:Ra}[t];r=Object.fromEntries(Object.keys(r).map(l=>[`--${l.replace(/([A-Z])/g,"-$1").toLowerCase()}`,r[l]])),R.isIEBrowser()?on({rootElement:n,variables:r}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(r).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const c="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===c)return a(document.styleSheets[d],l),document.styleSheets[d];const u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=c,u.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,c){let u=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${c}`){u=h,l.deleteRule(u);break}}}}addSider(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.siderPanelList.length+1});return{siderPanelList:[...n.siderPanelList,s]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.mainList.length+1});return{mainList:[...n.mainList,s]}},()=>{t()})})}showSiderByName(e,t){return new Promise(n=>{this.setState(s=>{let r=!1,i=0,a=s.siderPanelList.map(c=>(c.name===e&&(i=c.zIndex),c.zIndex));return{siderPanelList:s.siderPanelList.map(c=>(c.name===e?(c.show=t,c.zIndex=Math.max(...a)):c.zIndex>i&&c.zIndex--,c.show&&(r=!0),c)),showSider:r}},()=>{n()})})}showMainByName(e,t){return new Promise(n=>{this.setState(s=>({mainList:s.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{n()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Me.DOCUMENT).getObserver("onDocContainerDidMountObservable"))==null||e.notifyObservers(this)})}render(){const{addButton:e,context:t}=this.props.config,{layout:n,currentLocale:s,currentSkin:r,siderPanelList:i,mainList:a,showSider:l,renderState:c}=this.state;return f(Is.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},f(gn,{ref:this.layoutContainerRef,className:Xn.layoutContainer},f(fn,null,f(zt,{style:{display:n.outerLeft?"block":"none"}}),f(fn,{className:Xn.mainContent,style:{position:"relative"}},f(Pr,{style:{display:n.header?"block":"none"}},n.infoBar&&f(vb,null),n.toolBar&&f(pb,{toolList:[]})),f(fn,null,f(zt,{style:{display:n.innerLeft?"block":"none"}}),f(Ur,{className:n.contentSplit==="vertical"?Xn.contentContainerVertical:Xn.contentContainerHorizontal},a.map((u,h)=>{if(u.type===Un.JSX)return ro(u.content,{style:{display:u.show?"":"none"}});if(u.type===Un.JSX_STRING){const d=this.Render.renderFunction(u.content);return this.refMap[u.name]=ee(),f(d,{ref:this.refMap[u.name],style:{display:u.show?"":"none"}})}return u}),!!n.contentSplit&&f(gn,{ref:this.splitLeftRef,className:Xn.contentInnerLeftContainer},f("div",{className:Xn.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),f(gn,{ref:this.contentRef,className:Xn.contentInnerRightContainer,onClick:this.handleContentClick})),f(zt,{style:{display:n.innerRight?"block":"none"}})),f(zr,{style:{display:n.footer?"block":"none"}})),f(zt,{style:{display:n.outerRight&&l?"block":"none"},className:Xn.outerRightContainer},i.map((u,h)=>u.type===Un.JSX?ro(u.label,{style:{display:u.show?"":"none",zIndex:u.zIndex}}):u)))))}}const Cb=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Eb=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];class wb{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class n6{constructor(e){this._plugin=e,this._plugin.getPluginName(),this._initRegisterComponent();const t=this._plugin.config.layout==="auto"?R.deepClone(Jr.toolBarConfig):R.deepMerge(Jr.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:t.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:t.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",selectClassName:es.selectLabelString,show:t.font,border:!0,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||s.notifyObservers(n)},children:Eb},{type:1,tooltipLocale:"toolbar.fontSize",label:String(Zn.fs),show:t.fontSize,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},onKeyUp:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},children:Cb},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:t.bold,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:t.italic,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:t.strikethrough,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:t.underline,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:t.textColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:t.fillColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||s.notifyObservers(n)}}],this._toolBarModel=new wb,this._toolBarModel.config=t,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,s,r,i,a,l,c,u;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(h=>{this.setFontFamily(h)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(h=>{this.setFontSize(h)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(h=>{this.setFontWeight(h)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(h=>{this.setFontStyle(h)}),(r=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||r.add(h=>{this.setStrikeThrough(h)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(h=>{this.setUnderline(h)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(h=>{this.setFontColor(h)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(h=>{this.setBackground(h)}),(c=this._plugin.getObserver("onToolBarDidMountObservable"))==null||c.add(h=>{this._toolBarComponent=h,this.resetToolBarList()}),(u=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null||u.add(()=>{})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet");this._plugin.getPluginName(),this.Render=e.getComponentRender();const t={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};for(let n in t)this._plugin.registerComponent(n,t[n])}resetLocale(e){const t=this._plugin.context.getLocale();for(let n=0;n<e.length;n++){const s=e[n];s.tooltipLocale&&(s.tooltip=t.get(s.tooltipLocale)),s.locale&&(s.label=t.get(s.locale)),s.suffixLocale&&(s.suffix=t.get(s.suffixLocale)),s.children&&(s.children=this.resetLocale(s.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){}setBackground(e){}setFontSize(e){}setFontFamily(e){}setFontWeight(e){}setFontStyle(e){}setStrikeThrough(e){}setUnderline(e){}}class Sb{constructor(e){this._plugin=e,this._initialize()}_initialize(){}}class yb{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class o6{constructor(e){this._plugin=e;const t="UniverDoc Demo";this._infoBarModel=new yb(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setDocName(n)}}},this._initialize()}_initialize(){this._plugin.context.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Me.DOCUMENT).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setDocName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class Qr{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var Gs=(o=>(o.MAIN_SCENE="mainScene",o.DOCS_VIEW="docsView",o))(Gs||{});const js=cn.create(),Tb={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Ue.COLUMN,posOffset:100},positionV:{relativeFrom:$e.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:Bt.WRAP_SQUARE,behindDoc:Y.FALSE,wrapText:un.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:yt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:H.DRAWING},{elementId:"smallSub",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}};var Ba=(o=>(o.MAIN="__DocsRender__",o))(Ba||{});class Rb extends Qr{constructor(){super(...arguments),this.zIndex=1,this.viewKey=Gs.DOCS_VIEW}_initialize(){const e=this.getScene();this.getContext();const t=this._buildSkeleton(),n=new ws("__DocsRender__",t);n.zIndex=1e3,this._documentSkeleton=t,this._documents=n,t.calculate(),e.addObjects([n],0);const s=e.getEngine();if(s){const{width:r,height:i}=s,{width:a,height:l,pageMarginLeft:c,pageMarginTop:u}=n;let h=0,d=0,g=0,m=0;r>a?(h=r/2-a/2,g=r-30):(h=c,g=a+c*2),i>l?(d=i/2-l/2,m=i-30):(d=u,m=l+u*2),e.resize(g,m),n.translate(h,d)}n.enableEditor()}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_buildSkeleton(){const e=this.getContext();return Lo.create(Tb,e)}}js.add(new Rb);const Ab="page_view_background";class Ib extends Qr{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Ab}_initialize(){var s;const e=this.getScene();this.getContext();const t=e.getObject(Ba.MAIN),n=(s=t.getSkeleton())==null?void 0:s.getPageSize();t.onPageRenderObservable.add(r=>{const{page:i,pageLeft:a,pageTop:l,ctx:c}=r,{width:u,height:h,marginBottom:d,marginLeft:g,marginRight:m,marginTop:_}=i;c.save(),c.translate(a-.5,l-.5),Fe.drawWith(c,{width:(n==null?void 0:n.width)||u,height:(n==null?void 0:n.height)||h,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),c.restore()})}}js.add(new Ib);const Db="drawings_view_background";class Ob extends Qr{constructor(){super(...arguments),this.zIndex=3,this.viewKey=Db}_initialize(){var u;const e=this.getScene();this.getContext();const t=e.getObject(Ba.MAIN),n=t.getSkeleton(),s=n==null?void 0:n.getSkeletonData();if(!s)return;const{left:r,top:i}=t,{pages:a}=s,l=[],c=new Map;for(let h of a){const{skeDrawings:d,marginLeft:g,marginTop:m}=h;d.forEach(_=>{const{aLeft:p,aTop:v,height:b,width:C}=_,D=new Fe(_.objectId,{left:p+r+g,top:v+i+m,width:C,height:b,fill:"rgba(102,111,99, 0.8)",zIndex:11,isTransformer:!0});c.set(_.objectId,{marginLeft:g,marginTop:m}),l.push(D)})}e.openTransformer(),e.addObjects(l),(u=e.getTransformer())==null||u.onChangingObservable.add(h=>{const{objects:d}=h;d.forEach(g=>{const{oKey:m,left:_,top:p,height:v,width:b}=g,C=c.get(m),D=(C==null?void 0:C.marginLeft)||0,O=(C==null?void 0:C.marginTop)||0;n==null||n.updateDrawing(m,{left:_-r-D,top:p-i-O,height:v,width:b})}),n==null||n.calculate()}),e.closeTransformer()}}js.add(new Ob);const xb="page_view_background";class Mb extends Qr{constructor(){super(...arguments),this.zIndex=3,this.viewKey=xb}_initialize(){const e=this.getScene();this.getContext();const t=new br("TEXT_POLYGON_KEY_PREFIX_TEST",{pointsGroup:[[{x:100,y:10},{x:40,y:180},{x:190,y:60},{x:10,y:60},{x:160,y:180}]],fill:lt(Io.black,.2),isTransformer:!0});e.openTransformer(),e.addObjects([t]),e.closeTransformer()}}js.add(new Mb);class kb{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine;this._plugin.getContext();const t=new Ki(Gs.MAIN_SCENE,e,{width:1200,height:2e3});this._scene=t;const n=new Uo(Gs.DOCS_VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(bt.wheel,(s,r)=>{const i=s;if(i.ctrlKey){const a=Math.abs(i.deltaX);let l=a<40?.2:a<80?.4:.2;l*=i.deltaY>0?-1:1,t.scaleX<1&&(l/=2),t.scaleX+l>4?t.scale(4,4):t.scaleX+l<.1?t.scale(.1,.1):(i.deltaY>0,i.preventDefault())}else n.onMouseWheel(i,r)}),new Ni(n),t.addLayer(oo.create(t,[],0),oo.create(t,[],2)),this._viewLoader(t,this._plugin),e.runRenderLoop(()=>{t.render();const s=document.getElementById("app");s&&(s.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getDocsView(){return this.getView(Gs.DOCS_VIEW)}_viewLoader(e,t){js.getData().sort(ht).forEach(n=>{this._views.push(n.initialize(e,t))})}}const Bb={container:"univerdoc",layout:"auto"};class Fa extends To{constructor(e={}){super(Me.DOCUMENT),this._config=R.commonExtend(Bb,e)}static create(e){return new Fa(e)}installTo(e){e.installPlugin(this)}initialize(){var r;const e=this.getContext();(r=this.getObserver("onDocContainerDidMountObservable"))==null||r.add(()=>{this._initializeRender()}),e.getLocale().load({en:db,zh:hb}),this._componentList=new Map;const t=this._config.layout;(t==="auto"||t.toolBar)&&(this._toolBarControl=new n6(this)),(t==="auto"||t.infoBar)&&(this._infoBarControl=new o6(this)),this._toolBarControl=new n6(this),this._infoBarControl=new o6(this),this._docContainerController=new Sb(this);const n=this._initContainer(this._config.container),s={skin:"default",layout:this._config.layout,container:n,context:e,getSplitLeftRef:i=>{this._splitLeftRef=i},getContentRef:i=>{this._contentRef=i},addButton:i=>{this._addButtonFunc=i},addSider:i=>{this._addSiderFunc=i},addMain:i=>{this._addMainFunc=i},showSiderByName:i=>{this._showSiderByNameFunc=i},showMainByName:i=>{this._showMainByNameFunc=i},onDidMount:()=>{}};zn(f(bb,{config:s}),n)}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else sa(e)?t=e:(t=document.createElement("div"),t.id="univerdoc");return t}_initializeRender(){var t;const e=(t=this.getPluginByName(Me.BASE_RENDER))==null?void 0:t.getEngine();this.register(e)}register(e){let t=Ms(this.getContentRef());this._canvasEngine=e,e.setContainer(t),this._canvasView=new kb(e,this),window.onresize=()=>{e.resize()}}get config(){return this._config}getContentRef(){return this._contentRef}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}onMounted(e){gb(this),this.initialize()}onDestroy(){}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}}var Fb={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},Nb={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};function Lb(o){o.pushToObserve("onAfterChangeFontFamilyObservable"),o.pushToObserve("onAfterChangeFontSizeObservable"),o.pushToObserve("onAfterChangeFontWeightObservable"),o.pushToObserve("onAfterChangeFontItalicObservable"),o.pushToObserve("onAfterChangeFontStrikethroughObservable"),o.pushToObserve("onAfterChangeFontUnderlineObservable"),o.pushToObserve("onAfterChangeFontBackgroundObservable"),o.pushToObserve("onAfterChangeFontColorObservable"),o.pushToObserve("onDragAndDropStartObserver"),o.pushToObserve("onDragAndDroppingObserver"),o.pushToObserve("onDragAndDropEndEndObserver"),o.pushToObserve("onFillStartObserver"),o.pushToObserve("onFillingObserver"),o.pushToObserve("onFillEndObserver"),o.pushToObserve("onChangeCurrentSheetObserver"),o.pushToObserve("onToolBarDidMountObservable"),o.pushToObserve("onSheetBarDidMountObservable"),o.pushToObserve("onCountBarDidMountObservable"),o.pushToObserve("onInfoBarDidMountObservable"),o.pushToObserve("onSlideBarDidMountObservable"),o.pushToObserve("onRightMenuDidMountObservable"),o.pushToObserve("onSlideContainerDidMountObservable"),o.pushToObserve("onSpreadsheetKeyDownObservable"),o.pushToObserve("onSpreadsheetKeyUpObservable"),o.pushToObserve("onSpreadsheetKeyCopyObservable"),o.pushToObserve("onSpreadsheetKeyPasteObservable"),o.pushToObserve("onSpreadsheetKeyCutObservable"),o.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),o.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),o.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}var Yn={layoutContainer:"univer-layout-container",contentContainerHorizontal:"univer-content-container-horizontal",contentInnerLeftContainer:"univer-content-inner-left-container",hoverCursor:"univer-hover-cursor",contentInnerRightContainer:"univer-content-inner-right-container",contentContainerVertical:"univer-content-container-vertical",mainContent:"univer-main-content",outerRightContainer:"univer-outer-right-container"},Pb={textButton:"univer-text-button"};class zb extends _e{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return f("div",{className:Pb.textButton},f(n,{type:"text",active:t,onClick:this.handleClick},e))}}var ts={toolbarWarp:"univer-toolbar-warp",singleButton:"univer-single-button",moreHide:"univer-more-hide",moreShow:"univer-more-show",toolbar:"univer-toolbar",selectButton:"univer-select-button",colsMenu:"univer-cols-menu",selectLabelString:"univer-select-label-string",dropContent:"univer-drop-content",selectColorPickerParent:"univer-select-color-picker-parent",selectItemContent:"univer-select-item-content",selectColorPicker:"univer-select-color-picker",selectItem:"univer-select-item",doubleButton:"univer-double-button",colorBottom:"univer-color-bottom",doubleButtonRight:"univer-double-button-right",doubleButtonRightPopup:"univer-double-button-right-popup",doubleButtonMenuItem:"univer-double-button-menu-item",doubleButtonMenuItemIcon:"univer-double-button-menu-item-icon",doubleButtonMenuItemContent:"univer-double-button-menu-item-content",moreButton:"univer-more-button",moreTool:"univer-more-tool",univericonNextIcon:"univer-univericon-nextIcon"},Ks={selectItem:"univer-select-item",selectItemSelected:"univer-select-item-selected",selectItemContent:"univer-select-item-content",selectItemSuffix:"univer-select-item-suffix",selectDisabledItem:"univer-select-disabled-item"};class Na extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:r}=this.props;return f("div",{className:Ct(Ks.selectItem,r?Ks.selectDisabledItem:"")},t?f("span",{className:Ks.selectItemSelected},f(e,null)):"",f("span",{className:Ks.selectItemContent},n),s?f("span",{className:Ks.selectItemSuffix},s):"")}}var Ht={selectComponent:"univer-select-component",selectButton:"univer-select-button",selectSingle:"univer-select-single",selectInput:"univer-select-input",selectColor:"univer-select-color",colsMenu:"univer-cols-menu",colsMenuitem:"univer-cols-menuitem",selectItem:"univer-select-item",selectDouble:"univer-select-double",dropdown:"univer-dropdown",dropContent:"univer-drop-content",selectLine:"univer-select-line",dropIcon:"univer-drop-icon",selectLabel:"univer-select-label"};class Ub extends _e{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(r=>{r.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Button");return f("div",{className:`${Ht.selectSingle} ${n}`},f(r,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return f("div",{className:`${Ht.selectInput} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},f(r,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{color:s,menu:r}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return f("div",{className:`${Ht.selectColor} ${Ht.selectDouble} ${t}`},f(i,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:r,onClick:this.onClick},icon:f(a,null)},f("div",{className:Ht.selectLabel},e),f("div",{className:Ht.selectLine,style:{background:s}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{selectClassName:n="",tooltip:s}=this.props,r=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return f("div",{className:`${Ht.selectDouble} ${n}`},f(i,{type:"text"},f(ct,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:f(r,null)},f("div",{className:Ht.selectLabel},e))))},this.getFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button");return f("div",{className:`${Ht.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},f("div",{className:Ht.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,selectClassName:t="",tooltip:n}=this.props,{menu:s}=this.state,r=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return f("div",{className:`${Ht.selectDouble} ${t}`},f(r,{type:"text"},f(ct,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:f(i,null)},f("div",{className:Ht.selectLabel},e))))}}initialize(){var r;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(r=this.props.defaultColor)!=null?r:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}componentDidMount(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=this.handleSelected(r),a=n[r];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...l)=>{var h,d;const c=n[l[2]];if((d=(h=this.props).onClick)==null||d.call(h,l[1],l[2],l[3]),c.unSelectable)return;const u=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:u}):this.setState({content:n[l[2]].label,menu:u})}}else if(e===1){if(!n.length)return;const r=i=>{if(i!==null){if(i==="")return;let a=n.findIndex(c=>i===c.label),l=this.handleSelected(a<0?null:a);this.setState({content:i,menu:l})}else{let a=n.findIndex(u=>u.selected);a<0&&(a=0);let l=this.handleSelected(a);const c=n[a];this.setState({content:c.label,menu:l})}};r(s),this.onClick=(...i)=>{var l,c;(c=(l=this.props).onClick)==null||c.call(l,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:n[i[2]].label,menu:a})},this.onKeyUp=i=>{var l,c;const a=i.currentTarget.value;(c=(l=this.props).onKeyUp)==null||c.call(l,a),r(a)}}else if(e===2){const r=this.handleSelected(null);this.setState({menu:r}),this.onClick=()=>{var a,l;const{color:i}=this.state;(l=(a=this.props).onClick)==null||l.call(a,i)}}else if(e===4||e===5){if(!n.length)return;let r=n.findIndex(l=>l.selected);r<0&&(r=0);const i=n[r],a=this.handleSelected(r);this.setState({menu:a,value:i.value}),this.onClick=(...l)=>{var c,u,h,d;if(l.length){(u=(c=this.props).onClick)==null||u.call(c,l[1],l[2],l[3]);const g=this.handleSelected(l[2]);this.setState({menu:g,value:n[l[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}resetMenu(e,t){var s;const n=[];for(let r=0;r<e.length;r++){let i=!1;t||(i=(s=e[r].selected)!=null?s:!1),n[r]={label:""},n[r].label=f(Na,{disabled:e[r].disabled,border:e[r].border,selected:i,label:e[r].label,suffix:e[r].suffix}),n[r].disabled=e[r].disabled,n[r].style=e[r].style,n[r].value=e[r].value,n[r].className=e[r].className,n[r].onClick=e[r].onClick,e[r].children&&(n[r].children=this.getChildren(e[r].children))}return this.props.type===2&&(n[0]={label:f(Na,{label:f(tn,{style:{display:"block"},ref:r=>this.ColorRef=r,color:"#000",onClick:r=>{this.ColorRef.hideSelect(),this.setState({color:r},()=>{this.onClick()})}})})}),n}getChildren(e){return e.map(n=>{const s=this.props.hideSelectedIcon?!1:n.selected;return n.label=f(Na,{disabled:n.disabled,border:n.border,selected:s,label:n.label,suffix:n.suffix}),n.children&&(n.children=this.getChildren(n.children)),n})}render(){const{type:e=0}=this.props;return f("div",{className:Ht.selectComponent},this.getType(e))}}class Wb extends _e{constructor(){super(...arguments),this.toolbarWarp=ee(),this.toolbarRef=ee(),this.moreBtn=ee(),this.moreToolRef=ee(),this.SelectRef=ee(),this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Me.SLIDE);for(let r=0;r<e.length;r++){const i=e[r];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const l=(n=i.customLabel.props)!=null?n:{};i.label=f(a,{...l})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const l=(s=i.customSuffix.props)!=null?s:{};i.suffix=f(a,{...l})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e})}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{toolList:n}=t,s=this.Render.renderFunction("Button"),r=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return f(r,{style:{position:"relative"}},f("div",{className:ts.toolbarWarp,ref:this.toolbarWarp},f("div",{className:ts.toolbar,ref:this.toolbarRef},n.map(a=>a.toolbarType?f(i,{title:a.tooltip,placement:"bottom"},f(zb,{label:a.label,onClick:a.onClick})):f(Ub,{tooltip:a.tooltip,type:a.type,display:a.display,children:a.children,customLabel:a.customLabel,customSuffix:a.customSuffix,label:a.label,onClick:a.onClick,onKeyUp:a.onKeyUp,defaultColor:a.defaultColor,hideSelectedIcon:a.hideSelectedIcon,selectClassName:a.selectClassName}))),this.state.moreToolList.length===0?null:f("div",{ref:this.moreBtn,className:ts.singleButton},f(i,{title:this.state.moreText,placement:"bottom"},f(s,{type:"text",onClick:this.moreTool},f("div",{style:{fontSize:"14px"}},this.state.moreText))))),f("div",{className:`${ts.moreTool} ${this.state.more?ts.moreShow:null}`,ref:this.moreToolRef}))}}var zT="";class Hb extends _e{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Me.SLIDE))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),s=this.Render.renderFunction("Tooltip"),r=this.Render.renderFunction("DropDownIcon");this.Render.renderFunction("LogoIcon");const{back:i,sheet:a,update:l,save:c,rename:u}=this.state.infoList;return f(t,{className:"universheet-info-detail"},f("div",{style:{marginRight:"18px"}},f(s,{title:i.label,placement:"bottom"},f(e,{className:"universheet-info-return",type:"text"},f(r,{rotate:90})))),f("div",{className:"sheet-name"},f(s,{title:u.label,placement:"bottom"},f(n,{bordered:!1,value:a.label,onBlur:a.onBlur}))),f("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},l.label),f("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},c.label))}}var Gn={slideBar:"univer-slide-bar",slideBarContent:"univer-slide-bar-content",slideBarItem:"univer-slide-bar-item",slideBarBox:"univer-slide-bar-box",slideBarItemActive:"univer-slide-bar-item-active",slideAddButton:"univer-slide-add-button"};class $b extends _e{constructor(){super(...arguments),this.slideBarRef=ee()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={slideList:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSlideBarDidMountObservable",Me.SLIDE))==null||e.notifyObservers(this)}setSlide(e){this.setState({slideList:e})}handleClick(e){const t=this.slideBarRef.current.querySelectorAll(`.${Gn.slideBarItem}`);for(let n=0;n<t.length;n++)t[n].classList.remove(Gn.slideBarItemActive);t[e].classList.add(Gn.slideBarItemActive)}render(){const e=this._render.renderFunction("Button"),{addSlide:t}=this.props,{slideList:n}=this.state;return f("div",{className:Gn.slideBar,ref:this.slideBarRef},f("div",{className:Gn.slideBarContent},n.map((s,r)=>f("div",{className:Gn.slideBarItem,onClick:()=>this.handleClick(r)},f("span",null,r+1),f("div",{className:Gn.slideBarBox})))),f("div",{className:Gn.slideAddButton},f(e,{type:"text",onClick:t},"+")))}}const ei={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,toolBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class Vb extends _e{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=ee(),this.rightRef=ee(),this.menuRef=ee(),this.cellRightRef=ee(),this.btnRef=ee(),this.contentRef=ee(),this.layoutContainerRef=ee(),this.containerRef=ee(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var g,m,_,p,v;this.leftContentLeft=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().left,this.leftContentTop=(m=this.splitLeftRef.current)==null?void 0:m.getBoundingClientRect().top;const d=(_=this.splitLeftRef.current)==null?void 0:_.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(v=d==null?void 0:d.getBoundingClientRect())==null?void 0:v.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,g=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,g=g>=this.rightBorderY?this.rightBorderY:g,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${g}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:n,layout:s,context:r,addSider:i,addMain:a,showSiderByName:l,showMainByName:c}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),l(this.showSiderByName.bind(this)),c(this.showMainByName.bind(this));const u=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=u.getComponentRender(),this.setSkin(t,n),this.state={layout:s==="auto"?R.deepClone(ei):R.deepMerge(ei,s),currentLocale:r.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}setSkin(e,t){let n=document.documentElement,r={default:ya,dark:Ta,green:Ra}[t];r=Object.fromEntries(Object.keys(r).map(l=>[`--${l.replace(/([A-Z])/g,"-$1").toLowerCase()}`,r[l]])),R.isIEBrowser()?on({rootElement:n,variables:r}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(r).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(l){const c="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===c)return a(document.styleSheets[d],l),document.styleSheets[d];const u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=c,u.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,c){let u=0;for(let h=0;h<l.cssRules.length;h++){const d=l.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${c}`){u=h,l.deleteRule(u);break}}}}addSider(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.siderPanelList.length+1});return{siderPanelList:[...n.siderPanelList,s]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(n=>{const s=Object.assign(e,{show:!1,zIndex:n.mainList.length+1});return{mainList:[...n.mainList,s]}},()=>{t()})})}showSiderByName(e,t){return new Promise(n=>{this.setState(s=>{let r=!1,i=0,a=s.siderPanelList.map(c=>(c.name===e&&(i=c.zIndex),c.zIndex));return{siderPanelList:s.siderPanelList.map(c=>(c.name===e?(c.show=t,c.zIndex=Math.max(...a)):c.zIndex>i&&c.zIndex--,c.show&&(r=!0),c)),showSider:r}},()=>{n()})})}showMainByName(e,t){return new Promise(n=>{this.setState(s=>({mainList:s.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{n()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Me.SLIDE).getObserver("onSlideContainerDidMountObservable"))==null||e.notifyObservers(this)})}addSlide(){this.getContext().getPluginManager().getRequirePluginByName(Me.SLIDE).getSlideBarControl().addSlide()}render(){const{addButton:e,context:t}=this.props.config,{layout:n,currentLocale:s,currentSkin:r,siderPanelList:i,mainList:a,showSider:l,renderState:c}=this.state;return f(Is.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},f(gn,{ref:this.layoutContainerRef,className:Yn.layoutContainer},f(fn,null,f(zt,{style:{display:n.outerLeft?"block":"none"}}),f(fn,{className:Yn.mainContent,style:{position:"relative"}},f(Pr,{style:{display:n.header?"block":"none"}},n.infoBar&&f(Hb,null),n.toolBar&&f(Wb,{toolList:[]})),f(fn,null,f(zt,{style:{width:"300px",display:n.innerLeft?"block":"none"}},f($b,{addSlide:this.addSlide.bind(this)})),f(Ur,{className:n.contentSplit==="vertical"?Yn.contentContainerVertical:Yn.contentContainerHorizontal},a.map((u,h)=>{if(u.type===Un.JSX)return ro(u.content,{style:{display:u.show?"":"none"}});if(u.type===Un.JSX_STRING){const d=this.Render.renderFunction(u.content);return this.refMap[u.name]=ee(),f(d,{ref:this.refMap[u.name],style:{display:u.show?"":"none"}})}return u}),!!n.contentSplit&&f(gn,{ref:this.splitLeftRef,className:Yn.contentInnerLeftContainer},f("div",{className:Yn.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),f(gn,{ref:this.contentRef,className:Yn.contentInnerRightContainer,onClick:this.handleContentClick})),f(zt,{style:{display:n.innerRight?"block":"none"}})),f(zr,{style:{display:n.footer?"block":"none"}})),f(zt,{style:{display:n.outerRight&&l?"block":"none"},className:Yn.outerRightContainer},i.map((u,h)=>u.type===Un.JSX?ro(u.label,{style:{display:u.show?"":"none",zIndex:u.zIndex}}):u)))))}}const Xb=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Yb=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];class s6 extends _e{initialize(){var t;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={locale:"",color:(t=this.props.color)!=null?t:"#000"}}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setLocale(){const e=this.context.locale;this.setState({locale:e.get("borderLine.borderColor")})}setColor(e){this.setState({color:e})}render(){const e=this.Render.renderFunction("RightIcon"),{locale:t,color:n}=this.state;return f("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},f("span",{style:{display:"inline-block",borderBottom:`3px solid ${n}`}},t),f(e,null))}}class Gb{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class jb{constructor(e){this._plugin=e,this._plugin.getPluginName(),this._initRegisterComponent();const t=this._plugin.config.layout==="auto"?R.deepClone(ei.toolBarConfig):R.deepMerge(ei.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:t.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:t.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",selectClassName:ts.selectLabelString,show:t.font,border:!0,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||s.notifyObservers(n)},children:Yb},{type:1,tooltipLocale:"toolbar.fontSize",label:String(Zn.fs),show:t.fontSize,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},onKeyUp:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||s.notifyObservers(n)},children:Xb},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:t.bold,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:t.italic,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:t.strikethrough,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||s.notifyObservers(n)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:t.underline,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:t.textColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||s.notifyObservers(n)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:t.fillColor,onClick:n=>{var s;(s=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||s.notifyObservers(n)}}],this._toolBarModel=new Gb,this._toolBarModel.config=t,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,s,r,i,a,l,c,u;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(h=>{this.setFontFamily(h)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(h=>{this.setFontSize(h)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(h=>{this.setFontWeight(h)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(h=>{this.setFontStyle(h)}),(r=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||r.add(h=>{this.setStrikeThrough(h)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(h=>{this.setUnderline(h)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(h=>{this.setFontColor(h)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(h=>{this.setBackground(h)}),(c=this._plugin.getObserver("onToolBarDidMountObservable"))==null||c.add(h=>{this._toolBarComponent=h,this.resetToolBarList()}),(u=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null||u.add(()=>{})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet"),t=this._plugin.getPluginName();this.Render=e.getComponentRender();const n={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};this._plugin.registerComponent(t+s6.name,s6),this._plugin.registerComponent(t+tn.name,tn);for(let s in n)this._plugin.registerComponent(s,n[s])}resetLocale(e){const t=this._plugin.context.getLocale();for(let n=0;n<e.length;n++){const s=e[n];s.tooltipLocale&&(s.tooltip=t.get(s.tooltipLocale)),s.locale&&(s.label=t.get(s.locale)),s.suffixLocale&&(s.suffix=t.get(s.suffixLocale)),s.children&&(s.children=this.resetLocale(s.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){}setBackground(e){}setFontSize(e){}setFontFamily(e){}setFontWeight(e){}setFontStyle(e){}setStrikeThrough(e){}setUnderline(e){}}class Kb{constructor(e){this._plugin=e,this._initialize()}_initialize(){}}class qb{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class Zb{constructor(e){this._plugin=e;const t="UniverSlide Demo";this._infoBarModel=new qb(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setSlideName(n)}}},this._initialize()}_initialize(){this._plugin.context.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Me.SLIDE).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSlideName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class Jb{constructor(e){this._plugin=e,this._slideList=[{},{},{},{},{}],this._init()}_init(){this._plugin.context.getObserverManager().requiredObserver("onSlideBarDidMountObservable",Me.SLIDE).add(n=>{this._slideBar=n,this._slideBar.setSlide(this._slideList)})}addSlide(){this._slideList.push({}),this._slideBar.setSlide(this._slideList)}}class Qb{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var qs=(o=>(o.MAIN_SCENE="mainScene",o.DOCS_VIEW="docsView",o))(qs||{});const r6=cn.create(),e2={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Ue.COLUMN,posOffset:100},positionV:{relativeFrom:$e.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:Bt.WRAP_SQUARE,behindDoc:Y.FALSE,wrapText:un.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:yt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:H.DRAWING},{elementId:"smallSub",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},t2={documentId:"d",body:{blockElements:{twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u795D\u8D3ABabylon\u4E2D\u6587\u7F51\u987A\u5229\u542F\u52A8\uFF01",ts:{fs:30,cl:{rgb:"rgb(196,62,28)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["twoParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};class n2 extends Qb{constructor(){super(...arguments),this.zIndex=1,this.viewKey=qs.DOCS_VIEW}_initialize(){const e=this.getScene();this.getContext();const t=e.getEngine();if(!t)return;const n=1384,s=500,{width:r,height:i}=t,a=r/2-n/2,l=i/2-s/2,c=new Fe("canvas",{left:a,top:l,width:n,height:s,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),u=new ps({url:"https://cnbabylon.com/assets/img/banner_doc_cnbabylon.jpg",top:l+68,left:a,width:1384,height:432,zIndex:13,isTransformer:!0}),h=new mh(this.getContext(),"richText1",{richText:t2,width:420,zIndex:20,left:r/2-210,top:l+10,isTransformer:!0});e.openTransformer(),e.addObjects([c,u,h])}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_buildSkeleton(){const e=this.getContext();return Lo.create(e2,e)}}r6.add(new n2);class o2{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine;this._plugin.getContext();const t=new Ki(qs.MAIN_SCENE,e,{width:1200,height:2e3});this._scene=t;const n=new Uo(qs.DOCS_VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(bt.wheel,(s,r)=>{const i=s;if(i.ctrlKey){const a=Math.abs(i.deltaX);let l=a<40?.2:a<80?.4:.2;l*=i.deltaY>0?-1:1,t.scaleX<1&&(l/=2),t.scaleX+l>4?t.scale(4,4):t.scaleX+l<.1?t.scale(.1,.1):(i.deltaY>0,i.preventDefault())}else n.onMouseWheel(i,r)}),new Ni(n),t.addLayer(oo.create(t,[],0),oo.create(t,[],2)),this._viewLoader(t,this._plugin),e.runRenderLoop(()=>{t.render();const s=document.getElementById("app");s&&(s.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getDocsView(){return this.getView(qs.DOCS_VIEW)}_viewLoader(e,t){r6.getData().sort(ht).forEach(n=>{this._views.push(n.initialize(e,t))})}}const s2={container:"universlide",layout:"auto"};class La extends To{constructor(e={}){super(Me.SLIDE),this._config=R.commonExtend(s2,e)}static create(e){return new La(e)}installTo(e){e.installPlugin(this)}initialize(){var r;const e=this.getContext();(r=this.getObserver("onSlideContainerDidMountObservable"))==null||r.add(()=>{this._initializeRender()}),e.getLocale().load({en:Nb,zh:Fb}),this._componentList=new Map;const t=this._config.layout;(t==="auto"||t.toolBar)&&(this._toolBarControl=new jb(this)),(t==="auto"||t.infoBar)&&(this._infoBarControl=new Zb(this)),this._slideBarControl=new Jb(this),this._slideContainerController=new Kb(this);const n=this._initContainer(this._config.container),s={skin:"default",layout:this._config.layout,container:n,context:e,getSplitLeftRef:i=>{this._splitLeftRef=i},getContentRef:i=>{this._contentRef=i},addButton:i=>{this._addButtonFunc=i},addSider:i=>{this._addSiderFunc=i},addMain:i=>{this._addMainFunc=i},showSiderByName:i=>{this._showSiderByNameFunc=i},showMainByName:i=>{this._showMainByNameFunc=i},onDidMount:()=>{}};zn(f(Vb,{config:s}),n)}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else sa(e)?t=e:(t=document.createElement("div"),t.id="universlide");return t}_initializeRender(){var t;const e=(t=this.getPluginByName(Me.BASE_RENDER))==null?void 0:t.getEngine();this.register(e)}register(e){let t=Ms(this.getContentRef());this._canvasEngine=e,e.setContainer(t),this._canvasView=new o2(e,this),window.onresize=()=>{e.resize()}}get config(){return this._config}getContentRef(){return this._contentRef}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSlideBarControl(){return this._slideBarControl}onMounted(){Lb(this),this.initialize()}onDestroy(){}registerComponent(e,t){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}}const r2={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Ue.COLUMN,posOffset:100},positionV:{relativeFrom:$e.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:Bt.WRAP_SQUARE,behindDoc:Y.FALSE,wrapText:un.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Pe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Pe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Pe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:yt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:H.DRAWING},{elementId:"smallSub",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},ti={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ke.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:yt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:H.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:H.TEXT_RUN},{elementId:"smallSub",paragraphElementType:H.TEXT_RUN},{elementId:"twoElement",paragraphElementType:H.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},i2={id:"workbook-01",theme:"default",locale:Kn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:Y.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{cl:{rgb:"blue"},fs:16,bd:{t:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:ye.THICK,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"red"}}},ht:3},2:{bg:{rgb:"rgb(200, 2, 0)"},fs:24,ht:ze.RIGHT,vt:St.TOP},3:{ht:ze.RIGHT,vt:St.MIDDLE,tb:at.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:Y.FALSE},bd:{t:{s:ye.THIN,cl:{rgb:"black"}},l:{s:ye.THIN,cl:{rgb:"black"}},r:{s:ye.THIN,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}},5:{tb:at.WRAP}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-01":{type:Kt.GRID,id:"sheet-01",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:1,m:"1"},1:{v:1,m:"1"},2:{v:80,m:"80",s:"3"},3:{v:"\u5BCC\u6587\u672C\u7F16\u8F91",m:"\u5BCC\u6587\u672C\u7F16\u8F91",s:"2"}},2:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:"\u505A\u79FB\u52A8\u7AEF\u5F00\u53D1\u548C\u524D\u7AEF\u5F00\u53D1\u7684\u4EBA\u5458\uFF0C\u5BF9 MVC\u3001MVP\u3001MVVM \u8FD9\u51E0\u4E2A\u540D\u8BCD\u5E94\u8BE5\u90FD\u4E0D\u964C\u751F\uFF0C\u8FD9\u662F\u4E09\u4E2A\u6700\u5E38\u7528\u7684\u5E94\u7528\u67B6\u6784\u6A21\u5F0F\uFF0C\u76EE\u7684\u90FD\u662F\u4E3A\u4E86\u5C06\u4E1A\u52A1\u548C\u89C6\u56FE\u7684\u5B9E\u73B0\u4EE3\u7801\u5206\u79BB",s:"3",p:ti}},20:{10:{v:"\u5317\u4EAC\u9A6C\u62C9\u677E\u7EC4\u59D4\u4F1A\u529E\u516C\u5BA4\u4E00\u4F4D\u63A5\u7535\u8BDD\u7684\u5973\u58EB\u8BC1\u5B9E\uFF0C\u7684\u786E\u6709\u8FD9\u9879\u89C4\u5B9A\uFF0C\u5979\u8FD8\u79F02014\u5E74\u9A6C\u62C9\u677E\u7684\u9884\u767B\u8BB0\u5DE5\u4F5C\u5C06\u5728\u672C\u5468\u542F\u52A8\u3002\u5317\u4EAC\u9A6C\u62C9\u677E\u6BD4\u8D5B\u5C06\u572810\u670819\u65E5\u4E3E\u884C\u3002",s:"3"},12:{s:"4"}},29:{13:{p:R.deepClone(ti),s:"4"}},32:{3:{p:r2,s:"5"}}},name:"sheet1",tabColor:"red",hidden:Y.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10},{startRow:32,endRow:53,startColumn:3,endColumn:5}],rowData:{3:{h:50,hd:Y.FALSE},4:{h:60,hd:Y.FALSE},29:{h:200,hd:Y.FALSE}},columnData:{5:{w:100,hd:Y.FALSE},6:{w:200,hd:Y.FALSE},13:{w:300,hd:Y.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:Y.FALSE},columnTitle:{height:20,hidden:Y.FALSE},selections:["A2"],rightToLeft:Y.FALSE,pluginMeta:{}},"sheet-02":{type:Kt.GRID,id:"sheet-02",name:"sheet2",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},20:{0:{v:"sheet2",m:"sheet2"},1:{v:"sheet2 - 2",m:"sheet2 - 2"}}}},"sheet-03":{type:Kt.GRID,id:"sheet-03",name:"sheet3"},"sheet-04":{type:Kt.GRID,id:"sheet-04",name:"sheet4"},"sheet-05":{type:Kt.GRID,id:"sheet-05",name:"sheet5"},"sheet-06":{type:Kt.GRID,id:"sheet-06",name:"sheet6"}},namedRanges:[{namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}},{namedRangeId:"named-range-02",name:"namedRange02",range:{sheetId:"sheet-01",rangeData:{startRow:4,startColumn:2,endRow:5,endColumn:3}}}]};Kn.EN,Y.FALSE,ye.MEDIUM_DASHED,ye.MEDIUM_DASHED,ye.THICK,ye.THIN,ze.RIGHT,St.TOP,at.WRAP,Y.FALSE,ye.THIN,ye.THIN,ye.THIN,ye.THIN,Kt.GRID,R.deepClone(ti),Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Y.FALSE,Kt.GRID;class a2{constructor(){}init(e={}){const t=cr.newInstance(e.coreConfig);return t.installPlugin(new Ss),t.installPlugin(new _a),t.installPlugin(new ub(e.baseSheetsConfig)),t}}const l2=function(o){return new a2().init(o)};class c2{constructor(){}init(e={}){const t=lr.newInstance(e.coreConfig);return t.installPlugin(new Ss),t.installPlugin(new _a),t.installPlugin(new Fa(e.baseDocsConfig)),t}}const u2=function(o){return new c2().init(o)};class h2{constructor(){}init(e={}){const t=ur.newInstance(e.coreConfig);return t.installPlugin(new Ss),t.installPlugin(new _a),t.installPlugin(new La(e.baseSlidesConfig)),t}}const d2=function(o){return new h2().init(o)};return jn.DEFAULT_WORKBOOK_DATA=i2,jn.UniverCore=pg,jn.univerDocCustom=u2,jn.univerSheetCustom=l2,jn.univerSlideCustom=d2,Object.defineProperties(jn,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),jn}({});
